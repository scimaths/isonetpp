Command line
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_scoring_temp_ptc_mr
--TASK=gmn_match_hinge_scoring
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--temp_gmn_scoring=5
--DATASET_NAME=ptc_mr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge baseline scoring
saving initial model to ./gmn_match_hinge_scoring_temp_ptc_mr/initialModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
no. of params in model: 2050
Run: 0 train loss: 262.740920 Time: 585.12
Run: 0 VAL ap_score: 0.404930 map_score: 0.420115 Time: 192.50
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 1 train loss: 227.093446 Time: 584.74
Run: 1 VAL ap_score: 0.409675 map_score: 0.439381 Time: 192.54
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 2 train loss: 213.889118 Time: 587.47
Run: 2 VAL ap_score: 0.385484 map_score: 0.408297 Time: 193.42
Run: 3 train loss: 204.236886 Time: 590.51
Run: 3 VAL ap_score: 0.465892 map_score: 0.452798 Time: 193.33
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 4 train loss: 196.215352 Time: 584.57
Run: 4 VAL ap_score: 0.443608 map_score: 0.427981 Time: 193.09
Run: 5 train loss: 188.357918 Time: 580.50
Run: 5 VAL ap_score: 0.463535 map_score: 0.461305 Time: 193.19
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 6 train loss: 181.199330 Time: 583.62
Run: 6 VAL ap_score: 0.483392 map_score: 0.472285 Time: 192.83
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 7 train loss: 173.927974 Time: 580.92
Run: 7 VAL ap_score: 0.478104 map_score: 0.474643 Time: 193.94
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 8 train loss: 170.419606 Time: 584.72
Run: 8 VAL ap_score: 0.480788 map_score: 0.464034 Time: 192.96
Run: 9 train loss: 166.803764 Time: 582.90
Run: 9 VAL ap_score: 0.512920 map_score: 0.491939 Time: 194.49
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 10 train loss: 162.351927 Time: 586.91
Run: 10 VAL ap_score: 0.490619 map_score: 0.480225 Time: 192.87
Run: 11 train loss: 158.463455 Time: 581.95
Run: 11 VAL ap_score: 0.481924 map_score: 0.486312 Time: 192.57
Run: 12 train loss: 155.892741 Time: 583.95
Run: 12 VAL ap_score: 0.483693 map_score: 0.490265 Time: 193.49
Run: 13 train loss: 154.042933 Time: 584.36
Run: 13 VAL ap_score: 0.500285 map_score: 0.491327 Time: 193.09
Run: 14 train loss: 151.695706 Time: 584.95
Run: 14 VAL ap_score: 0.482651 map_score: 0.487758 Time: 193.95
Run: 15 train loss: 149.431827 Time: 586.27
Run: 15 VAL ap_score: 0.490953 map_score: 0.485597 Time: 193.40
Run: 16 train loss: 147.581180 Time: 584.92
Run: 16 VAL ap_score: 0.504908 map_score: 0.501429 Time: 192.99
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 17 train loss: 146.474732 Time: 584.26
Run: 17 VAL ap_score: 0.484697 map_score: 0.499037 Time: 193.43
Run: 18 train loss: 143.802207 Time: 583.56
Run: 18 VAL ap_score: 0.515889 map_score: 0.516372 Time: 192.78
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 19 train loss: 142.928353 Time: 582.31
Run: 19 VAL ap_score: 0.511687 map_score: 0.510852 Time: 193.95
Run: 20 train loss: 140.439439 Time: 583.13
Run: 20 VAL ap_score: 0.528857 map_score: 0.504289 Time: 193.31
Run: 21 train loss: 139.689306 Time: 582.50
Run: 21 VAL ap_score: 0.511227 map_score: 0.508167 Time: 193.24
Run: 22 train loss: 138.140560 Time: 581.42
Run: 22 VAL ap_score: 0.507472 map_score: 0.498234 Time: 191.84
Run: 23 train loss: 136.571888 Time: 586.74
Run: 23 VAL ap_score: 0.528735 map_score: 0.506850 Time: 192.91
Run: 24 train loss: 136.908008 Time: 586.64
Run: 24 VAL ap_score: 0.528876 map_score: 0.512554 Time: 193.91
Run: 25 train loss: 135.606274 Time: 585.37
Run: 25 VAL ap_score: 0.478372 map_score: 0.487482 Time: 192.73
Run: 26 train loss: 133.712095 Time: 585.85
Run: 26 VAL ap_score: 0.513086 map_score: 0.501369 Time: 193.41
Run: 27 train loss: 133.065866 Time: 584.62
Run: 27 VAL ap_score: 0.500916 map_score: 0.499112 Time: 193.75
Run: 28 train loss: 132.750293 Time: 584.35
Run: 28 VAL ap_score: 0.535541 map_score: 0.521276 Time: 193.14
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 29 train loss: 131.169068 Time: 585.03
Run: 29 VAL ap_score: 0.511542 map_score: 0.509473 Time: 193.47
Run: 30 train loss: 129.499193 Time: 581.02
Run: 30 VAL ap_score: 0.535126 map_score: 0.526465 Time: 192.56
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 31 train loss: 130.299350 Time: 582.66
Run: 31 VAL ap_score: 0.536985 map_score: 0.516058 Time: 190.81
Run: 32 train loss: 129.664937 Time: 576.30
Run: 32 VAL ap_score: 0.503361 map_score: 0.508443 Time: 189.96
Run: 33 train loss: 127.288640 Time: 575.26
Run: 33 VAL ap_score: 0.502031 map_score: 0.512295 Time: 185.92
Run: 34 train loss: 126.992761 Time: 568.16
Run: 34 VAL ap_score: 0.516101 map_score: 0.519466 Time: 187.11
Run: 35 train loss: 126.404187 Time: 566.05
Run: 35 VAL ap_score: 0.540282 map_score: 0.525643 Time: 187.93
Run: 36 train loss: 126.230837 Time: 569.72
Run: 36 VAL ap_score: 0.538067 map_score: 0.532561 Time: 185.97
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 37 train loss: 124.797511 Time: 604.57
Run: 37 VAL ap_score: 0.524636 map_score: 0.525201 Time: 206.19
Run: 38 train loss: 124.157979 Time: 532.45
Run: 38 VAL ap_score: 0.503656 map_score: 0.519301 Time: 172.96
Run: 39 train loss: 123.594275 Time: 541.78
Run: 39 VAL ap_score: 0.495219 map_score: 0.522589 Time: 218.05
Run: 40 train loss: 122.448146 Time: 583.54
Run: 40 VAL ap_score: 0.531488 map_score: 0.526197 Time: 186.41
Run: 41 train loss: 122.323009 Time: 542.01
Run: 41 VAL ap_score: 0.509547 map_score: 0.518387 Time: 173.29
Run: 42 train loss: 121.217992 Time: 532.36
Run: 42 VAL ap_score: 0.499712 map_score: 0.524951 Time: 172.74
Run: 43 train loss: 121.061545 Time: 522.26
Run: 43 VAL ap_score: 0.514891 map_score: 0.532291 Time: 172.51
Run: 44 train loss: 121.104630 Time: 539.38
Run: 44 VAL ap_score: 0.522027 map_score: 0.520145 Time: 172.00
Run: 45 train loss: 119.596237 Time: 541.31
Run: 45 VAL ap_score: 0.547310 map_score: 0.537243 Time: 171.91
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 46 train loss: 119.572188 Time: 542.07
Run: 46 VAL ap_score: 0.511816 map_score: 0.536690 Time: 173.13
Run: 47 train loss: 119.088812 Time: 554.37
Run: 47 VAL ap_score: 0.543498 map_score: 0.547671 Time: 173.68
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 48 train loss: 118.306070 Time: 548.31
Run: 48 VAL ap_score: 0.519260 map_score: 0.531744 Time: 240.40
Run: 49 train loss: 118.086076 Time: 532.14
Run: 49 VAL ap_score: 0.530494 map_score: 0.550666 Time: 172.89
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 50 train loss: 117.513390 Time: 563.58
Run: 50 VAL ap_score: 0.479873 map_score: 0.517900 Time: 171.67
Run: 51 train loss: 117.351771 Time: 581.97
Run: 51 VAL ap_score: 0.524021 map_score: 0.528824 Time: 172.75
Run: 52 train loss: 116.657651 Time: 552.49
Run: 52 VAL ap_score: 0.530378 map_score: 0.509184 Time: 173.30
Run: 53 train loss: 116.906759 Time: 605.50
Run: 53 VAL ap_score: 0.532886 map_score: 0.535255 Time: 172.53
Run: 54 train loss: 116.338306 Time: 529.90
Run: 54 VAL ap_score: 0.518038 map_score: 0.534408 Time: 172.93
Run: 55 train loss: 114.431422 Time: 533.86
Run: 55 VAL ap_score: 0.514268 map_score: 0.529172 Time: 173.56
Run: 56 train loss: 114.420924 Time: 528.06
Run: 56 VAL ap_score: 0.526321 map_score: 0.538990 Time: 175.10
Run: 57 train loss: 114.247887 Time: 534.15
Run: 57 VAL ap_score: 0.520334 map_score: 0.542698 Time: 175.09
Run: 58 train loss: 114.883378 Time: 533.71
Run: 58 VAL ap_score: 0.539201 map_score: 0.547119 Time: 173.89
Run: 59 train loss: 113.530919 Time: 529.83
Run: 59 VAL ap_score: 0.488244 map_score: 0.553215 Time: 172.52
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 60 train loss: 112.192718 Time: 524.97
Run: 60 VAL ap_score: 0.523238 map_score: 0.543742 Time: 173.25
Run: 61 train loss: 112.207296 Time: 541.75
Run: 61 VAL ap_score: 0.494406 map_score: 0.506924 Time: 172.73
Run: 62 train loss: 112.268307 Time: 540.81
Run: 62 VAL ap_score: 0.506962 map_score: 0.554363 Time: 173.41
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 63 train loss: 113.200198 Time: 520.77
Run: 63 VAL ap_score: 0.539880 map_score: 0.534975 Time: 172.62
Run: 64 train loss: 110.865907 Time: 528.14
Run: 64 VAL ap_score: 0.531637 map_score: 0.538245 Time: 173.87
Run: 65 train loss: 110.733565 Time: 519.47
Run: 65 VAL ap_score: 0.504814 map_score: 0.539661 Time: 173.20
Run: 66 train loss: 111.416455 Time: 554.05
Run: 66 VAL ap_score: 0.521594 map_score: 0.546096 Time: 173.26
Run: 67 train loss: 109.889017 Time: 564.19
Run: 67 VAL ap_score: 0.556161 map_score: 0.564050 Time: 172.25
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 68 train loss: 110.423731 Time: 567.49
Run: 68 VAL ap_score: 0.531268 map_score: 0.553314 Time: 206.26
Run: 69 train loss: 109.791226 Time: 535.63
Run: 69 VAL ap_score: 0.552893 map_score: 0.553781 Time: 172.81
Run: 70 train loss: 109.873118 Time: 531.12
Run: 70 VAL ap_score: 0.519251 map_score: 0.542975 Time: 173.04
Run: 71 train loss: 108.546477 Time: 526.47
Run: 71 VAL ap_score: 0.515901 map_score: 0.533809 Time: 172.63
Run: 72 train loss: 108.845360 Time: 528.13
Run: 72 VAL ap_score: 0.551425 map_score: 0.543309 Time: 172.62
Run: 73 train loss: 108.335476 Time: 533.75
Run: 73 VAL ap_score: 0.541741 map_score: 0.553089 Time: 173.21
Run: 74 train loss: 108.628904 Time: 537.16
Run: 74 VAL ap_score: 0.513015 map_score: 0.550990 Time: 210.54
Run: 75 train loss: 108.031934 Time: 589.78
Run: 75 VAL ap_score: 0.518386 map_score: 0.552082 Time: 173.52
Run: 76 train loss: 108.696669 Time: 535.52
Run: 76 VAL ap_score: 0.545786 map_score: 0.550836 Time: 173.94
Run: 77 train loss: 107.281500 Time: 561.12
Run: 77 VAL ap_score: 0.543749 map_score: 0.543856 Time: 218.29
Run: 78 train loss: 106.232837 Time: 583.94
Run: 78 VAL ap_score: 0.539470 map_score: 0.551698 Time: 242.07
Run: 79 train loss: 106.642271 Time: 642.96
Run: 79 VAL ap_score: 0.525526 map_score: 0.547714 Time: 174.06
Run: 80 train loss: 106.916121 Time: 556.85
Run: 80 VAL ap_score: 0.493716 map_score: 0.533824 Time: 176.48
Run: 81 train loss: 105.973972 Time: 582.57
Run: 81 VAL ap_score: 0.545937 map_score: 0.556672 Time: 177.96
Run: 82 train loss: 105.096918 Time: 549.32
Run: 82 VAL ap_score: 0.552027 map_score: 0.555027 Time: 244.27
Run: 83 train loss: 104.981658 Time: 562.37
Run: 83 VAL ap_score: 0.544458 map_score: 0.564525 Time: 243.43
saving best validated model to ./gmn_match_hinge_scoring_temp_ptc_mr/bestValidationModels/gmn_match_hinge_scoring_ptc_mr_7366_2024-01-24_03:20:41.363259
Run: 84 train loss: 106.017456 Time: 649.28
Run: 84 VAL ap_score: 0.528357 map_score: 0.537081 Time: 179.73
Run: 85 train loss: 104.437288 Time: 696.01
Run: 85 VAL ap_score: 0.515290 map_score: 0.535225 Time: 174.34
Run: 86 train loss: 104.990238 Time: 630.49
Run: 86 VAL ap_score: 0.558230 map_score: 0.562834 Time: 273.60
Run: 87 train loss: 104.026752 Time: 691.02
Run: 87 VAL ap_score: 0.515040 map_score: 0.554803 Time: 195.98
Run: 88 train loss: 104.762493 Time: 534.80
Run: 88 VAL ap_score: 0.562112 map_score: 0.560782 Time: 172.82
Run: 89 train loss: 104.162838 Time: 533.10
Run: 89 VAL ap_score: 0.529294 map_score: 0.555341 Time: 172.09
Run: 90 train loss: 103.856837 Time: 537.35
Run: 90 VAL ap_score: 0.541788 map_score: 0.553017 Time: 174.02
Run: 91 train loss: 103.272765 Time: 546.72
Run: 91 VAL ap_score: 0.540322 map_score: 0.554191 Time: 216.67
Run: 92 train loss: 103.796271 Time: 537.25
Run: 92 VAL ap_score: 0.512021 map_score: 0.549543 Time: 239.90
Run: 93 train loss: 103.260992 Time: 522.36
Run: 93 VAL ap_score: 0.549761 map_score: 0.558020 Time: 172.81
Run: 94 train loss: 103.360607 Time: 556.30
Run: 94 VAL ap_score: 0.504240 map_score: 0.542164 Time: 240.68
Run: 95 train loss: 103.066861 Time: 551.13
Run: 95 VAL ap_score: 0.564834 map_score: 0.555602 Time: 172.71
Run: 96 train loss: 102.263969 Time: 539.34
Run: 96 VAL ap_score: 0.548857 map_score: 0.541027 Time: 225.81
Run: 97 train loss: 102.726387 Time: 527.43
Run: 97 VAL ap_score: 0.561802 map_score: 0.551735 Time: 207.60
Run: 98 train loss: 102.691189 Time: 535.42
Run: 98 VAL ap_score: 0.526162 map_score: 0.537679 Time: 172.23
Run: 99 train loss: 102.218875 Time: 530.65
Run: 99 VAL ap_score: 0.555439 map_score: 0.558035 Time: 174.21
Run: 100 train loss: 102.420865 Time: 579.47
Run: 100 VAL ap_score: 0.526717 map_score: 0.552147 Time: 189.49
Run: 101 train loss: 102.795604 Time: 570.85
Run: 101 VAL ap_score: 0.520862 map_score: 0.553548 Time: 187.55
Run: 102 train loss: 101.709486 Time: 570.85
Run: 102 VAL ap_score: 0.550097 map_score: 0.560788 Time: 188.54
Run: 103 train loss: 101.855118 Time: 570.74
Run: 103 VAL ap_score: 0.555279 map_score: 0.542533 Time: 188.72
Run: 104 train loss: 101.150269 Time: 570.77
Run: 104 VAL ap_score: 0.547489 map_score: 0.554341 Time: 187.72
Run: 105 train loss: 100.783641 Time: 570.92
Run: 105 VAL ap_score: 0.542520 map_score: 0.558092 Time: 188.33
Run: 106 train loss: 100.368971 Time: 570.93
Run: 106 VAL ap_score: 0.568598 map_score: 0.552889 Time: 188.23
