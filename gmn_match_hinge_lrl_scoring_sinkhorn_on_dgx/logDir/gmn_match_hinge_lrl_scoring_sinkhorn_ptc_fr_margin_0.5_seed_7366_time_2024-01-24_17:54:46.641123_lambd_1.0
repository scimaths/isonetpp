Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx
--TASK=gmn_match_hinge_lrl_scoring_sinkhorn
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/initialModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
no. of params in model: 2168
Run: 0 train loss: 232.074800 Time: 466.86
Run: 0 VAL ap_score: 0.523585 map_score: 0.522821 Time: 150.18
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 1 train loss: 183.318435 Time: 465.50
Run: 1 VAL ap_score: 0.548002 map_score: 0.550033 Time: 150.95
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 2 train loss: 163.136797 Time: 464.59
Run: 2 VAL ap_score: 0.589326 map_score: 0.586182 Time: 151.59
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 3 train loss: 142.736473 Time: 467.24
Run: 3 VAL ap_score: 0.614830 map_score: 0.604194 Time: 152.44
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 4 train loss: 130.001497 Time: 466.36
Run: 4 VAL ap_score: 0.641536 map_score: 0.631794 Time: 152.28
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 5 train loss: 121.637748 Time: 587.39
Run: 5 VAL ap_score: 0.652469 map_score: 0.628086 Time: 157.09
Run: 6 train loss: 112.102046 Time: 466.06
Run: 6 VAL ap_score: 0.666173 map_score: 0.646019 Time: 151.71
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 7 train loss: 103.731229 Time: 463.22
Run: 7 VAL ap_score: 0.688891 map_score: 0.665362 Time: 150.95
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 8 train loss: 96.772983 Time: 458.73
Run: 8 VAL ap_score: 0.708922 map_score: 0.689785 Time: 151.41
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 9 train loss: 92.546695 Time: 461.33
Run: 9 VAL ap_score: 0.690308 map_score: 0.679069 Time: 151.54
Run: 10 train loss: 90.209970 Time: 459.39
Run: 10 VAL ap_score: 0.723048 map_score: 0.704299 Time: 151.31
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 11 train loss: 90.297631 Time: 459.95
Run: 11 VAL ap_score: 0.718514 map_score: 0.701781 Time: 151.53
Run: 12 train loss: 85.182424 Time: 462.60
Run: 12 VAL ap_score: 0.724953 map_score: 0.702512 Time: 154.76
Run: 13 train loss: 82.850497 Time: 460.52
Run: 13 VAL ap_score: 0.730122 map_score: 0.706840 Time: 159.40
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 14 train loss: 82.312576 Time: 462.04
Run: 14 VAL ap_score: 0.738109 map_score: 0.715042 Time: 152.13
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 15 train loss: 80.550575 Time: 456.73
Run: 15 VAL ap_score: 0.739358 map_score: 0.706522 Time: 151.58
Run: 16 train loss: 78.248018 Time: 457.85
Run: 16 VAL ap_score: 0.745442 map_score: 0.720086 Time: 151.60
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 17 train loss: 77.604314 Time: 455.42
Run: 17 VAL ap_score: 0.749906 map_score: 0.723865 Time: 152.94
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 18 train loss: 76.264353 Time: 457.04
Run: 18 VAL ap_score: 0.758782 map_score: 0.728863 Time: 152.18
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 19 train loss: 75.086142 Time: 456.67
Run: 19 VAL ap_score: 0.749422 map_score: 0.721027 Time: 152.16
Run: 20 train loss: 73.326539 Time: 458.53
Run: 20 VAL ap_score: 0.728017 map_score: 0.709286 Time: 152.33
Run: 21 train loss: 72.168225 Time: 461.66
Run: 21 VAL ap_score: 0.758978 map_score: 0.732003 Time: 151.44
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 22 train loss: 71.694390 Time: 473.10
Run: 22 VAL ap_score: 0.747694 map_score: 0.730798 Time: 156.74
Run: 23 train loss: 71.777179 Time: 456.90
Run: 23 VAL ap_score: 0.749983 map_score: 0.732230 Time: 152.46
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 24 train loss: 68.744689 Time: 457.17
Run: 24 VAL ap_score: 0.771975 map_score: 0.742268 Time: 152.31
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 25 train loss: 69.172622 Time: 456.95
Run: 25 VAL ap_score: 0.777855 map_score: 0.747266 Time: 151.94
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 26 train loss: 68.690131 Time: 459.16
Run: 26 VAL ap_score: 0.755707 map_score: 0.734907 Time: 153.32
Run: 27 train loss: 67.517342 Time: 461.38
Run: 27 VAL ap_score: 0.768592 map_score: 0.744400 Time: 152.01
Run: 28 train loss: 66.525178 Time: 460.12
Run: 28 VAL ap_score: 0.773062 map_score: 0.746639 Time: 153.45
Run: 29 train loss: 66.053715 Time: 458.52
Run: 29 VAL ap_score: 0.763547 map_score: 0.741244 Time: 152.92
Run: 30 train loss: 64.919250 Time: 460.24
Run: 30 VAL ap_score: 0.784707 map_score: 0.760135 Time: 152.00
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 31 train loss: 63.749048 Time: 457.47
Run: 31 VAL ap_score: 0.767441 map_score: 0.743072 Time: 152.70
Run: 32 train loss: 63.233649 Time: 457.71
Run: 32 VAL ap_score: 0.775808 map_score: 0.745345 Time: 151.86
Run: 33 train loss: 62.926998 Time: 455.09
Run: 33 VAL ap_score: 0.757109 map_score: 0.744608 Time: 152.29
Run: 34 train loss: 61.253889 Time: 457.11
Run: 34 VAL ap_score: 0.770534 map_score: 0.749837 Time: 151.68
Run: 35 train loss: 60.721305 Time: 458.18
Run: 35 VAL ap_score: 0.786015 map_score: 0.761742 Time: 152.48
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 36 train loss: 60.727675 Time: 458.61
Run: 36 VAL ap_score: 0.777739 map_score: 0.748004 Time: 151.91
Run: 37 train loss: 61.119580 Time: 510.09
Run: 37 VAL ap_score: 0.775793 map_score: 0.754603 Time: 206.50
Run: 38 train loss: 60.375428 Time: 548.66
Run: 38 VAL ap_score: 0.785040 map_score: 0.759966 Time: 212.36
Run: 39 train loss: 59.734419 Time: 545.42
Run: 39 VAL ap_score: 0.775265 map_score: 0.758320 Time: 204.55
Run: 40 train loss: 59.458115 Time: 546.92
Run: 40 VAL ap_score: 0.788375 map_score: 0.764552 Time: 204.22
saving best validated model to ./gmn_match_hinge_lrl_scoring_sinkhorn_on_dgx/bestValidationModels/gmn_match_hinge_lrl_scoring_sinkhorn_ptc_fr_7366_2024-01-24_17:54:46.641123
Run: 41 train loss: 58.880158 Time: 546.95
Run: 41 VAL ap_score: 0.767256 map_score: 0.754035 Time: 209.34
Run: 42 train loss: 59.217317 Time: 543.80
Run: 42 VAL ap_score: 0.768068 map_score: 0.751161 Time: 204.86
Run: 43 train loss: 58.502935 Time: 546.88
Run: 43 VAL ap_score: 0.787473 map_score: 0.756995 Time: 206.38
Run: 44 train loss: 58.504286 Time: 546.66
Run: 44 VAL ap_score: 0.786045 map_score: 0.755733 Time: 209.43
Run: 45 train loss: 57.942477 Time: 545.10
