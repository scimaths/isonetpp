Command line
/raid/infolab/vaibhav/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1
--TASK=gmn_match_hinge_lrl_scoring_injective_attention_inter
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
--temp_gmn_scoring=0.1
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge, LRL scoring, Injective Attention, Interaction features
saving initial model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/initialModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
no. of params in model: 2498
Run: 0 train loss: 301.092181 Time: 727.52
Run: 0 VAL ap_score: 0.479204 map_score: 0.505610 Time: 250.83
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 1 train loss: 198.873249 Time: 708.81
Run: 1 VAL ap_score: 0.506208 map_score: 0.535765 Time: 249.00
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 2 train loss: 178.727768 Time: 636.81
Run: 2 VAL ap_score: 0.525065 map_score: 0.554547 Time: 214.31
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 3 train loss: 168.164458 Time: 623.01
Run: 3 VAL ap_score: 0.544109 map_score: 0.558822 Time: 215.40
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 4 train loss: 158.501386 Time: 617.12
Run: 4 VAL ap_score: 0.543196 map_score: 0.563071 Time: 213.93
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 5 train loss: 150.883887 Time: 630.69
Run: 5 VAL ap_score: 0.569799 map_score: 0.581568 Time: 229.13
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 6 train loss: 143.004108 Time: 637.85
Run: 6 VAL ap_score: 0.565779 map_score: 0.581372 Time: 233.25
Run: 7 train loss: 135.296848 Time: 623.65
Run: 7 VAL ap_score: 0.574499 map_score: 0.593529 Time: 238.57
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 8 train loss: 131.589389 Time: 631.07
Run: 8 VAL ap_score: 0.594375 map_score: 0.610015 Time: 233.65
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 9 train loss: 125.446187 Time: 625.44
Run: 9 VAL ap_score: 0.608361 map_score: 0.623169 Time: 237.29
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 10 train loss: 121.805596 Time: 609.51
Run: 10 VAL ap_score: 0.577003 map_score: 0.605637 Time: 213.33
Run: 11 train loss: 119.743520 Time: 580.72
Run: 11 VAL ap_score: 0.593837 map_score: 0.607753 Time: 223.60
Run: 12 train loss: 115.388172 Time: 595.36
Run: 12 VAL ap_score: 0.617939 map_score: 0.637362 Time: 220.94
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 13 train loss: 113.309373 Time: 591.91
Run: 13 VAL ap_score: 0.644009 map_score: 0.652776 Time: 214.66
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 14 train loss: 110.350734 Time: 579.97
Run: 14 VAL ap_score: 0.624482 map_score: 0.631209 Time: 210.76
Run: 15 train loss: 109.250924 Time: 598.08
Run: 15 VAL ap_score: 0.643894 map_score: 0.643234 Time: 213.76
Run: 16 train loss: 107.248926 Time: 604.90
Run: 16 VAL ap_score: 0.643209 map_score: 0.645534 Time: 211.26
Run: 17 train loss: 104.222640 Time: 584.36
Run: 17 VAL ap_score: 0.656308 map_score: 0.651415 Time: 214.49
Run: 18 train loss: 102.310852 Time: 604.21
Run: 18 VAL ap_score: 0.623953 map_score: 0.643102 Time: 221.98
Run: 19 train loss: 101.292408 Time: 573.48
Run: 19 VAL ap_score: 0.630128 map_score: 0.644803 Time: 192.12
Run: 20 train loss: 97.944672 Time: 531.94
Run: 20 VAL ap_score: 0.627104 map_score: 0.627818 Time: 190.57
Run: 21 train loss: 97.390743 Time: 527.01
Run: 21 VAL ap_score: 0.659182 map_score: 0.664841 Time: 191.94
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 22 train loss: 97.004048 Time: 526.56
Run: 22 VAL ap_score: 0.636892 map_score: 0.648405 Time: 189.65
Run: 23 train loss: 94.512625 Time: 522.68
Run: 23 VAL ap_score: 0.660915 map_score: 0.660142 Time: 190.32
Run: 24 train loss: 93.625550 Time: 525.38
Run: 24 VAL ap_score: 0.641179 map_score: 0.650573 Time: 193.45
Run: 25 train loss: 91.662517 Time: 531.62
Run: 25 VAL ap_score: 0.641466 map_score: 0.651097 Time: 192.10
Run: 26 train loss: 90.377942 Time: 528.03
Run: 26 VAL ap_score: 0.631125 map_score: 0.647184 Time: 192.95
Run: 27 train loss: 90.786005 Time: 531.56
Run: 27 VAL ap_score: 0.665409 map_score: 0.672828 Time: 191.58
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 28 train loss: 89.834292 Time: 535.09
Run: 28 VAL ap_score: 0.638680 map_score: 0.644917 Time: 190.02
Run: 29 train loss: 90.376387 Time: 526.65
Run: 29 VAL ap_score: 0.646160 map_score: 0.654013 Time: 182.51
Run: 30 train loss: 89.000318 Time: 525.99
Run: 30 VAL ap_score: 0.652167 map_score: 0.652241 Time: 184.65
Run: 31 train loss: 88.338387 Time: 530.56
Run: 31 VAL ap_score: 0.671926 map_score: 0.665124 Time: 184.03
Run: 32 train loss: 86.698732 Time: 526.92
Run: 32 VAL ap_score: 0.666790 map_score: 0.660276 Time: 181.84
Run: 33 train loss: 86.757059 Time: 527.92
Run: 33 VAL ap_score: 0.695669 map_score: 0.687952 Time: 186.30
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 34 train loss: 86.312425 Time: 530.60
Run: 34 VAL ap_score: 0.684534 map_score: 0.677707 Time: 187.01
Run: 35 train loss: 84.771452 Time: 527.60
Run: 35 VAL ap_score: 0.688266 map_score: 0.691816 Time: 187.77
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 36 train loss: 83.404128 Time: 526.77
Run: 36 VAL ap_score: 0.683938 map_score: 0.679052 Time: 190.63
Run: 37 train loss: 83.276053 Time: 534.90
Run: 37 VAL ap_score: 0.698546 map_score: 0.692285 Time: 189.24
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_inter_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_inter_ptc_mm_7762_2024-01-26_21:21:35.198826
Run: 38 train loss: 83.188859 Time: 536.81
Run: 38 VAL ap_score: 0.702535 map_score: 0.691538 Time: 187.67
Run: 39 train loss: 82.049020 Time: 534.79
Run: 39 VAL ap_score: 0.682808 map_score: 0.680240 Time: 189.38
