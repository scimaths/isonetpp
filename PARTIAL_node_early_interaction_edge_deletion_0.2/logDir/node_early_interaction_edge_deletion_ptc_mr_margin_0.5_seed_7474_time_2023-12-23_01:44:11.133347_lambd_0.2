Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=ptc_mr
--SEED=2
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_ptc_mr80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_mr80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mr80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_mr80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_mr80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mr80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
no. of params in model: 2498
Run: 0 train loss: 97.238648 Time: 167.87
Run: 0 VAL ap_score: 0.596109 map_score: 0.563746 Time: 77.40
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 1 train loss: 40.891959 Time: 179.98
Run: 1 VAL ap_score: 0.666051 map_score: 0.633205 Time: 77.70
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 2 train loss: 34.121369 Time: 178.97
Run: 2 VAL ap_score: 0.704348 map_score: 0.677510 Time: 77.03
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 3 train loss: 29.326826 Time: 181.11
Run: 3 VAL ap_score: 0.738291 map_score: 0.703932 Time: 74.97
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 4 train loss: 26.666300 Time: 181.80
Run: 4 VAL ap_score: 0.767155 map_score: 0.718783 Time: 74.90
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 5 train loss: 23.468865 Time: 182.65
Run: 5 VAL ap_score: 0.757337 map_score: 0.708797 Time: 73.75
Run: 6 train loss: 21.671714 Time: 183.31
Run: 6 VAL ap_score: 0.750194 map_score: 0.696522 Time: 72.11
Run: 7 train loss: 18.949461 Time: 184.78
Run: 7 VAL ap_score: 0.776852 map_score: 0.747408 Time: 71.49
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 8 train loss: 18.142301 Time: 185.48
Run: 8 VAL ap_score: 0.784056 map_score: 0.757076 Time: 70.37
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 9 train loss: 17.341997 Time: 183.46
Run: 9 VAL ap_score: 0.779083 map_score: 0.754286 Time: 68.78
Run: 10 train loss: 16.581622 Time: 186.25
Run: 10 VAL ap_score: 0.776516 map_score: 0.769594 Time: 69.12
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 11 train loss: 15.892857 Time: 186.49
Run: 11 VAL ap_score: 0.782617 map_score: 0.755375 Time: 68.85
Run: 12 train loss: 14.990153 Time: 186.16
Run: 12 VAL ap_score: 0.809104 map_score: 0.778581 Time: 69.20
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 13 train loss: 14.777113 Time: 185.41
Run: 13 VAL ap_score: 0.797628 map_score: 0.758698 Time: 71.15
Run: 14 train loss: 14.391850 Time: 186.38
Run: 14 VAL ap_score: 0.820738 map_score: 0.788000 Time: 69.93
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 15 train loss: 13.690227 Time: 181.77
Run: 15 VAL ap_score: 0.817553 map_score: 0.788167 Time: 70.25
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 16 train loss: 13.398003 Time: 184.78
Run: 16 VAL ap_score: 0.814355 map_score: 0.796141 Time: 70.30
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 17 train loss: 12.808363 Time: 178.03
Run: 17 VAL ap_score: 0.836807 map_score: 0.794538 Time: 70.60
Run: 18 train loss: 12.180798 Time: 184.52
Run: 18 VAL ap_score: 0.783562 map_score: 0.771140 Time: 71.93
Run: 19 train loss: 11.842869 Time: 185.17
Run: 19 VAL ap_score: 0.835717 map_score: 0.801015 Time: 71.14
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 20 train loss: 11.779200 Time: 183.06
Run: 20 VAL ap_score: 0.837099 map_score: 0.794355 Time: 72.16
Run: 21 train loss: 10.990734 Time: 181.26
Run: 21 VAL ap_score: 0.836039 map_score: 0.790138 Time: 73.98
Run: 22 train loss: 10.482182 Time: 182.64
Run: 22 VAL ap_score: 0.837123 map_score: 0.794246 Time: 74.63
Run: 23 train loss: 10.528499 Time: 182.97
Run: 23 VAL ap_score: 0.852369 map_score: 0.808928 Time: 75.06
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 24 train loss: 9.822780 Time: 179.60
Run: 24 VAL ap_score: 0.854533 map_score: 0.809927 Time: 77.27
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 25 train loss: 10.063641 Time: 179.26
Run: 25 VAL ap_score: 0.850415 map_score: 0.829256 Time: 77.91
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 26 train loss: 9.942694 Time: 182.07
Run: 26 VAL ap_score: 0.826460 map_score: 0.805722 Time: 77.59
Run: 27 train loss: 9.243392 Time: 181.71
Run: 27 VAL ap_score: 0.864851 map_score: 0.836728 Time: 79.01
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 28 train loss: 9.343572 Time: 180.18
Run: 28 VAL ap_score: 0.858047 map_score: 0.817718 Time: 77.92
Run: 29 train loss: 9.142855 Time: 173.51
Run: 29 VAL ap_score: 0.849106 map_score: 0.807505 Time: 78.72
Run: 30 train loss: 8.397461 Time: 180.78
Run: 30 VAL ap_score: 0.850031 map_score: 0.816878 Time: 77.77
Run: 31 train loss: 8.232958 Time: 178.24
Run: 31 VAL ap_score: 0.867180 map_score: 0.838278 Time: 77.64
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 32 train loss: 8.131760 Time: 179.10
Run: 32 VAL ap_score: 0.867989 map_score: 0.845857 Time: 78.47
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 33 train loss: 7.961506 Time: 173.58
Run: 33 VAL ap_score: 0.869666 map_score: 0.834594 Time: 79.17
Run: 34 train loss: 7.433693 Time: 182.20
Run: 34 VAL ap_score: 0.867351 map_score: 0.833133 Time: 78.43
Run: 35 train loss: 7.858818 Time: 180.27
Run: 35 VAL ap_score: 0.819739 map_score: 0.834765 Time: 76.60
Run: 36 train loss: 8.509605 Time: 183.61
Run: 36 VAL ap_score: 0.869796 map_score: 0.823720 Time: 76.39
Run: 37 train loss: 7.114009 Time: 180.05
Run: 37 VAL ap_score: 0.863562 map_score: 0.845919 Time: 77.22
Run: 38 train loss: 6.867093 Time: 175.81
Run: 38 VAL ap_score: 0.842987 map_score: 0.818732 Time: 76.61
Run: 39 train loss: 6.954469 Time: 180.15
Run: 39 VAL ap_score: 0.874027 map_score: 0.831891 Time: 76.75
Run: 40 train loss: 6.954879 Time: 180.39
Run: 40 VAL ap_score: 0.869222 map_score: 0.846084 Time: 75.36
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 41 train loss: 6.994297 Time: 179.46
Run: 41 VAL ap_score: 0.884571 map_score: 0.852476 Time: 75.78
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 42 train loss: 6.630767 Time: 183.55
Run: 42 VAL ap_score: 0.885208 map_score: 0.849732 Time: 75.49
Run: 43 train loss: 6.291369 Time: 183.45
Run: 43 VAL ap_score: 0.850709 map_score: 0.809973 Time: 75.61
Run: 44 train loss: 6.313743 Time: 182.23
Run: 44 VAL ap_score: 0.892093 map_score: 0.851910 Time: 76.24
Run: 45 train loss: 6.113335 Time: 181.45
Run: 45 VAL ap_score: 0.862360 map_score: 0.846978 Time: 76.25
Run: 46 train loss: 6.278814 Time: 181.93
Run: 46 VAL ap_score: 0.871499 map_score: 0.845185 Time: 77.46
Run: 47 train loss: 6.840158 Time: 180.60
Run: 47 VAL ap_score: 0.872570 map_score: 0.837509 Time: 79.43
Run: 48 train loss: 5.702779 Time: 170.41
Run: 48 VAL ap_score: 0.883284 map_score: 0.842214 Time: 78.88
Run: 49 train loss: 6.299494 Time: 170.07
Run: 49 VAL ap_score: 0.856095 map_score: 0.830830 Time: 77.57
Run: 50 train loss: 7.489663 Time: 182.09
Run: 50 VAL ap_score: 0.895783 map_score: 0.862180 Time: 77.48
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 51 train loss: 5.521153 Time: 179.60
Run: 51 VAL ap_score: 0.883878 map_score: 0.855759 Time: 79.37
Run: 52 train loss: 5.771279 Time: 177.44
Run: 52 VAL ap_score: 0.882234 map_score: 0.847401 Time: 78.78
Run: 53 train loss: 5.616871 Time: 179.79
Run: 53 VAL ap_score: 0.817459 map_score: 0.791867 Time: 78.18
Run: 54 train loss: 9.873452 Time: 176.68
Run: 54 VAL ap_score: 0.889702 map_score: 0.853655 Time: 78.25
Run: 55 train loss: 5.286064 Time: 181.01
Run: 55 VAL ap_score: 0.899676 map_score: 0.866024 Time: 79.42
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 56 train loss: 5.022319 Time: 179.87
Run: 56 VAL ap_score: 0.892410 map_score: 0.858565 Time: 78.97
Run: 57 train loss: 4.916809 Time: 170.23
Run: 57 VAL ap_score: 0.891372 map_score: 0.862443 Time: 78.89
Run: 58 train loss: 5.113614 Time: 175.76
Run: 58 VAL ap_score: 0.900045 map_score: 0.870509 Time: 79.09
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 59 train loss: 5.469948 Time: 179.43
Run: 59 VAL ap_score: 0.888079 map_score: 0.852729 Time: 79.55
Run: 60 train loss: 4.993456 Time: 177.80
Run: 60 VAL ap_score: 0.881596 map_score: 0.845165 Time: 78.94
Run: 61 train loss: 5.165331 Time: 179.66
Run: 61 VAL ap_score: 0.889740 map_score: 0.855879 Time: 77.65
Run: 62 train loss: 5.070422 Time: 181.74
Run: 62 VAL ap_score: 0.867738 map_score: 0.833651 Time: 76.59
Run: 63 train loss: 5.217117 Time: 182.21
Run: 63 VAL ap_score: 0.900637 map_score: 0.873253 Time: 74.22
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mr_7474_2023-12-23_01:44:11.133347
Run: 64 train loss: 4.855547 Time: 182.15
Run: 64 VAL ap_score: 0.881875 map_score: 0.846417 Time: 74.12
Run: 65 train loss: 5.317541 Time: 187.04
Run: 65 VAL ap_score: 0.885968 map_score: 0.846017 Time: 72.12
Run: 66 train loss: 4.931669 Time: 183.34
Run: 66 VAL ap_score: 0.882955 map_score: 0.848595 Time: 72.59
Run: 67 train loss: 4.769036 Time: 185.73
Run: 67 VAL ap_score: 0.901761 map_score: 0.872649 Time: 73.12
Run: 68 train loss: 4.692912 Time: 185.85
Run: 68 VAL ap_score: 0.861580 map_score: 0.822637 Time: 73.38
Run: 69 train loss: 4.715765 Time: 185.27
Run: 69 VAL ap_score: 0.898908 map_score: 0.864008 Time: 74.84
Run: 70 train loss: 4.776383 Time: 175.45
Run: 70 VAL ap_score: 0.887213 map_score: 0.857955 Time: 73.69
Run: 71 train loss: 4.794312 Time: 173.90
Run: 71 VAL ap_score: 0.859214 map_score: 0.849456 Time: 73.25
Run: 72 train loss: 5.125078 Time: 188.35
Run: 72 VAL ap_score: 0.893620 map_score: 0.860988 Time: 72.44
Run: 73 train loss: 4.261216 Time: 188.03
Run: 73 VAL ap_score: 0.893771 map_score: 0.868853 Time: 72.23
Run: 74 train loss: 4.209268 Time: 186.67
Run: 74 VAL ap_score: 0.903810 map_score: 0.871263 Time: 73.25
Run: 75 train loss: 4.597588 Time: 187.55
Run: 75 VAL ap_score: 0.869082 map_score: 0.845417 Time: 73.96
Run: 76 train loss: 4.846809 Time: 179.14
Run: 76 VAL ap_score: 0.903398 map_score: 0.870847 Time: 75.21
Run: 77 train loss: 4.159646 Time: 184.10
