Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=ptc_mm
--SEED=4
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4929
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_ptc_mm80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_mm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mm80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_mm80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_mm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mm80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
no. of params in model: 2498
Run: 0 train loss: 80.927283 Time: 182.03
Run: 0 VAL ap_score: 0.501310 map_score: 0.537583 Time: 77.17
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 1 train loss: 40.072862 Time: 180.75
Run: 1 VAL ap_score: 0.653229 map_score: 0.644522 Time: 76.97
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 2 train loss: 30.021593 Time: 168.88
Run: 2 VAL ap_score: 0.624753 map_score: 0.641131 Time: 78.29
Run: 3 train loss: 25.172688 Time: 172.08
Run: 3 VAL ap_score: 0.671168 map_score: 0.686603 Time: 76.53
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 4 train loss: 22.767611 Time: 171.69
Run: 4 VAL ap_score: 0.664534 map_score: 0.674345 Time: 76.46
Run: 5 train loss: 21.551840 Time: 170.95
Run: 5 VAL ap_score: 0.701228 map_score: 0.709430 Time: 74.13
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 6 train loss: 19.668808 Time: 173.71
Run: 6 VAL ap_score: 0.715421 map_score: 0.734721 Time: 72.38
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 7 train loss: 18.416580 Time: 174.21
Run: 7 VAL ap_score: 0.720807 map_score: 0.751893 Time: 72.01
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 8 train loss: 16.378633 Time: 174.02
Run: 8 VAL ap_score: 0.749052 map_score: 0.766909 Time: 70.91
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 9 train loss: 15.606875 Time: 176.07
Run: 9 VAL ap_score: 0.762619 map_score: 0.763178 Time: 69.77
Run: 10 train loss: 14.089325 Time: 175.89
Run: 10 VAL ap_score: 0.759041 map_score: 0.794669 Time: 70.08
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 11 train loss: 12.928370 Time: 176.52
Run: 11 VAL ap_score: 0.746861 map_score: 0.783163 Time: 68.86
Run: 12 train loss: 12.335411 Time: 175.19
Run: 12 VAL ap_score: 0.786517 map_score: 0.811296 Time: 69.63
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 13 train loss: 11.055837 Time: 185.36
Run: 13 VAL ap_score: 0.779722 map_score: 0.810337 Time: 70.45
Run: 14 train loss: 10.347162 Time: 189.99
Run: 14 VAL ap_score: 0.798842 map_score: 0.811218 Time: 74.69
Run: 15 train loss: 10.071572 Time: 192.94
Run: 15 VAL ap_score: 0.807859 map_score: 0.822854 Time: 70.46
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 16 train loss: 10.060755 Time: 186.21
Run: 16 VAL ap_score: 0.830317 map_score: 0.826212 Time: 70.77
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 17 train loss: 9.088634 Time: 186.23
Run: 17 VAL ap_score: 0.821730 map_score: 0.809521 Time: 72.47
Run: 18 train loss: 8.861720 Time: 184.76
Run: 18 VAL ap_score: 0.825946 map_score: 0.816720 Time: 73.20
Run: 19 train loss: 8.231625 Time: 183.10
Run: 19 VAL ap_score: 0.843465 map_score: 0.840114 Time: 74.30
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 20 train loss: 7.415571 Time: 180.95
Run: 20 VAL ap_score: 0.819965 map_score: 0.830016 Time: 74.23
Run: 21 train loss: 7.453645 Time: 182.20
Run: 21 VAL ap_score: 0.865345 map_score: 0.859190 Time: 75.92
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 22 train loss: 6.623961 Time: 181.19
Run: 22 VAL ap_score: 0.864232 map_score: 0.864157 Time: 77.59
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 23 train loss: 6.895023 Time: 176.93
Run: 23 VAL ap_score: 0.834799 map_score: 0.853279 Time: 76.80
Run: 24 train loss: 6.460566 Time: 180.32
Run: 24 VAL ap_score: 0.863027 map_score: 0.858358 Time: 79.19
Run: 25 train loss: 6.397928 Time: 180.90
Run: 25 VAL ap_score: 0.873217 map_score: 0.867777 Time: 79.14
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 26 train loss: 6.152047 Time: 179.12
Run: 26 VAL ap_score: 0.880744 map_score: 0.877449 Time: 78.65
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 27 train loss: 5.651923 Time: 179.35
Run: 27 VAL ap_score: 0.867309 map_score: 0.862960 Time: 80.25
Run: 28 train loss: 5.593324 Time: 180.79
Run: 28 VAL ap_score: 0.870500 map_score: 0.867943 Time: 79.38
Run: 29 train loss: 5.529372 Time: 179.40
Run: 29 VAL ap_score: 0.879746 map_score: 0.884463 Time: 79.68
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 30 train loss: 5.413323 Time: 177.40
Run: 30 VAL ap_score: 0.895429 map_score: 0.897880 Time: 79.11
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 31 train loss: 5.170582 Time: 178.75
Run: 31 VAL ap_score: 0.877592 map_score: 0.883325 Time: 79.27
Run: 32 train loss: 5.191990 Time: 179.64
Run: 32 VAL ap_score: 0.888196 map_score: 0.884434 Time: 77.78
Run: 33 train loss: 4.772979 Time: 175.56
Run: 33 VAL ap_score: 0.871602 map_score: 0.872352 Time: 78.38
Run: 34 train loss: 5.124755 Time: 170.96
Run: 34 VAL ap_score: 0.908174 map_score: 0.900947 Time: 76.55
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 35 train loss: 4.337224 Time: 170.82
Run: 35 VAL ap_score: 0.881885 map_score: 0.894465 Time: 75.50
Run: 36 train loss: 4.828581 Time: 171.16
Run: 36 VAL ap_score: 0.896054 map_score: 0.901202 Time: 76.81
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 37 train loss: 4.293366 Time: 178.19
Run: 37 VAL ap_score: 0.873483 map_score: 0.872621 Time: 77.86
Run: 38 train loss: 4.262446 Time: 182.09
Run: 38 VAL ap_score: 0.905218 map_score: 0.905993 Time: 76.08
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 39 train loss: 4.486646 Time: 181.98
Run: 39 VAL ap_score: 0.911050 map_score: 0.906380 Time: 75.99
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 40 train loss: 4.021898 Time: 187.34
Run: 40 VAL ap_score: 0.888789 map_score: 0.901263 Time: 74.33
Run: 41 train loss: 4.292491 Time: 183.82
Run: 41 VAL ap_score: 0.909781 map_score: 0.905203 Time: 79.78
Run: 42 train loss: 4.230890 Time: 169.99
Run: 42 VAL ap_score: 0.899881 map_score: 0.907781 Time: 75.22
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 43 train loss: 5.240367 Time: 171.48
Run: 43 VAL ap_score: 0.894501 map_score: 0.900212 Time: 76.35
Run: 44 train loss: 3.585232 Time: 169.43
Run: 44 VAL ap_score: 0.918460 map_score: 0.914796 Time: 76.83
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 45 train loss: 3.577314 Time: 172.12
Run: 45 VAL ap_score: 0.877987 map_score: 0.882940 Time: 80.88
Run: 46 train loss: 3.654380 Time: 186.76
Run: 46 VAL ap_score: 0.919064 map_score: 0.910074 Time: 78.67
Run: 47 train loss: 3.614361 Time: 177.33
Run: 47 VAL ap_score: 0.926008 map_score: 0.914740 Time: 80.33
Run: 48 train loss: 3.352268 Time: 178.74
Run: 48 VAL ap_score: 0.903165 map_score: 0.894365 Time: 79.71
Run: 49 train loss: 4.108310 Time: 180.93
Run: 49 VAL ap_score: 0.922765 map_score: 0.918725 Time: 77.57
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 50 train loss: 3.832168 Time: 180.11
Run: 50 VAL ap_score: 0.924288 map_score: 0.916373 Time: 78.16
Run: 51 train loss: 3.415213 Time: 181.34
Run: 51 VAL ap_score: 0.900458 map_score: 0.900966 Time: 80.25
Run: 52 train loss: 3.555828 Time: 179.08
Run: 52 VAL ap_score: 0.918064 map_score: 0.911149 Time: 78.78
Run: 53 train loss: 3.459159 Time: 178.24
Run: 53 VAL ap_score: 0.915733 map_score: 0.916002 Time: 78.57
Run: 54 train loss: 3.472971 Time: 178.75
Run: 54 VAL ap_score: 0.911753 map_score: 0.914015 Time: 78.56
Run: 55 train loss: 3.197552 Time: 178.69
Run: 55 VAL ap_score: 0.921153 map_score: 0.907347 Time: 79.38
Run: 56 train loss: 3.462697 Time: 183.77
Run: 56 VAL ap_score: 0.897164 map_score: 0.907196 Time: 78.86
Run: 57 train loss: 3.309553 Time: 188.49
Run: 57 VAL ap_score: 0.918160 map_score: 0.918847 Time: 81.51
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 58 train loss: 3.588199 Time: 181.87
Run: 58 VAL ap_score: 0.930425 map_score: 0.912715 Time: 76.19
Run: 59 train loss: 2.899295 Time: 181.78
Run: 59 VAL ap_score: 0.924218 map_score: 0.922288 Time: 76.68
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 60 train loss: 3.236394 Time: 185.76
Run: 60 VAL ap_score: 0.914525 map_score: 0.912806 Time: 75.68
Run: 61 train loss: 3.277044 Time: 183.23
Run: 61 VAL ap_score: 0.865305 map_score: 0.881847 Time: 74.53
Run: 62 train loss: 3.374679 Time: 183.76
Run: 62 VAL ap_score: 0.923757 map_score: 0.917328 Time: 73.43
Run: 63 train loss: 3.238141 Time: 187.11
Run: 63 VAL ap_score: 0.931676 map_score: 0.922055 Time: 72.17
Run: 64 train loss: 2.901623 Time: 184.65
Run: 64 VAL ap_score: 0.923587 map_score: 0.919532 Time: 72.80
Run: 65 train loss: 2.785566 Time: 185.51
Run: 65 VAL ap_score: 0.928769 map_score: 0.923145 Time: 72.91
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 66 train loss: 3.158840 Time: 186.95
Run: 66 VAL ap_score: 0.920526 map_score: 0.915302 Time: 74.02
Run: 67 train loss: 2.987271 Time: 195.02
Run: 67 VAL ap_score: 0.932187 map_score: 0.921783 Time: 78.51
Run: 68 train loss: 2.813627 Time: 193.81
Run: 68 VAL ap_score: 0.918139 map_score: 0.906149 Time: 84.37
Run: 69 train loss: 2.886578 Time: 175.34
Run: 69 VAL ap_score: 0.926749 map_score: 0.919846 Time: 79.12
Run: 70 train loss: 2.877824 Time: 181.01
Run: 70 VAL ap_score: 0.905492 map_score: 0.911218 Time: 80.58
Run: 71 train loss: 2.999409 Time: 185.11
Run: 71 VAL ap_score: 0.935692 map_score: 0.924925 Time: 81.20
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_4929_2023-12-23_01:45:21.662893
Run: 72 train loss: 3.007116 Time: 180.26
Run: 72 VAL ap_score: 0.901456 map_score: 0.902930 Time: 83.17
Run: 73 train loss: 2.505371 Time: 181.71
Run: 73 VAL ap_score: 0.925394 map_score: 0.920833 Time: 82.23
Run: 74 train loss: 3.148720 Time: 182.92
Run: 74 VAL ap_score: 0.905926 map_score: 0.890502 Time: 82.80
Run: 75 train loss: 2.597802 Time: 191.25
Run: 75 VAL ap_score: 0.928172 map_score: 0.923925 Time: 86.42
Run: 76 train loss: 2.601607 Time: 191.36
Run: 76 VAL ap_score: 0.918111 map_score: 0.921478 Time: 79.52
