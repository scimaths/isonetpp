Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=mutag
--SEED=0
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4586
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_mutag80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_mutag80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/mutag80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_mutag80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_mutag80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/mutag80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
no. of params in model: 2498
Run: 0 train loss: 83.683718 Time: 83.21
Run: 0 VAL ap_score: 0.645062 map_score: 0.696342 Time: 38.42
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 1 train loss: 41.612657 Time: 146.21
Run: 1 VAL ap_score: 0.779597 map_score: 0.778557 Time: 80.38
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 2 train loss: 30.492108 Time: 173.50
Run: 2 VAL ap_score: 0.812891 map_score: 0.804515 Time: 81.96
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 3 train loss: 23.452125 Time: 174.03
Run: 3 VAL ap_score: 0.829851 map_score: 0.807535 Time: 82.10
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 4 train loss: 18.731572 Time: 175.03
Run: 4 VAL ap_score: 0.899491 map_score: 0.879785 Time: 81.60
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 5 train loss: 14.378312 Time: 175.71
Run: 5 VAL ap_score: 0.918622 map_score: 0.907963 Time: 81.17
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 6 train loss: 11.357420 Time: 173.31
Run: 6 VAL ap_score: 0.935460 map_score: 0.915297 Time: 79.81
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 7 train loss: 9.236321 Time: 173.35
Run: 7 VAL ap_score: 0.946840 map_score: 0.921846 Time: 81.04
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 8 train loss: 8.031584 Time: 177.33
Run: 8 VAL ap_score: 0.939715 map_score: 0.920659 Time: 80.59
Run: 9 train loss: 8.548718 Time: 176.49
Run: 9 VAL ap_score: 0.953242 map_score: 0.925011 Time: 82.24
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 10 train loss: 7.345166 Time: 178.09
Run: 10 VAL ap_score: 0.953073 map_score: 0.927681 Time: 81.15
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 11 train loss: 7.254706 Time: 177.28
Run: 11 VAL ap_score: 0.956704 map_score: 0.930456 Time: 81.23
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 12 train loss: 6.916832 Time: 175.55
Run: 12 VAL ap_score: 0.948250 map_score: 0.927440 Time: 79.47
Run: 13 train loss: 6.594056 Time: 175.61
Run: 13 VAL ap_score: 0.960293 map_score: 0.927788 Time: 79.00
Run: 14 train loss: 5.558337 Time: 170.36
Run: 14 VAL ap_score: 0.934823 map_score: 0.920646 Time: 78.34
Run: 15 train loss: 5.968665 Time: 168.99
Run: 15 VAL ap_score: 0.959274 map_score: 0.939982 Time: 79.71
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 16 train loss: 5.398803 Time: 175.93
Run: 16 VAL ap_score: 0.967355 map_score: 0.940829 Time: 79.42
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 17 train loss: 5.454491 Time: 176.92
Run: 17 VAL ap_score: 0.971629 map_score: 0.955636 Time: 79.56
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 18 train loss: 5.265316 Time: 178.24
Run: 18 VAL ap_score: 0.959834 map_score: 0.946424 Time: 80.32
Run: 19 train loss: 3.958823 Time: 176.09
Run: 19 VAL ap_score: 0.980119 map_score: 0.961117 Time: 79.51
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 20 train loss: 3.932210 Time: 179.98
Run: 20 VAL ap_score: 0.975559 map_score: 0.960688 Time: 77.05
Run: 21 train loss: 4.167845 Time: 179.32
Run: 21 VAL ap_score: 0.979298 map_score: 0.964574 Time: 75.49
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 22 train loss: 7.003228 Time: 177.93
Run: 22 VAL ap_score: 0.848485 map_score: 0.848676 Time: 75.95
Run: 23 train loss: 4.483316 Time: 178.84
Run: 23 VAL ap_score: 0.978049 map_score: 0.964607 Time: 75.35
Run: 24 train loss: 3.726926 Time: 172.03
Run: 24 VAL ap_score: 0.981864 map_score: 0.965693 Time: 75.79
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 25 train loss: 3.080009 Time: 167.87
Run: 25 VAL ap_score: 0.984181 map_score: 0.966398 Time: 76.82
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 26 train loss: 3.080444 Time: 172.26
Run: 26 VAL ap_score: 0.976471 map_score: 0.960201 Time: 76.02
Run: 27 train loss: 3.285221 Time: 168.06
Run: 27 VAL ap_score: 0.981968 map_score: 0.967366 Time: 75.19
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 28 train loss: 3.131194 Time: 179.12
Run: 28 VAL ap_score: 0.983123 map_score: 0.971644 Time: 74.90
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 29 train loss: 3.910575 Time: 176.03
Run: 29 VAL ap_score: 0.979072 map_score: 0.965808 Time: 73.62
Run: 30 train loss: 3.771187 Time: 172.96
Run: 30 VAL ap_score: 0.987919 map_score: 0.975649 Time: 74.39
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 31 train loss: 2.817846 Time: 171.82
Run: 31 VAL ap_score: 0.977056 map_score: 0.970945 Time: 75.57
Run: 32 train loss: 4.206152 Time: 177.94
Run: 32 VAL ap_score: 0.984357 map_score: 0.975531 Time: 75.46
Run: 33 train loss: 2.626152 Time: 180.32
Run: 33 VAL ap_score: 0.986496 map_score: 0.974697 Time: 73.86
Run: 34 train loss: 2.617954 Time: 179.09
Run: 34 VAL ap_score: 0.985383 map_score: 0.972544 Time: 76.07
Run: 35 train loss: 2.689136 Time: 172.48
Run: 35 VAL ap_score: 0.987899 map_score: 0.976751 Time: 75.63
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 36 train loss: 3.738334 Time: 168.99
Run: 36 VAL ap_score: 0.988634 map_score: 0.978277 Time: 77.46
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 37 train loss: 2.427344 Time: 178.13
Run: 37 VAL ap_score: 0.984718 map_score: 0.974309 Time: 81.47
Run: 38 train loss: 3.199995 Time: 175.24
Run: 38 VAL ap_score: 0.987783 map_score: 0.976318 Time: 80.89
Run: 39 train loss: 2.722259 Time: 173.14
Run: 39 VAL ap_score: 0.987716 map_score: 0.977636 Time: 80.38
Run: 40 train loss: 2.343462 Time: 176.13
Run: 40 VAL ap_score: 0.988641 map_score: 0.974192 Time: 80.30
Run: 41 train loss: 5.079794 Time: 174.38
Run: 41 VAL ap_score: 0.788055 map_score: 0.848766 Time: 81.78
Run: 42 train loss: 3.944418 Time: 173.57
Run: 42 VAL ap_score: 0.989502 map_score: 0.977595 Time: 79.49
Run: 43 train loss: 2.266093 Time: 173.25
Run: 43 VAL ap_score: 0.986147 map_score: 0.974957 Time: 80.97
Run: 44 train loss: 2.116578 Time: 174.30
Run: 44 VAL ap_score: 0.986605 map_score: 0.975930 Time: 81.80
Run: 45 train loss: 2.582204 Time: 173.43
Run: 45 VAL ap_score: 0.986557 map_score: 0.972194 Time: 82.16
Run: 46 train loss: 3.806606 Time: 164.06
Run: 46 VAL ap_score: 0.992155 map_score: 0.981633 Time: 79.62
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 47 train loss: 2.251290 Time: 169.02
Run: 47 VAL ap_score: 0.991646 map_score: 0.985298 Time: 78.43
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 48 train loss: 2.140762 Time: 176.26
Run: 48 VAL ap_score: 0.991552 map_score: 0.983216 Time: 79.89
Run: 49 train loss: 2.560135 Time: 177.71
Run: 49 VAL ap_score: 0.991460 map_score: 0.983634 Time: 78.69
Run: 50 train loss: 2.228335 Time: 176.55
Run: 50 VAL ap_score: 0.991685 map_score: 0.981829 Time: 77.82
Run: 51 train loss: 2.928048 Time: 173.29
Run: 51 VAL ap_score: 0.986747 map_score: 0.977360 Time: 78.23
Run: 52 train loss: 1.923674 Time: 175.63
Run: 52 VAL ap_score: 0.990952 map_score: 0.981430 Time: 77.91
Run: 53 train loss: 3.308491 Time: 178.44
Run: 53 VAL ap_score: 0.970889 map_score: 0.953996 Time: 79.13
Run: 54 train loss: 2.385060 Time: 178.20
Run: 54 VAL ap_score: 0.990907 map_score: 0.981696 Time: 78.59
Run: 55 train loss: 2.119160 Time: 178.01
Run: 55 VAL ap_score: 0.990742 map_score: 0.980446 Time: 77.88
Run: 56 train loss: 1.885082 Time: 170.71
Run: 56 VAL ap_score: 0.992584 map_score: 0.985242 Time: 78.21
Run: 57 train loss: 1.703779 Time: 177.01
Run: 57 VAL ap_score: 0.991655 map_score: 0.982288 Time: 77.90
Run: 58 train loss: 2.435554 Time: 174.69
Run: 58 VAL ap_score: 0.992140 map_score: 0.983406 Time: 77.58
Run: 59 train loss: 1.944239 Time: 178.72
Run: 59 VAL ap_score: 0.991564 map_score: 0.984835 Time: 76.07
Run: 60 train loss: 3.728026 Time: 175.01
Run: 60 VAL ap_score: 0.989977 map_score: 0.978904 Time: 76.74
Run: 61 train loss: 1.813671 Time: 177.90
Run: 61 VAL ap_score: 0.990498 map_score: 0.982095 Time: 77.45
Run: 62 train loss: 1.570976 Time: 176.13
Run: 62 VAL ap_score: 0.991200 map_score: 0.983953 Time: 77.68
Run: 63 train loss: 1.671516 Time: 176.53
Run: 63 VAL ap_score: 0.991359 map_score: 0.978800 Time: 76.40
Run: 64 train loss: 4.111655 Time: 177.26
Run: 64 VAL ap_score: 0.991887 map_score: 0.982403 Time: 75.71
Run: 65 train loss: 1.779317 Time: 180.33
Run: 65 VAL ap_score: 0.993316 map_score: 0.985092 Time: 74.17
Run: 66 train loss: 2.016356 Time: 179.83
Run: 66 VAL ap_score: 0.992704 map_score: 0.982836 Time: 73.70
Run: 67 train loss: 1.736066 Time: 179.19
Run: 67 VAL ap_score: 0.991965 map_score: 0.986508 Time: 73.14
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_mutag_4586_2023-12-23_01:41:21.076680
Run: 68 train loss: 1.719034 Time: 180.58
Run: 68 VAL ap_score: 0.993400 map_score: 0.985801 Time: 73.71
Run: 69 train loss: 1.755603 Time: 181.54
Run: 69 VAL ap_score: 0.990892 map_score: 0.982213 Time: 73.28
Run: 70 train loss: 3.842635 Time: 179.13
Run: 70 VAL ap_score: 0.991441 map_score: 0.981732 Time: 73.13
Run: 71 train loss: 1.695882 Time: 178.98
Run: 71 VAL ap_score: 0.991633 map_score: 0.982813 Time: 75.24
Run: 72 train loss: 1.719199 Time: 180.94
Run: 72 VAL ap_score: 0.991647 map_score: 0.985544 Time: 73.54
Run: 73 train loss: 1.789974 Time: 182.41
Run: 73 VAL ap_score: 0.982808 map_score: 0.976372 Time: 72.83
Run: 74 train loss: 1.866002 Time: 175.62
Run: 74 VAL ap_score: 0.990453 map_score: 0.983536 Time: 74.30
Run: 75 train loss: 1.787200 Time: 172.26
Run: 75 VAL ap_score: 0.993634 map_score: 0.984746 Time: 74.93
Run: 76 train loss: 1.983143 Time: 179.95
Run: 76 VAL ap_score: 0.991824 map_score: 0.984893 Time: 74.21
Run: 77 train loss: 1.762627 Time: 181.70
Run: 77 VAL ap_score: 0.992037 map_score: 0.984410 Time: 73.60
Run: 78 train loss: 1.813134 Time: 181.09
Run: 78 VAL ap_score: 0.993831 map_score: 0.985523 Time: 72.65
Run: 79 train loss: 1.561735 Time: 184.48
Run: 79 VAL ap_score: 0.993114 map_score: 0.985955 Time: 71.86
