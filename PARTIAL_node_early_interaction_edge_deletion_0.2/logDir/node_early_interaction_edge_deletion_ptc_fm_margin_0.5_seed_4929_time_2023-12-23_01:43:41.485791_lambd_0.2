Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=ptc_fm
--SEED=4
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4929
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_ptc_fm80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_fm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fm80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_fm80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_fm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fm80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
no. of params in model: 2498
Run: 0 train loss: 79.103502 Time: 163.64
Run: 0 VAL ap_score: 0.751293 map_score: 0.698653 Time: 79.53
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 1 train loss: 40.325458 Time: 181.56
Run: 1 VAL ap_score: 0.820258 map_score: 0.760119 Time: 78.87
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 2 train loss: 34.103428 Time: 179.64
Run: 2 VAL ap_score: 0.827507 map_score: 0.757326 Time: 79.07
Run: 3 train loss: 31.852641 Time: 180.52
Run: 3 VAL ap_score: 0.852935 map_score: 0.781798 Time: 77.49
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 4 train loss: 28.748977 Time: 185.91
Run: 4 VAL ap_score: 0.825723 map_score: 0.771981 Time: 77.98
Run: 5 train loss: 25.279810 Time: 183.17
Run: 5 VAL ap_score: 0.865964 map_score: 0.819897 Time: 76.11
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 6 train loss: 23.640203 Time: 183.20
Run: 6 VAL ap_score: 0.876469 map_score: 0.829202 Time: 74.41
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 7 train loss: 21.042778 Time: 185.51
Run: 7 VAL ap_score: 0.882238 map_score: 0.835485 Time: 73.17
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 8 train loss: 19.823101 Time: 186.18
Run: 8 VAL ap_score: 0.888434 map_score: 0.831411 Time: 71.26
Run: 9 train loss: 19.949557 Time: 189.54
Run: 9 VAL ap_score: 0.894124 map_score: 0.851708 Time: 69.49
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 10 train loss: 16.863652 Time: 189.15
Run: 10 VAL ap_score: 0.891757 map_score: 0.864246 Time: 69.66
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 11 train loss: 15.556311 Time: 193.93
Run: 11 VAL ap_score: 0.908822 map_score: 0.856509 Time: 75.59
Run: 12 train loss: 14.596940 Time: 190.56
Run: 12 VAL ap_score: 0.901641 map_score: 0.869000 Time: 72.87
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 13 train loss: 13.487057 Time: 186.85
Run: 13 VAL ap_score: 0.917333 map_score: 0.866031 Time: 75.93
Run: 14 train loss: 14.295016 Time: 173.73
Run: 14 VAL ap_score: 0.901305 map_score: 0.845071 Time: 72.44
Run: 15 train loss: 12.438294 Time: 175.30
Run: 15 VAL ap_score: 0.908379 map_score: 0.850876 Time: 72.24
Run: 16 train loss: 11.709511 Time: 178.00
Run: 16 VAL ap_score: 0.918592 map_score: 0.867843 Time: 71.30
Run: 17 train loss: 11.250870 Time: 180.14
Run: 17 VAL ap_score: 0.914150 map_score: 0.865161 Time: 72.11
Run: 18 train loss: 11.425133 Time: 176.97
Run: 18 VAL ap_score: 0.917040 map_score: 0.865757 Time: 70.75
Run: 19 train loss: 10.849129 Time: 182.03
Run: 19 VAL ap_score: 0.924858 map_score: 0.878260 Time: 75.82
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 20 train loss: 10.389777 Time: 196.35
Run: 20 VAL ap_score: 0.907232 map_score: 0.862442 Time: 80.01
Run: 21 train loss: 10.014063 Time: 190.67
Run: 21 VAL ap_score: 0.926495 map_score: 0.883872 Time: 79.07
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 22 train loss: 9.495956 Time: 181.47
Run: 22 VAL ap_score: 0.918174 map_score: 0.861902 Time: 81.76
Run: 23 train loss: 9.028537 Time: 183.70
Run: 23 VAL ap_score: 0.928785 map_score: 0.884296 Time: 85.73
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 24 train loss: 8.730149 Time: 182.30
Run: 24 VAL ap_score: 0.932881 map_score: 0.888985 Time: 82.40
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 25 train loss: 10.343112 Time: 179.59
Run: 25 VAL ap_score: 0.933326 map_score: 0.897038 Time: 82.89
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 26 train loss: 9.285913 Time: 178.36
Run: 26 VAL ap_score: 0.939353 map_score: 0.900223 Time: 81.53
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 27 train loss: 7.697210 Time: 180.59
Run: 27 VAL ap_score: 0.933638 map_score: 0.895085 Time: 81.37
Run: 28 train loss: 8.195635 Time: 180.72
Run: 28 VAL ap_score: 0.922184 map_score: 0.881200 Time: 81.02
Run: 29 train loss: 7.486673 Time: 187.04
Run: 29 VAL ap_score: 0.928007 map_score: 0.893068 Time: 76.86
Run: 30 train loss: 7.457395 Time: 181.58
Run: 30 VAL ap_score: 0.933854 map_score: 0.902670 Time: 76.19
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 31 train loss: 7.378591 Time: 182.82
Run: 31 VAL ap_score: 0.943176 map_score: 0.906900 Time: 74.63
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 32 train loss: 6.633752 Time: 182.82
Run: 32 VAL ap_score: 0.948246 map_score: 0.916085 Time: 75.68
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 33 train loss: 6.603041 Time: 183.80
Run: 33 VAL ap_score: 0.928403 map_score: 0.891821 Time: 75.98
Run: 34 train loss: 6.644293 Time: 185.60
Run: 34 VAL ap_score: 0.946813 map_score: 0.916809 Time: 78.30
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 35 train loss: 6.448999 Time: 180.15
Run: 35 VAL ap_score: 0.890340 map_score: 0.846198 Time: 80.08
Run: 36 train loss: 7.634555 Time: 184.89
Run: 36 VAL ap_score: 0.941121 map_score: 0.913008 Time: 78.69
Run: 37 train loss: 5.750992 Time: 181.55
Run: 37 VAL ap_score: 0.936222 map_score: 0.902794 Time: 78.51
Run: 38 train loss: 5.995437 Time: 181.57
Run: 38 VAL ap_score: 0.943227 map_score: 0.913559 Time: 76.75
Run: 39 train loss: 7.692013 Time: 182.52
Run: 39 VAL ap_score: 0.940477 map_score: 0.894648 Time: 78.02
Run: 40 train loss: 6.302530 Time: 183.08
Run: 40 VAL ap_score: 0.941012 map_score: 0.904710 Time: 76.10
Run: 41 train loss: 5.507336 Time: 184.10
Run: 41 VAL ap_score: 0.941292 map_score: 0.908238 Time: 81.06
Run: 42 train loss: 4.963323 Time: 189.99
Run: 42 VAL ap_score: 0.950423 map_score: 0.919054 Time: 75.87
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 43 train loss: 4.894650 Time: 183.47
Run: 43 VAL ap_score: 0.930570 map_score: 0.902767 Time: 77.73
Run: 44 train loss: 5.568090 Time: 183.11
Run: 44 VAL ap_score: 0.930183 map_score: 0.911776 Time: 76.81
Run: 45 train loss: 5.239692 Time: 181.87
Run: 45 VAL ap_score: 0.948057 map_score: 0.914037 Time: 75.14
Run: 46 train loss: 4.735570 Time: 182.06
Run: 46 VAL ap_score: 0.939270 map_score: 0.904571 Time: 75.12
Run: 47 train loss: 4.948500 Time: 183.41
Run: 47 VAL ap_score: 0.939491 map_score: 0.915827 Time: 75.11
Run: 48 train loss: 4.780246 Time: 182.25
Run: 48 VAL ap_score: 0.946732 map_score: 0.924461 Time: 75.05
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 49 train loss: 4.604478 Time: 179.04
Run: 49 VAL ap_score: 0.939635 map_score: 0.921272 Time: 74.27
Run: 50 train loss: 4.315998 Time: 171.76
Run: 50 VAL ap_score: 0.941343 map_score: 0.918354 Time: 76.59
Run: 51 train loss: 4.381470 Time: 172.10
Run: 51 VAL ap_score: 0.935828 map_score: 0.905469 Time: 75.06
Run: 52 train loss: 4.353522 Time: 171.95
Run: 52 VAL ap_score: 0.943161 map_score: 0.910183 Time: 77.06
Run: 53 train loss: 4.840686 Time: 171.68
Run: 53 VAL ap_score: 0.939225 map_score: 0.914429 Time: 75.94
Run: 54 train loss: 4.339319 Time: 174.40
Run: 54 VAL ap_score: 0.908075 map_score: 0.879538 Time: 75.86
Run: 55 train loss: 4.599100 Time: 172.33
Run: 55 VAL ap_score: 0.946625 map_score: 0.927308 Time: 75.99
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 56 train loss: 4.710436 Time: 173.50
Run: 56 VAL ap_score: 0.927368 map_score: 0.912831 Time: 76.34
Run: 57 train loss: 3.870933 Time: 171.76
Run: 57 VAL ap_score: 0.933947 map_score: 0.926053 Time: 74.68
Run: 58 train loss: 3.968557 Time: 172.14
Run: 58 VAL ap_score: 0.930283 map_score: 0.909308 Time: 75.00
Run: 59 train loss: 3.766272 Time: 173.74
Run: 59 VAL ap_score: 0.934390 map_score: 0.915841 Time: 75.08
Run: 60 train loss: 3.787151 Time: 175.17
Run: 60 VAL ap_score: 0.940645 map_score: 0.918038 Time: 74.05
Run: 61 train loss: 3.863557 Time: 173.87
Run: 61 VAL ap_score: 0.938123 map_score: 0.922330 Time: 73.63
Run: 62 train loss: 5.154804 Time: 175.48
Run: 62 VAL ap_score: 0.927185 map_score: 0.917017 Time: 72.92
Run: 63 train loss: 3.664957 Time: 175.78
Run: 63 VAL ap_score: 0.943777 map_score: 0.925610 Time: 72.37
Run: 64 train loss: 3.792551 Time: 174.80
Run: 64 VAL ap_score: 0.940871 map_score: 0.918546 Time: 72.96
Run: 65 train loss: 3.967926 Time: 176.45
Run: 65 VAL ap_score: 0.937517 map_score: 0.914799 Time: 72.44
Run: 66 train loss: 3.905670 Time: 175.73
Run: 66 VAL ap_score: 0.912322 map_score: 0.879067 Time: 72.77
Run: 67 train loss: 4.069726 Time: 175.91
Run: 67 VAL ap_score: 0.946775 map_score: 0.927892 Time: 73.28
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 68 train loss: 3.839211 Time: 174.86
Run: 68 VAL ap_score: 0.935497 map_score: 0.930314 Time: 73.25
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
Run: 69 train loss: 3.533777 Time: 173.26
Run: 69 VAL ap_score: 0.941526 map_score: 0.926539 Time: 75.79
Run: 70 train loss: 3.210847 Time: 174.83
Run: 70 VAL ap_score: 0.929929 map_score: 0.925865 Time: 75.09
Run: 71 train loss: 3.620891 Time: 176.35
Run: 71 VAL ap_score: 0.928214 map_score: 0.908301 Time: 75.56
Run: 72 train loss: 4.131761 Time: 175.89
Run: 72 VAL ap_score: 0.942746 map_score: 0.920064 Time: 76.35
Run: 73 train loss: 3.355873 Time: 175.33
Run: 73 VAL ap_score: 0.932180 map_score: 0.916178 Time: 75.97
Run: 74 train loss: 3.486606 Time: 176.00
Run: 74 VAL ap_score: 0.951929 map_score: 0.921310 Time: 75.95
Run: 75 train loss: 3.844721 Time: 173.99
Run: 75 VAL ap_score: 0.943998 map_score: 0.918888 Time: 76.05
Run: 76 train loss: 3.358677 Time: 175.07
Run: 76 VAL ap_score: 0.944207 map_score: 0.922122 Time: 75.43
Run: 77 train loss: 3.150801 Time: 174.74
Run: 77 VAL ap_score: 0.950045 map_score: 0.930958 Time: 74.45
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_4929_2023-12-23_01:43:41.485791
