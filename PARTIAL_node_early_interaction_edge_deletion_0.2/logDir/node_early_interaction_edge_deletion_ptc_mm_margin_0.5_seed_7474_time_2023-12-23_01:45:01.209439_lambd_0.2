Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=ptc_mm
--SEED=2
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_ptc_mm80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_mm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mm80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_mm80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_mm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mm80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
no. of params in model: 2498
Run: 0 train loss: 97.954741 Time: 179.46
Run: 0 VAL ap_score: 0.468019 map_score: 0.542735 Time: 75.26
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 1 train loss: 43.205445 Time: 177.98
Run: 1 VAL ap_score: 0.570149 map_score: 0.573930 Time: 76.55
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 2 train loss: 34.453670 Time: 170.04
Run: 2 VAL ap_score: 0.560270 map_score: 0.590050 Time: 73.76
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 3 train loss: 31.524668 Time: 179.04
Run: 3 VAL ap_score: 0.594287 map_score: 0.609848 Time: 73.12
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 4 train loss: 29.540917 Time: 181.99
Run: 4 VAL ap_score: 0.600676 map_score: 0.628617 Time: 73.21
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 5 train loss: 27.947351 Time: 181.27
Run: 5 VAL ap_score: 0.658501 map_score: 0.661314 Time: 73.99
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 6 train loss: 25.470497 Time: 179.67
Run: 6 VAL ap_score: 0.698143 map_score: 0.693814 Time: 76.28
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 7 train loss: 23.764422 Time: 177.58
Run: 7 VAL ap_score: 0.699209 map_score: 0.719587 Time: 75.78
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 8 train loss: 22.002452 Time: 175.76
Run: 8 VAL ap_score: 0.646540 map_score: 0.677689 Time: 75.31
Run: 9 train loss: 20.531988 Time: 180.22
Run: 9 VAL ap_score: 0.718548 map_score: 0.736846 Time: 77.13
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 10 train loss: 19.383761 Time: 178.24
Run: 10 VAL ap_score: 0.720942 map_score: 0.738432 Time: 75.69
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 11 train loss: 18.163851 Time: 179.53
Run: 11 VAL ap_score: 0.741875 map_score: 0.754706 Time: 77.06
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 12 train loss: 16.230972 Time: 180.76
Run: 12 VAL ap_score: 0.732726 map_score: 0.761368 Time: 76.47
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 13 train loss: 15.825550 Time: 181.57
Run: 13 VAL ap_score: 0.743668 map_score: 0.772211 Time: 76.38
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 14 train loss: 14.888660 Time: 178.74
Run: 14 VAL ap_score: 0.746121 map_score: 0.785770 Time: 77.11
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 15 train loss: 14.372418 Time: 178.66
Run: 15 VAL ap_score: 0.786694 map_score: 0.796283 Time: 76.32
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 16 train loss: 13.556289 Time: 180.01
Run: 16 VAL ap_score: 0.781641 map_score: 0.803472 Time: 77.33
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 17 train loss: 12.709859 Time: 181.65
Run: 17 VAL ap_score: 0.788510 map_score: 0.808910 Time: 77.73
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 18 train loss: 12.427221 Time: 178.73
Run: 18 VAL ap_score: 0.791243 map_score: 0.815620 Time: 78.27
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 19 train loss: 11.702577 Time: 179.35
Run: 19 VAL ap_score: 0.800797 map_score: 0.815217 Time: 76.58
Run: 20 train loss: 11.434095 Time: 179.64
Run: 20 VAL ap_score: 0.786205 map_score: 0.805975 Time: 76.91
Run: 21 train loss: 11.364514 Time: 173.34
Run: 21 VAL ap_score: 0.806916 map_score: 0.832448 Time: 75.40
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 22 train loss: 10.500693 Time: 172.48
Run: 22 VAL ap_score: 0.786690 map_score: 0.827432 Time: 75.72
Run: 23 train loss: 10.103796 Time: 180.44
Run: 23 VAL ap_score: 0.786164 map_score: 0.831236 Time: 75.65
Run: 24 train loss: 10.146103 Time: 181.10
Run: 24 VAL ap_score: 0.759907 map_score: 0.827478 Time: 73.99
Run: 25 train loss: 9.433889 Time: 180.97
Run: 25 VAL ap_score: 0.809141 map_score: 0.840618 Time: 74.33
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 26 train loss: 8.978964 Time: 184.49
Run: 26 VAL ap_score: 0.755795 map_score: 0.842239 Time: 74.81
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 27 train loss: 8.575410 Time: 183.51
Run: 27 VAL ap_score: 0.811096 map_score: 0.832600 Time: 74.22
Run: 28 train loss: 8.361299 Time: 180.76
Run: 28 VAL ap_score: 0.813844 map_score: 0.856432 Time: 75.23
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 29 train loss: 8.338033 Time: 181.32
Run: 29 VAL ap_score: 0.809805 map_score: 0.871197 Time: 76.51
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 30 train loss: 8.236057 Time: 178.96
Run: 30 VAL ap_score: 0.826474 map_score: 0.859980 Time: 76.59
Run: 31 train loss: 7.507564 Time: 181.19
Run: 31 VAL ap_score: 0.818367 map_score: 0.853612 Time: 77.88
Run: 32 train loss: 7.646616 Time: 179.96
Run: 32 VAL ap_score: 0.821823 map_score: 0.863317 Time: 78.52
Run: 33 train loss: 7.426616 Time: 178.92
Run: 33 VAL ap_score: 0.846692 map_score: 0.867115 Time: 81.23
Run: 34 train loss: 7.310843 Time: 181.04
Run: 34 VAL ap_score: 0.836173 map_score: 0.868349 Time: 82.92
Run: 35 train loss: 7.009418 Time: 180.70
Run: 35 VAL ap_score: 0.820799 map_score: 0.865231 Time: 82.18
Run: 36 train loss: 7.942299 Time: 178.15
Run: 36 VAL ap_score: 0.844752 map_score: 0.867061 Time: 81.87
Run: 37 train loss: 6.851693 Time: 178.18
Run: 37 VAL ap_score: 0.836165 map_score: 0.862892 Time: 78.94
Run: 38 train loss: 6.640157 Time: 178.48
Run: 38 VAL ap_score: 0.825316 map_score: 0.840134 Time: 77.84
Run: 39 train loss: 6.675888 Time: 181.12
Run: 39 VAL ap_score: 0.867100 map_score: 0.870052 Time: 77.64
Run: 40 train loss: 14.447881 Time: 181.40
Run: 40 VAL ap_score: 0.786795 map_score: 0.819236 Time: 77.55
Run: 41 train loss: 8.441870 Time: 185.47
Run: 41 VAL ap_score: 0.808452 map_score: 0.849667 Time: 76.39
Run: 42 train loss: 6.610702 Time: 175.82
Run: 42 VAL ap_score: 0.852829 map_score: 0.881267 Time: 76.13
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 43 train loss: 6.460058 Time: 182.53
Run: 43 VAL ap_score: 0.864863 map_score: 0.880689 Time: 77.25
Run: 44 train loss: 6.271662 Time: 182.16
Run: 44 VAL ap_score: 0.834076 map_score: 0.886405 Time: 75.59
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 45 train loss: 5.868494 Time: 184.39
Run: 45 VAL ap_score: 0.823912 map_score: 0.869858 Time: 75.58
Run: 46 train loss: 5.866628 Time: 183.63
Run: 46 VAL ap_score: 0.843019 map_score: 0.881840 Time: 75.75
Run: 47 train loss: 5.996320 Time: 182.36
Run: 47 VAL ap_score: 0.848896 map_score: 0.872977 Time: 74.05
Run: 48 train loss: 5.517893 Time: 185.56
Run: 48 VAL ap_score: 0.827612 map_score: 0.868874 Time: 73.92
Run: 49 train loss: 6.160497 Time: 183.68
Run: 49 VAL ap_score: 0.813788 map_score: 0.855955 Time: 75.66
Run: 50 train loss: 5.499119 Time: 181.18
Run: 50 VAL ap_score: 0.837845 map_score: 0.868817 Time: 75.79
Run: 51 train loss: 5.285344 Time: 183.89
Run: 51 VAL ap_score: 0.832326 map_score: 0.878710 Time: 76.10
Run: 52 train loss: 5.290102 Time: 184.22
Run: 52 VAL ap_score: 0.831226 map_score: 0.878080 Time: 73.72
Run: 53 train loss: 5.581471 Time: 183.98
Run: 53 VAL ap_score: 0.846178 map_score: 0.871343 Time: 75.39
Run: 54 train loss: 5.496229 Time: 184.37
Run: 54 VAL ap_score: 0.849531 map_score: 0.862672 Time: 73.00
Run: 55 train loss: 5.301408 Time: 184.25
Run: 55 VAL ap_score: 0.859918 map_score: 0.869302 Time: 71.17
Run: 56 train loss: 5.529282 Time: 186.53
Run: 56 VAL ap_score: 0.820261 map_score: 0.867130 Time: 70.20
Run: 57 train loss: 5.038792 Time: 185.80
Run: 57 VAL ap_score: 0.839540 map_score: 0.841742 Time: 71.01
Run: 58 train loss: 5.199663 Time: 184.16
Run: 58 VAL ap_score: 0.845256 map_score: 0.876053 Time: 71.36
Run: 59 train loss: 4.817201 Time: 178.81
Run: 59 VAL ap_score: 0.796819 map_score: 0.855602 Time: 71.26
Run: 60 train loss: 4.507554 Time: 184.63
Run: 60 VAL ap_score: 0.833830 map_score: 0.886052 Time: 71.80
Run: 61 train loss: 4.540108 Time: 178.90
Run: 61 VAL ap_score: 0.848292 map_score: 0.880849 Time: 72.21
Run: 62 train loss: 4.596358 Time: 177.95
Run: 62 VAL ap_score: 0.837364 map_score: 0.871599 Time: 72.59
Run: 63 train loss: 5.151510 Time: 182.78
Run: 63 VAL ap_score: 0.850115 map_score: 0.879433 Time: 72.92
Run: 64 train loss: 5.041654 Time: 184.14
Run: 64 VAL ap_score: 0.863138 map_score: 0.886639 Time: 73.78
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 65 train loss: 4.276666 Time: 184.65
Run: 65 VAL ap_score: 0.852835 map_score: 0.887497 Time: 74.30
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 66 train loss: 4.669780 Time: 175.67
Run: 66 VAL ap_score: 0.845202 map_score: 0.859796 Time: 74.05
Run: 67 train loss: 4.468983 Time: 178.45
Run: 67 VAL ap_score: 0.859513 map_score: 0.858479 Time: 73.72
Run: 68 train loss: 12.600976 Time: 173.96
Run: 68 VAL ap_score: 0.807842 map_score: 0.840317 Time: 74.44
Run: 69 train loss: 6.237777 Time: 173.09
Run: 69 VAL ap_score: 0.824287 map_score: 0.875212 Time: 75.72
Run: 70 train loss: 4.807364 Time: 180.89
Run: 70 VAL ap_score: 0.868987 map_score: 0.887854 Time: 76.82
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 71 train loss: 4.513331 Time: 181.18
Run: 71 VAL ap_score: 0.861965 map_score: 0.895705 Time: 76.46
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 72 train loss: 4.262753 Time: 180.24
Run: 72 VAL ap_score: 0.867849 map_score: 0.873463 Time: 77.47
Run: 73 train loss: 4.010778 Time: 180.25
Run: 73 VAL ap_score: 0.827032 map_score: 0.880416 Time: 76.00
Run: 74 train loss: 4.183577 Time: 179.24
Run: 74 VAL ap_score: 0.871442 map_score: 0.882776 Time: 77.13
Run: 75 train loss: 4.116497 Time: 182.33
Run: 75 VAL ap_score: 0.843619 map_score: 0.878009 Time: 76.77
Run: 76 train loss: 4.082626 Time: 183.65
Run: 76 VAL ap_score: 0.876082 map_score: 0.900088 Time: 74.55
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7474_2023-12-23_01:45:01.209439
Run: 77 train loss: 3.899681 Time: 173.09
