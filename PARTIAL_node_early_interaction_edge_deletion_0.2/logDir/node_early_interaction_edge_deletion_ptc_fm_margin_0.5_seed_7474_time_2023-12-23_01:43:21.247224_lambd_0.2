Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=ptc_fm
--SEED=2
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_ptc_fm80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_fm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fm80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_fm80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_fm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fm80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
no. of params in model: 2498
Run: 0 train loss: 96.744563 Time: 162.98
Run: 0 VAL ap_score: 0.738809 map_score: 0.689540 Time: 78.24
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 1 train loss: 43.692531 Time: 179.84
Run: 1 VAL ap_score: 0.809280 map_score: 0.752157 Time: 77.60
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 2 train loss: 37.754958 Time: 179.34
Run: 2 VAL ap_score: 0.816028 map_score: 0.746899 Time: 76.68
Run: 3 train loss: 34.550241 Time: 181.03
Run: 3 VAL ap_score: 0.855017 map_score: 0.797856 Time: 77.28
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 4 train loss: 32.113550 Time: 179.90
Run: 4 VAL ap_score: 0.835035 map_score: 0.791854 Time: 78.66
Run: 5 train loss: 29.073423 Time: 180.67
Run: 5 VAL ap_score: 0.857119 map_score: 0.811126 Time: 76.31
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 6 train loss: 26.669709 Time: 180.41
Run: 6 VAL ap_score: 0.857487 map_score: 0.804586 Time: 77.26
Run: 7 train loss: 23.937957 Time: 179.71
Run: 7 VAL ap_score: 0.854636 map_score: 0.809987 Time: 76.50
Run: 8 train loss: 21.996893 Time: 179.48
Run: 8 VAL ap_score: 0.857904 map_score: 0.814830 Time: 75.84
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 9 train loss: 20.923621 Time: 181.95
Run: 9 VAL ap_score: 0.884592 map_score: 0.837051 Time: 74.59
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 10 train loss: 18.750463 Time: 180.20
Run: 10 VAL ap_score: 0.877544 map_score: 0.823793 Time: 75.97
Run: 11 train loss: 17.831527 Time: 180.24
Run: 11 VAL ap_score: 0.893196 map_score: 0.853677 Time: 77.57
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 12 train loss: 16.754284 Time: 179.57
Run: 12 VAL ap_score: 0.893994 map_score: 0.859532 Time: 75.69
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 13 train loss: 15.871792 Time: 179.03
Run: 13 VAL ap_score: 0.879993 map_score: 0.828087 Time: 76.91
Run: 14 train loss: 15.456074 Time: 181.96
Run: 14 VAL ap_score: 0.896042 map_score: 0.843147 Time: 76.50
Run: 15 train loss: 15.755689 Time: 181.80
Run: 15 VAL ap_score: 0.872820 map_score: 0.834918 Time: 78.62
Run: 16 train loss: 15.090805 Time: 179.67
Run: 16 VAL ap_score: 0.907545 map_score: 0.858889 Time: 77.14
Run: 17 train loss: 14.602357 Time: 181.30
Run: 17 VAL ap_score: 0.902598 map_score: 0.858533 Time: 78.42
Run: 18 train loss: 13.656889 Time: 182.62
Run: 18 VAL ap_score: 0.902441 map_score: 0.863189 Time: 77.70
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 19 train loss: 13.721323 Time: 181.60
Run: 19 VAL ap_score: 0.885640 map_score: 0.850136 Time: 78.38
Run: 20 train loss: 13.191040 Time: 180.83
Run: 20 VAL ap_score: 0.906076 map_score: 0.860559 Time: 80.91
Run: 21 train loss: 12.368454 Time: 179.40
Run: 21 VAL ap_score: 0.924342 map_score: 0.875279 Time: 80.98
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 22 train loss: 12.139255 Time: 179.24
Run: 22 VAL ap_score: 0.898451 map_score: 0.854789 Time: 80.92
Run: 23 train loss: 11.949280 Time: 178.82
Run: 23 VAL ap_score: 0.920311 map_score: 0.868519 Time: 80.60
Run: 24 train loss: 11.963999 Time: 179.96
Run: 24 VAL ap_score: 0.900078 map_score: 0.869818 Time: 79.49
Run: 25 train loss: 11.523316 Time: 168.33
Run: 25 VAL ap_score: 0.918963 map_score: 0.878278 Time: 81.06
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 26 train loss: 11.026936 Time: 167.27
Run: 26 VAL ap_score: 0.930139 map_score: 0.880968 Time: 81.24
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 27 train loss: 12.137451 Time: 166.33
Run: 27 VAL ap_score: 0.910109 map_score: 0.877599 Time: 81.42
Run: 28 train loss: 11.950224 Time: 169.26
Run: 28 VAL ap_score: 0.900274 map_score: 0.862078 Time: 80.20
Run: 29 train loss: 10.797086 Time: 168.50
Run: 29 VAL ap_score: 0.909150 map_score: 0.882427 Time: 79.63
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 30 train loss: 10.861184 Time: 169.16
Run: 30 VAL ap_score: 0.920049 map_score: 0.882510 Time: 79.66
Run: 31 train loss: 9.790375 Time: 169.18
Run: 31 VAL ap_score: 0.913983 map_score: 0.886621 Time: 77.78
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 32 train loss: 10.013704 Time: 169.73
Run: 32 VAL ap_score: 0.923157 map_score: 0.883606 Time: 76.87
Run: 33 train loss: 8.632291 Time: 172.16
Run: 33 VAL ap_score: 0.917245 map_score: 0.876845 Time: 76.72
Run: 34 train loss: 9.642542 Time: 170.86
Run: 34 VAL ap_score: 0.909381 map_score: 0.869051 Time: 73.93
Run: 35 train loss: 9.380258 Time: 173.34
Run: 35 VAL ap_score: 0.921272 map_score: 0.884002 Time: 73.18
Run: 36 train loss: 7.927972 Time: 175.49
Run: 36 VAL ap_score: 0.929100 map_score: 0.900866 Time: 72.92
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 37 train loss: 7.927022 Time: 175.26
Run: 37 VAL ap_score: 0.911522 map_score: 0.884005 Time: 72.30
Run: 38 train loss: 9.041508 Time: 175.05
Run: 38 VAL ap_score: 0.928825 map_score: 0.901739 Time: 72.78
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 39 train loss: 7.516884 Time: 173.94
Run: 39 VAL ap_score: 0.932412 map_score: 0.891527 Time: 73.70
Run: 40 train loss: 7.404464 Time: 174.56
Run: 40 VAL ap_score: 0.933434 map_score: 0.898198 Time: 71.97
Run: 41 train loss: 7.383025 Time: 174.67
Run: 41 VAL ap_score: 0.920997 map_score: 0.875876 Time: 72.80
Run: 42 train loss: 7.526934 Time: 174.61
Run: 42 VAL ap_score: 0.929328 map_score: 0.904662 Time: 73.95
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 43 train loss: 6.813160 Time: 175.21
Run: 43 VAL ap_score: 0.936057 map_score: 0.905604 Time: 74.26
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 44 train loss: 7.107164 Time: 174.34
Run: 44 VAL ap_score: 0.932605 map_score: 0.903374 Time: 74.77
Run: 45 train loss: 7.166867 Time: 171.31
Run: 45 VAL ap_score: 0.930573 map_score: 0.905272 Time: 74.38
Run: 46 train loss: 6.619748 Time: 172.61
Run: 46 VAL ap_score: 0.933771 map_score: 0.907317 Time: 75.79
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 47 train loss: 6.460182 Time: 172.88
Run: 47 VAL ap_score: 0.948168 map_score: 0.917398 Time: 77.25
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 48 train loss: 6.768459 Time: 182.65
Run: 48 VAL ap_score: 0.934960 map_score: 0.900891 Time: 74.52
Run: 49 train loss: 6.091369 Time: 181.91
Run: 49 VAL ap_score: 0.944915 map_score: 0.925495 Time: 73.93
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 50 train loss: 6.285547 Time: 183.15
Run: 50 VAL ap_score: 0.930341 map_score: 0.906254 Time: 74.98
Run: 51 train loss: 6.241074 Time: 186.11
Run: 51 VAL ap_score: 0.937275 map_score: 0.912936 Time: 76.24
Run: 52 train loss: 5.795524 Time: 181.93
Run: 52 VAL ap_score: 0.932074 map_score: 0.891144 Time: 76.92
Run: 53 train loss: 6.251541 Time: 181.99
Run: 53 VAL ap_score: 0.924586 map_score: 0.904839 Time: 74.85
Run: 54 train loss: 6.498329 Time: 182.81
Run: 54 VAL ap_score: 0.935827 map_score: 0.905473 Time: 77.70
Run: 55 train loss: 5.446673 Time: 186.14
Run: 55 VAL ap_score: 0.943282 map_score: 0.915314 Time: 74.61
Run: 56 train loss: 5.869153 Time: 185.39
Run: 56 VAL ap_score: 0.936617 map_score: 0.909319 Time: 72.41
Run: 57 train loss: 5.364303 Time: 179.13
Run: 57 VAL ap_score: 0.921993 map_score: 0.901738 Time: 72.71
Run: 58 train loss: 5.268624 Time: 186.16
Run: 58 VAL ap_score: 0.928455 map_score: 0.914218 Time: 71.03
Run: 59 train loss: 5.464163 Time: 187.25
Run: 59 VAL ap_score: 0.922237 map_score: 0.904543 Time: 71.26
Run: 60 train loss: 5.180487 Time: 191.40
Run: 60 VAL ap_score: 0.936734 map_score: 0.918370 Time: 75.68
Run: 61 train loss: 4.920906 Time: 187.03
Run: 61 VAL ap_score: 0.940120 map_score: 0.918328 Time: 71.49
Run: 62 train loss: 5.448209 Time: 185.88
Run: 62 VAL ap_score: 0.938182 map_score: 0.912088 Time: 72.49
Run: 63 train loss: 5.138706 Time: 184.69
Run: 63 VAL ap_score: 0.926053 map_score: 0.895087 Time: 72.19
Run: 64 train loss: 5.141460 Time: 187.04
Run: 64 VAL ap_score: 0.945535 map_score: 0.917641 Time: 72.59
Run: 65 train loss: 4.844780 Time: 183.80
Run: 65 VAL ap_score: 0.943831 map_score: 0.916060 Time: 72.23
Run: 66 train loss: 4.811470 Time: 189.41
Run: 66 VAL ap_score: 0.928609 map_score: 0.901046 Time: 71.56
Run: 67 train loss: 4.499332 Time: 186.90
Run: 67 VAL ap_score: 0.931481 map_score: 0.904252 Time: 70.74
Run: 68 train loss: 8.146063 Time: 187.35
Run: 68 VAL ap_score: 0.946367 map_score: 0.921031 Time: 71.59
Run: 69 train loss: 5.552688 Time: 187.86
Run: 69 VAL ap_score: 0.931720 map_score: 0.913750 Time: 72.12
Run: 70 train loss: 4.242187 Time: 190.36
Run: 70 VAL ap_score: 0.948171 map_score: 0.929254 Time: 73.33
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
Run: 71 train loss: 4.260490 Time: 183.50
Run: 71 VAL ap_score: 0.949790 map_score: 0.926747 Time: 71.79
Run: 72 train loss: 4.469923 Time: 187.92
Run: 72 VAL ap_score: 0.926060 map_score: 0.916413 Time: 75.71
Run: 73 train loss: 4.726069 Time: 187.72
Run: 73 VAL ap_score: 0.930441 map_score: 0.903334 Time: 71.96
Run: 74 train loss: 5.012851 Time: 180.84
Run: 74 VAL ap_score: 0.951889 map_score: 0.917384 Time: 72.31
Run: 75 train loss: 3.740085 Time: 181.19
Run: 75 VAL ap_score: 0.944044 map_score: 0.923593 Time: 72.13
Run: 76 train loss: 4.429635 Time: 184.33
Run: 76 VAL ap_score: 0.942560 map_score: 0.910691 Time: 72.96
Run: 77 train loss: 4.168135 Time: 185.86
Run: 77 VAL ap_score: 0.950307 map_score: 0.930670 Time: 73.49
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fm_7474_2023-12-23_01:43:21.247224
