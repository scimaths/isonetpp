Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=aids
--SEED=0
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4586
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_aids80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_aids80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/aids80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_aids80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_aids80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/aids80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
no. of params in model: 2498
Run: 0 train loss: 75.041974 Time: 68.12
Run: 0 VAL ap_score: 0.601587 map_score: 0.565807 Time: 26.53
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 1 train loss: 31.992710 Time: 105.57
Run: 1 VAL ap_score: 0.637641 map_score: 0.614380 Time: 61.29
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 2 train loss: 29.786488 Time: 174.14
Run: 2 VAL ap_score: 0.643791 map_score: 0.631617 Time: 73.80
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 3 train loss: 28.915462 Time: 175.19
Run: 3 VAL ap_score: 0.685126 map_score: 0.638558 Time: 73.42
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 4 train loss: 28.304673 Time: 183.89
Run: 4 VAL ap_score: 0.667829 map_score: 0.614927 Time: 77.48
Run: 5 train loss: 28.059554 Time: 183.53
Run: 5 VAL ap_score: 0.659941 map_score: 0.638470 Time: 72.26
Run: 6 train loss: 27.326737 Time: 174.37
Run: 6 VAL ap_score: 0.696634 map_score: 0.657787 Time: 72.84
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 7 train loss: 27.189775 Time: 177.25
Run: 7 VAL ap_score: 0.707552 map_score: 0.659161 Time: 73.97
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 8 train loss: 26.004820 Time: 177.49
Run: 8 VAL ap_score: 0.708660 map_score: 0.664979 Time: 74.70
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 9 train loss: 25.280749 Time: 174.08
Run: 9 VAL ap_score: 0.690305 map_score: 0.670854 Time: 75.86
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 10 train loss: 24.888724 Time: 173.97
Run: 10 VAL ap_score: 0.718558 map_score: 0.689748 Time: 75.13
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 11 train loss: 24.524212 Time: 173.57
Run: 11 VAL ap_score: 0.695947 map_score: 0.681611 Time: 74.87
Run: 12 train loss: 24.051255 Time: 182.52
Run: 12 VAL ap_score: 0.716789 map_score: 0.687829 Time: 79.24
Run: 13 train loss: 23.442705 Time: 175.02
Run: 13 VAL ap_score: 0.692829 map_score: 0.695022 Time: 76.79
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 14 train loss: 22.476806 Time: 172.46
Run: 14 VAL ap_score: 0.665239 map_score: 0.692063 Time: 75.43
Run: 15 train loss: 22.467755 Time: 172.12
Run: 15 VAL ap_score: 0.705816 map_score: 0.702306 Time: 77.60
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 16 train loss: 21.890359 Time: 173.24
Run: 16 VAL ap_score: 0.714689 map_score: 0.715868 Time: 76.37
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 17 train loss: 21.541582 Time: 170.98
Run: 17 VAL ap_score: 0.737593 map_score: 0.729888 Time: 77.76
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 18 train loss: 21.156328 Time: 171.35
Run: 18 VAL ap_score: 0.735987 map_score: 0.728297 Time: 77.10
Run: 19 train loss: 20.284042 Time: 171.23
Run: 19 VAL ap_score: 0.734159 map_score: 0.739487 Time: 78.38
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 20 train loss: 19.531182 Time: 172.06
Run: 20 VAL ap_score: 0.738261 map_score: 0.749204 Time: 76.58
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 21 train loss: 19.702475 Time: 170.17
Run: 21 VAL ap_score: 0.746361 map_score: 0.765844 Time: 78.04
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 22 train loss: 17.686116 Time: 171.18
Run: 22 VAL ap_score: 0.758821 map_score: 0.797907 Time: 77.41
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 23 train loss: 16.189012 Time: 171.01
Run: 23 VAL ap_score: 0.794132 map_score: 0.820963 Time: 77.82
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 24 train loss: 15.174179 Time: 170.17
Run: 24 VAL ap_score: 0.821670 map_score: 0.858858 Time: 76.31
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 25 train loss: 13.828212 Time: 174.21
Run: 25 VAL ap_score: 0.777144 map_score: 0.835379 Time: 77.78
Run: 26 train loss: 12.587970 Time: 171.81
Run: 26 VAL ap_score: 0.842731 map_score: 0.870027 Time: 76.60
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 27 train loss: 11.179544 Time: 172.48
Run: 27 VAL ap_score: 0.873107 map_score: 0.853146 Time: 77.07
Run: 28 train loss: 10.288756 Time: 170.03
Run: 28 VAL ap_score: 0.901756 map_score: 0.897037 Time: 78.43
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 29 train loss: 10.767742 Time: 174.12
Run: 29 VAL ap_score: 0.889571 map_score: 0.890792 Time: 78.81
Run: 30 train loss: 9.484720 Time: 173.45
Run: 30 VAL ap_score: 0.859419 map_score: 0.893237 Time: 78.09
Run: 31 train loss: 9.420887 Time: 172.28
Run: 31 VAL ap_score: 0.889873 map_score: 0.854369 Time: 77.85
Run: 32 train loss: 9.470003 Time: 173.62
Run: 32 VAL ap_score: 0.894404 map_score: 0.914732 Time: 76.90
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 33 train loss: 8.529445 Time: 173.52
Run: 33 VAL ap_score: 0.878817 map_score: 0.912023 Time: 77.97
Run: 34 train loss: 7.902350 Time: 173.47
Run: 34 VAL ap_score: 0.904260 map_score: 0.922729 Time: 76.80
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 35 train loss: 7.905930 Time: 171.26
Run: 35 VAL ap_score: 0.870534 map_score: 0.913738 Time: 77.63
Run: 36 train loss: 7.385413 Time: 174.01
Run: 36 VAL ap_score: 0.892907 map_score: 0.914668 Time: 77.96
Run: 37 train loss: 6.859568 Time: 174.02
Run: 37 VAL ap_score: 0.915684 map_score: 0.932272 Time: 77.67
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 38 train loss: 6.797239 Time: 173.51
Run: 38 VAL ap_score: 0.912720 map_score: 0.932252 Time: 76.47
Run: 39 train loss: 6.324780 Time: 173.75
Run: 39 VAL ap_score: 0.901738 map_score: 0.936973 Time: 77.10
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 40 train loss: 7.410313 Time: 173.98
Run: 40 VAL ap_score: 0.891939 map_score: 0.928743 Time: 75.37
Run: 41 train loss: 5.867249 Time: 172.24
Run: 41 VAL ap_score: 0.904178 map_score: 0.931224 Time: 75.91
Run: 42 train loss: 6.567416 Time: 177.88
Run: 42 VAL ap_score: 0.934761 map_score: 0.935403 Time: 79.86
Run: 43 train loss: 5.589780 Time: 179.56
Run: 43 VAL ap_score: 0.936061 map_score: 0.940940 Time: 75.11
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 44 train loss: 5.453324 Time: 164.56
Run: 44 VAL ap_score: 0.954436 map_score: 0.941961 Time: 77.16
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 45 train loss: 5.054893 Time: 164.35
Run: 45 VAL ap_score: 0.943649 map_score: 0.940193 Time: 78.44
Run: 46 train loss: 5.075493 Time: 163.87
Run: 46 VAL ap_score: 0.939632 map_score: 0.942575 Time: 79.21
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 47 train loss: 5.486820 Time: 174.09
Run: 47 VAL ap_score: 0.950660 map_score: 0.946210 Time: 78.91
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 48 train loss: 5.291476 Time: 172.39
Run: 48 VAL ap_score: 0.948625 map_score: 0.946208 Time: 79.05
Run: 49 train loss: 6.082771 Time: 172.52
Run: 49 VAL ap_score: 0.948665 map_score: 0.949804 Time: 78.51
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 50 train loss: 5.168299 Time: 173.22
Run: 50 VAL ap_score: 0.921133 map_score: 0.944935 Time: 78.02
Run: 51 train loss: 4.465213 Time: 170.14
Run: 51 VAL ap_score: 0.947465 map_score: 0.952377 Time: 76.62
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 52 train loss: 4.361352 Time: 172.61
Run: 52 VAL ap_score: 0.944973 map_score: 0.951976 Time: 78.41
Run: 53 train loss: 4.389176 Time: 172.64
Run: 53 VAL ap_score: 0.951654 map_score: 0.942133 Time: 77.61
Run: 54 train loss: 4.508902 Time: 172.97
Run: 54 VAL ap_score: 0.945040 map_score: 0.954004 Time: 77.56
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 55 train loss: 4.382143 Time: 172.47
Run: 55 VAL ap_score: 0.928331 map_score: 0.952448 Time: 77.75
Run: 56 train loss: 3.882052 Time: 165.89
Run: 56 VAL ap_score: 0.953442 map_score: 0.950595 Time: 78.81
Run: 57 train loss: 3.867209 Time: 160.92
Run: 57 VAL ap_score: 0.940989 map_score: 0.944848 Time: 77.92
Run: 58 train loss: 4.264251 Time: 163.85
Run: 58 VAL ap_score: 0.944902 map_score: 0.958409 Time: 80.04
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 59 train loss: 3.783035 Time: 174.97
Run: 59 VAL ap_score: 0.940395 map_score: 0.945758 Time: 82.52
Run: 60 train loss: 4.049180 Time: 172.15
Run: 60 VAL ap_score: 0.936004 map_score: 0.949788 Time: 81.23
Run: 61 train loss: 4.391544 Time: 173.33
Run: 61 VAL ap_score: 0.933412 map_score: 0.944036 Time: 81.03
Run: 62 train loss: 3.870105 Time: 170.20
Run: 62 VAL ap_score: 0.967576 map_score: 0.958555 Time: 81.68
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 63 train loss: 3.372425 Time: 170.55
Run: 63 VAL ap_score: 0.951572 map_score: 0.957383 Time: 81.05
Run: 64 train loss: 3.901303 Time: 171.76
Run: 64 VAL ap_score: 0.959896 map_score: 0.956224 Time: 82.10
Run: 65 train loss: 3.447883 Time: 169.64
Run: 65 VAL ap_score: 0.959000 map_score: 0.961036 Time: 81.35
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 66 train loss: 3.220176 Time: 172.20
Run: 66 VAL ap_score: 0.960568 map_score: 0.960268 Time: 80.31
Run: 67 train loss: 3.970267 Time: 172.83
Run: 67 VAL ap_score: 0.957683 map_score: 0.961851 Time: 80.85
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 68 train loss: 3.271355 Time: 172.47
Run: 68 VAL ap_score: 0.957480 map_score: 0.959400 Time: 78.32
Run: 69 train loss: 3.238920 Time: 172.07
Run: 69 VAL ap_score: 0.961727 map_score: 0.959284 Time: 76.70
Run: 70 train loss: 3.712799 Time: 173.39
Run: 70 VAL ap_score: 0.973659 map_score: 0.963106 Time: 75.44
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 71 train loss: 2.993863 Time: 176.48
Run: 71 VAL ap_score: 0.966685 map_score: 0.953619 Time: 77.10
Run: 72 train loss: 3.142838 Time: 176.83
Run: 72 VAL ap_score: 0.966947 map_score: 0.963178 Time: 75.76
Run: 73 train loss: 3.131430 Time: 176.28
Run: 73 VAL ap_score: 0.967377 map_score: 0.958865 Time: 75.62
Run: 74 train loss: 3.301981 Time: 172.91
Run: 74 VAL ap_score: 0.961728 map_score: 0.952675 Time: 72.57
Run: 75 train loss: 2.879522 Time: 176.03
Run: 75 VAL ap_score: 0.970155 map_score: 0.965998 Time: 70.45
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_aids_4586_2023-12-23_01:40:32.387443
Run: 76 train loss: 2.823831 Time: 177.06
Run: 76 VAL ap_score: 0.958233 map_score: 0.959815 Time: 69.36
Run: 77 train loss: 2.632898 Time: 179.60
Run: 77 VAL ap_score: 0.957056 map_score: 0.958497 Time: 69.38
Run: 78 train loss: 4.840040 Time: 180.00
Run: 78 VAL ap_score: 0.938786 map_score: 0.953508 Time: 70.95
Run: 79 train loss: 2.719743 Time: 180.57
Run: 79 VAL ap_score: 0.951526 map_score: 0.954892 Time: 70.22
Run: 80 train loss: 2.522963 Time: 177.72
Run: 80 VAL ap_score: 0.967749 map_score: 0.963213 Time: 70.82
