Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=ptc_fr
--SEED=0
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4586
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_ptc_fr80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_fr80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fr80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_fr80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_fr80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fr80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
no. of params in model: 2498
Run: 0 train loss: 92.560802 Time: 116.01
Run: 0 VAL ap_score: 0.625788 map_score: 0.570153 Time: 68.93
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 1 train loss: 40.679244 Time: 179.17
Run: 1 VAL ap_score: 0.644411 map_score: 0.615247 Time: 76.39
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 2 train loss: 37.150848 Time: 178.33
Run: 2 VAL ap_score: 0.681578 map_score: 0.644725 Time: 78.97
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 3 train loss: 31.145152 Time: 178.96
Run: 3 VAL ap_score: 0.693845 map_score: 0.679829 Time: 77.43
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 4 train loss: 25.655091 Time: 176.56
Run: 4 VAL ap_score: 0.742238 map_score: 0.698977 Time: 77.54
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 5 train loss: 23.061714 Time: 179.68
Run: 5 VAL ap_score: 0.743915 map_score: 0.728170 Time: 77.01
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 6 train loss: 21.396141 Time: 181.79
Run: 6 VAL ap_score: 0.731994 map_score: 0.687410 Time: 77.40
Run: 7 train loss: 19.507860 Time: 178.72
Run: 7 VAL ap_score: 0.796953 map_score: 0.757165 Time: 80.91
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 8 train loss: 18.049339 Time: 180.14
Run: 8 VAL ap_score: 0.788469 map_score: 0.780382 Time: 83.20
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 9 train loss: 17.592525 Time: 181.33
Run: 9 VAL ap_score: 0.789788 map_score: 0.763348 Time: 79.96
Run: 10 train loss: 16.273843 Time: 176.47
Run: 10 VAL ap_score: 0.841493 map_score: 0.805311 Time: 80.33
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 11 train loss: 14.881763 Time: 175.96
Run: 11 VAL ap_score: 0.829139 map_score: 0.805327 Time: 78.04
Run: 12 train loss: 14.431331 Time: 176.84
Run: 12 VAL ap_score: 0.840212 map_score: 0.814529 Time: 80.10
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 13 train loss: 14.169513 Time: 179.28
Run: 13 VAL ap_score: 0.854364 map_score: 0.834866 Time: 77.79
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 14 train loss: 13.370900 Time: 179.34
Run: 14 VAL ap_score: 0.848047 map_score: 0.834484 Time: 78.45
Run: 15 train loss: 13.727854 Time: 180.78
Run: 15 VAL ap_score: 0.858608 map_score: 0.827098 Time: 77.07
Run: 16 train loss: 13.145045 Time: 180.60
Run: 16 VAL ap_score: 0.860003 map_score: 0.840883 Time: 76.58
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 17 train loss: 12.456618 Time: 180.02
Run: 17 VAL ap_score: 0.879682 map_score: 0.852830 Time: 77.55
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 18 train loss: 12.289157 Time: 178.95
Run: 18 VAL ap_score: 0.867604 map_score: 0.854099 Time: 77.29
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 19 train loss: 12.075334 Time: 180.68
Run: 19 VAL ap_score: 0.872603 map_score: 0.844252 Time: 78.37
Run: 20 train loss: 11.751928 Time: 180.75
Run: 20 VAL ap_score: 0.848045 map_score: 0.828332 Time: 78.44
Run: 21 train loss: 11.562552 Time: 179.63
Run: 21 VAL ap_score: 0.868583 map_score: 0.856678 Time: 78.07
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 22 train loss: 11.420139 Time: 172.02
Run: 22 VAL ap_score: 0.877810 map_score: 0.848017 Time: 77.79
Run: 23 train loss: 10.751068 Time: 168.89
Run: 23 VAL ap_score: 0.870442 map_score: 0.854349 Time: 76.03
Run: 24 train loss: 10.694100 Time: 170.28
Run: 24 VAL ap_score: 0.892926 map_score: 0.871058 Time: 75.82
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 25 train loss: 10.463094 Time: 170.58
Run: 25 VAL ap_score: 0.893328 map_score: 0.872107 Time: 74.22
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 26 train loss: 9.899171 Time: 171.91
Run: 26 VAL ap_score: 0.879186 map_score: 0.867227 Time: 73.76
Run: 27 train loss: 9.544903 Time: 171.23
Run: 27 VAL ap_score: 0.871730 map_score: 0.857777 Time: 73.18
Run: 28 train loss: 9.618707 Time: 172.06
Run: 28 VAL ap_score: 0.887097 map_score: 0.870009 Time: 73.01
Run: 29 train loss: 9.349821 Time: 171.68
Run: 29 VAL ap_score: 0.907189 map_score: 0.892928 Time: 75.35
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 30 train loss: 9.119625 Time: 169.72
Run: 30 VAL ap_score: 0.898370 map_score: 0.892897 Time: 76.99
Run: 31 train loss: 8.975578 Time: 169.77
Run: 31 VAL ap_score: 0.897967 map_score: 0.880434 Time: 77.75
Run: 32 train loss: 9.141733 Time: 167.73
Run: 32 VAL ap_score: 0.894834 map_score: 0.877208 Time: 79.11
Run: 33 train loss: 8.664517 Time: 166.07
Run: 33 VAL ap_score: 0.904661 map_score: 0.897977 Time: 80.62
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 34 train loss: 8.301942 Time: 167.35
Run: 34 VAL ap_score: 0.903811 map_score: 0.890629 Time: 80.63
Run: 35 train loss: 8.090771 Time: 167.08
Run: 35 VAL ap_score: 0.890404 map_score: 0.880020 Time: 82.90
Run: 36 train loss: 8.473625 Time: 167.10
Run: 36 VAL ap_score: 0.893333 map_score: 0.877820 Time: 83.49
Run: 37 train loss: 8.207741 Time: 167.66
Run: 37 VAL ap_score: 0.915656 map_score: 0.899570 Time: 83.11
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 38 train loss: 8.101240 Time: 167.62
Run: 38 VAL ap_score: 0.902267 map_score: 0.893380 Time: 81.49
Run: 39 train loss: 8.041579 Time: 168.02
Run: 39 VAL ap_score: 0.913337 map_score: 0.891342 Time: 78.58
Run: 40 train loss: 7.831041 Time: 168.19
Run: 40 VAL ap_score: 0.916922 map_score: 0.902188 Time: 78.40
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 41 train loss: 7.714230 Time: 168.96
Run: 41 VAL ap_score: 0.923586 map_score: 0.911724 Time: 77.26
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 42 train loss: 7.687535 Time: 170.96
Run: 42 VAL ap_score: 0.903247 map_score: 0.890853 Time: 75.70
Run: 43 train loss: 7.453458 Time: 171.81
Run: 43 VAL ap_score: 0.911489 map_score: 0.893773 Time: 79.02
Run: 44 train loss: 7.479013 Time: 171.49
Run: 44 VAL ap_score: 0.917604 map_score: 0.909098 Time: 77.87
Run: 45 train loss: 7.468238 Time: 171.05
Run: 45 VAL ap_score: 0.907943 map_score: 0.885418 Time: 78.29
Run: 46 train loss: 7.451148 Time: 169.49
Run: 46 VAL ap_score: 0.925975 map_score: 0.915247 Time: 77.30
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 47 train loss: 7.480038 Time: 167.88
Run: 47 VAL ap_score: 0.928035 map_score: 0.920831 Time: 77.05
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 48 train loss: 6.888193 Time: 169.39
Run: 48 VAL ap_score: 0.922520 map_score: 0.915157 Time: 77.06
Run: 49 train loss: 6.919558 Time: 168.43
Run: 49 VAL ap_score: 0.920078 map_score: 0.908829 Time: 75.83
Run: 50 train loss: 6.813472 Time: 169.83
Run: 50 VAL ap_score: 0.924557 map_score: 0.912260 Time: 75.08
Run: 51 train loss: 7.047126 Time: 172.00
Run: 51 VAL ap_score: 0.921928 map_score: 0.910191 Time: 75.44
Run: 52 train loss: 7.375391 Time: 181.84
Run: 52 VAL ap_score: 0.926858 map_score: 0.918293 Time: 76.04
Run: 53 train loss: 6.759205 Time: 180.94
Run: 53 VAL ap_score: 0.917505 map_score: 0.904263 Time: 75.64
Run: 54 train loss: 6.364405 Time: 181.77
Run: 54 VAL ap_score: 0.924835 map_score: 0.919382 Time: 74.03
Run: 55 train loss: 7.360240 Time: 182.49
Run: 55 VAL ap_score: 0.917891 map_score: 0.902804 Time: 75.91
Run: 56 train loss: 6.766478 Time: 185.81
Run: 56 VAL ap_score: 0.932082 map_score: 0.923008 Time: 73.52
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 57 train loss: 6.524748 Time: 183.96
Run: 57 VAL ap_score: 0.920332 map_score: 0.921026 Time: 71.59
Run: 58 train loss: 6.315396 Time: 187.18
Run: 58 VAL ap_score: 0.929739 map_score: 0.917448 Time: 71.87
Run: 59 train loss: 6.291470 Time: 186.32
Run: 59 VAL ap_score: 0.924711 map_score: 0.924719 Time: 71.86
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 60 train loss: 6.403762 Time: 184.04
Run: 60 VAL ap_score: 0.916171 map_score: 0.910646 Time: 72.06
Run: 61 train loss: 6.345908 Time: 184.65
Run: 61 VAL ap_score: 0.921173 map_score: 0.916006 Time: 72.18
Run: 62 train loss: 5.908879 Time: 181.50
Run: 62 VAL ap_score: 0.940844 map_score: 0.927465 Time: 72.83
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 63 train loss: 6.219103 Time: 184.55
Run: 63 VAL ap_score: 0.929987 map_score: 0.923185 Time: 72.83
Run: 64 train loss: 5.626312 Time: 184.32
Run: 64 VAL ap_score: 0.935406 map_score: 0.925121 Time: 72.46
Run: 65 train loss: 5.718449 Time: 184.84
Run: 65 VAL ap_score: 0.925766 map_score: 0.927780 Time: 72.91
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 66 train loss: 5.852197 Time: 188.43
Run: 66 VAL ap_score: 0.928983 map_score: 0.920147 Time: 72.77
Run: 67 train loss: 5.897652 Time: 184.00
Run: 67 VAL ap_score: 0.936737 map_score: 0.928576 Time: 72.22
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 68 train loss: 5.435040 Time: 183.88
Run: 68 VAL ap_score: 0.934892 map_score: 0.926183 Time: 71.62
Run: 69 train loss: 5.686918 Time: 180.45
Run: 69 VAL ap_score: 0.935358 map_score: 0.932770 Time: 72.31
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 70 train loss: 5.506177 Time: 184.28
Run: 70 VAL ap_score: 0.918325 map_score: 0.919493 Time: 71.90
Run: 71 train loss: 5.376357 Time: 185.57
Run: 71 VAL ap_score: 0.884367 map_score: 0.891010 Time: 72.60
Run: 72 train loss: 5.537379 Time: 187.19
Run: 72 VAL ap_score: 0.938697 map_score: 0.934118 Time: 71.83
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 73 train loss: 4.932057 Time: 184.99
Run: 73 VAL ap_score: 0.945582 map_score: 0.937999 Time: 70.66
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 74 train loss: 5.397870 Time: 184.58
Run: 74 VAL ap_score: 0.906548 map_score: 0.917694 Time: 69.67
Run: 75 train loss: 5.097385 Time: 183.92
Run: 75 VAL ap_score: 0.947002 map_score: 0.937491 Time: 69.91
Run: 76 train loss: 4.968135 Time: 184.19
Run: 76 VAL ap_score: 0.946658 map_score: 0.936886 Time: 75.29
Run: 77 train loss: 4.746069 Time: 187.00
Run: 77 VAL ap_score: 0.950273 map_score: 0.944605 Time: 69.78
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4586_2023-12-23_01:42:11.154898
Run: 78 train loss: 5.198760 Time: 184.29
Run: 78 VAL ap_score: 0.940679 map_score: 0.930680 Time: 70.61
