Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.2
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.2
--DATASET_NAME=ptc_fr
--SEED=4
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4929
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.2}
loading train query graphs from ./Datasets/splits/train/train_ptc_fr80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_fr80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fr80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_fr80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_fr80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fr80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.2/initialModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
no. of params in model: 2498
Run: 0 train loss: 76.634560 Time: 145.12
Run: 0 VAL ap_score: 0.548586 map_score: 0.580243 Time: 81.68
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 1 train loss: 35.800852 Time: 177.02
Run: 1 VAL ap_score: 0.669027 map_score: 0.638658 Time: 86.77
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 2 train loss: 29.959337 Time: 178.10
Run: 2 VAL ap_score: 0.698976 map_score: 0.650651 Time: 78.76
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 3 train loss: 27.686461 Time: 176.03
Run: 3 VAL ap_score: 0.727454 map_score: 0.686411 Time: 79.20
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 4 train loss: 25.327275 Time: 174.72
Run: 4 VAL ap_score: 0.715944 map_score: 0.689597 Time: 85.83
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 5 train loss: 23.423766 Time: 186.68
Run: 5 VAL ap_score: 0.756446 map_score: 0.710172 Time: 78.28
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 6 train loss: 20.591182 Time: 176.92
Run: 6 VAL ap_score: 0.778201 map_score: 0.750104 Time: 80.03
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 7 train loss: 18.144863 Time: 179.92
Run: 7 VAL ap_score: 0.819691 map_score: 0.785317 Time: 78.16
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 8 train loss: 17.417127 Time: 176.70
Run: 8 VAL ap_score: 0.817272 map_score: 0.794727 Time: 78.85
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 9 train loss: 16.212382 Time: 177.08
Run: 9 VAL ap_score: 0.785199 map_score: 0.771973 Time: 79.17
Run: 10 train loss: 14.483693 Time: 176.74
Run: 10 VAL ap_score: 0.854106 map_score: 0.821941 Time: 79.67
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 11 train loss: 13.539651 Time: 177.22
Run: 11 VAL ap_score: 0.848822 map_score: 0.813469 Time: 79.59
Run: 12 train loss: 13.014549 Time: 179.45
Run: 12 VAL ap_score: 0.854223 map_score: 0.827278 Time: 78.32
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 13 train loss: 12.645452 Time: 175.26
Run: 13 VAL ap_score: 0.872069 map_score: 0.850143 Time: 77.29
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 14 train loss: 11.887658 Time: 167.03
Run: 14 VAL ap_score: 0.880450 map_score: 0.862388 Time: 80.43
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 15 train loss: 11.543127 Time: 167.93
Run: 15 VAL ap_score: 0.846835 map_score: 0.827907 Time: 80.41
Run: 16 train loss: 11.203114 Time: 177.26
Run: 16 VAL ap_score: 0.895754 map_score: 0.873863 Time: 80.62
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 17 train loss: 10.917140 Time: 173.00
Run: 17 VAL ap_score: 0.895376 map_score: 0.870278 Time: 80.36
Run: 18 train loss: 10.927089 Time: 175.92
Run: 18 VAL ap_score: 0.896108 map_score: 0.871808 Time: 78.64
Run: 19 train loss: 9.878717 Time: 174.21
Run: 19 VAL ap_score: 0.891503 map_score: 0.872362 Time: 80.30
Run: 20 train loss: 10.282350 Time: 176.46
Run: 20 VAL ap_score: 0.887763 map_score: 0.859169 Time: 79.77
Run: 21 train loss: 9.651230 Time: 177.10
Run: 21 VAL ap_score: 0.897233 map_score: 0.881644 Time: 78.92
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 22 train loss: 9.178037 Time: 177.38
Run: 22 VAL ap_score: 0.903554 map_score: 0.886365 Time: 77.68
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 23 train loss: 9.208248 Time: 178.43
Run: 23 VAL ap_score: 0.904497 map_score: 0.880421 Time: 78.35
Run: 24 train loss: 8.787437 Time: 176.19
Run: 24 VAL ap_score: 0.887913 map_score: 0.872345 Time: 76.95
Run: 25 train loss: 8.546257 Time: 182.35
Run: 25 VAL ap_score: 0.905804 map_score: 0.882357 Time: 77.75
Run: 26 train loss: 8.395994 Time: 180.99
Run: 26 VAL ap_score: 0.919926 map_score: 0.903039 Time: 78.84
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 27 train loss: 8.343650 Time: 177.81
Run: 27 VAL ap_score: 0.919473 map_score: 0.901257 Time: 77.88
Run: 28 train loss: 7.939807 Time: 179.11
Run: 28 VAL ap_score: 0.917812 map_score: 0.899426 Time: 76.63
Run: 29 train loss: 7.709250 Time: 178.36
Run: 29 VAL ap_score: 0.920904 map_score: 0.905965 Time: 77.44
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 30 train loss: 7.452585 Time: 179.34
Run: 30 VAL ap_score: 0.918021 map_score: 0.897409 Time: 77.86
Run: 31 train loss: 7.418141 Time: 182.01
Run: 31 VAL ap_score: 0.928523 map_score: 0.909527 Time: 76.15
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 32 train loss: 8.032375 Time: 179.42
Run: 32 VAL ap_score: 0.910027 map_score: 0.910013 Time: 75.11
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 33 train loss: 7.086826 Time: 179.72
Run: 33 VAL ap_score: 0.928028 map_score: 0.909977 Time: 75.77
Run: 34 train loss: 6.974341 Time: 181.16
Run: 34 VAL ap_score: 0.932095 map_score: 0.913607 Time: 73.90
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 35 train loss: 7.143429 Time: 183.79
Run: 35 VAL ap_score: 0.929286 map_score: 0.907130 Time: 73.83
Run: 36 train loss: 6.505082 Time: 182.94
Run: 36 VAL ap_score: 0.921099 map_score: 0.910413 Time: 75.02
Run: 37 train loss: 6.322115 Time: 185.29
Run: 37 VAL ap_score: 0.935645 map_score: 0.919912 Time: 75.73
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 38 train loss: 6.442561 Time: 182.56
Run: 38 VAL ap_score: 0.926962 map_score: 0.916084 Time: 74.25
Run: 39 train loss: 6.243376 Time: 186.23
Run: 39 VAL ap_score: 0.925896 map_score: 0.914914 Time: 75.83
Run: 40 train loss: 6.039103 Time: 180.72
Run: 40 VAL ap_score: 0.938410 map_score: 0.920547 Time: 76.20
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 41 train loss: 5.927364 Time: 180.10
Run: 41 VAL ap_score: 0.927535 map_score: 0.912388 Time: 75.68
Run: 42 train loss: 5.697265 Time: 181.75
Run: 42 VAL ap_score: 0.944067 map_score: 0.923782 Time: 80.18
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 43 train loss: 5.628807 Time: 180.25
Run: 43 VAL ap_score: 0.936964 map_score: 0.923430 Time: 78.41
Run: 44 train loss: 5.372322 Time: 178.98
Run: 44 VAL ap_score: 0.921930 map_score: 0.914450 Time: 79.45
Run: 45 train loss: 5.431876 Time: 178.50
Run: 45 VAL ap_score: 0.934358 map_score: 0.915868 Time: 77.99
Run: 46 train loss: 5.435291 Time: 180.68
Run: 46 VAL ap_score: 0.947043 map_score: 0.933167 Time: 79.91
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 47 train loss: 5.060843 Time: 176.87
Run: 47 VAL ap_score: 0.938212 map_score: 0.919920 Time: 80.75
Run: 48 train loss: 5.466639 Time: 177.07
Run: 48 VAL ap_score: 0.948422 map_score: 0.934194 Time: 79.62
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 49 train loss: 5.254540 Time: 177.30
Run: 49 VAL ap_score: 0.949978 map_score: 0.933751 Time: 80.43
Run: 50 train loss: 4.915830 Time: 177.63
Run: 50 VAL ap_score: 0.949459 map_score: 0.933614 Time: 77.31
Run: 51 train loss: 5.012675 Time: 177.43
Run: 51 VAL ap_score: 0.936771 map_score: 0.930237 Time: 77.43
Run: 52 train loss: 5.169316 Time: 177.27
Run: 52 VAL ap_score: 0.952597 map_score: 0.937442 Time: 77.49
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 53 train loss: 4.836799 Time: 187.48
Run: 53 VAL ap_score: 0.949375 map_score: 0.935358 Time: 81.70
Run: 54 train loss: 4.749127 Time: 179.00
Run: 54 VAL ap_score: 0.947210 map_score: 0.930469 Time: 78.37
Run: 55 train loss: 4.738171 Time: 177.56
Run: 55 VAL ap_score: 0.949002 map_score: 0.938100 Time: 80.50
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 56 train loss: 4.473286 Time: 179.27
Run: 56 VAL ap_score: 0.944772 map_score: 0.931375 Time: 83.07
Run: 57 train loss: 4.493851 Time: 177.26
Run: 57 VAL ap_score: 0.929878 map_score: 0.909968 Time: 80.94
Run: 58 train loss: 4.531699 Time: 168.06
Run: 58 VAL ap_score: 0.941340 map_score: 0.926976 Time: 81.02
Run: 59 train loss: 4.628963 Time: 164.25
Run: 59 VAL ap_score: 0.951437 map_score: 0.938235 Time: 82.15
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 60 train loss: 4.524974 Time: 163.22
Run: 60 VAL ap_score: 0.954346 map_score: 0.940303 Time: 81.24
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 61 train loss: 4.440263 Time: 165.09
Run: 61 VAL ap_score: 0.951458 map_score: 0.938096 Time: 81.92
Run: 62 train loss: 4.411353 Time: 168.10
Run: 62 VAL ap_score: 0.952900 map_score: 0.937407 Time: 79.74
Run: 63 train loss: 4.356793 Time: 168.19
Run: 63 VAL ap_score: 0.950408 map_score: 0.942110 Time: 78.23
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 64 train loss: 4.930506 Time: 169.81
Run: 64 VAL ap_score: 0.957238 map_score: 0.945200 Time: 76.29
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 65 train loss: 4.295933 Time: 180.78
Run: 65 VAL ap_score: 0.956386 map_score: 0.947807 Time: 80.53
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 66 train loss: 4.814838 Time: 180.52
Run: 66 VAL ap_score: 0.939781 map_score: 0.925383 Time: 75.36
Run: 67 train loss: 4.287128 Time: 179.64
Run: 67 VAL ap_score: 0.953206 map_score: 0.940070 Time: 76.48
Run: 68 train loss: 4.081472 Time: 181.24
Run: 68 VAL ap_score: 0.938888 map_score: 0.929542 Time: 78.56
Run: 69 train loss: 4.230388 Time: 180.48
Run: 69 VAL ap_score: 0.954087 map_score: 0.939794 Time: 78.90
Run: 70 train loss: 3.857469 Time: 178.51
Run: 70 VAL ap_score: 0.943394 map_score: 0.926298 Time: 78.50
Run: 71 train loss: 4.102019 Time: 175.39
Run: 71 VAL ap_score: 0.947811 map_score: 0.938142 Time: 77.55
Run: 72 train loss: 4.026078 Time: 177.25
Run: 72 VAL ap_score: 0.948637 map_score: 0.942007 Time: 76.13
Run: 73 train loss: 3.953772 Time: 181.00
Run: 73 VAL ap_score: 0.955717 map_score: 0.950887 Time: 76.65
saving best validated model to ./node_early_interaction_edge_deletion_0.2/bestValidationModels/node_early_interaction_edge_deletion_ptc_fr_4929_2023-12-23_01:42:51.218657
Run: 74 train loss: 3.947588 Time: 182.19
Run: 74 VAL ap_score: 0.960819 map_score: 0.947085 Time: 83.08
Run: 75 train loss: 4.243442 Time: 183.12
Run: 75 VAL ap_score: 0.938437 map_score: 0.932174 Time: 79.45
Run: 76 train loss: 4.292837 Time: 177.16
Run: 76 VAL ap_score: 0.952374 map_score: 0.947077 Time: 81.86
Run: 77 train loss: 4.005126 Time: 179.84
Run: 77 VAL ap_score: 0.952995 map_score: 0.941814 Time: 81.07
