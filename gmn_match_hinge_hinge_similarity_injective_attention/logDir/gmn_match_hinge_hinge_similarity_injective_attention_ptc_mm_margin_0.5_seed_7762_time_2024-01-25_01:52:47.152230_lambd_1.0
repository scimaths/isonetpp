Command line
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_hinge_similarity_injective_attention
--TASK=gmn_match_hinge_hinge_similarity_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge hinge_similarity
saving initial model to ./gmn_match_hinge_hinge_similarity_injective_attention/initialModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
no. of params in model: 2050
Run: 0 train loss: 257.585166 Time: 402.08
Run: 0 VAL ap_score: 0.485261 map_score: 0.513709 Time: 113.31
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 1 train loss: 186.270747 Time: 401.54
Run: 1 VAL ap_score: 0.522986 map_score: 0.556373 Time: 112.71
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 2 train loss: 170.212554 Time: 395.96
Run: 2 VAL ap_score: 0.551168 map_score: 0.559731 Time: 111.07
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 3 train loss: 160.307855 Time: 398.82
Run: 3 VAL ap_score: 0.554556 map_score: 0.571427 Time: 114.01
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 4 train loss: 155.365118 Time: 397.30
Run: 4 VAL ap_score: 0.514757 map_score: 0.546545 Time: 113.02
Run: 5 train loss: 146.425142 Time: 396.76
Run: 5 VAL ap_score: 0.579881 map_score: 0.598181 Time: 112.14
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 6 train loss: 141.672884 Time: 395.62
Run: 6 VAL ap_score: 0.559415 map_score: 0.581353 Time: 112.28
Run: 7 train loss: 134.762049 Time: 391.29
Run: 7 VAL ap_score: 0.602379 map_score: 0.609208 Time: 112.04
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 8 train loss: 133.152145 Time: 396.28
Run: 8 VAL ap_score: 0.608260 map_score: 0.611078 Time: 114.80
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 9 train loss: 127.567070 Time: 386.82
Run: 9 VAL ap_score: 0.609756 map_score: 0.611128 Time: 112.57
Run: 10 train loss: 125.456796 Time: 398.28
Run: 10 VAL ap_score: 0.552911 map_score: 0.581706 Time: 112.39
Run: 11 train loss: 122.758151 Time: 395.13
Run: 11 VAL ap_score: 0.599260 map_score: 0.606969 Time: 113.05
Run: 12 train loss: 120.639229 Time: 395.70
Run: 12 VAL ap_score: 0.600849 map_score: 0.607671 Time: 113.34
Run: 13 train loss: 116.900420 Time: 396.87
Run: 13 VAL ap_score: 0.617337 map_score: 0.619200 Time: 113.25
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 14 train loss: 113.323945 Time: 398.47
Run: 14 VAL ap_score: 0.593502 map_score: 0.596446 Time: 111.81
Run: 15 train loss: 112.589797 Time: 394.97
Run: 15 VAL ap_score: 0.626159 map_score: 0.620535 Time: 112.57
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 16 train loss: 110.163717 Time: 394.01
Run: 16 VAL ap_score: 0.634676 map_score: 0.625433 Time: 110.11
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 17 train loss: 110.219910 Time: 397.96
Run: 17 VAL ap_score: 0.639474 map_score: 0.638432 Time: 116.99
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 18 train loss: 107.708057 Time: 399.45
Run: 18 VAL ap_score: 0.629083 map_score: 0.634550 Time: 115.85
Run: 19 train loss: 107.145895 Time: 413.38
Run: 19 VAL ap_score: 0.604192 map_score: 0.618540 Time: 119.44
Run: 20 train loss: 105.333272 Time: 425.38
Run: 20 VAL ap_score: 0.622129 map_score: 0.620176 Time: 120.50
Run: 21 train loss: 104.283263 Time: 430.73
Run: 21 VAL ap_score: 0.619250 map_score: 0.624611 Time: 120.40
Run: 22 train loss: 103.742166 Time: 434.62
Run: 22 VAL ap_score: 0.621567 map_score: 0.619166 Time: 126.81
Run: 23 train loss: 101.905075 Time: 435.58
Run: 23 VAL ap_score: 0.628112 map_score: 0.625499 Time: 123.48
Run: 24 train loss: 101.788165 Time: 436.00
Run: 24 VAL ap_score: 0.627413 map_score: 0.622126 Time: 124.83
Run: 25 train loss: 100.345471 Time: 434.25
Run: 25 VAL ap_score: 0.625466 map_score: 0.631211 Time: 122.59
Run: 26 train loss: 99.294381 Time: 435.88
Run: 26 VAL ap_score: 0.635652 map_score: 0.634882 Time: 124.84
Run: 27 train loss: 98.292910 Time: 434.94
Run: 27 VAL ap_score: 0.638866 map_score: 0.633349 Time: 126.10
Run: 28 train loss: 96.424238 Time: 435.38
Run: 28 VAL ap_score: 0.647781 map_score: 0.639855 Time: 124.65
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 29 train loss: 96.968564 Time: 433.33
Run: 29 VAL ap_score: 0.656962 map_score: 0.655128 Time: 121.48
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 30 train loss: 95.624628 Time: 432.01
Run: 30 VAL ap_score: 0.615750 map_score: 0.608007 Time: 126.17
Run: 31 train loss: 95.479016 Time: 438.28
Run: 31 VAL ap_score: 0.640553 map_score: 0.639120 Time: 125.89
Run: 32 train loss: 93.763620 Time: 436.21
Run: 32 VAL ap_score: 0.650308 map_score: 0.645780 Time: 127.15
Run: 33 train loss: 93.664425 Time: 436.90
Run: 33 VAL ap_score: 0.644023 map_score: 0.646488 Time: 125.41
Run: 34 train loss: 93.248990 Time: 435.81
Run: 34 VAL ap_score: 0.615847 map_score: 0.622047 Time: 125.45
Run: 35 train loss: 91.320732 Time: 438.23
Run: 35 VAL ap_score: 0.642462 map_score: 0.646170 Time: 125.12
Run: 36 train loss: 91.202161 Time: 434.99
Run: 36 VAL ap_score: 0.653751 map_score: 0.646077 Time: 124.22
Run: 37 train loss: 90.968282 Time: 439.76
Run: 37 VAL ap_score: 0.652589 map_score: 0.645024 Time: 126.39
Run: 38 train loss: 90.920934 Time: 430.92
Run: 38 VAL ap_score: 0.649419 map_score: 0.644713 Time: 124.62
Run: 39 train loss: 90.689437 Time: 434.68
Run: 39 VAL ap_score: 0.643105 map_score: 0.641722 Time: 125.57
Run: 40 train loss: 89.996898 Time: 435.72
Run: 40 VAL ap_score: 0.663191 map_score: 0.652973 Time: 124.90
Run: 41 train loss: 89.179784 Time: 440.24
Run: 41 VAL ap_score: 0.661970 map_score: 0.659739 Time: 124.07
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 42 train loss: 89.407894 Time: 434.59
Run: 42 VAL ap_score: 0.649455 map_score: 0.646472 Time: 128.63
Run: 43 train loss: 87.491405 Time: 437.38
Run: 43 VAL ap_score: 0.662213 map_score: 0.658005 Time: 126.57
Run: 44 train loss: 88.234755 Time: 434.94
Run: 44 VAL ap_score: 0.649466 map_score: 0.657100 Time: 125.48
Run: 45 train loss: 88.208070 Time: 438.27
Run: 45 VAL ap_score: 0.660794 map_score: 0.663584 Time: 126.86
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 46 train loss: 87.291615 Time: 437.57
Run: 46 VAL ap_score: 0.648768 map_score: 0.643649 Time: 124.50
Run: 47 train loss: 86.420150 Time: 432.63
Run: 47 VAL ap_score: 0.665907 map_score: 0.660045 Time: 126.75
Run: 48 train loss: 86.360731 Time: 434.83
Run: 48 VAL ap_score: 0.664409 map_score: 0.659839 Time: 125.18
Run: 49 train loss: 85.808689 Time: 433.14
Run: 49 VAL ap_score: 0.669090 map_score: 0.661224 Time: 126.29
Run: 50 train loss: 85.998778 Time: 435.27
Run: 50 VAL ap_score: 0.651602 map_score: 0.651764 Time: 124.79
Run: 51 train loss: 85.930147 Time: 434.19
Run: 51 VAL ap_score: 0.648852 map_score: 0.650352 Time: 125.44
Run: 52 train loss: 86.202654 Time: 433.87
Run: 52 VAL ap_score: 0.669688 map_score: 0.673361 Time: 124.89
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 53 train loss: 85.698069 Time: 434.11
Run: 53 VAL ap_score: 0.637962 map_score: 0.645873 Time: 125.01
Run: 54 train loss: 84.059129 Time: 435.07
Run: 54 VAL ap_score: 0.653920 map_score: 0.662589 Time: 124.39
Run: 55 train loss: 84.644128 Time: 431.23
Run: 55 VAL ap_score: 0.667686 map_score: 0.671604 Time: 125.43
Run: 56 train loss: 83.665593 Time: 433.21
Run: 56 VAL ap_score: 0.675442 map_score: 0.677425 Time: 124.10
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 57 train loss: 82.575723 Time: 433.36
Run: 57 VAL ap_score: 0.679224 map_score: 0.675625 Time: 125.16
Run: 58 train loss: 83.095126 Time: 431.84
Run: 58 VAL ap_score: 0.667627 map_score: 0.669511 Time: 124.96
Run: 59 train loss: 81.850528 Time: 426.88
Run: 59 VAL ap_score: 0.669893 map_score: 0.671149 Time: 123.84
Run: 60 train loss: 81.706718 Time: 433.72
Run: 60 VAL ap_score: 0.681435 map_score: 0.680045 Time: 126.48
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 61 train loss: 82.045255 Time: 433.38
Run: 61 VAL ap_score: 0.665096 map_score: 0.669607 Time: 126.29
Run: 62 train loss: 81.050586 Time: 434.60
Run: 62 VAL ap_score: 0.683154 map_score: 0.680789 Time: 125.11
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 63 train loss: 81.505043 Time: 433.29
Run: 63 VAL ap_score: 0.671755 map_score: 0.679966 Time: 125.31
Run: 64 train loss: 80.755444 Time: 433.22
Run: 64 VAL ap_score: 0.683497 map_score: 0.684509 Time: 125.05
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 65 train loss: 80.863619 Time: 432.39
Run: 65 VAL ap_score: 0.661278 map_score: 0.673615 Time: 124.08
Run: 66 train loss: 80.424547 Time: 437.10
Run: 66 VAL ap_score: 0.677027 map_score: 0.680132 Time: 124.52
Run: 67 train loss: 79.815097 Time: 434.75
Run: 67 VAL ap_score: 0.667504 map_score: 0.667182 Time: 124.85
Run: 68 train loss: 80.062935 Time: 433.50
Run: 68 VAL ap_score: 0.685397 map_score: 0.682131 Time: 127.42
Run: 69 train loss: 79.277797 Time: 433.97
Run: 69 VAL ap_score: 0.680789 map_score: 0.678514 Time: 124.65
Run: 70 train loss: 78.742355 Time: 441.92
Run: 70 VAL ap_score: 0.670349 map_score: 0.679297 Time: 123.09
Run: 71 train loss: 78.882328 Time: 435.39
Run: 71 VAL ap_score: 0.692728 map_score: 0.686578 Time: 127.77
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 72 train loss: 78.043805 Time: 435.90
Run: 72 VAL ap_score: 0.693455 map_score: 0.686355 Time: 126.82
Run: 73 train loss: 79.259713 Time: 435.50
Run: 73 VAL ap_score: 0.680915 map_score: 0.677769 Time: 124.57
Run: 74 train loss: 77.982792 Time: 433.04
Run: 74 VAL ap_score: 0.670889 map_score: 0.676197 Time: 124.69
Run: 75 train loss: 78.220375 Time: 433.99
Run: 75 VAL ap_score: 0.682794 map_score: 0.677320 Time: 123.67
Run: 76 train loss: 78.538894 Time: 432.30
Run: 76 VAL ap_score: 0.676533 map_score: 0.684723 Time: 125.95
Run: 77 train loss: 77.431207 Time: 431.41
Run: 77 VAL ap_score: 0.669880 map_score: 0.681115 Time: 124.23
Run: 78 train loss: 76.775630 Time: 432.82
Run: 78 VAL ap_score: 0.694508 map_score: 0.688948 Time: 126.98
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 79 train loss: 76.961632 Time: 434.68
Run: 79 VAL ap_score: 0.673340 map_score: 0.683796 Time: 126.34
Run: 80 train loss: 77.427597 Time: 436.12
Run: 80 VAL ap_score: 0.686083 map_score: 0.692074 Time: 124.90
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 81 train loss: 77.136061 Time: 434.96
Run: 81 VAL ap_score: 0.678303 map_score: 0.679782 Time: 126.02
Run: 82 train loss: 76.894929 Time: 434.03
Run: 82 VAL ap_score: 0.690533 map_score: 0.690040 Time: 124.86
Run: 83 train loss: 76.528915 Time: 431.38
Run: 83 VAL ap_score: 0.680188 map_score: 0.686751 Time: 124.30
Run: 84 train loss: 76.892721 Time: 432.67
Run: 84 VAL ap_score: 0.672975 map_score: 0.667486 Time: 123.97
Run: 85 train loss: 75.878426 Time: 435.05
Run: 85 VAL ap_score: 0.684659 map_score: 0.681950 Time: 128.58
Run: 86 train loss: 76.032481 Time: 433.52
Run: 86 VAL ap_score: 0.690036 map_score: 0.698245 Time: 124.80
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mm_7762_2024-01-25_01:52:47.152230
Run: 87 train loss: 75.810485 Time: 434.96
Run: 87 VAL ap_score: 0.695513 map_score: 0.693364 Time: 124.95
Run: 88 train loss: 75.350055 Time: 434.15
Run: 88 VAL ap_score: 0.691952 map_score: 0.691916 Time: 124.46
Run: 89 train loss: 75.812481 Time: 434.36
Run: 89 VAL ap_score: 0.684699 map_score: 0.687726 Time: 126.47
Run: 90 train loss: 75.713631 Time: 435.13
