Command line
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_hinge_similarity_injective_attention
--TASK=gmn_match_hinge_hinge_similarity_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge hinge_similarity
saving initial model to ./gmn_match_hinge_hinge_similarity_injective_attention/initialModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
no. of params in model: 2050
Run: 0 train loss: 259.047725 Time: 403.95
Run: 0 VAL ap_score: 0.419404 map_score: 0.448393 Time: 114.96
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 1 train loss: 186.465852 Time: 398.55
Run: 1 VAL ap_score: 0.479166 map_score: 0.493009 Time: 115.20
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 2 train loss: 166.007104 Time: 389.63
Run: 2 VAL ap_score: 0.490511 map_score: 0.484752 Time: 115.01
Run: 3 train loss: 156.048013 Time: 397.40
Run: 3 VAL ap_score: 0.512744 map_score: 0.499465 Time: 114.70
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 4 train loss: 149.857296 Time: 403.30
Run: 4 VAL ap_score: 0.513700 map_score: 0.509507 Time: 117.56
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 5 train loss: 142.582641 Time: 399.64
Run: 5 VAL ap_score: 0.532374 map_score: 0.527232 Time: 115.20
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 6 train loss: 136.719225 Time: 405.05
Run: 6 VAL ap_score: 0.553437 map_score: 0.543583 Time: 114.56
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 7 train loss: 134.287747 Time: 400.67
Run: 7 VAL ap_score: 0.555053 map_score: 0.550685 Time: 114.53
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 8 train loss: 131.260306 Time: 398.91
Run: 8 VAL ap_score: 0.569974 map_score: 0.559730 Time: 114.85
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 9 train loss: 127.587091 Time: 394.46
Run: 9 VAL ap_score: 0.554671 map_score: 0.553022 Time: 113.90
Run: 10 train loss: 124.947534 Time: 398.71
Run: 10 VAL ap_score: 0.579886 map_score: 0.566840 Time: 114.61
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 11 train loss: 122.422526 Time: 399.43
Run: 11 VAL ap_score: 0.564495 map_score: 0.563963 Time: 114.25
Run: 12 train loss: 118.368965 Time: 392.60
Run: 12 VAL ap_score: 0.585299 map_score: 0.574510 Time: 115.41
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 13 train loss: 118.052025 Time: 398.64
Run: 13 VAL ap_score: 0.601342 map_score: 0.581203 Time: 113.03
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 14 train loss: 114.629607 Time: 397.21
Run: 14 VAL ap_score: 0.596689 map_score: 0.572639 Time: 112.96
Run: 15 train loss: 113.716375 Time: 393.03
Run: 15 VAL ap_score: 0.602820 map_score: 0.576573 Time: 127.74
Run: 16 train loss: 110.779069 Time: 392.09
Run: 16 VAL ap_score: 0.590739 map_score: 0.560202 Time: 115.67
Run: 17 train loss: 110.153747 Time: 402.51
Run: 17 VAL ap_score: 0.587605 map_score: 0.579060 Time: 118.34
Run: 18 train loss: 107.743758 Time: 410.41
Run: 18 VAL ap_score: 0.602013 map_score: 0.573627 Time: 127.16
Run: 19 train loss: 106.026773 Time: 425.52
Run: 19 VAL ap_score: 0.598088 map_score: 0.574007 Time: 134.14
Run: 20 train loss: 105.243997 Time: 436.00
Run: 20 VAL ap_score: 0.622492 map_score: 0.584944 Time: 129.36
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 21 train loss: 103.295094 Time: 436.18
Run: 21 VAL ap_score: 0.596429 map_score: 0.576968 Time: 135.42
Run: 22 train loss: 101.758650 Time: 444.42
Run: 22 VAL ap_score: 0.626923 map_score: 0.589772 Time: 131.77
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 23 train loss: 100.770703 Time: 442.15
Run: 23 VAL ap_score: 0.613398 map_score: 0.583488 Time: 130.92
Run: 24 train loss: 98.373491 Time: 442.05
Run: 24 VAL ap_score: 0.595566 map_score: 0.572183 Time: 129.92
Run: 25 train loss: 98.367099 Time: 438.97
Run: 25 VAL ap_score: 0.609845 map_score: 0.583465 Time: 128.13
Run: 26 train loss: 97.052629 Time: 436.28
Run: 26 VAL ap_score: 0.626262 map_score: 0.587459 Time: 142.88
Run: 27 train loss: 96.340748 Time: 443.06
Run: 27 VAL ap_score: 0.593806 map_score: 0.573848 Time: 130.25
Run: 28 train loss: 95.594609 Time: 442.47
Run: 28 VAL ap_score: 0.606835 map_score: 0.578438 Time: 129.51
Run: 29 train loss: 94.344925 Time: 437.46
Run: 29 VAL ap_score: 0.621075 map_score: 0.587174 Time: 135.52
Run: 30 train loss: 92.856703 Time: 439.57
Run: 30 VAL ap_score: 0.615121 map_score: 0.596569 Time: 131.27
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 31 train loss: 93.559609 Time: 442.65
Run: 31 VAL ap_score: 0.615748 map_score: 0.583548 Time: 129.44
Run: 32 train loss: 92.660282 Time: 445.48
Run: 32 VAL ap_score: 0.585538 map_score: 0.565219 Time: 128.96
Run: 33 train loss: 91.192342 Time: 439.87
Run: 33 VAL ap_score: 0.598690 map_score: 0.580543 Time: 130.17
Run: 34 train loss: 90.836692 Time: 437.00
Run: 34 VAL ap_score: 0.597559 map_score: 0.585960 Time: 131.15
Run: 35 train loss: 89.611474 Time: 440.68
Run: 35 VAL ap_score: 0.609110 map_score: 0.583229 Time: 128.86
Run: 36 train loss: 90.347506 Time: 436.21
Run: 36 VAL ap_score: 0.626678 map_score: 0.596880 Time: 128.77
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 37 train loss: 88.626070 Time: 439.66
Run: 37 VAL ap_score: 0.637390 map_score: 0.595714 Time: 131.67
Run: 38 train loss: 87.471418 Time: 444.90
Run: 38 VAL ap_score: 0.598815 map_score: 0.577197 Time: 134.44
Run: 39 train loss: 87.590926 Time: 441.39
Run: 39 VAL ap_score: 0.633829 map_score: 0.596249 Time: 130.59
Run: 40 train loss: 87.853506 Time: 441.19
Run: 40 VAL ap_score: 0.636916 map_score: 0.599364 Time: 132.05
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 41 train loss: 87.102646 Time: 437.88
Run: 41 VAL ap_score: 0.631622 map_score: 0.602091 Time: 130.68
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 42 train loss: 85.977195 Time: 438.34
Run: 42 VAL ap_score: 0.640018 map_score: 0.607244 Time: 130.76
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 43 train loss: 86.324761 Time: 441.55
Run: 43 VAL ap_score: 0.631350 map_score: 0.599553 Time: 127.32
Run: 44 train loss: 85.018707 Time: 445.98
Run: 44 VAL ap_score: 0.633231 map_score: 0.593616 Time: 131.98
Run: 45 train loss: 85.943901 Time: 443.02
Run: 45 VAL ap_score: 0.632507 map_score: 0.603706 Time: 129.35
Run: 46 train loss: 84.741812 Time: 439.44
Run: 46 VAL ap_score: 0.641083 map_score: 0.602182 Time: 128.78
Run: 47 train loss: 83.979823 Time: 439.61
Run: 47 VAL ap_score: 0.630343 map_score: 0.609732 Time: 133.37
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 48 train loss: 83.843658 Time: 447.99
Run: 48 VAL ap_score: 0.639273 map_score: 0.609624 Time: 131.45
Run: 49 train loss: 83.418827 Time: 446.62
Run: 49 VAL ap_score: 0.632897 map_score: 0.608448 Time: 133.11
Run: 50 train loss: 83.066704 Time: 443.40
Run: 50 VAL ap_score: 0.624818 map_score: 0.596722 Time: 130.14
Run: 51 train loss: 83.570855 Time: 450.20
Run: 51 VAL ap_score: 0.605826 map_score: 0.605530 Time: 134.97
Run: 52 train loss: 82.846605 Time: 446.56
Run: 52 VAL ap_score: 0.613348 map_score: 0.583515 Time: 133.99
Run: 53 train loss: 81.760044 Time: 445.91
Run: 53 VAL ap_score: 0.617577 map_score: 0.602807 Time: 131.39
Run: 54 train loss: 81.453014 Time: 444.10
Run: 54 VAL ap_score: 0.625949 map_score: 0.601407 Time: 132.05
Run: 55 train loss: 81.440029 Time: 443.62
Run: 55 VAL ap_score: 0.616812 map_score: 0.603094 Time: 129.43
Run: 56 train loss: 80.852877 Time: 449.35
Run: 56 VAL ap_score: 0.628882 map_score: 0.606884 Time: 130.72
Run: 57 train loss: 80.955035 Time: 446.93
Run: 57 VAL ap_score: 0.632322 map_score: 0.597684 Time: 129.97
Run: 58 train loss: 80.929888 Time: 444.39
Run: 58 VAL ap_score: 0.634135 map_score: 0.603734 Time: 130.90
Run: 59 train loss: 80.515127 Time: 448.69
Run: 59 VAL ap_score: 0.630179 map_score: 0.616595 Time: 132.69
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 60 train loss: 80.551342 Time: 443.99
Run: 60 VAL ap_score: 0.643724 map_score: 0.604801 Time: 134.75
Run: 61 train loss: 79.590898 Time: 443.59
Run: 61 VAL ap_score: 0.634466 map_score: 0.596597 Time: 131.78
Run: 62 train loss: 79.401500 Time: 448.67
Run: 62 VAL ap_score: 0.644240 map_score: 0.605609 Time: 137.64
Run: 63 train loss: 79.664362 Time: 448.18
Run: 63 VAL ap_score: 0.637355 map_score: 0.615125 Time: 134.51
Run: 64 train loss: 80.093571 Time: 452.32
Run: 64 VAL ap_score: 0.638818 map_score: 0.608916 Time: 132.68
Run: 65 train loss: 79.370886 Time: 450.85
Run: 65 VAL ap_score: 0.640352 map_score: 0.612606 Time: 132.57
Run: 66 train loss: 79.115857 Time: 445.96
Run: 66 VAL ap_score: 0.642764 map_score: 0.618142 Time: 132.31
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 67 train loss: 78.264173 Time: 448.34
Run: 67 VAL ap_score: 0.641513 map_score: 0.617920 Time: 131.76
Run: 68 train loss: 79.172830 Time: 454.23
Run: 68 VAL ap_score: 0.624119 map_score: 0.597805 Time: 136.05
Run: 69 train loss: 78.275080 Time: 450.44
Run: 69 VAL ap_score: 0.635590 map_score: 0.617678 Time: 132.00
Run: 70 train loss: 78.183171 Time: 445.60
Run: 70 VAL ap_score: 0.627514 map_score: 0.613974 Time: 138.37
Run: 71 train loss: 78.084977 Time: 444.36
Run: 71 VAL ap_score: 0.644698 map_score: 0.613528 Time: 133.33
Run: 72 train loss: 77.982424 Time: 444.30
Run: 72 VAL ap_score: 0.631873 map_score: 0.606973 Time: 131.23
Run: 73 train loss: 77.596893 Time: 450.79
Run: 73 VAL ap_score: 0.638805 map_score: 0.611878 Time: 131.04
Run: 74 train loss: 78.239453 Time: 447.18
Run: 74 VAL ap_score: 0.633697 map_score: 0.605927 Time: 130.89
Run: 75 train loss: 77.245569 Time: 449.26
Run: 75 VAL ap_score: 0.643972 map_score: 0.609193 Time: 127.67
Run: 76 train loss: 77.544345 Time: 444.28
Run: 76 VAL ap_score: 0.645548 map_score: 0.610621 Time: 130.76
Run: 77 train loss: 77.352077 Time: 446.68
Run: 77 VAL ap_score: 0.651132 map_score: 0.623263 Time: 131.38
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 78 train loss: 78.056260 Time: 443.08
Run: 78 VAL ap_score: 0.655701 map_score: 0.612330 Time: 129.88
Run: 79 train loss: 77.414043 Time: 447.18
Run: 79 VAL ap_score: 0.646587 map_score: 0.615199 Time: 132.09
Run: 80 train loss: 76.624256 Time: 450.68
Run: 80 VAL ap_score: 0.660581 map_score: 0.624361 Time: 131.29
saving best validated model to ./gmn_match_hinge_hinge_similarity_injective_attention/bestValidationModels/gmn_match_hinge_hinge_similarity_injective_attention_ptc_mr_7366_2024-01-25_01:52:37.551578
Run: 81 train loss: 77.912336 Time: 443.01
Run: 81 VAL ap_score: 0.632219 map_score: 0.604140 Time: 130.36
Run: 82 train loss: 76.975479 Time: 448.26
Run: 82 VAL ap_score: 0.645581 map_score: 0.611376 Time: 130.95
Run: 83 train loss: 77.140538 Time: 453.73
Run: 83 VAL ap_score: 0.643513 map_score: 0.609339 Time: 138.49
Run: 84 train loss: 77.220541 Time: 447.64
Run: 84 VAL ap_score: 0.653470 map_score: 0.614994 Time: 133.70
Run: 85 train loss: 76.556933 Time: 446.79
Run: 85 VAL ap_score: 0.656343 map_score: 0.619709 Time: 132.28
Run: 86 train loss: 76.814438 Time: 446.39
Run: 86 VAL ap_score: 0.644588 map_score: 0.608943 Time: 131.96
Run: 87 train loss: 75.882996 Time: 444.41
Run: 87 VAL ap_score: 0.615062 map_score: 0.609068 Time: 131.72
