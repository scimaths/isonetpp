Command line
/raid/infolab/vaibhav/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_injective_attention_temp_0.1
--TASK=gmn_match_hinge_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
--temp_gmn_scoring=0.1
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge Injective Attention
saving initial model to ./gmn_match_hinge_injective_attention_temp_0.1/initialModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
no. of params in model: 2050
Run: 0 train loss: 224.385492 Time: 629.73
Run: 0 VAL ap_score: 0.416134 map_score: 0.445470 Time: 234.42
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 1 train loss: 182.579067 Time: 634.25
Run: 1 VAL ap_score: 0.460384 map_score: 0.484644 Time: 232.44
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 2 train loss: 163.672058 Time: 632.75
Run: 2 VAL ap_score: 0.446272 map_score: 0.443825 Time: 232.50
Run: 3 train loss: 152.392918 Time: 632.08
Run: 3 VAL ap_score: 0.504368 map_score: 0.496113 Time: 230.61
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 4 train loss: 142.479136 Time: 631.81
Run: 4 VAL ap_score: 0.470179 map_score: 0.469375 Time: 228.27
Run: 5 train loss: 135.490279 Time: 635.36
Run: 5 VAL ap_score: 0.512897 map_score: 0.511732 Time: 228.80
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 6 train loss: 131.823096 Time: 631.84
Run: 6 VAL ap_score: 0.537878 map_score: 0.518701 Time: 228.91
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 7 train loss: 128.248202 Time: 631.71
Run: 7 VAL ap_score: 0.537063 map_score: 0.516679 Time: 227.93
Run: 8 train loss: 124.470695 Time: 633.21
Run: 8 VAL ap_score: 0.523026 map_score: 0.507218 Time: 230.09
Run: 9 train loss: 120.751199 Time: 632.52
Run: 9 VAL ap_score: 0.559802 map_score: 0.536620 Time: 230.51
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 10 train loss: 118.981360 Time: 632.78
Run: 10 VAL ap_score: 0.572644 map_score: 0.540510 Time: 233.31
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 11 train loss: 116.408429 Time: 625.15
Run: 11 VAL ap_score: 0.545184 map_score: 0.530141 Time: 233.43
Run: 12 train loss: 113.982927 Time: 621.42
Run: 12 VAL ap_score: 0.557795 map_score: 0.530541 Time: 236.80
Run: 13 train loss: 112.882995 Time: 620.74
Run: 13 VAL ap_score: 0.525088 map_score: 0.523006 Time: 237.55
Run: 14 train loss: 110.624867 Time: 616.71
Run: 14 VAL ap_score: 0.575844 map_score: 0.546990 Time: 241.56
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 15 train loss: 109.127744 Time: 618.02
Run: 15 VAL ap_score: 0.576378 map_score: 0.550471 Time: 246.46
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 16 train loss: 108.044463 Time: 607.86
Run: 16 VAL ap_score: 0.574889 map_score: 0.552457 Time: 247.27
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 17 train loss: 106.802532 Time: 605.51
Run: 17 VAL ap_score: 0.579347 map_score: 0.557921 Time: 245.93
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 18 train loss: 105.872408 Time: 606.29
Run: 18 VAL ap_score: 0.527843 map_score: 0.534464 Time: 247.32
Run: 19 train loss: 105.693644 Time: 610.80
Run: 19 VAL ap_score: 0.557461 map_score: 0.528066 Time: 246.02
Run: 20 train loss: 103.996721 Time: 611.29
Run: 20 VAL ap_score: 0.585594 map_score: 0.552232 Time: 248.44
Run: 21 train loss: 101.851958 Time: 606.31
Run: 21 VAL ap_score: 0.567217 map_score: 0.532087 Time: 248.12
Run: 22 train loss: 102.532016 Time: 610.15
Run: 22 VAL ap_score: 0.586766 map_score: 0.567626 Time: 242.87
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 23 train loss: 99.893933 Time: 615.41
Run: 23 VAL ap_score: 0.592569 map_score: 0.551007 Time: 242.38
Run: 24 train loss: 99.722016 Time: 611.64
Run: 24 VAL ap_score: 0.583064 map_score: 0.551085 Time: 242.45
Run: 25 train loss: 99.360095 Time: 620.62
Run: 25 VAL ap_score: 0.576676 map_score: 0.547063 Time: 239.99
Run: 26 train loss: 98.787353 Time: 620.34
Run: 26 VAL ap_score: 0.569259 map_score: 0.549091 Time: 238.75
Run: 27 train loss: 98.127318 Time: 620.21
Run: 27 VAL ap_score: 0.586622 map_score: 0.565907 Time: 232.68
Run: 28 train loss: 96.563287 Time: 625.45
Run: 28 VAL ap_score: 0.601598 map_score: 0.571323 Time: 232.82
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 29 train loss: 97.003963 Time: 624.65
Run: 29 VAL ap_score: 0.579630 map_score: 0.556160 Time: 224.19
Run: 30 train loss: 95.206730 Time: 733.08
Run: 30 VAL ap_score: 0.568543 map_score: 0.550010 Time: 219.96
Run: 31 train loss: 95.431176 Time: 631.62
Run: 31 VAL ap_score: 0.598802 map_score: 0.562815 Time: 230.04
Run: 32 train loss: 94.765459 Time: 656.11
Run: 32 VAL ap_score: 0.594734 map_score: 0.546910 Time: 227.88
Run: 33 train loss: 93.677393 Time: 632.07
Run: 33 VAL ap_score: 0.609533 map_score: 0.566091 Time: 225.19
Run: 34 train loss: 92.844534 Time: 623.07
Run: 34 VAL ap_score: 0.585289 map_score: 0.546663 Time: 225.77
Run: 35 train loss: 93.071952 Time: 623.82
Run: 35 VAL ap_score: 0.562219 map_score: 0.550894 Time: 217.19
Run: 36 train loss: 92.827666 Time: 617.98
Run: 36 VAL ap_score: 0.595046 map_score: 0.566079 Time: 229.97
Run: 37 train loss: 91.695351 Time: 621.29
Run: 37 VAL ap_score: 0.613972 map_score: 0.574538 Time: 232.09
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 38 train loss: 91.835097 Time: 618.82
Run: 38 VAL ap_score: 0.593388 map_score: 0.565795 Time: 225.92
Run: 39 train loss: 90.322417 Time: 692.93
Run: 39 VAL ap_score: 0.602022 map_score: 0.560975 Time: 256.47
Run: 40 train loss: 90.381984 Time: 638.26
Run: 40 VAL ap_score: 0.612004 map_score: 0.568176 Time: 227.27
Run: 41 train loss: 89.975600 Time: 615.65
Run: 41 VAL ap_score: 0.611574 map_score: 0.569687 Time: 274.47
Run: 42 train loss: 88.860732 Time: 785.17
Run: 42 VAL ap_score: 0.604879 map_score: 0.577455 Time: 287.99
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 43 train loss: 89.462462 Time: 708.89
Run: 43 VAL ap_score: 0.607442 map_score: 0.578618 Time: 278.52
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 44 train loss: 88.665288 Time: 756.02
Run: 44 VAL ap_score: 0.610876 map_score: 0.574530 Time: 279.75
Run: 45 train loss: 88.424321 Time: 749.52
Run: 45 VAL ap_score: 0.614073 map_score: 0.571003 Time: 282.70
Run: 46 train loss: 87.903303 Time: 751.99
Run: 46 VAL ap_score: 0.619323 map_score: 0.579087 Time: 279.25
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 47 train loss: 88.392237 Time: 743.17
Run: 47 VAL ap_score: 0.595871 map_score: 0.566438 Time: 275.96
Run: 48 train loss: 87.134888 Time: 743.15
Run: 48 VAL ap_score: 0.624316 map_score: 0.592289 Time: 277.46
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 49 train loss: 86.558261 Time: 748.60
Run: 49 VAL ap_score: 0.605883 map_score: 0.580939 Time: 278.36
Run: 50 train loss: 86.737991 Time: 744.21
Run: 50 VAL ap_score: 0.615589 map_score: 0.582591 Time: 274.65
Run: 51 train loss: 87.131166 Time: 741.10
Run: 51 VAL ap_score: 0.624411 map_score: 0.596751 Time: 278.58
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 52 train loss: 86.334827 Time: 733.27
Run: 52 VAL ap_score: 0.614266 map_score: 0.574751 Time: 285.13
Run: 53 train loss: 86.308272 Time: 737.14
Run: 53 VAL ap_score: 0.615737 map_score: 0.591092 Time: 288.55
Run: 54 train loss: 85.268417 Time: 728.49
Run: 54 VAL ap_score: 0.622336 map_score: 0.585208 Time: 292.46
Run: 55 train loss: 85.316870 Time: 728.30
Run: 55 VAL ap_score: 0.639395 map_score: 0.596824 Time: 296.34
Run: 56 train loss: 84.520628 Time: 734.68
Run: 56 VAL ap_score: 0.623492 map_score: 0.600414 Time: 296.34
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 57 train loss: 84.508710 Time: 733.22
Run: 57 VAL ap_score: 0.611156 map_score: 0.580270 Time: 299.12
Run: 58 train loss: 84.535333 Time: 662.32
Run: 58 VAL ap_score: 0.614675 map_score: 0.584181 Time: 238.32
Run: 59 train loss: 85.361022 Time: 615.43
Run: 59 VAL ap_score: 0.621305 map_score: 0.593248 Time: 239.97
Run: 60 train loss: 83.840841 Time: 616.20
Run: 60 VAL ap_score: 0.628665 map_score: 0.583762 Time: 238.65
Run: 61 train loss: 82.913358 Time: 623.62
Run: 61 VAL ap_score: 0.607945 map_score: 0.582070 Time: 242.10
Run: 62 train loss: 83.340543 Time: 625.45
Run: 62 VAL ap_score: 0.622089 map_score: 0.595114 Time: 241.08
Run: 63 train loss: 83.592237 Time: 615.64
Run: 63 VAL ap_score: 0.629339 map_score: 0.599804 Time: 238.95
Run: 64 train loss: 81.776168 Time: 620.87
Run: 64 VAL ap_score: 0.643755 map_score: 0.601848 Time: 237.53
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 65 train loss: 82.796906 Time: 624.24
Run: 65 VAL ap_score: 0.622189 map_score: 0.586266 Time: 235.22
Run: 66 train loss: 81.878156 Time: 622.07
Run: 66 VAL ap_score: 0.610020 map_score: 0.581912 Time: 241.32
Run: 67 train loss: 81.519738 Time: 619.08
Run: 67 VAL ap_score: 0.627975 map_score: 0.596256 Time: 238.38
Run: 68 train loss: 82.169732 Time: 627.20
Run: 68 VAL ap_score: 0.625012 map_score: 0.586131 Time: 238.66
Run: 69 train loss: 81.783200 Time: 630.96
Run: 69 VAL ap_score: 0.645129 map_score: 0.607403 Time: 236.61
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 70 train loss: 80.992213 Time: 622.34
Run: 70 VAL ap_score: 0.626609 map_score: 0.584103 Time: 236.88
Run: 71 train loss: 80.775821 Time: 619.17
Run: 71 VAL ap_score: 0.645609 map_score: 0.613103 Time: 240.10
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_mr_7366_2024-01-25_21:35:53.336771
Run: 72 train loss: 80.870272 Time: 617.89
Run: 72 VAL ap_score: 0.646439 map_score: 0.603126 Time: 244.80
Run: 73 train loss: 80.357283 Time: 613.51
Run: 73 VAL ap_score: 0.641331 map_score: 0.598727 Time: 242.55
Run: 74 train loss: 80.491533 Time: 615.93
Run: 74 VAL ap_score: 0.641735 map_score: 0.597764 Time: 252.71
Run: 75 train loss: 80.883716 Time: 606.88
Run: 75 VAL ap_score: 0.630261 map_score: 0.595502 Time: 253.82
Run: 76 train loss: 79.254455 Time: 610.73
Run: 76 VAL ap_score: 0.640526 map_score: 0.591407 Time: 257.24
Run: 77 train loss: 79.028106 Time: 609.44
Run: 77 VAL ap_score: 0.625072 map_score: 0.591326 Time: 256.71
Run: 78 train loss: 79.915221 Time: 599.54
Run: 78 VAL ap_score: 0.642499 map_score: 0.602523 Time: 236.67
Run: 79 train loss: 79.891355 Time: 585.32
Run: 79 VAL ap_score: 0.637498 map_score: 0.606435 Time: 244.13
Run: 80 train loss: 79.153206 Time: 605.44
Run: 80 VAL ap_score: 0.605078 map_score: 0.583540 Time: 250.13
Run: 81 train loss: 79.388207 Time: 619.81
Run: 81 VAL ap_score: 0.620378 map_score: 0.596106 Time: 248.45
Run: 82 train loss: 78.226222 Time: 616.24
Run: 82 VAL ap_score: 0.612210 map_score: 0.585770 Time: 247.58
Run: 83 train loss: 79.821197 Time: 615.97
Run: 83 VAL ap_score: 0.633443 map_score: 0.601652 Time: 252.23
Run: 84 train loss: 78.883963 Time: 614.25
Run: 84 VAL ap_score: 0.633802 map_score: 0.603853 Time: 248.26
Run: 85 train loss: 78.424063 Time: 616.59
Run: 85 VAL ap_score: 0.643229 map_score: 0.597630 Time: 247.27
Run: 86 train loss: 78.656233 Time: 618.07
Run: 86 VAL ap_score: 0.622496 map_score: 0.596703 Time: 245.40
Run: 87 train loss: 79.223002 Time: 612.09
Run: 87 VAL ap_score: 0.617260 map_score: 0.598115 Time: 241.89
Run: 88 train loss: 78.203374 Time: 615.32
Run: 88 VAL ap_score: 0.631846 map_score: 0.599504 Time: 239.45
Run: 89 train loss: 78.258869 Time: 628.30
Run: 89 VAL ap_score: 0.615191 map_score: 0.589341 Time: 236.45
Run: 90 train loss: 78.030166 Time: 623.93
Run: 90 VAL ap_score: 0.623555 map_score: 0.593203 Time: 233.81
Run: 91 train loss: 77.173337 Time: 626.76
Run: 91 VAL ap_score: 0.624405 map_score: 0.596675 Time: 227.19
Run: 92 train loss: 77.776984 Time: 631.33
Run: 92 VAL ap_score: 0.635572 map_score: 0.606760 Time: 226.24
Run: 93 train loss: 77.050131 Time: 633.29
Run: 93 VAL ap_score: 0.643053 map_score: 0.607063 Time: 221.11
Run: 94 train loss: 78.075543 Time: 623.08
