Command line
/raid/infolab/vaibhav/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_injective_attention_temp_0.1
--TASK=gmn_match_hinge_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
--temp_gmn_scoring=0.1
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4929
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge Injective Attention
saving initial model to ./gmn_match_hinge_injective_attention_temp_0.1/initialModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
no. of params in model: 2050
Run: 0 train loss: 238.803616 Time: 625.51
Run: 0 VAL ap_score: 0.451907 map_score: 0.497873 Time: 236.71
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 1 train loss: 185.004086 Time: 628.26
Run: 1 VAL ap_score: 0.498329 map_score: 0.520783 Time: 234.68
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 2 train loss: 168.369997 Time: 633.02
Run: 2 VAL ap_score: 0.519892 map_score: 0.534570 Time: 234.49
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 3 train loss: 158.353868 Time: 634.31
Run: 3 VAL ap_score: 0.555600 map_score: 0.562692 Time: 232.25
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 4 train loss: 152.039496 Time: 631.26
Run: 4 VAL ap_score: 0.545023 map_score: 0.555016 Time: 230.78
Run: 5 train loss: 148.109916 Time: 627.82
Run: 5 VAL ap_score: 0.583126 map_score: 0.586838 Time: 230.47
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 6 train loss: 143.175714 Time: 626.38
Run: 6 VAL ap_score: 0.585085 map_score: 0.589856 Time: 228.24
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 7 train loss: 139.432076 Time: 626.59
Run: 7 VAL ap_score: 0.581541 map_score: 0.583392 Time: 227.73
Run: 8 train loss: 136.842329 Time: 626.70
Run: 8 VAL ap_score: 0.592608 map_score: 0.593215 Time: 227.27
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 9 train loss: 130.623593 Time: 622.59
Run: 9 VAL ap_score: 0.607050 map_score: 0.608105 Time: 230.76
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 10 train loss: 128.176959 Time: 624.86
Run: 10 VAL ap_score: 0.596346 map_score: 0.600649 Time: 235.46
Run: 11 train loss: 124.232351 Time: 625.14
Run: 11 VAL ap_score: 0.620707 map_score: 0.622275 Time: 234.00
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 12 train loss: 122.189853 Time: 623.12
Run: 12 VAL ap_score: 0.607261 map_score: 0.607606 Time: 237.64
Run: 13 train loss: 119.866864 Time: 616.83
Run: 13 VAL ap_score: 0.625626 map_score: 0.630501 Time: 239.07
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 14 train loss: 117.863538 Time: 615.50
Run: 14 VAL ap_score: 0.615148 map_score: 0.623116 Time: 238.87
Run: 15 train loss: 116.169642 Time: 615.77
Run: 15 VAL ap_score: 0.633488 map_score: 0.632613 Time: 243.07
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 16 train loss: 113.555415 Time: 611.42
Run: 16 VAL ap_score: 0.602457 map_score: 0.614248 Time: 247.52
Run: 17 train loss: 112.593971 Time: 610.84
Run: 17 VAL ap_score: 0.614048 map_score: 0.618082 Time: 245.71
Run: 18 train loss: 112.448856 Time: 611.81
Run: 18 VAL ap_score: 0.628732 map_score: 0.638228 Time: 244.45
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 19 train loss: 110.938922 Time: 612.84
Run: 19 VAL ap_score: 0.631835 map_score: 0.630748 Time: 242.76
Run: 20 train loss: 109.905307 Time: 616.61
Run: 20 VAL ap_score: 0.621098 map_score: 0.633832 Time: 242.33
Run: 21 train loss: 108.083198 Time: 617.02
Run: 21 VAL ap_score: 0.630966 map_score: 0.637913 Time: 242.27
Run: 22 train loss: 107.845527 Time: 622.47
Run: 22 VAL ap_score: 0.652805 map_score: 0.652598 Time: 237.80
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 23 train loss: 105.308890 Time: 625.18
Run: 23 VAL ap_score: 0.606275 map_score: 0.623939 Time: 238.65
Run: 24 train loss: 105.003459 Time: 625.68
Run: 24 VAL ap_score: 0.597273 map_score: 0.619629 Time: 238.33
Run: 25 train loss: 103.249200 Time: 626.95
Run: 25 VAL ap_score: 0.641792 map_score: 0.648244 Time: 234.12
Run: 26 train loss: 102.196418 Time: 630.89
Run: 26 VAL ap_score: 0.643077 map_score: 0.643895 Time: 233.44
Run: 27 train loss: 101.809544 Time: 629.01
Run: 27 VAL ap_score: 0.641229 map_score: 0.655467 Time: 229.01
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 28 train loss: 100.673314 Time: 636.38
Run: 28 VAL ap_score: 0.635308 map_score: 0.645185 Time: 227.03
Run: 29 train loss: 99.949997 Time: 632.62
Run: 29 VAL ap_score: 0.595663 map_score: 0.622477 Time: 222.19
Run: 30 train loss: 98.682418 Time: 736.81
Run: 30 VAL ap_score: 0.636650 map_score: 0.644455 Time: 220.81
Run: 31 train loss: 97.551569 Time: 640.90
Run: 31 VAL ap_score: 0.645135 map_score: 0.654610 Time: 216.61
Run: 32 train loss: 97.888754 Time: 680.11
Run: 32 VAL ap_score: 0.625024 map_score: 0.637804 Time: 232.34
Run: 33 train loss: 96.339997 Time: 632.72
Run: 33 VAL ap_score: 0.635402 map_score: 0.641068 Time: 227.75
Run: 34 train loss: 95.588694 Time: 626.14
Run: 34 VAL ap_score: 0.660720 map_score: 0.667969 Time: 229.01
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 35 train loss: 95.704885 Time: 682.37
Run: 35 VAL ap_score: 0.636891 map_score: 0.645481 Time: 247.85
Run: 36 train loss: 94.759504 Time: 620.50
Run: 36 VAL ap_score: 0.646878 map_score: 0.651072 Time: 241.52
Run: 37 train loss: 93.855884 Time: 617.08
Run: 37 VAL ap_score: 0.639072 map_score: 0.644061 Time: 240.66
Run: 38 train loss: 93.354477 Time: 619.32
Run: 38 VAL ap_score: 0.667051 map_score: 0.673724 Time: 230.41
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 39 train loss: 92.258467 Time: 598.05
Run: 39 VAL ap_score: 0.634893 map_score: 0.653190 Time: 220.98
Run: 40 train loss: 92.373538 Time: 620.25
Run: 40 VAL ap_score: 0.669930 map_score: 0.668945 Time: 225.99
Run: 41 train loss: 91.712718 Time: 627.83
Run: 41 VAL ap_score: 0.644206 map_score: 0.663842 Time: 279.33
Run: 42 train loss: 91.139512 Time: 790.92
Run: 42 VAL ap_score: 0.653311 map_score: 0.653987 Time: 285.54
Run: 43 train loss: 90.899745 Time: 717.58
Run: 43 VAL ap_score: 0.615638 map_score: 0.653622 Time: 280.43
Run: 44 train loss: 91.502513 Time: 761.36
Run: 44 VAL ap_score: 0.659188 map_score: 0.666646 Time: 282.07
Run: 45 train loss: 89.883394 Time: 759.19
Run: 45 VAL ap_score: 0.668637 map_score: 0.678394 Time: 284.28
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 46 train loss: 89.376627 Time: 760.93
Run: 46 VAL ap_score: 0.672611 map_score: 0.675329 Time: 280.00
Run: 47 train loss: 88.335682 Time: 760.58
Run: 47 VAL ap_score: 0.671987 map_score: 0.681150 Time: 279.96
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 48 train loss: 89.231585 Time: 752.89
Run: 48 VAL ap_score: 0.652880 map_score: 0.657679 Time: 275.85
Run: 49 train loss: 87.881077 Time: 749.97
Run: 49 VAL ap_score: 0.625732 map_score: 0.639648 Time: 277.47
Run: 50 train loss: 88.161307 Time: 755.84
Run: 50 VAL ap_score: 0.664479 map_score: 0.673439 Time: 281.36
Run: 51 train loss: 87.224637 Time: 754.00
Run: 51 VAL ap_score: 0.641426 map_score: 0.644406 Time: 280.69
Run: 52 train loss: 86.796991 Time: 751.04
Run: 52 VAL ap_score: 0.664473 map_score: 0.685541 Time: 284.09
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 53 train loss: 86.817111 Time: 748.62
Run: 53 VAL ap_score: 0.664136 map_score: 0.671915 Time: 283.15
Run: 54 train loss: 86.714924 Time: 747.64
Run: 54 VAL ap_score: 0.658409 map_score: 0.663337 Time: 286.86
Run: 55 train loss: 87.545058 Time: 746.03
Run: 55 VAL ap_score: 0.657845 map_score: 0.666488 Time: 294.45
Run: 56 train loss: 86.916024 Time: 743.28
Run: 56 VAL ap_score: 0.665863 map_score: 0.671582 Time: 291.72
Run: 57 train loss: 85.581428 Time: 745.26
Run: 57 VAL ap_score: 0.650302 map_score: 0.666927 Time: 295.50
Run: 58 train loss: 85.723454 Time: 645.43
Run: 58 VAL ap_score: 0.649285 map_score: 0.662763 Time: 246.83
Run: 59 train loss: 85.108361 Time: 631.42
Run: 59 VAL ap_score: 0.661973 map_score: 0.660197 Time: 249.61
Run: 60 train loss: 84.270992 Time: 631.56
Run: 60 VAL ap_score: 0.669504 map_score: 0.683619 Time: 249.18
Run: 61 train loss: 85.258094 Time: 619.86
Run: 61 VAL ap_score: 0.666834 map_score: 0.676783 Time: 241.82
Run: 62 train loss: 84.181648 Time: 621.93
Run: 62 VAL ap_score: 0.663567 map_score: 0.669258 Time: 244.75
Run: 63 train loss: 83.704837 Time: 623.93
Run: 63 VAL ap_score: 0.665785 map_score: 0.679529 Time: 249.04
Run: 64 train loss: 83.351259 Time: 622.88
Run: 64 VAL ap_score: 0.668841 map_score: 0.679724 Time: 249.64
Run: 65 train loss: 82.897817 Time: 629.49
Run: 65 VAL ap_score: 0.663457 map_score: 0.673082 Time: 252.80
Run: 66 train loss: 82.776730 Time: 614.94
Run: 66 VAL ap_score: 0.657034 map_score: 0.675087 Time: 247.08
Run: 67 train loss: 82.398965 Time: 623.87
Run: 67 VAL ap_score: 0.656630 map_score: 0.657660 Time: 252.31
Run: 68 train loss: 81.832859 Time: 630.68
Run: 68 VAL ap_score: 0.649419 map_score: 0.659317 Time: 254.22
Run: 69 train loss: 82.085808 Time: 625.49
Run: 69 VAL ap_score: 0.683275 map_score: 0.684362 Time: 253.24
Run: 70 train loss: 82.288283 Time: 621.47
Run: 70 VAL ap_score: 0.679036 map_score: 0.687316 Time: 249.89
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 71 train loss: 81.358974 Time: 612.24
Run: 71 VAL ap_score: 0.664571 map_score: 0.670011 Time: 252.15
Run: 72 train loss: 82.237596 Time: 622.47
Run: 72 VAL ap_score: 0.662093 map_score: 0.672928 Time: 258.04
Run: 73 train loss: 81.547565 Time: 623.63
Run: 73 VAL ap_score: 0.652974 map_score: 0.661422 Time: 255.96
Run: 74 train loss: 80.794049 Time: 622.89
Run: 74 VAL ap_score: 0.669565 map_score: 0.683159 Time: 258.80
Run: 75 train loss: 80.730673 Time: 617.58
Run: 75 VAL ap_score: 0.686922 map_score: 0.687129 Time: 258.62
Run: 76 train loss: 79.782408 Time: 621.18
Run: 76 VAL ap_score: 0.678332 map_score: 0.681010 Time: 259.20
Run: 77 train loss: 80.371985 Time: 624.89
Run: 77 VAL ap_score: 0.674455 map_score: 0.676897 Time: 256.69
Run: 78 train loss: 80.631142 Time: 605.48
Run: 78 VAL ap_score: 0.657836 map_score: 0.665482 Time: 243.35
Run: 79 train loss: 79.660012 Time: 635.91
Run: 79 VAL ap_score: 0.646443 map_score: 0.668695 Time: 258.85
Run: 80 train loss: 79.528346 Time: 647.54
Run: 80 VAL ap_score: 0.663862 map_score: 0.675769 Time: 246.98
Run: 81 train loss: 80.442814 Time: 626.65
Run: 81 VAL ap_score: 0.667663 map_score: 0.683961 Time: 244.32
Run: 82 train loss: 79.398601 Time: 634.93
Run: 82 VAL ap_score: 0.676612 map_score: 0.679930 Time: 241.36
Run: 83 train loss: 79.030645 Time: 636.64
Run: 83 VAL ap_score: 0.672472 map_score: 0.686117 Time: 242.06
Run: 84 train loss: 79.266621 Time: 638.23
Run: 84 VAL ap_score: 0.671035 map_score: 0.684817 Time: 242.27
Run: 85 train loss: 78.629538 Time: 634.68
Run: 85 VAL ap_score: 0.670346 map_score: 0.677173 Time: 244.71
Run: 86 train loss: 78.366228 Time: 634.02
Run: 86 VAL ap_score: 0.681607 map_score: 0.687589 Time: 243.11
saving best validated model to ./gmn_match_hinge_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_injective_attention_ptc_fm_4929_2024-01-25_21:35:43.622660
Run: 87 train loss: 78.624240 Time: 633.27
Run: 87 VAL ap_score: 0.638646 map_score: 0.673274 Time: 239.15
Run: 88 train loss: 78.444287 Time: 641.09
Run: 88 VAL ap_score: 0.670466 map_score: 0.681822 Time: 237.62
Run: 89 train loss: 78.610435 Time: 633.94
Run: 89 VAL ap_score: 0.667068 map_score: 0.677332 Time: 241.96
Run: 90 train loss: 77.770179 Time: 626.99
Run: 90 VAL ap_score: 0.661042 map_score: 0.682131 Time: 245.83
Run: 91 train loss: 77.889415 Time: 630.53
Run: 91 VAL ap_score: 0.664703 map_score: 0.680355 Time: 244.09
Run: 92 train loss: 78.518087 Time: 638.49
Run: 92 VAL ap_score: 0.652146 map_score: 0.667558 Time: 247.37
Run: 93 train loss: 77.536571 Time: 647.86
