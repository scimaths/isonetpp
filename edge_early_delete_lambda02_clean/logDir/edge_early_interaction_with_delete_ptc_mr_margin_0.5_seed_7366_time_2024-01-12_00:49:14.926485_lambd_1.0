Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda02_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mr
--interpretability_lambda=0.2
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda02_clean/initialModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
no. of params in model: 3730
Run: 0 train loss: 272.788003 Time: 771.90
Run: 0 VAL ap_score: 0.502269 map_score: 0.486409 Time: 315.69
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 1 train loss: 178.098050 Time: 621.29
Run: 1 VAL ap_score: 0.503667 map_score: 0.510705 Time: 257.55
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 2 train loss: 157.577649 Time: 695.87
Run: 2 VAL ap_score: 0.537905 map_score: 0.534720 Time: 244.80
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 3 train loss: 141.149486 Time: 674.63
Run: 3 VAL ap_score: 0.556174 map_score: 0.536514 Time: 250.85
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 4 train loss: 129.906369 Time: 674.96
Run: 4 VAL ap_score: 0.558527 map_score: 0.578516 Time: 261.01
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 5 train loss: 122.667271 Time: 692.69
Run: 5 VAL ap_score: 0.608281 map_score: 0.602066 Time: 257.15
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 6 train loss: 115.985394 Time: 679.63
Run: 6 VAL ap_score: 0.621895 map_score: 0.599418 Time: 258.77
Run: 7 train loss: 108.904567 Time: 697.67
Run: 7 VAL ap_score: 0.628459 map_score: 0.617766 Time: 260.18
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 8 train loss: 104.880124 Time: 677.40
Run: 8 VAL ap_score: 0.607789 map_score: 0.615943 Time: 244.92
Run: 9 train loss: 100.520156 Time: 658.84
Run: 9 VAL ap_score: 0.621972 map_score: 0.608965 Time: 257.88
Run: 10 train loss: 95.923409 Time: 678.59
Run: 10 VAL ap_score: 0.626871 map_score: 0.627516 Time: 236.33
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 11 train loss: 90.872729 Time: 668.25
Run: 11 VAL ap_score: 0.646029 map_score: 0.647044 Time: 259.30
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 12 train loss: 89.005061 Time: 672.64
Run: 12 VAL ap_score: 0.588540 map_score: 0.610950 Time: 250.58
Run: 13 train loss: 87.210024 Time: 698.60
Run: 13 VAL ap_score: 0.660078 map_score: 0.637558 Time: 250.13
Run: 14 train loss: 84.351736 Time: 654.36
Run: 14 VAL ap_score: 0.653551 map_score: 0.647774 Time: 257.59
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 15 train loss: 82.137806 Time: 673.23
Run: 15 VAL ap_score: 0.657809 map_score: 0.641978 Time: 246.95
Run: 16 train loss: 80.153940 Time: 682.31
Run: 16 VAL ap_score: 0.662107 map_score: 0.646599 Time: 265.83
Run: 17 train loss: 78.310604 Time: 687.19
Run: 17 VAL ap_score: 0.666730 map_score: 0.654342 Time: 254.11
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 18 train loss: 74.574290 Time: 678.41
Run: 18 VAL ap_score: 0.653354 map_score: 0.655644 Time: 263.66
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 19 train loss: 74.249720 Time: 665.07
Run: 19 VAL ap_score: 0.637306 map_score: 0.631949 Time: 240.55
Run: 20 train loss: 71.586493 Time: 673.22
Run: 20 VAL ap_score: 0.687234 map_score: 0.665304 Time: 257.19
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 21 train loss: 69.429596 Time: 675.84
Run: 21 VAL ap_score: 0.669880 map_score: 0.660247 Time: 255.55
Run: 22 train loss: 68.991867 Time: 665.16
Run: 22 VAL ap_score: 0.686919 map_score: 0.680044 Time: 251.10
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 23 train loss: 65.707460 Time: 670.49
Run: 23 VAL ap_score: 0.690612 map_score: 0.677509 Time: 259.47
Run: 24 train loss: 64.677354 Time: 671.35
Run: 24 VAL ap_score: 0.671559 map_score: 0.676048 Time: 265.43
Run: 25 train loss: 65.052406 Time: 646.88
Run: 25 VAL ap_score: 0.686526 map_score: 0.669265 Time: 259.77
Run: 26 train loss: 64.072800 Time: 676.39
Run: 26 VAL ap_score: 0.690497 map_score: 0.679489 Time: 257.46
Run: 27 train loss: 62.071089 Time: 664.98
Run: 27 VAL ap_score: 0.707919 map_score: 0.698736 Time: 262.69
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 28 train loss: 61.263430 Time: 661.53
Run: 28 VAL ap_score: 0.721620 map_score: 0.695069 Time: 246.28
Run: 29 train loss: 59.478601 Time: 672.21
Run: 29 VAL ap_score: 0.732195 map_score: 0.704522 Time: 271.69
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 30 train loss: 58.262248 Time: 665.24
Run: 30 VAL ap_score: 0.716983 map_score: 0.693924 Time: 262.68
Run: 31 train loss: 57.952510 Time: 670.43
Run: 31 VAL ap_score: 0.728661 map_score: 0.705224 Time: 261.27
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 32 train loss: 57.056025 Time: 660.30
Run: 32 VAL ap_score: 0.731995 map_score: 0.714090 Time: 263.22
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 33 train loss: 56.090890 Time: 646.17
Run: 33 VAL ap_score: 0.719516 map_score: 0.708911 Time: 310.27
Run: 34 train loss: 55.375409 Time: 892.81
Run: 34 VAL ap_score: 0.700431 map_score: 0.677612 Time: 287.76
Run: 35 train loss: 53.844182 Time: 734.84
Run: 35 VAL ap_score: 0.715355 map_score: 0.716179 Time: 283.38
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 36 train loss: 52.991536 Time: 708.50
Run: 36 VAL ap_score: 0.741718 map_score: 0.720882 Time: 253.28
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 37 train loss: 51.883480 Time: 695.09
Run: 37 VAL ap_score: 0.730841 map_score: 0.716980 Time: 270.75
Run: 38 train loss: 52.162535 Time: 684.17
Run: 38 VAL ap_score: 0.723666 map_score: 0.702875 Time: 252.66
Run: 39 train loss: 50.344834 Time: 674.54
Run: 39 VAL ap_score: 0.742606 map_score: 0.721333 Time: 239.58
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 40 train loss: 51.692412 Time: 652.43
Run: 40 VAL ap_score: 0.694512 map_score: 0.689583 Time: 232.44
Run: 41 train loss: 49.184257 Time: 596.42
Run: 41 VAL ap_score: 0.755115 map_score: 0.727761 Time: 230.04
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 42 train loss: 48.806477 Time: 594.34
Run: 42 VAL ap_score: 0.751963 map_score: 0.724984 Time: 241.44
Run: 43 train loss: 49.005836 Time: 599.16
Run: 43 VAL ap_score: 0.759131 map_score: 0.730237 Time: 229.08
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 44 train loss: 48.079185 Time: 593.92
Run: 44 VAL ap_score: 0.763382 map_score: 0.737791 Time: 219.52
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 45 train loss: 48.383708 Time: 577.52
Run: 45 VAL ap_score: 0.756116 map_score: 0.730984 Time: 223.30
Run: 46 train loss: 47.059065 Time: 583.57
Run: 46 VAL ap_score: 0.757227 map_score: 0.737569 Time: 243.76
Run: 47 train loss: 45.987402 Time: 581.82
Run: 47 VAL ap_score: 0.760480 map_score: 0.745191 Time: 228.14
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 48 train loss: 46.274516 Time: 576.13
Run: 48 VAL ap_score: 0.751389 map_score: 0.726156 Time: 236.53
Run: 49 train loss: 44.993012 Time: 596.26
Run: 49 VAL ap_score: 0.763753 map_score: 0.740676 Time: 264.77
Run: 50 train loss: 45.403218 Time: 596.51
Run: 50 VAL ap_score: 0.752640 map_score: 0.727647 Time: 249.36
Run: 51 train loss: 44.514662 Time: 593.97
Run: 51 VAL ap_score: 0.757580 map_score: 0.742816 Time: 227.57
Run: 52 train loss: 44.035655 Time: 571.87
Run: 52 VAL ap_score: 0.753425 map_score: 0.739987 Time: 219.56
Run: 53 train loss: 44.489721 Time: 551.60
Run: 53 VAL ap_score: 0.767511 map_score: 0.752687 Time: 218.94
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 54 train loss: 45.219401 Time: 561.18
Run: 54 VAL ap_score: 0.768339 map_score: 0.743780 Time: 246.97
Run: 55 train loss: 43.305849 Time: 648.54
Run: 55 VAL ap_score: 0.758128 map_score: 0.739851 Time: 232.59
Run: 56 train loss: 42.190877 Time: 550.65
Run: 56 VAL ap_score: 0.742058 map_score: 0.724593 Time: 232.46
Run: 57 train loss: 42.584313 Time: 612.99
Run: 57 VAL ap_score: 0.753085 map_score: 0.729564 Time: 227.80
Run: 58 train loss: 41.684407 Time: 578.85
Run: 58 VAL ap_score: 0.780564 map_score: 0.749227 Time: 205.26
Run: 59 train loss: 40.624859 Time: 544.75
Run: 59 VAL ap_score: 0.738454 map_score: 0.731238 Time: 219.00
Run: 60 train loss: 40.938471 Time: 578.43
Run: 60 VAL ap_score: 0.785833 map_score: 0.773249 Time: 222.47
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:49:14.926485
Run: 61 train loss: 39.804394 Time: 572.64
Run: 61 VAL ap_score: 0.749690 map_score: 0.743694 Time: 227.60
Run: 62 train loss: 40.578285 Time: 572.58
Run: 62 VAL ap_score: 0.760503 map_score: 0.743218 Time: 212.76
Run: 63 train loss: 39.264371 Time: 587.83
Run: 63 VAL ap_score: 0.800668 map_score: 0.770419 Time: 226.15
Run: 64 train loss: 39.461419 Time: 582.39
Run: 64 VAL ap_score: 0.780420 map_score: 0.764807 Time: 216.96
Run: 65 train loss: 38.163947 Time: 575.07
Run: 65 VAL ap_score: 0.763026 map_score: 0.742833 Time: 224.36
Run: 66 train loss: 39.304239 Time: 544.73
Run: 66 VAL ap_score: 0.757315 map_score: 0.744049 Time: 207.04
Run: 67 train loss: 38.751572 Time: 518.91
Run: 67 VAL ap_score: 0.779818 map_score: 0.770361 Time: 200.54
Run: 68 train loss: 38.932100 Time: 513.30
Run: 68 VAL ap_score: 0.791683 map_score: 0.763800 Time: 181.23
Run: 69 train loss: 37.269888 Time: 462.66
Run: 69 VAL ap_score: 0.778402 map_score: 0.757319 Time: 170.86
