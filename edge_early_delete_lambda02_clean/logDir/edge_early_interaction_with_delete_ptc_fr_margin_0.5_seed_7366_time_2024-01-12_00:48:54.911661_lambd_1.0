Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda02_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fr
--interpretability_lambda=0.2
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda02_clean/initialModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
no. of params in model: 3730
Run: 0 train loss: 291.941801 Time: 587.36
Run: 0 VAL ap_score: 0.525743 map_score: 0.536832 Time: 269.64
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 1 train loss: 181.687884 Time: 613.99
Run: 1 VAL ap_score: 0.569910 map_score: 0.551317 Time: 187.65
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 2 train loss: 160.427250 Time: 589.52
Run: 2 VAL ap_score: 0.591614 map_score: 0.586406 Time: 223.50
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 3 train loss: 144.931615 Time: 607.87
Run: 3 VAL ap_score: 0.630086 map_score: 0.606896 Time: 215.39
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 4 train loss: 133.199795 Time: 597.55
Run: 4 VAL ap_score: 0.623725 map_score: 0.615025 Time: 219.93
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 5 train loss: 125.461883 Time: 610.19
Run: 5 VAL ap_score: 0.630835 map_score: 0.619677 Time: 207.08
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 6 train loss: 119.615108 Time: 603.47
Run: 6 VAL ap_score: 0.657725 map_score: 0.631845 Time: 211.77
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 7 train loss: 111.435867 Time: 611.21
Run: 7 VAL ap_score: 0.679500 map_score: 0.664237 Time: 213.50
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 8 train loss: 101.276117 Time: 608.28
Run: 8 VAL ap_score: 0.673045 map_score: 0.659966 Time: 216.02
Run: 9 train loss: 92.746730 Time: 607.79
Run: 9 VAL ap_score: 0.701798 map_score: 0.673621 Time: 215.17
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 10 train loss: 87.569447 Time: 601.38
Run: 10 VAL ap_score: 0.747885 map_score: 0.721605 Time: 218.70
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 11 train loss: 82.920736 Time: 603.55
Run: 11 VAL ap_score: 0.758003 map_score: 0.732313 Time: 215.00
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 12 train loss: 79.824476 Time: 592.99
Run: 12 VAL ap_score: 0.725296 map_score: 0.714680 Time: 212.19
Run: 13 train loss: 73.752692 Time: 597.27
Run: 13 VAL ap_score: 0.755965 map_score: 0.746118 Time: 226.78
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 14 train loss: 72.135582 Time: 610.59
Run: 14 VAL ap_score: 0.743119 map_score: 0.735441 Time: 217.14
Run: 15 train loss: 69.042929 Time: 602.96
Run: 15 VAL ap_score: 0.745679 map_score: 0.747749 Time: 207.99
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 16 train loss: 66.306959 Time: 586.75
Run: 16 VAL ap_score: 0.768473 map_score: 0.759246 Time: 214.49
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 17 train loss: 64.722279 Time: 605.58
Run: 17 VAL ap_score: 0.780224 map_score: 0.765352 Time: 219.57
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 18 train loss: 62.707024 Time: 600.45
Run: 18 VAL ap_score: 0.764662 map_score: 0.746728 Time: 206.40
Run: 19 train loss: 63.409209 Time: 601.33
Run: 19 VAL ap_score: 0.762587 map_score: 0.743761 Time: 217.47
Run: 20 train loss: 59.199980 Time: 581.00
Run: 20 VAL ap_score: 0.740184 map_score: 0.730839 Time: 204.01
Run: 21 train loss: 59.402147 Time: 597.56
Run: 21 VAL ap_score: 0.773881 map_score: 0.769268 Time: 217.31
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 22 train loss: 58.810403 Time: 600.08
Run: 22 VAL ap_score: 0.776884 map_score: 0.770153 Time: 205.38
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 23 train loss: 56.599085 Time: 591.84
Run: 23 VAL ap_score: 0.788633 map_score: 0.759924 Time: 211.34
Run: 24 train loss: 55.305969 Time: 595.01
Run: 24 VAL ap_score: 0.758063 map_score: 0.747758 Time: 205.13
Run: 25 train loss: 54.791084 Time: 598.18
Run: 25 VAL ap_score: 0.801079 map_score: 0.781482 Time: 198.17
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 26 train loss: 52.826817 Time: 594.09
Run: 26 VAL ap_score: 0.792284 map_score: 0.783245 Time: 208.51
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 27 train loss: 51.806550 Time: 592.89
Run: 27 VAL ap_score: 0.815360 map_score: 0.792049 Time: 213.25
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 28 train loss: 50.357361 Time: 599.12
Run: 28 VAL ap_score: 0.792776 map_score: 0.776202 Time: 199.11
Run: 29 train loss: 50.886845 Time: 600.83
Run: 29 VAL ap_score: 0.810352 map_score: 0.781419 Time: 211.31
Run: 30 train loss: 48.312645 Time: 604.91
Run: 30 VAL ap_score: 0.801304 map_score: 0.782387 Time: 201.13
Run: 31 train loss: 48.151520 Time: 597.93
Run: 31 VAL ap_score: 0.812281 map_score: 0.783350 Time: 219.07
Run: 32 train loss: 46.454454 Time: 602.93
Run: 32 VAL ap_score: 0.813429 map_score: 0.793469 Time: 210.93
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 33 train loss: 46.017122 Time: 583.99
Run: 33 VAL ap_score: 0.821139 map_score: 0.800067 Time: 215.86
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 34 train loss: 45.501886 Time: 607.26
Run: 34 VAL ap_score: 0.814600 map_score: 0.796012 Time: 214.77
Run: 35 train loss: 45.671571 Time: 577.78
Run: 35 VAL ap_score: 0.780444 map_score: 0.780603 Time: 222.20
Run: 36 train loss: 43.926804 Time: 566.88
Run: 36 VAL ap_score: 0.839304 map_score: 0.817105 Time: 216.25
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 37 train loss: 43.578893 Time: 584.37
Run: 37 VAL ap_score: 0.830408 map_score: 0.816449 Time: 216.93
Run: 38 train loss: 42.884868 Time: 584.05
Run: 38 VAL ap_score: 0.839053 map_score: 0.816344 Time: 264.13
Run: 39 train loss: 41.892883 Time: 802.84
Run: 39 VAL ap_score: 0.823279 map_score: 0.807984 Time: 266.13
Run: 40 train loss: 42.078277 Time: 816.19
Run: 40 VAL ap_score: 0.831329 map_score: 0.817699 Time: 318.25
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 41 train loss: 40.639719 Time: 829.44
Run: 41 VAL ap_score: 0.843730 map_score: 0.820039 Time: 295.64
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 42 train loss: 40.792998 Time: 752.10
Run: 42 VAL ap_score: 0.808773 map_score: 0.791513 Time: 287.43
Run: 43 train loss: 40.467881 Time: 607.08
Run: 43 VAL ap_score: 0.827512 map_score: 0.820369 Time: 205.57
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 44 train loss: 40.392677 Time: 607.70
Run: 44 VAL ap_score: 0.839591 map_score: 0.821747 Time: 216.06
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 45 train loss: 38.123742 Time: 595.96
Run: 45 VAL ap_score: 0.845145 map_score: 0.824031 Time: 209.63
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 46 train loss: 39.618696 Time: 597.81
Run: 46 VAL ap_score: 0.834829 map_score: 0.820549 Time: 218.55
Run: 47 train loss: 37.091613 Time: 614.99
Run: 47 VAL ap_score: 0.783283 map_score: 0.782068 Time: 221.51
Run: 48 train loss: 37.585226 Time: 611.33
Run: 48 VAL ap_score: 0.825103 map_score: 0.807450 Time: 224.57
Run: 49 train loss: 36.360610 Time: 621.64
Run: 49 VAL ap_score: 0.826971 map_score: 0.818540 Time: 226.66
Run: 50 train loss: 36.628642 Time: 594.07
Run: 50 VAL ap_score: 0.848435 map_score: 0.830296 Time: 233.99
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 51 train loss: 36.229612 Time: 581.97
Run: 51 VAL ap_score: 0.829673 map_score: 0.820476 Time: 227.51
Run: 52 train loss: 35.686172 Time: 595.01
Run: 52 VAL ap_score: 0.834237 map_score: 0.823903 Time: 237.35
Run: 53 train loss: 36.034767 Time: 595.28
Run: 53 VAL ap_score: 0.841209 map_score: 0.831629 Time: 235.18
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 54 train loss: 35.447949 Time: 635.08
Run: 54 VAL ap_score: 0.851693 map_score: 0.834551 Time: 274.63
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 55 train loss: 35.736075 Time: 638.29
Run: 55 VAL ap_score: 0.845757 map_score: 0.823546 Time: 265.34
Run: 56 train loss: 35.009652 Time: 643.93
Run: 56 VAL ap_score: 0.837325 map_score: 0.819642 Time: 247.64
Run: 57 train loss: 36.034051 Time: 603.77
Run: 57 VAL ap_score: 0.849137 map_score: 0.829552 Time: 230.06
Run: 58 train loss: 35.429828 Time: 607.30
Run: 58 VAL ap_score: 0.828825 map_score: 0.814621 Time: 222.42
Run: 59 train loss: 33.913386 Time: 575.13
Run: 59 VAL ap_score: 0.849879 map_score: 0.827957 Time: 252.93
Run: 60 train loss: 33.913358 Time: 695.87
Run: 60 VAL ap_score: 0.832376 map_score: 0.814736 Time: 318.55
Run: 61 train loss: 33.773630 Time: 651.87
Run: 61 VAL ap_score: 0.851717 map_score: 0.834387 Time: 242.55
Run: 62 train loss: 32.851861 Time: 628.96
Run: 62 VAL ap_score: 0.858541 map_score: 0.836253 Time: 211.36
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 63 train loss: 34.069164 Time: 581.30
Run: 63 VAL ap_score: 0.856492 map_score: 0.828757 Time: 217.00
Run: 64 train loss: 32.605513 Time: 613.40
Run: 64 VAL ap_score: 0.844376 map_score: 0.830482 Time: 222.51
Run: 65 train loss: 32.214692 Time: 610.08
Run: 65 VAL ap_score: 0.846406 map_score: 0.823634 Time: 210.41
Run: 66 train loss: 32.665403 Time: 614.68
Run: 66 VAL ap_score: 0.854709 map_score: 0.834561 Time: 218.23
Run: 67 train loss: 31.410833 Time: 603.11
Run: 67 VAL ap_score: 0.865727 map_score: 0.845234 Time: 213.84
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 68 train loss: 31.651463 Time: 616.40
Run: 68 VAL ap_score: 0.869817 map_score: 0.845409 Time: 210.81
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_00:48:54.911661
Run: 69 train loss: 30.762547 Time: 600.87
Run: 69 VAL ap_score: 0.864581 map_score: 0.844325 Time: 236.03
Run: 70 train loss: 30.852384 Time: 619.60
Run: 70 VAL ap_score: 0.803287 map_score: 0.797613 Time: 225.59
Run: 71 train loss: 29.978783 Time: 580.00
Run: 71 VAL ap_score: 0.859373 map_score: 0.837043 Time: 222.31
Run: 72 train loss: 30.665493 Time: 648.59
Run: 72 VAL ap_score: 0.859716 map_score: 0.835501 Time: 319.48
