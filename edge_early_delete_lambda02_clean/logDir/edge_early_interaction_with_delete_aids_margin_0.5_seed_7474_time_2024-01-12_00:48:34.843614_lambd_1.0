Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda02_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=aids
--interpretability_lambda=0.2
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_aids240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_aids240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/aids240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_aids240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_aids240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/aids240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda02_clean/initialModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
no. of params in model: 3730
Run: 0 train loss: 305.071794 Time: 421.86
Run: 0 VAL ap_score: 0.445594 map_score: 0.445455 Time: 162.79
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 1 train loss: 196.820620 Time: 572.62
Run: 1 VAL ap_score: 0.490725 map_score: 0.491905 Time: 137.04
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 2 train loss: 173.794329 Time: 410.78
Run: 2 VAL ap_score: 0.479557 map_score: 0.510311 Time: 131.06
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 3 train loss: 157.711584 Time: 563.09
Run: 3 VAL ap_score: 0.560311 map_score: 0.539810 Time: 212.47
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 4 train loss: 144.680206 Time: 547.70
Run: 4 VAL ap_score: 0.572086 map_score: 0.551806 Time: 203.46
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 5 train loss: 135.134330 Time: 556.90
Run: 5 VAL ap_score: 0.585420 map_score: 0.562501 Time: 203.95
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 6 train loss: 127.319028 Time: 544.66
Run: 6 VAL ap_score: 0.599714 map_score: 0.576033 Time: 216.69
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 7 train loss: 116.643470 Time: 551.39
Run: 7 VAL ap_score: 0.631369 map_score: 0.610471 Time: 208.01
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 8 train loss: 108.603554 Time: 544.25
Run: 8 VAL ap_score: 0.637822 map_score: 0.630324 Time: 212.65
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 9 train loss: 100.766246 Time: 563.36
Run: 9 VAL ap_score: 0.660997 map_score: 0.656679 Time: 207.84
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 10 train loss: 89.338831 Time: 558.63
Run: 10 VAL ap_score: 0.661887 map_score: 0.648843 Time: 199.24
Run: 11 train loss: 82.869910 Time: 571.61
Run: 11 VAL ap_score: 0.666743 map_score: 0.663075 Time: 201.45
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 12 train loss: 77.018821 Time: 550.04
Run: 12 VAL ap_score: 0.692742 map_score: 0.682034 Time: 211.58
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 13 train loss: 71.478431 Time: 561.01
Run: 13 VAL ap_score: 0.705034 map_score: 0.699719 Time: 206.03
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 14 train loss: 67.107594 Time: 556.46
Run: 14 VAL ap_score: 0.663781 map_score: 0.678379 Time: 205.44
Run: 15 train loss: 63.132537 Time: 569.59
Run: 15 VAL ap_score: 0.721404 map_score: 0.703159 Time: 202.10
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 16 train loss: 58.871909 Time: 563.50
Run: 16 VAL ap_score: 0.695766 map_score: 0.683708 Time: 214.43
Run: 17 train loss: 59.119589 Time: 578.04
Run: 17 VAL ap_score: 0.749472 map_score: 0.718311 Time: 211.66
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 18 train loss: 56.613884 Time: 555.44
Run: 18 VAL ap_score: 0.696659 map_score: 0.687043 Time: 206.59
Run: 19 train loss: 55.494444 Time: 566.97
Run: 19 VAL ap_score: 0.743808 map_score: 0.723312 Time: 209.47
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 20 train loss: 52.500093 Time: 564.52
Run: 20 VAL ap_score: 0.759723 map_score: 0.733765 Time: 208.89
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 21 train loss: 51.697007 Time: 556.28
Run: 21 VAL ap_score: 0.750731 map_score: 0.729765 Time: 210.03
Run: 22 train loss: 49.786681 Time: 567.73
Run: 22 VAL ap_score: 0.753422 map_score: 0.729090 Time: 198.83
Run: 23 train loss: 47.824282 Time: 566.81
Run: 23 VAL ap_score: 0.742763 map_score: 0.735898 Time: 203.21
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 24 train loss: 46.377709 Time: 556.43
Run: 24 VAL ap_score: 0.740713 map_score: 0.728454 Time: 204.57
Run: 25 train loss: 46.134111 Time: 554.14
Run: 25 VAL ap_score: 0.757849 map_score: 0.747295 Time: 198.83
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 26 train loss: 44.143561 Time: 557.74
Run: 26 VAL ap_score: 0.779912 map_score: 0.751751 Time: 198.20
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 27 train loss: 43.636040 Time: 557.12
Run: 27 VAL ap_score: 0.791300 map_score: 0.757446 Time: 204.63
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 28 train loss: 43.534893 Time: 550.40
Run: 28 VAL ap_score: 0.768411 map_score: 0.743304 Time: 194.22
Run: 29 train loss: 42.831709 Time: 553.75
Run: 29 VAL ap_score: 0.765842 map_score: 0.753364 Time: 200.27
Run: 30 train loss: 41.996884 Time: 548.05
Run: 30 VAL ap_score: 0.804839 map_score: 0.771122 Time: 200.62
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 31 train loss: 41.198536 Time: 563.13
Run: 31 VAL ap_score: 0.803306 map_score: 0.781467 Time: 211.76
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 32 train loss: 40.378709 Time: 557.60
Run: 32 VAL ap_score: 0.752489 map_score: 0.735748 Time: 200.93
Run: 33 train loss: 39.804802 Time: 558.84
Run: 33 VAL ap_score: 0.794643 map_score: 0.776830 Time: 198.77
Run: 34 train loss: 40.022942 Time: 552.02
Run: 34 VAL ap_score: 0.797838 map_score: 0.768827 Time: 204.39
Run: 35 train loss: 38.808447 Time: 566.73
Run: 35 VAL ap_score: 0.787586 map_score: 0.778307 Time: 201.93
Run: 36 train loss: 38.644880 Time: 552.83
Run: 36 VAL ap_score: 0.800758 map_score: 0.782162 Time: 208.74
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 37 train loss: 38.370652 Time: 549.41
Run: 37 VAL ap_score: 0.790955 map_score: 0.773533 Time: 197.86
Run: 38 train loss: 37.094510 Time: 555.40
Run: 38 VAL ap_score: 0.812517 map_score: 0.791281 Time: 210.69
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 39 train loss: 36.708469 Time: 561.30
Run: 39 VAL ap_score: 0.786904 map_score: 0.768704 Time: 204.14
Run: 40 train loss: 37.245408 Time: 543.31
Run: 40 VAL ap_score: 0.805210 map_score: 0.785571 Time: 206.45
Run: 41 train loss: 35.519546 Time: 554.70
Run: 41 VAL ap_score: 0.820153 map_score: 0.794123 Time: 224.12
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 42 train loss: 35.717122 Time: 739.28
Run: 42 VAL ap_score: 0.811156 map_score: 0.784835 Time: 264.38
Run: 43 train loss: 35.968778 Time: 634.28
Run: 43 VAL ap_score: 0.813725 map_score: 0.796648 Time: 296.37
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 44 train loss: 35.233246 Time: 780.23
Run: 44 VAL ap_score: 0.815840 map_score: 0.796849 Time: 287.97
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 45 train loss: 35.314573 Time: 750.85
Run: 45 VAL ap_score: 0.794716 map_score: 0.781816 Time: 245.58
Run: 46 train loss: 34.730435 Time: 695.30
Run: 46 VAL ap_score: 0.817698 map_score: 0.796171 Time: 211.57
Run: 47 train loss: 33.937456 Time: 561.10
Run: 47 VAL ap_score: 0.817953 map_score: 0.787901 Time: 206.73
Run: 48 train loss: 40.255972 Time: 568.48
Run: 48 VAL ap_score: 0.815350 map_score: 0.792677 Time: 209.06
Run: 49 train loss: 32.998270 Time: 556.95
Run: 49 VAL ap_score: 0.798461 map_score: 0.780785 Time: 217.39
Run: 50 train loss: 34.365214 Time: 571.19
Run: 50 VAL ap_score: 0.803547 map_score: 0.786414 Time: 210.07
Run: 51 train loss: 32.641624 Time: 570.73
Run: 51 VAL ap_score: 0.807761 map_score: 0.796070 Time: 233.59
Run: 52 train loss: 33.589464 Time: 577.36
Run: 52 VAL ap_score: 0.832975 map_score: 0.812042 Time: 220.45
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 53 train loss: 32.714366 Time: 568.93
Run: 53 VAL ap_score: 0.807147 map_score: 0.784960 Time: 219.83
Run: 54 train loss: 32.327421 Time: 580.93
Run: 54 VAL ap_score: 0.811839 map_score: 0.787252 Time: 216.07
Run: 55 train loss: 32.115287 Time: 569.39
Run: 55 VAL ap_score: 0.813153 map_score: 0.798282 Time: 216.26
Run: 56 train loss: 31.998213 Time: 561.06
Run: 56 VAL ap_score: 0.810829 map_score: 0.798488 Time: 223.85
Run: 57 train loss: 31.902071 Time: 560.93
Run: 57 VAL ap_score: 0.826274 map_score: 0.805939 Time: 249.84
Run: 58 train loss: 31.738694 Time: 643.93
Run: 58 VAL ap_score: 0.826473 map_score: 0.803374 Time: 276.72
Run: 59 train loss: 31.900525 Time: 635.12
Run: 59 VAL ap_score: 0.817207 map_score: 0.800002 Time: 244.37
Run: 60 train loss: 31.664584 Time: 585.32
Run: 60 VAL ap_score: 0.817897 map_score: 0.796098 Time: 225.38
Run: 61 train loss: 31.865968 Time: 573.47
Run: 61 VAL ap_score: 0.829954 map_score: 0.810125 Time: 214.11
Run: 62 train loss: 30.981174 Time: 558.96
Run: 62 VAL ap_score: 0.802418 map_score: 0.783473 Time: 213.14
Run: 63 train loss: 31.906514 Time: 574.46
Run: 63 VAL ap_score: 0.823173 map_score: 0.807491 Time: 257.60
Run: 64 train loss: 30.022954 Time: 612.96
Run: 64 VAL ap_score: 0.829081 map_score: 0.815808 Time: 225.20
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 65 train loss: 31.204561 Time: 551.68
Run: 65 VAL ap_score: 0.809519 map_score: 0.795636 Time: 235.27
Run: 66 train loss: 31.289642 Time: 623.85
Run: 66 VAL ap_score: 0.825812 map_score: 0.808660 Time: 246.02
Run: 67 train loss: 30.670489 Time: 599.65
Run: 67 VAL ap_score: 0.838196 map_score: 0.810982 Time: 215.78
Run: 68 train loss: 30.104672 Time: 567.11
Run: 68 VAL ap_score: 0.802440 map_score: 0.787633 Time: 215.26
Run: 69 train loss: 29.689422 Time: 580.87
Run: 69 VAL ap_score: 0.838972 map_score: 0.816155 Time: 220.00
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 70 train loss: 30.583806 Time: 569.59
Run: 70 VAL ap_score: 0.832044 map_score: 0.808808 Time: 214.71
Run: 71 train loss: 30.101648 Time: 572.49
Run: 71 VAL ap_score: 0.838891 map_score: 0.824158 Time: 209.29
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_00:48:34.843614
Run: 72 train loss: 29.699018 Time: 562.32
Run: 72 VAL ap_score: 0.807497 map_score: 0.794483 Time: 184.55
Run: 73 train loss: 30.310340 Time: 558.08
Run: 73 VAL ap_score: 0.822405 map_score: 0.808335 Time: 215.70
Run: 74 train loss: 29.893240 Time: 570.52
Run: 74 VAL ap_score: 0.773247 map_score: 0.760510 Time: 214.29
Run: 75 train loss: 30.680656 Time: 678.23
Run: 75 VAL ap_score: 0.831661 map_score: 0.808476 Time: 274.37
Run: 76 train loss: 29.676635 Time: 744.89
Run: 76 VAL ap_score: 0.810351 map_score: 0.798492 Time: 316.74
Run: 77 train loss: 28.867196 Time: 708.25
Run: 77 VAL ap_score: 0.827586 map_score: 0.803938 Time: 262.81
