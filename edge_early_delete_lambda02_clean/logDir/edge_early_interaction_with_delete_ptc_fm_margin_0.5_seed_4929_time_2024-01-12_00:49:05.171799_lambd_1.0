Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda02_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fm
--interpretability_lambda=0.2
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4929
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda02_clean/initialModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
no. of params in model: 3730
Run: 0 train loss: 271.396013 Time: 804.30
Run: 0 VAL ap_score: 0.530922 map_score: 0.552065 Time: 251.46
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 1 train loss: 174.627247 Time: 509.67
Run: 1 VAL ap_score: 0.545766 map_score: 0.557714 Time: 205.14
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 2 train loss: 152.290000 Time: 643.05
Run: 2 VAL ap_score: 0.566146 map_score: 0.564588 Time: 253.51
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 3 train loss: 135.605706 Time: 647.83
Run: 3 VAL ap_score: 0.616543 map_score: 0.637438 Time: 250.94
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 4 train loss: 121.276874 Time: 636.97
Run: 4 VAL ap_score: 0.667540 map_score: 0.672104 Time: 250.73
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 5 train loss: 109.899280 Time: 646.29
Run: 5 VAL ap_score: 0.629059 map_score: 0.669460 Time: 248.10
Run: 6 train loss: 104.151032 Time: 641.99
Run: 6 VAL ap_score: 0.651542 map_score: 0.678100 Time: 244.94
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 7 train loss: 99.894920 Time: 649.00
Run: 7 VAL ap_score: 0.618834 map_score: 0.665533 Time: 241.82
Run: 8 train loss: 96.170500 Time: 633.15
Run: 8 VAL ap_score: 0.653782 map_score: 0.678154 Time: 238.03
Run: 9 train loss: 92.280646 Time: 643.21
Run: 9 VAL ap_score: 0.686579 map_score: 0.700036 Time: 245.60
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 10 train loss: 91.093484 Time: 651.70
Run: 10 VAL ap_score: 0.691240 map_score: 0.691822 Time: 243.28
Run: 11 train loss: 87.100153 Time: 646.76
Run: 11 VAL ap_score: 0.669522 map_score: 0.692908 Time: 253.26
Run: 12 train loss: 84.235151 Time: 657.92
Run: 12 VAL ap_score: 0.715394 map_score: 0.721008 Time: 245.50
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 13 train loss: 79.637349 Time: 650.53
Run: 13 VAL ap_score: 0.713293 map_score: 0.729921 Time: 245.41
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 14 train loss: 78.215352 Time: 647.18
Run: 14 VAL ap_score: 0.673858 map_score: 0.721789 Time: 251.71
Run: 15 train loss: 76.003597 Time: 656.52
Run: 15 VAL ap_score: 0.704002 map_score: 0.722399 Time: 238.54
Run: 16 train loss: 74.308006 Time: 647.14
Run: 16 VAL ap_score: 0.658835 map_score: 0.716543 Time: 244.96
Run: 17 train loss: 70.756534 Time: 638.65
Run: 17 VAL ap_score: 0.685013 map_score: 0.730154 Time: 235.30
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 18 train loss: 68.610760 Time: 647.87
Run: 18 VAL ap_score: 0.719014 map_score: 0.750729 Time: 243.68
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 19 train loss: 67.190059 Time: 633.57
Run: 19 VAL ap_score: 0.728598 map_score: 0.750153 Time: 251.81
Run: 20 train loss: 64.643653 Time: 631.29
Run: 20 VAL ap_score: 0.685927 map_score: 0.739944 Time: 246.44
Run: 21 train loss: 63.712552 Time: 648.62
Run: 21 VAL ap_score: 0.693266 map_score: 0.734587 Time: 239.67
Run: 22 train loss: 61.628989 Time: 660.80
Run: 22 VAL ap_score: 0.725564 map_score: 0.747427 Time: 241.68
Run: 23 train loss: 59.237089 Time: 652.70
Run: 23 VAL ap_score: 0.672300 map_score: 0.735860 Time: 244.98
Run: 24 train loss: 60.199761 Time: 655.66
Run: 24 VAL ap_score: 0.691558 map_score: 0.745843 Time: 241.03
Run: 25 train loss: 57.173173 Time: 651.07
Run: 25 VAL ap_score: 0.737409 map_score: 0.765026 Time: 242.16
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 26 train loss: 56.001795 Time: 637.76
Run: 26 VAL ap_score: 0.724520 map_score: 0.758904 Time: 243.19
Run: 27 train loss: 56.014412 Time: 642.54
Run: 27 VAL ap_score: 0.740216 map_score: 0.762554 Time: 245.18
Run: 28 train loss: 54.106073 Time: 646.72
Run: 28 VAL ap_score: 0.741848 map_score: 0.753462 Time: 252.69
Run: 29 train loss: 52.923353 Time: 649.73
Run: 29 VAL ap_score: 0.736035 map_score: 0.770585 Time: 243.24
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 30 train loss: 50.224056 Time: 661.15
Run: 30 VAL ap_score: 0.723746 map_score: 0.782531 Time: 244.94
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 31 train loss: 49.324705 Time: 645.49
Run: 31 VAL ap_score: 0.778851 map_score: 0.787403 Time: 251.77
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 32 train loss: 48.069152 Time: 630.25
Run: 32 VAL ap_score: 0.764508 map_score: 0.781522 Time: 247.56
Run: 33 train loss: 47.146622 Time: 660.43
Run: 33 VAL ap_score: 0.756580 map_score: 0.784534 Time: 238.74
Run: 34 train loss: 46.898131 Time: 651.48
Run: 34 VAL ap_score: 0.656037 map_score: 0.759599 Time: 240.29
Run: 35 train loss: 46.322920 Time: 758.42
Run: 35 VAL ap_score: 0.765797 map_score: 0.782293 Time: 315.55
Run: 36 train loss: 44.979102 Time: 925.99
Run: 36 VAL ap_score: 0.775008 map_score: 0.787706 Time: 364.98
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 37 train loss: 43.538193 Time: 639.37
Run: 37 VAL ap_score: 0.751045 map_score: 0.792612 Time: 227.35
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 38 train loss: 42.143573 Time: 607.88
Run: 38 VAL ap_score: 0.778796 map_score: 0.813131 Time: 239.21
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 39 train loss: 41.315963 Time: 618.83
Run: 39 VAL ap_score: 0.800739 map_score: 0.820558 Time: 231.02
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 40 train loss: 39.917625 Time: 630.82
Run: 40 VAL ap_score: 0.731151 map_score: 0.794904 Time: 256.00
Run: 41 train loss: 40.093822 Time: 632.72
Run: 41 VAL ap_score: 0.806672 map_score: 0.824091 Time: 258.17
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 42 train loss: 39.336956 Time: 632.77
Run: 42 VAL ap_score: 0.803359 map_score: 0.829375 Time: 217.59
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 43 train loss: 38.420745 Time: 529.70
Run: 43 VAL ap_score: 0.759089 map_score: 0.802878 Time: 207.99
Run: 44 train loss: 36.904489 Time: 521.64
Run: 44 VAL ap_score: 0.782214 map_score: 0.830771 Time: 207.67
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 45 train loss: 37.103267 Time: 519.33
Run: 45 VAL ap_score: 0.819273 map_score: 0.835191 Time: 198.71
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 46 train loss: 35.951636 Time: 510.22
Run: 46 VAL ap_score: 0.820796 map_score: 0.831199 Time: 193.77
Run: 47 train loss: 35.823542 Time: 499.70
Run: 47 VAL ap_score: 0.726204 map_score: 0.788493 Time: 186.62
Run: 48 train loss: 35.663773 Time: 510.66
Run: 48 VAL ap_score: 0.792422 map_score: 0.834196 Time: 191.49
Run: 49 train loss: 33.997608 Time: 524.37
Run: 49 VAL ap_score: 0.811022 map_score: 0.839178 Time: 199.84
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 50 train loss: 34.386845 Time: 521.43
Run: 50 VAL ap_score: 0.814813 map_score: 0.846558 Time: 202.82
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 51 train loss: 33.524175 Time: 523.17
Run: 51 VAL ap_score: 0.752982 map_score: 0.817339 Time: 195.54
Run: 52 train loss: 33.350529 Time: 517.49
Run: 52 VAL ap_score: 0.758187 map_score: 0.817789 Time: 201.62
Run: 53 train loss: 32.069553 Time: 499.23
Run: 53 VAL ap_score: 0.803940 map_score: 0.830222 Time: 200.23
Run: 54 train loss: 31.530594 Time: 537.73
Run: 54 VAL ap_score: 0.822169 map_score: 0.842510 Time: 194.66
Run: 55 train loss: 31.277717 Time: 524.68
Run: 55 VAL ap_score: 0.807802 map_score: 0.836369 Time: 204.46
Run: 56 train loss: 32.033881 Time: 534.60
Run: 56 VAL ap_score: 0.790612 map_score: 0.849812 Time: 205.62
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 57 train loss: 30.166648 Time: 542.71
Run: 57 VAL ap_score: 0.815103 map_score: 0.843248 Time: 213.04
Run: 58 train loss: 30.312839 Time: 555.19
Run: 58 VAL ap_score: 0.783081 map_score: 0.834745 Time: 216.40
Run: 59 train loss: 29.595625 Time: 531.84
Run: 59 VAL ap_score: 0.798068 map_score: 0.845050 Time: 193.24
Run: 60 train loss: 29.281637 Time: 514.16
Run: 60 VAL ap_score: 0.837719 map_score: 0.864406 Time: 198.18
saving best validated model to ./edge_early_delete_lambda02_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fm_4929_2024-01-12_00:49:05.171799
Run: 61 train loss: 29.674067 Time: 529.73
Run: 61 VAL ap_score: 0.792389 map_score: 0.853004 Time: 196.50
Run: 62 train loss: 29.589687 Time: 521.40
Run: 62 VAL ap_score: 0.823328 map_score: 0.855785 Time: 207.49
Run: 63 train loss: 28.913197 Time: 539.84
Run: 63 VAL ap_score: 0.805593 map_score: 0.845057 Time: 204.93
Run: 64 train loss: 28.560478 Time: 529.17
Run: 64 VAL ap_score: 0.763883 map_score: 0.822285 Time: 206.93
Run: 65 train loss: 28.863686 Time: 551.25
Run: 65 VAL ap_score: 0.829355 map_score: 0.856924 Time: 203.30
Run: 66 train loss: 28.935132 Time: 538.20
Run: 66 VAL ap_score: 0.799925 map_score: 0.855262 Time: 198.34
Run: 67 train loss: 29.424905 Time: 537.29
Run: 67 VAL ap_score: 0.804817 map_score: 0.830904 Time: 207.89
Run: 68 train loss: 27.645182 Time: 523.13
Run: 68 VAL ap_score: 0.819861 map_score: 0.859308 Time: 202.26
Run: 69 train loss: 28.117659 Time: 548.73
Run: 69 VAL ap_score: 0.798490 map_score: 0.845573 Time: 204.21
Run: 70 train loss: 27.414248 Time: 533.12
Run: 70 VAL ap_score: 0.794342 map_score: 0.848160 Time: 208.92
Run: 71 train loss: 26.516007 Time: 511.45
Run: 71 VAL ap_score: 0.791863 map_score: 0.856559 Time: 202.23
Run: 72 train loss: 27.367674 Time: 501.09
Run: 72 VAL ap_score: 0.810620 map_score: 0.846308 Time: 194.18
Run: 73 train loss: 26.569852 Time: 629.02
Run: 73 VAL ap_score: 0.824815 map_score: 0.847234 Time: 312.07
