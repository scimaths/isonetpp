Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl
--TASK=gmn_match_hinge_lrl
--MARGIN=0.5
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4929
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl
saving initial model to ./gmn_match_hinge_lrl/initialModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
no. of params in model: 2498
Run: 0 train loss: 274.963936 Time: 459.02
Run: 0 VAL ap_score: 0.445377 map_score: 0.467413 Time: 129.96
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 1 train loss: 194.337732 Time: 612.37
Run: 1 VAL ap_score: 0.488743 map_score: 0.515542 Time: 237.53
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 2 train loss: 167.123760 Time: 493.27
Run: 2 VAL ap_score: 0.517702 map_score: 0.537841 Time: 259.96
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 3 train loss: 158.032757 Time: 889.16
Run: 3 VAL ap_score: 0.472314 map_score: 0.480231 Time: 361.42
Run: 4 train loss: 152.562367 Time: 888.50
Run: 4 VAL ap_score: 0.552336 map_score: 0.560509 Time: 363.11
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 5 train loss: 146.532881 Time: 885.57
Run: 5 VAL ap_score: 0.548175 map_score: 0.565890 Time: 364.84
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 6 train loss: 141.258230 Time: 884.30
Run: 6 VAL ap_score: 0.569236 map_score: 0.584594 Time: 365.55
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 7 train loss: 137.000819 Time: 884.06
Run: 7 VAL ap_score: 0.539338 map_score: 0.550552 Time: 366.77
Run: 8 train loss: 135.071865 Time: 881.63
Run: 8 VAL ap_score: 0.581931 map_score: 0.595025 Time: 367.51
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 9 train loss: 131.729728 Time: 881.46
Run: 9 VAL ap_score: 0.584274 map_score: 0.590225 Time: 369.00
Run: 10 train loss: 130.852944 Time: 880.09
Run: 10 VAL ap_score: 0.570222 map_score: 0.585673 Time: 370.39
Run: 11 train loss: 127.497151 Time: 877.50
Run: 11 VAL ap_score: 0.579967 map_score: 0.589625 Time: 370.73
Run: 12 train loss: 125.281097 Time: 877.35
Run: 12 VAL ap_score: 0.592806 map_score: 0.592882 Time: 370.48
Run: 13 train loss: 122.018144 Time: 878.08
Run: 13 VAL ap_score: 0.591644 map_score: 0.594907 Time: 371.01
Run: 14 train loss: 120.597898 Time: 878.42
Run: 14 VAL ap_score: 0.590104 map_score: 0.598919 Time: 371.27
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 15 train loss: 118.021146 Time: 876.48
Run: 15 VAL ap_score: 0.592694 map_score: 0.610177 Time: 371.73
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 16 train loss: 116.421835 Time: 877.41
Run: 16 VAL ap_score: 0.599646 map_score: 0.613188 Time: 371.92
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 17 train loss: 115.461979 Time: 876.33
Run: 17 VAL ap_score: 0.587830 map_score: 0.597801 Time: 372.08
Run: 18 train loss: 114.025941 Time: 876.71
Run: 18 VAL ap_score: 0.587312 map_score: 0.606686 Time: 371.64
Run: 19 train loss: 112.029450 Time: 875.87
Run: 19 VAL ap_score: 0.596749 map_score: 0.608857 Time: 372.15
Run: 20 train loss: 110.741267 Time: 875.70
Run: 20 VAL ap_score: 0.578581 map_score: 0.594514 Time: 372.26
Run: 21 train loss: 110.667080 Time: 875.64
Run: 21 VAL ap_score: 0.598265 map_score: 0.616718 Time: 373.22
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 22 train loss: 110.049749 Time: 875.81
Run: 22 VAL ap_score: 0.602940 map_score: 0.610896 Time: 372.57
Run: 23 train loss: 108.316295 Time: 875.46
Run: 23 VAL ap_score: 0.606997 map_score: 0.617486 Time: 373.44
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 24 train loss: 108.454341 Time: 875.06
Run: 24 VAL ap_score: 0.578825 map_score: 0.595954 Time: 373.49
Run: 25 train loss: 107.882184 Time: 874.21
Run: 25 VAL ap_score: 0.604825 map_score: 0.620455 Time: 373.83
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 26 train loss: 106.503509 Time: 873.54
Run: 26 VAL ap_score: 0.598450 map_score: 0.606175 Time: 373.68
Run: 27 train loss: 105.658634 Time: 874.40
Run: 27 VAL ap_score: 0.601828 map_score: 0.623074 Time: 373.37
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 28 train loss: 104.207700 Time: 875.42
Run: 28 VAL ap_score: 0.596400 map_score: 0.609283 Time: 371.76
Run: 29 train loss: 104.417417 Time: 508.10
Run: 29 VAL ap_score: 0.593783 map_score: 0.603704 Time: 130.79
Run: 30 train loss: 103.582156 Time: 389.24
Run: 30 VAL ap_score: 0.589474 map_score: 0.597476 Time: 132.04
Run: 31 train loss: 102.690600 Time: 386.63
Run: 31 VAL ap_score: 0.625756 map_score: 0.634894 Time: 130.30
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 32 train loss: 101.959744 Time: 387.30
Run: 32 VAL ap_score: 0.618993 map_score: 0.627226 Time: 130.63
Run: 33 train loss: 100.425570 Time: 388.16
Run: 33 VAL ap_score: 0.614377 map_score: 0.624563 Time: 130.40
Run: 34 train loss: 100.679236 Time: 386.60
Run: 34 VAL ap_score: 0.621993 map_score: 0.634168 Time: 130.53
Run: 35 train loss: 100.227495 Time: 386.27
Run: 35 VAL ap_score: 0.612479 map_score: 0.620988 Time: 130.13
Run: 36 train loss: 99.475018 Time: 387.11
Run: 36 VAL ap_score: 0.625912 map_score: 0.638574 Time: 130.15
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 37 train loss: 98.218503 Time: 389.01
Run: 37 VAL ap_score: 0.616661 map_score: 0.632188 Time: 129.92
Run: 38 train loss: 97.952460 Time: 388.56
Run: 38 VAL ap_score: 0.620567 map_score: 0.632188 Time: 129.91
Run: 39 train loss: 97.538403 Time: 389.40
Run: 39 VAL ap_score: 0.616971 map_score: 0.627986 Time: 129.59
Run: 40 train loss: 98.137734 Time: 400.82
Run: 40 VAL ap_score: 0.586114 map_score: 0.603057 Time: 136.46
Run: 41 train loss: 97.327580 Time: 418.09
Run: 41 VAL ap_score: 0.627244 map_score: 0.637327 Time: 136.47
Run: 42 train loss: 97.403651 Time: 388.54
Run: 42 VAL ap_score: 0.622310 map_score: 0.635460 Time: 132.00
Run: 43 train loss: 95.632491 Time: 386.90
Run: 43 VAL ap_score: 0.608411 map_score: 0.629585 Time: 130.59
Run: 44 train loss: 95.881801 Time: 390.32
Run: 44 VAL ap_score: 0.634787 map_score: 0.638014 Time: 130.70
Run: 45 train loss: 95.202334 Time: 397.59
Run: 45 VAL ap_score: 0.615425 map_score: 0.623486 Time: 133.17
Run: 46 train loss: 94.982488 Time: 400.62
Run: 46 VAL ap_score: 0.628207 map_score: 0.631415 Time: 135.08
Run: 47 train loss: 94.155249 Time: 467.01
Run: 47 VAL ap_score: 0.609817 map_score: 0.626446 Time: 179.81
Run: 48 train loss: 94.858307 Time: 470.50
Run: 48 VAL ap_score: 0.612322 map_score: 0.622990 Time: 132.94
Run: 49 train loss: 93.293989 Time: 395.93
Run: 49 VAL ap_score: 0.593817 map_score: 0.615673 Time: 133.20
Run: 50 train loss: 93.478427 Time: 574.19
Run: 50 VAL ap_score: 0.627902 map_score: 0.634543 Time: 245.59
Run: 51 train loss: 94.449059 Time: 604.46
Run: 51 VAL ap_score: 0.616327 map_score: 0.630383 Time: 240.82
Run: 52 train loss: 91.775952 Time: 601.93
Run: 52 VAL ap_score: 0.638795 map_score: 0.643852 Time: 239.13
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 53 train loss: 92.070742 Time: 598.93
Run: 53 VAL ap_score: 0.621538 map_score: 0.640436 Time: 239.76
Run: 54 train loss: 92.518803 Time: 597.96
Run: 54 VAL ap_score: 0.622260 map_score: 0.627896 Time: 240.05
Run: 55 train loss: 92.062033 Time: 601.51
Run: 55 VAL ap_score: 0.616515 map_score: 0.630198 Time: 238.38
Run: 56 train loss: 91.386063 Time: 589.54
Run: 56 VAL ap_score: 0.633477 map_score: 0.647130 Time: 243.31
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 57 train loss: 91.029687 Time: 624.66
Run: 57 VAL ap_score: 0.623903 map_score: 0.631113 Time: 243.40
Run: 58 train loss: 90.842037 Time: 620.72
Run: 58 VAL ap_score: 0.623361 map_score: 0.638260 Time: 240.74
Run: 59 train loss: 90.063281 Time: 616.59
Run: 59 VAL ap_score: 0.632592 map_score: 0.633966 Time: 241.14
Run: 60 train loss: 90.868431 Time: 617.23
Run: 60 VAL ap_score: 0.631061 map_score: 0.639129 Time: 238.08
Run: 61 train loss: 90.372348 Time: 595.65
Run: 61 VAL ap_score: 0.620929 map_score: 0.632564 Time: 236.06
Run: 62 train loss: 90.218492 Time: 592.40
Run: 62 VAL ap_score: 0.620998 map_score: 0.631242 Time: 236.45
Run: 63 train loss: 90.005772 Time: 591.99
Run: 63 VAL ap_score: 0.625908 map_score: 0.635242 Time: 235.54
Run: 64 train loss: 89.163143 Time: 590.73
Run: 64 VAL ap_score: 0.640756 map_score: 0.646992 Time: 234.83
Run: 65 train loss: 89.178204 Time: 589.60
Run: 65 VAL ap_score: 0.623706 map_score: 0.636541 Time: 236.17
Run: 66 train loss: 89.256578 Time: 418.90
Run: 66 VAL ap_score: 0.579428 map_score: 0.603370 Time: 131.33
Run: 67 train loss: 89.130562 Time: 386.30
Run: 67 VAL ap_score: 0.634207 map_score: 0.640257 Time: 132.09
Run: 68 train loss: 88.129586 Time: 386.69
Run: 68 VAL ap_score: 0.631789 map_score: 0.636804 Time: 131.63
Run: 69 train loss: 87.583144 Time: 387.17
Run: 69 VAL ap_score: 0.636555 map_score: 0.635780 Time: 132.34
Run: 70 train loss: 87.843620 Time: 387.74
Run: 70 VAL ap_score: 0.633868 map_score: 0.647646 Time: 132.37
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 71 train loss: 87.356305 Time: 385.94
Run: 71 VAL ap_score: 0.642068 map_score: 0.645669 Time: 132.62
Run: 72 train loss: 87.204433 Time: 386.47
Run: 72 VAL ap_score: 0.618650 map_score: 0.635138 Time: 132.31
Run: 73 train loss: 86.304212 Time: 386.38
Run: 73 VAL ap_score: 0.641134 map_score: 0.643521 Time: 132.52
Run: 74 train loss: 87.036389 Time: 387.75
Run: 74 VAL ap_score: 0.598537 map_score: 0.613992 Time: 132.95
Run: 75 train loss: 86.716427 Time: 386.42
Run: 75 VAL ap_score: 0.651145 map_score: 0.647819 Time: 132.98
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 76 train loss: 85.906912 Time: 386.31
Run: 76 VAL ap_score: 0.616036 map_score: 0.634578 Time: 132.78
Run: 77 train loss: 86.471538 Time: 386.50
Run: 77 VAL ap_score: 0.647185 map_score: 0.645775 Time: 130.63
Run: 78 train loss: 86.005606 Time: 386.81
Run: 78 VAL ap_score: 0.634411 map_score: 0.637400 Time: 131.94
Run: 79 train loss: 85.316918 Time: 385.59
Run: 79 VAL ap_score: 0.642530 map_score: 0.652451 Time: 132.85
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 80 train loss: 85.342362 Time: 386.34
Run: 80 VAL ap_score: 0.633748 map_score: 0.641650 Time: 132.39
Run: 81 train loss: 85.421506 Time: 386.83
Run: 81 VAL ap_score: 0.626162 map_score: 0.634801 Time: 132.77
Run: 82 train loss: 85.843216 Time: 384.45
Run: 82 VAL ap_score: 0.631219 map_score: 0.640336 Time: 132.00
Run: 83 train loss: 85.605101 Time: 384.51
Run: 83 VAL ap_score: 0.607657 map_score: 0.626008 Time: 132.58
Run: 84 train loss: 84.132613 Time: 483.68
Run: 84 VAL ap_score: 0.649900 map_score: 0.646885 Time: 234.56
Run: 85 train loss: 84.827856 Time: 451.05
Run: 85 VAL ap_score: 0.631799 map_score: 0.639189 Time: 132.35
Run: 86 train loss: 84.890611 Time: 385.88
Run: 86 VAL ap_score: 0.629010 map_score: 0.638577 Time: 133.28
Run: 87 train loss: 83.792819 Time: 405.37
Run: 87 VAL ap_score: 0.630365 map_score: 0.640119 Time: 138.78
Run: 88 train loss: 83.907778 Time: 409.63
Run: 88 VAL ap_score: 0.654726 map_score: 0.658297 Time: 138.85
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 89 train loss: 83.135216 Time: 409.80
Run: 89 VAL ap_score: 0.648947 map_score: 0.650469 Time: 137.70
Run: 90 train loss: 83.468870 Time: 436.01
Run: 90 VAL ap_score: 0.583722 map_score: 0.602935 Time: 203.71
Run: 91 train loss: 83.301136 Time: 514.90
Run: 91 VAL ap_score: 0.649727 map_score: 0.655613 Time: 200.39
Run: 92 train loss: 82.940960 Time: 533.93
Run: 92 VAL ap_score: 0.628131 map_score: 0.641459 Time: 208.96
Run: 93 train loss: 82.915190 Time: 526.96
Run: 93 VAL ap_score: 0.646409 map_score: 0.654118 Time: 228.82
Run: 94 train loss: 82.731387 Time: 562.26
Run: 94 VAL ap_score: 0.635945 map_score: 0.650058 Time: 221.59
Run: 95 train loss: 82.164484 Time: 392.03
Run: 95 VAL ap_score: 0.651798 map_score: 0.661270 Time: 131.27
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 96 train loss: 82.322933 Time: 388.96
Run: 96 VAL ap_score: 0.628011 map_score: 0.647878 Time: 171.36
Run: 97 train loss: 81.770854 Time: 467.82
Run: 97 VAL ap_score: 0.629989 map_score: 0.638664 Time: 178.04
Run: 98 train loss: 82.375586 Time: 466.21
Run: 98 VAL ap_score: 0.609293 map_score: 0.637852 Time: 178.16
Run: 99 train loss: 81.001217 Time: 466.35
Run: 99 VAL ap_score: 0.644600 map_score: 0.653049 Time: 176.30
Run: 100 train loss: 80.855887 Time: 458.93
Run: 100 VAL ap_score: 0.645755 map_score: 0.665247 Time: 164.55
saving best validated model to ./gmn_match_hinge_lrl/bestValidationModels/gmn_match_hinge_lrl_ptc_fm_4929_2024-01-21_23:25:24.507678
Run: 101 train loss: 82.113712 Time: 473.58
Run: 101 VAL ap_score: 0.647377 map_score: 0.651939 Time: 167.94
Run: 102 train loss: 80.631583 Time: 474.07
Run: 102 VAL ap_score: 0.644533 map_score: 0.654939 Time: 164.83
Run: 103 train loss: 81.309304 Time: 477.96
Run: 103 VAL ap_score: 0.644563 map_score: 0.658910 Time: 166.26
Run: 104 train loss: 80.712086 Time: 477.20
Run: 104 VAL ap_score: 0.651674 map_score: 0.660332 Time: 164.90
