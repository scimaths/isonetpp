Experiment greed_hinge for model: 'greed', dataset: 'ptc_mr_large', seed: 1704 started at time: 2024-05-07_10:41:51
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id greed_hinge
--experiment_dir experiments/
--model_config_path configs/greed.yaml
--dataset_name ptc_mr
--seed 1704
--dataset_size large
--margin 0.5
loaded train query graphs from ./large_dataset/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
saving intial model to experiments/greed_hinge/initial_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
no. of params in model: 1840
Run: 0 train loss: 331.871446 Time: 153.86
Run: 0 VAL ap_score: 0.286494 map_score: 0.322859 Time: 65.33
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 1 train loss: 299.573855 Time: 136.99
Run: 1 VAL ap_score: 0.266533 map_score: 0.299230 Time: 59.88
Run: 2 train loss: 274.916692 Time: 140.23
Run: 2 VAL ap_score: 0.354132 map_score: 0.387136 Time: 59.61
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 3 train loss: 262.488601 Time: 141.55
Run: 3 VAL ap_score: 0.360263 map_score: 0.381762 Time: 59.87
Run: 4 train loss: 243.753485 Time: 139.12
Run: 4 VAL ap_score: 0.388252 map_score: 0.396899 Time: 71.40
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 5 train loss: 220.536882 Time: 211.72
Run: 5 VAL ap_score: 0.402971 map_score: 0.416265 Time: 111.29
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 6 train loss: 207.313734 Time: 278.87
Run: 6 VAL ap_score: 0.410923 map_score: 0.428547 Time: 127.82
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 7 train loss: 202.092616 Time: 280.29
Run: 7 VAL ap_score: 0.409007 map_score: 0.425128 Time: 115.90
Run: 8 train loss: 196.549442 Time: 283.16
Run: 8 VAL ap_score: 0.409532 map_score: 0.411465 Time: 122.93
Run: 9 train loss: 194.381306 Time: 273.65
Run: 9 VAL ap_score: 0.419671 map_score: 0.434100 Time: 125.76
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 10 train loss: 192.025832 Time: 285.80
Run: 10 VAL ap_score: 0.431646 map_score: 0.441561 Time: 117.33
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 11 train loss: 189.097504 Time: 284.29
Run: 11 VAL ap_score: 0.431787 map_score: 0.437863 Time: 122.47
Run: 12 train loss: 189.417595 Time: 279.55
Run: 12 VAL ap_score: 0.408306 map_score: 0.409325 Time: 115.26
Run: 13 train loss: 186.050329 Time: 284.94
Run: 13 VAL ap_score: 0.437595 map_score: 0.452063 Time: 123.91
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 14 train loss: 185.442521 Time: 282.25
Run: 14 VAL ap_score: 0.436772 map_score: 0.448451 Time: 124.61
Run: 15 train loss: 183.128659 Time: 274.03
Run: 15 VAL ap_score: 0.381884 map_score: 0.389964 Time: 119.69
Run: 16 train loss: 182.058581 Time: 281.61
Run: 16 VAL ap_score: 0.435302 map_score: 0.433650 Time: 125.30
Run: 17 train loss: 182.015719 Time: 255.63
Run: 17 VAL ap_score: 0.442982 map_score: 0.452483 Time: 101.20
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 18 train loss: 179.414297 Time: 235.27
Run: 18 VAL ap_score: 0.453974 map_score: 0.461765 Time: 107.56
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 19 train loss: 178.408444 Time: 237.05
Run: 19 VAL ap_score: 0.454956 map_score: 0.453864 Time: 102.34
Run: 20 train loss: 177.201762 Time: 252.26
Run: 20 VAL ap_score: 0.422210 map_score: 0.427014 Time: 106.80
Run: 21 train loss: 177.320873 Time: 243.67
Run: 21 VAL ap_score: 0.424270 map_score: 0.423596 Time: 105.38
Run: 22 train loss: 176.172436 Time: 256.10
Run: 22 VAL ap_score: 0.445350 map_score: 0.443448 Time: 112.80
Run: 23 train loss: 174.696149 Time: 252.69
Run: 23 VAL ap_score: 0.428565 map_score: 0.428701 Time: 95.66
Run: 24 train loss: 172.988612 Time: 230.88
Run: 24 VAL ap_score: 0.421929 map_score: 0.427443 Time: 133.50
Run: 25 train loss: 172.715128 Time: 241.36
Run: 25 VAL ap_score: 0.464659 map_score: 0.467372 Time: 112.18
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 26 train loss: 172.865450 Time: 288.99
Run: 26 VAL ap_score: 0.469507 map_score: 0.471573 Time: 132.42
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 27 train loss: 171.569636 Time: 300.57
Run: 27 VAL ap_score: 0.452882 map_score: 0.447961 Time: 121.49
Run: 28 train loss: 171.357085 Time: 301.75
Run: 28 VAL ap_score: 0.459185 map_score: 0.459368 Time: 117.36
Run: 29 train loss: 171.303323 Time: 306.05
Run: 29 VAL ap_score: 0.463780 map_score: 0.465077 Time: 119.89
Run: 30 train loss: 170.052913 Time: 293.63
Run: 30 VAL ap_score: 0.445750 map_score: 0.453311 Time: 132.81
Run: 31 train loss: 168.736555 Time: 295.03
Run: 31 VAL ap_score: 0.451413 map_score: 0.453395 Time: 124.39
Run: 32 train loss: 169.823656 Time: 305.65
Run: 32 VAL ap_score: 0.434378 map_score: 0.437106 Time: 130.65
Run: 33 train loss: 168.526013 Time: 275.68
Run: 33 VAL ap_score: 0.468060 map_score: 0.462310 Time: 128.87
Run: 34 train loss: 168.912663 Time: 294.74
Run: 34 VAL ap_score: 0.456516 map_score: 0.461355 Time: 130.78
Run: 35 train loss: 167.194573 Time: 289.90
Run: 35 VAL ap_score: 0.452579 map_score: 0.469445 Time: 127.80
Run: 36 train loss: 167.569428 Time: 288.17
Run: 36 VAL ap_score: 0.484682 map_score: 0.478778 Time: 104.31
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 37 train loss: 165.975004 Time: 252.81
Run: 37 VAL ap_score: 0.463981 map_score: 0.466540 Time: 101.72
Run: 38 train loss: 167.128172 Time: 235.32
Run: 38 VAL ap_score: 0.468714 map_score: 0.468317 Time: 95.84
Run: 39 train loss: 166.628632 Time: 249.27
Run: 39 VAL ap_score: 0.476234 map_score: 0.476993 Time: 94.34
Run: 40 train loss: 163.414816 Time: 233.19
Run: 40 VAL ap_score: 0.450108 map_score: 0.452638 Time: 105.60
Run: 41 train loss: 164.374408 Time: 247.35
Run: 41 VAL ap_score: 0.478468 map_score: 0.474125 Time: 91.56
Run: 42 train loss: 163.927016 Time: 225.50
Run: 42 VAL ap_score: 0.460410 map_score: 0.453817 Time: 67.21
Run: 43 train loss: 163.759087 Time: 178.59
Run: 43 VAL ap_score: 0.487887 map_score: 0.474146 Time: 77.46
Run: 44 train loss: 163.184774 Time: 182.03
Run: 44 VAL ap_score: 0.475340 map_score: 0.470758 Time: 76.79
Run: 45 train loss: 163.288206 Time: 181.96
Run: 45 VAL ap_score: 0.474733 map_score: 0.468171 Time: 71.78
Run: 46 train loss: 161.561297 Time: 180.14
Run: 46 VAL ap_score: 0.486434 map_score: 0.475311 Time: 82.84
Run: 47 train loss: 160.170094 Time: 177.67
Run: 47 VAL ap_score: 0.459972 map_score: 0.465121 Time: 76.84
Run: 48 train loss: 162.071645 Time: 177.45
Run: 48 VAL ap_score: 0.473610 map_score: 0.478415 Time: 73.04
Run: 49 train loss: 161.515640 Time: 186.97
Run: 49 VAL ap_score: 0.472843 map_score: 0.471616 Time: 82.82
Run: 50 train loss: 160.130055 Time: 283.35
Run: 50 VAL ap_score: 0.484499 map_score: 0.487999 Time: 144.47
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 51 train loss: 158.703166 Time: 330.25
Run: 51 VAL ap_score: 0.474151 map_score: 0.474058 Time: 151.83
Run: 52 train loss: 158.497861 Time: 333.62
Run: 52 VAL ap_score: 0.472233 map_score: 0.475708 Time: 145.84
Run: 53 train loss: 157.338334 Time: 335.05
Run: 53 VAL ap_score: 0.490609 map_score: 0.478270 Time: 151.15
Run: 54 train loss: 158.871227 Time: 343.28
Run: 54 VAL ap_score: 0.488483 map_score: 0.477156 Time: 156.49
Run: 55 train loss: 157.169346 Time: 332.45
Run: 55 VAL ap_score: 0.475341 map_score: 0.480032 Time: 137.96
Run: 56 train loss: 156.800251 Time: 345.17
Run: 56 VAL ap_score: 0.491606 map_score: 0.484434 Time: 149.60
Run: 57 train loss: 157.206475 Time: 350.47
Run: 57 VAL ap_score: 0.459083 map_score: 0.459238 Time: 148.63
Run: 58 train loss: 156.569860 Time: 349.06
Run: 58 VAL ap_score: 0.461267 map_score: 0.468406 Time: 148.41
Run: 59 train loss: 156.717377 Time: 348.12
Run: 59 VAL ap_score: 0.485756 map_score: 0.481472 Time: 153.05
Run: 60 train loss: 155.479381 Time: 336.54
Run: 60 VAL ap_score: 0.493073 map_score: 0.483147 Time: 156.55
Run: 61 train loss: 154.941430 Time: 325.60
Run: 61 VAL ap_score: 0.496227 map_score: 0.488439 Time: 148.55
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 62 train loss: 154.954661 Time: 319.12
Run: 62 VAL ap_score: 0.470087 map_score: 0.469707 Time: 141.26
Run: 63 train loss: 154.051707 Time: 339.79
Run: 63 VAL ap_score: 0.486439 map_score: 0.479104 Time: 133.82
Run: 64 train loss: 153.057348 Time: 324.31
Run: 64 VAL ap_score: 0.495417 map_score: 0.489142 Time: 155.94
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 65 train loss: 153.757351 Time: 327.82
Run: 65 VAL ap_score: 0.478885 map_score: 0.482313 Time: 148.21
Run: 66 train loss: 153.852474 Time: 341.30
Run: 66 VAL ap_score: 0.494934 map_score: 0.485739 Time: 158.33
Run: 67 train loss: 151.972282 Time: 358.91
Run: 67 VAL ap_score: 0.486439 map_score: 0.484008 Time: 158.33
Run: 68 train loss: 153.106941 Time: 360.64
Run: 68 VAL ap_score: 0.471823 map_score: 0.467355 Time: 162.49
Run: 69 train loss: 151.655979 Time: 364.55
Run: 69 VAL ap_score: 0.489809 map_score: 0.480702 Time: 160.19
Run: 70 train loss: 151.496495 Time: 361.72
Run: 70 VAL ap_score: 0.468256 map_score: 0.469639 Time: 165.04
Run: 71 train loss: 151.801336 Time: 365.92
Run: 71 VAL ap_score: 0.486546 map_score: 0.478373 Time: 162.01
Run: 72 train loss: 152.250726 Time: 365.52
Run: 72 VAL ap_score: 0.487887 map_score: 0.480264 Time: 160.77
Run: 73 train loss: 150.544084 Time: 375.57
Run: 73 VAL ap_score: 0.487141 map_score: 0.485288 Time: 176.74
Run: 74 train loss: 150.068370 Time: 385.60
Run: 74 VAL ap_score: 0.487449 map_score: 0.481087 Time: 172.96
Run: 75 train loss: 150.614611 Time: 386.92
Run: 75 VAL ap_score: 0.476463 map_score: 0.487974 Time: 174.64
Run: 76 train loss: 150.748822 Time: 369.11
Run: 76 VAL ap_score: 0.494070 map_score: 0.498213 Time: 116.75
saving best validated model to experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
Run: 77 train loss: 150.887462 Time: 261.38
Run: 77 VAL ap_score: 0.492441 map_score: 0.486861 Time: 116.21
Run: 78 train loss: 150.355863 Time: 212.27
Run: 78 VAL ap_score: 0.493618 map_score: 0.484591 Time: 87.95
Run: 79 train loss: 149.596709 Time: 197.29
Run: 79 VAL ap_score: 0.491260 map_score: 0.487046 Time: 88.25
Run: 80 train loss: 149.595202 Time: 201.71
Run: 80 VAL ap_score: 0.490505 map_score: 0.487102 Time: 90.51
Run: 81 train loss: 148.219381 Time: 201.56
Run: 81 VAL ap_score: 0.490631 map_score: 0.492756 Time: 90.58
Run: 82 train loss: 148.469806 Time: 278.28
Run: 82 VAL ap_score: 0.478070 map_score: 0.477970 Time: 137.36
Run: 83 train loss: 149.824242 Time: 302.39
Run: 83 VAL ap_score: 0.490199 map_score: 0.490731 Time: 137.90
Run: 84 train loss: 148.127076 Time: 302.62
Run: 84 VAL ap_score: 0.487119 map_score: 0.485002 Time: 137.36
Run: 85 train loss: 148.215196 Time: 302.95
Run: 85 VAL ap_score: 0.494037 map_score: 0.498162 Time: 139.82
Run: 86 train loss: 147.836318 Time: 303.62
Run: 86 VAL ap_score: 0.466437 map_score: 0.460604 Time: 132.91
Run: 87 train loss: 148.465141 Time: 305.42
Run: 87 VAL ap_score: 0.495719 map_score: 0.493290 Time: 138.21
Run: 88 train loss: 148.050907 Time: 305.61
Run: 88 VAL ap_score: 0.488660 map_score: 0.490661 Time: 140.00
Run: 89 train loss: 147.688506 Time: 304.23
Run: 89 VAL ap_score: 0.496676 map_score: 0.494459 Time: 137.76
Run: 90 train loss: 149.190683 Time: 305.34
Run: 90 VAL ap_score: 0.493719 map_score: 0.491289 Time: 135.22
Run: 91 train loss: 146.879062 Time: 304.88
Run: 91 VAL ap_score: 0.481634 map_score: 0.489765 Time: 137.22
Run: 92 train loss: 147.528759 Time: 309.15
Run: 92 VAL ap_score: 0.482015 map_score: 0.485151 Time: 137.76
Run: 93 train loss: 147.944564 Time: 305.40
Run: 93 VAL ap_score: 0.472411 map_score: 0.472141 Time: 137.78
Run: 94 train loss: 146.795741 Time: 306.69
Run: 94 VAL ap_score: 0.490795 map_score: 0.495013 Time: 130.57
Run: 95 train loss: 147.743228 Time: 301.16
Run: 95 VAL ap_score: 0.497384 map_score: 0.493554 Time: 136.64
Run: 96 train loss: 147.707672 Time: 307.30
Run: 96 VAL ap_score: 0.485909 map_score: 0.473456 Time: 135.97
Run: 97 train loss: 146.360887 Time: 307.34
Run: 97 VAL ap_score: 0.484195 map_score: 0.477526 Time: 133.86
Run: 98 train loss: 145.493999 Time: 304.56
Run: 98 VAL ap_score: 0.485992 map_score: 0.490644 Time: 136.78
Run: 99 train loss: 146.065745 Time: 307.24
Run: 99 VAL ap_score: 0.491585 map_score: 0.489419 Time: 137.05
Run: 100 train loss: 147.349451 Time: 306.37
Run: 100 VAL ap_score: 0.490371 map_score: 0.485007 Time: 138.38
Run: 101 train loss: 146.265864 Time: 305.95
Run: 101 VAL ap_score: 0.486960 map_score: 0.485783 Time: 134.53
Run: 102 train loss: 145.289338 Time: 308.47
Run: 102 VAL ap_score: 0.495317 map_score: 0.490083 Time: 134.45
Run: 103 train loss: 145.400858 Time: 311.15
Run: 103 VAL ap_score: 0.488777 map_score: 0.484355 Time: 136.25
Run: 104 train loss: 145.232199 Time: 310.77
Run: 104 VAL ap_score: 0.475018 map_score: 0.470681 Time: 136.42
Run: 105 train loss: 145.768449 Time: 310.75
Run: 105 VAL ap_score: 0.487870 map_score: 0.480721 Time: 134.22
Run: 106 train loss: 146.750515 Time: 308.80
Run: 106 VAL ap_score: 0.489122 map_score: 0.493070 Time: 135.33
Run: 107 train loss: 145.957750 Time: 309.35
Run: 107 VAL ap_score: 0.485684 map_score: 0.489120 Time: 135.79
Run: 108 train loss: 145.477314 Time: 306.94
Run: 108 VAL ap_score: 0.486129 map_score: 0.486808 Time: 136.82
Run: 109 train loss: 145.668410 Time: 289.80
Run: 109 VAL ap_score: 0.481949 map_score: 0.473455 Time: 89.46
Run: 110 train loss: 145.161133 Time: 153.26
Run: 110 VAL ap_score: 0.481174 map_score: 0.483928 Time: 58.69
Run: 111 train loss: 145.637809 Time: 134.87
Run: 111 VAL ap_score: 0.481234 map_score: 0.482954 Time: 58.67
Run: 112 train loss: 145.532812 Time: 133.60
Run: 112 VAL ap_score: 0.485886 map_score: 0.487581 Time: 55.69
Run: 113 train loss: 144.855733 Time: 133.67
Run: 113 VAL ap_score: 0.484664 map_score: 0.484838 Time: 59.15
Run: 114 train loss: 145.332691 Time: 134.00
Run: 114 VAL ap_score: 0.494961 map_score: 0.497131 Time: 59.72
Run: 115 train loss: 145.274886 Time: 134.22
Run: 115 VAL ap_score: 0.492304 map_score: 0.487084 Time: 56.34
Run: 116 train loss: 143.932393 Time: 132.37
Run: 116 VAL ap_score: 0.493923 map_score: 0.488449 Time: 60.29
Run: 117 train loss: 145.052208 Time: 133.65
Run: 117 VAL ap_score: 0.483295 map_score: 0.484202 Time: 59.23
Run: 118 train loss: 144.449090 Time: 134.93
Run: 118 VAL ap_score: 0.498644 map_score: 0.486881 Time: 59.80
Run: 119 train loss: 143.206571 Time: 135.71
Run: 119 VAL ap_score: 0.490098 map_score: 0.489036 Time: 90.44
Run: 120 train loss: 144.263850 Time: 128.86
Run: 120 VAL ap_score: 0.491814 map_score: 0.487789 Time: 170.45
Run: 121 train loss: 144.604499 Time: 274.83
Run: 121 VAL ap_score: 0.489493 map_score: 0.488648 Time: 78.48
Run: 122 train loss: 144.214787 Time: 277.45
Run: 122 VAL ap_score: 0.481716 map_score: 0.475886 Time: 122.95
Run: 123 train loss: 144.070714 Time: 280.62
Run: 123 VAL ap_score: 0.476099 map_score: 0.481417 Time: 101.47
Run: 124 train loss: 143.530492 Time: 213.81
Run: 124 VAL ap_score: 0.494822 map_score: 0.496191 Time: 95.25
Run: 125 train loss: 143.109274 Time: 274.11
Run: 125 VAL ap_score: 0.490138 map_score: 0.492621 Time: 121.88
Run: 126 train loss: 144.183072 Time: 274.85
Run: 126 VAL ap_score: 0.490159 map_score: 0.491496 Time: 122.03
Run: 127 train loss: 143.637918 Time: 278.76
Run: 127 VAL ap_score: 0.494381 map_score: 0.490756 Time: 122.04
loading best validated model from experiments/greed_hinge/trained_models/greed_ptc_mr_large_dataset_seed_1704_2024-05-07_10:41:51.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_mr240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
TEST - ap_score: 0.529795 map_score: 0.527573
