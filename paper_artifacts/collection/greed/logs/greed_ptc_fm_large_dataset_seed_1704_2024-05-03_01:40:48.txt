Experiment greed for model: 'greed', dataset: 'ptc_fm_large', seed: 1704 started at time: 2024-05-03_01:40:48
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id greed
--experiment_dir experiments/
--model_config_path configs/greed.yaml
--dataset_name ptc_fm
--seed 1704
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_fm240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fm240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_fm240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fm240k_corpus_subgraphs.pkl
saving intial model to experiments/greed/initial_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
no. of params in model: 1840
Run: 0 train loss: 432.164130 Time: 187.01
Run: 0 VAL ap_score: 0.326043 map_score: 0.377234 Time: 85.99
saving best validated model to experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
Run: 1 train loss: 319.048775 Time: 189.80
Run: 1 VAL ap_score: 0.320263 map_score: 0.395344 Time: 85.56
saving best validated model to experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
Run: 2 train loss: 315.905765 Time: 189.03
Run: 2 VAL ap_score: 0.346059 map_score: 0.396028 Time: 85.78
saving best validated model to experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
Run: 3 train loss: 313.127064 Time: 188.19
Run: 3 VAL ap_score: 0.344763 map_score: 0.390507 Time: 85.56
Run: 4 train loss: 311.700597 Time: 187.66
Run: 4 VAL ap_score: 0.347533 map_score: 0.409113 Time: 58.25
saving best validated model to experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
Run: 5 train loss: 311.784535 Time: 130.66
Run: 5 VAL ap_score: 0.353507 map_score: 0.407502 Time: 57.21
Run: 6 train loss: 309.952470 Time: 130.96
Run: 6 VAL ap_score: 0.349312 map_score: 0.398202 Time: 57.30
Run: 7 train loss: 310.516831 Time: 130.48
Run: 7 VAL ap_score: 0.345991 map_score: 0.401391 Time: 57.91
Run: 8 train loss: 311.110756 Time: 130.72
Run: 8 VAL ap_score: 0.340374 map_score: 0.398147 Time: 57.36
Run: 9 train loss: 309.675980 Time: 130.60
Run: 9 VAL ap_score: 0.355089 map_score: 0.403916 Time: 57.99
Run: 10 train loss: 309.734383 Time: 128.55
Run: 10 VAL ap_score: 0.347873 map_score: 0.408736 Time: 57.63
Run: 11 train loss: 310.216780 Time: 129.28
Run: 11 VAL ap_score: 0.351585 map_score: 0.406329 Time: 56.51
Run: 12 train loss: 310.007571 Time: 167.70
Run: 12 VAL ap_score: 0.343852 map_score: 0.404326 Time: 165.56
Run: 13 train loss: 308.715075 Time: 334.16
Run: 13 VAL ap_score: 0.348765 map_score: 0.402824 Time: 165.86
Run: 14 train loss: 308.657676 Time: 334.92
Run: 14 VAL ap_score: 0.348833 map_score: 0.406923 Time: 164.67
Run: 15 train loss: 310.200493 Time: 338.61
Run: 15 VAL ap_score: 0.341797 map_score: 0.398841 Time: 161.82
Run: 16 train loss: 309.709795 Time: 341.59
Run: 16 VAL ap_score: 0.348268 map_score: 0.389492 Time: 159.17
Run: 17 train loss: 309.514301 Time: 344.34
Run: 17 VAL ap_score: 0.351946 map_score: 0.409113 Time: 156.32
Run: 18 train loss: 308.835465 Time: 346.42
Run: 18 VAL ap_score: 0.349621 map_score: 0.406671 Time: 153.63
Run: 19 train loss: 308.309667 Time: 347.21
Run: 19 VAL ap_score: 0.353132 map_score: 0.406277 Time: 153.11
Run: 20 train loss: 308.327327 Time: 347.32
Run: 20 VAL ap_score: 0.352995 map_score: 0.405249 Time: 154.23
Run: 21 train loss: 308.551760 Time: 345.50
Run: 21 VAL ap_score: 0.357925 map_score: 0.401447 Time: 157.06
Run: 22 train loss: 308.972031 Time: 343.18
Run: 22 VAL ap_score: 0.347181 map_score: 0.406749 Time: 159.87
Run: 23 train loss: 308.250693 Time: 340.43
Run: 23 VAL ap_score: 0.344105 map_score: 0.399000 Time: 161.88
Run: 24 train loss: 308.351884 Time: 337.67
Run: 24 VAL ap_score: 0.340819 map_score: 0.410715 Time: 163.70
saving best validated model to experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
Run: 25 train loss: 308.248482 Time: 336.32
Run: 25 VAL ap_score: 0.340240 map_score: 0.410785 Time: 164.63
Run: 26 train loss: 309.277564 Time: 334.85
Run: 26 VAL ap_score: 0.353117 map_score: 0.395715 Time: 165.28
Run: 27 train loss: 309.430630 Time: 333.59
Run: 27 VAL ap_score: 0.352278 map_score: 0.408278 Time: 165.83
Run: 28 train loss: 308.917325 Time: 334.53
Run: 28 VAL ap_score: 0.350916 map_score: 0.407880 Time: 165.77
Run: 29 train loss: 308.075932 Time: 334.93
Run: 29 VAL ap_score: 0.348600 map_score: 0.400184 Time: 164.64
Run: 30 train loss: 308.399989 Time: 336.09
Run: 30 VAL ap_score: 0.353492 map_score: 0.410340 Time: 163.22
Run: 31 train loss: 308.449920 Time: 337.55
Run: 31 VAL ap_score: 0.358289 map_score: 0.406326 Time: 161.60
Run: 32 train loss: 307.392813 Time: 340.15
Run: 32 VAL ap_score: 0.334000 map_score: 0.403943 Time: 159.65
Run: 33 train loss: 307.936145 Time: 341.29
Run: 33 VAL ap_score: 0.350978 map_score: 0.402662 Time: 158.19
Run: 34 train loss: 308.042585 Time: 342.07
Run: 34 VAL ap_score: 0.332585 map_score: 0.402039 Time: 158.41
Run: 35 train loss: 308.506369 Time: 342.47
Run: 35 VAL ap_score: 0.348973 map_score: 0.401155 Time: 158.05
Run: 36 train loss: 307.588006 Time: 342.69
Run: 36 VAL ap_score: 0.352070 map_score: 0.404437 Time: 157.64
Run: 37 train loss: 307.535656 Time: 342.25
Run: 37 VAL ap_score: 0.332125 map_score: 0.385337 Time: 158.82
Run: 38 train loss: 308.023515 Time: 340.65
Run: 38 VAL ap_score: 0.352888 map_score: 0.409464 Time: 159.03
Run: 39 train loss: 307.490852 Time: 340.40
Run: 39 VAL ap_score: 0.352098 map_score: 0.407038 Time: 159.44
Run: 40 train loss: 307.703363 Time: 340.33
Run: 40 VAL ap_score: 0.346620 map_score: 0.413052 Time: 159.73
saving best validated model to experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
Run: 41 train loss: 307.346321 Time: 339.95
Run: 41 VAL ap_score: 0.354762 map_score: 0.404093 Time: 160.82
Run: 42 train loss: 307.862512 Time: 338.61
Run: 42 VAL ap_score: 0.348437 map_score: 0.396441 Time: 161.57
Run: 43 train loss: 307.697967 Time: 338.68
Run: 43 VAL ap_score: 0.355775 map_score: 0.405770 Time: 161.48
Run: 44 train loss: 306.806510 Time: 338.87
Run: 44 VAL ap_score: 0.346229 map_score: 0.411249 Time: 161.24
Run: 45 train loss: 307.900138 Time: 339.34
Run: 45 VAL ap_score: 0.350857 map_score: 0.405266 Time: 160.73
Run: 46 train loss: 307.105936 Time: 339.84
Run: 46 VAL ap_score: 0.358777 map_score: 0.404108 Time: 160.32
Run: 47 train loss: 305.754777 Time: 338.98
Run: 47 VAL ap_score: 0.354179 map_score: 0.406300 Time: 161.51
Run: 48 train loss: 306.768781 Time: 338.11
Run: 48 VAL ap_score: 0.356694 map_score: 0.414404 Time: 162.61
saving best validated model to experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
Run: 49 train loss: 306.254590 Time: 337.75
Run: 49 VAL ap_score: 0.359646 map_score: 0.402837 Time: 162.64
Run: 50 train loss: 306.313683 Time: 337.35
Run: 50 VAL ap_score: 0.359770 map_score: 0.402423 Time: 162.90
Run: 51 train loss: 305.509864 Time: 337.40
Run: 51 VAL ap_score: 0.358090 map_score: 0.409081 Time: 162.68
Run: 52 train loss: 306.205541 Time: 338.32
Run: 52 VAL ap_score: 0.355641 map_score: 0.409528 Time: 161.95
Run: 53 train loss: 305.121337 Time: 338.68
Run: 53 VAL ap_score: 0.364450 map_score: 0.405394 Time: 161.36
Run: 54 train loss: 305.972089 Time: 338.34
Run: 54 VAL ap_score: 0.359733 map_score: 0.406993 Time: 162.18
Run: 55 train loss: 306.148132 Time: 336.54
Run: 55 VAL ap_score: 0.363454 map_score: 0.401536 Time: 163.09
Run: 56 train loss: 305.802018 Time: 337.00
Run: 56 VAL ap_score: 0.351924 map_score: 0.407254 Time: 162.88
Run: 57 train loss: 305.760843 Time: 338.30
Run: 57 VAL ap_score: 0.356737 map_score: 0.406033 Time: 162.03
Run: 58 train loss: 305.495252 Time: 339.03
Run: 58 VAL ap_score: 0.372366 map_score: 0.410667 Time: 161.09
Run: 59 train loss: 305.837022 Time: 340.52
Run: 59 VAL ap_score: 0.357082 map_score: 0.405563 Time: 159.17
Run: 60 train loss: 305.596978 Time: 342.64
Run: 60 VAL ap_score: 0.353930 map_score: 0.411742 Time: 157.07
Run: 61 train loss: 305.047630 Time: 343.91
Run: 61 VAL ap_score: 0.366552 map_score: 0.403211 Time: 156.54
Run: 62 train loss: 305.530302 Time: 344.23
Run: 62 VAL ap_score: 0.364686 map_score: 0.409984 Time: 340.14
Run: 63 train loss: 305.050862 Time: 426.55
Run: 63 VAL ap_score: 0.350006 map_score: 0.411758 Time: 159.38
Run: 64 train loss: 304.889725 Time: 340.26
Run: 64 VAL ap_score: 0.354607 map_score: 0.410396 Time: 161.16
Run: 65 train loss: 305.341445 Time: 339.05
Run: 65 VAL ap_score: 0.365758 map_score: 0.412848 Time: 162.53
Run: 66 train loss: 304.716181 Time: 339.11
Run: 66 VAL ap_score: 0.370194 map_score: 0.414062 Time: 162.66
Run: 67 train loss: 304.793035 Time: 340.01
Run: 67 VAL ap_score: 0.365121 map_score: 0.408616 Time: 162.24
Run: 68 train loss: 305.025089 Time: 340.18
Run: 68 VAL ap_score: 0.350666 map_score: 0.401809 Time: 162.02
Run: 69 train loss: 305.146884 Time: 338.72
Run: 69 VAL ap_score: 0.359485 map_score: 0.404595 Time: 161.83
Run: 70 train loss: 304.187212 Time: 339.29
Run: 70 VAL ap_score: 0.357730 map_score: 0.399262 Time: 160.46
Run: 71 train loss: 305.436808 Time: 339.65
Run: 71 VAL ap_score: 0.362102 map_score: 0.405314 Time: 160.90
Run: 72 train loss: 305.149400 Time: 339.20
Run: 72 VAL ap_score: 0.366497 map_score: 0.403052 Time: 161.09
Run: 73 train loss: 304.918083 Time: 339.42
Run: 73 VAL ap_score: 0.360727 map_score: 0.413889 Time: 161.09
Run: 74 train loss: 304.407733 Time: 339.23
Run: 74 VAL ap_score: 0.361740 map_score: 0.407265 Time: 161.24
Run: 75 train loss: 304.742185 Time: 339.79
Run: 75 VAL ap_score: 0.369365 map_score: 0.412586 Time: 161.11
Run: 76 train loss: 304.793683 Time: 339.57
Run: 76 VAL ap_score: 0.351540 map_score: 0.402029 Time: 160.72
Run: 77 train loss: 304.594952 Time: 338.71
Run: 77 VAL ap_score: 0.341866 map_score: 0.390426 Time: 161.22
Run: 78 train loss: 304.000598 Time: 338.19
Run: 78 VAL ap_score: 0.355529 map_score: 0.410369 Time: 161.69
Run: 79 train loss: 304.105918 Time: 338.42
Run: 79 VAL ap_score: 0.348705 map_score: 0.392325 Time: 162.47
Run: 80 train loss: 304.228646 Time: 337.72
Run: 80 VAL ap_score: 0.346319 map_score: 0.409363 Time: 163.13
Run: 81 train loss: 304.383371 Time: 337.65
Run: 81 VAL ap_score: 0.370568 map_score: 0.408274 Time: 163.22
Run: 82 train loss: 303.506288 Time: 337.24
Run: 82 VAL ap_score: 0.358139 map_score: 0.414220 Time: 162.50
Run: 83 train loss: 306.116616 Time: 338.50
Run: 83 VAL ap_score: 0.342972 map_score: 0.400591 Time: 160.99
Run: 84 train loss: 304.361924 Time: 340.22
Run: 84 VAL ap_score: 0.354648 map_score: 0.413568 Time: 159.46
Run: 85 train loss: 304.855842 Time: 341.62
Run: 85 VAL ap_score: 0.354873 map_score: 0.408422 Time: 158.77
Run: 86 train loss: 304.741086 Time: 342.24
Run: 86 VAL ap_score: 0.362248 map_score: 0.405310 Time: 158.63
Run: 87 train loss: 304.236937 Time: 342.69
Run: 87 VAL ap_score: 0.357400 map_score: 0.408900 Time: 158.33
Run: 88 train loss: 304.664785 Time: 342.47
Run: 88 VAL ap_score: 0.355779 map_score: 0.404377 Time: 157.46
Run: 89 train loss: 304.266055 Time: 343.28
Run: 89 VAL ap_score: 0.366617 map_score: 0.407026 Time: 158.16
Run: 90 train loss: 304.849363 Time: 342.34
Run: 90 VAL ap_score: 0.360637 map_score: 0.407960 Time: 159.01
Run: 91 train loss: 305.140640 Time: 341.78
Run: 91 VAL ap_score: 0.358148 map_score: 0.410365 Time: 159.70
Run: 92 train loss: 304.799257 Time: 340.94
Run: 92 VAL ap_score: 0.358075 map_score: 0.406587 Time: 160.98
Run: 93 train loss: 303.803707 Time: 741.62
Run: 93 VAL ap_score: 0.368134 map_score: 0.409854 Time: 546.31
Run: 94 train loss: 303.988901 Time: 1130.09
Run: 94 VAL ap_score: 0.370810 map_score: 0.405560 Time: 549.07
Run: 95 train loss: 304.394488 Time: 1130.83
Run: 95 VAL ap_score: 0.364025 map_score: 0.414489 Time: 546.94
Run: 96 train loss: 303.987242 Time: 1129.27
Run: 96 VAL ap_score: 0.351976 map_score: 0.410246 Time: 550.49
Run: 97 train loss: 304.126607 Time: 1128.94
Run: 97 VAL ap_score: 0.359682 map_score: 0.411314 Time: 547.46
Run: 98 train loss: 304.155002 Time: 1127.94
Run: 98 VAL ap_score: 0.353589 map_score: 0.408888 Time: 547.24
Run: 99 train loss: 303.659020 Time: 1132.47
Run: 99 VAL ap_score: 0.357944 map_score: 0.408842 Time: 544.95
loading best validated model from experiments/greed/trained_models/greed_ptc_fm_large_dataset_seed_1704_2024-05-03_01:40:48.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_fm240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fm240k_corpus_subgraphs.pkl
TEST - ap_score: 0.368260 map_score: 0.417053
