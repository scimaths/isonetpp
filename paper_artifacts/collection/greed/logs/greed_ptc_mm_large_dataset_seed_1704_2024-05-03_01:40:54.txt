Experiment greed for model: 'greed', dataset: 'ptc_mm_large', seed: 1704 started at time: 2024-05-03_01:40:54
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id greed
--experiment_dir experiments/
--model_config_path configs/greed.yaml
--dataset_name ptc_mm
--seed 1704
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
saving intial model to experiments/greed/initial_models/greed_ptc_mm_large_dataset_seed_1704_2024-05-03_01:40:54.pth
no. of params in model: 1840
Run: 0 train loss: 327.470347 Time: 183.00
Run: 0 VAL ap_score: 0.328927 map_score: 0.378270 Time: 79.05
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-05-03_01:40:54.pth
Run: 1 train loss: 311.484544 Time: 185.08
Run: 1 VAL ap_score: 0.320244 map_score: 0.373821 Time: 79.33
Run: 2 train loss: 309.303286 Time: 184.49
Run: 2 VAL ap_score: 0.339612 map_score: 0.390555 Time: 79.08
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-05-03_01:40:54.pth
Run: 3 train loss: 306.971503 Time: 184.09
Run: 3 VAL ap_score: 0.358718 map_score: 0.403027 Time: 79.39
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-05-03_01:40:54.pth
Run: 4 train loss: 306.721638 Time: 182.89
Run: 4 VAL ap_score: 0.342944 map_score: 0.388968 Time: 79.81
Run: 5 train loss: 305.824470 Time: 184.51
Run: 5 VAL ap_score: 0.353518 map_score: 0.400766 Time: 79.17
Run: 6 train loss: 305.731489 Time: 184.28
Run: 6 VAL ap_score: 0.335182 map_score: 0.385372 Time: 79.04
Run: 7 train loss: 306.201073 Time: 184.72
Run: 7 VAL ap_score: 0.361824 map_score: 0.401451 Time: 79.97
Run: 8 train loss: 304.461244 Time: 184.33
Run: 8 VAL ap_score: 0.359535 map_score: 0.404616 Time: 79.45
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-05-03_01:40:54.pth
Run: 9 train loss: 304.306157 Time: 149.64
Run: 9 VAL ap_score: 0.349974 map_score: 0.401654 Time: 56.54
Run: 10 train loss: 304.448306 Time: 136.35
Run: 10 VAL ap_score: 0.363264 map_score: 0.406162 Time: 69.16
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-05-03_01:40:54.pth
Run: 11 train loss: 303.595573 Time: 362.83
Run: 11 VAL ap_score: 0.344003 map_score: 0.398972 Time: 150.83
Run: 12 train loss: 303.497433 Time: 360.34
Run: 12 VAL ap_score: 0.348471 map_score: 0.394699 Time: 153.50
Run: 13 train loss: 303.749208 Time: 357.72
Run: 13 VAL ap_score: 0.360184 map_score: 0.404457 Time: 155.91
Run: 14 train loss: 302.625163 Time: 355.23
Run: 14 VAL ap_score: 0.363692 map_score: 0.402114 Time: 158.28
Run: 15 train loss: 302.882667 Time: 353.15
Run: 15 VAL ap_score: 0.355027 map_score: 0.405109 Time: 160.79
Run: 16 train loss: 302.943630 Time: 350.32
Run: 16 VAL ap_score: 0.359701 map_score: 0.401430 Time: 162.68
Run: 17 train loss: 302.666582 Time: 347.94
Run: 17 VAL ap_score: 0.355071 map_score: 0.399708 Time: 164.54
Run: 18 train loss: 302.287599 Time: 346.21
Run: 18 VAL ap_score: 0.350688 map_score: 0.397220 Time: 165.31
Run: 19 train loss: 302.072861 Time: 345.42
Run: 19 VAL ap_score: 0.352110 map_score: 0.400190 Time: 165.96
Run: 20 train loss: 301.864272 Time: 345.35
Run: 20 VAL ap_score: 0.365642 map_score: 0.404734 Time: 166.44
Run: 21 train loss: 301.630124 Time: 344.95
Run: 21 VAL ap_score: 0.303683 map_score: 0.381218 Time: 166.47
Run: 22 train loss: 303.140056 Time: 344.84
Run: 22 VAL ap_score: 0.353362 map_score: 0.399982 Time: 166.63
Run: 23 train loss: 301.606176 Time: 345.27
Run: 23 VAL ap_score: 0.361655 map_score: 0.406014 Time: 165.47
Run: 24 train loss: 301.872393 Time: 346.82
Run: 24 VAL ap_score: 0.356290 map_score: 0.404264 Time: 164.29
Run: 25 train loss: 301.818518 Time: 348.19
Run: 25 VAL ap_score: 0.345620 map_score: 0.400941 Time: 163.38
Run: 26 train loss: 300.477600 Time: 349.50
Run: 26 VAL ap_score: 0.340570 map_score: 0.403958 Time: 161.65
Run: 27 train loss: 301.485795 Time: 351.21
Run: 27 VAL ap_score: 0.357212 map_score: 0.402805 Time: 160.18
Run: 28 train loss: 301.299311 Time: 352.10
Run: 28 VAL ap_score: 0.350971 map_score: 0.391724 Time: 160.22
Run: 29 train loss: 302.030914 Time: 351.58
Run: 29 VAL ap_score: 0.346038 map_score: 0.402000 Time: 160.42
Run: 30 train loss: 300.835847 Time: 351.18
Run: 30 VAL ap_score: 0.352700 map_score: 0.393647 Time: 160.81
Run: 31 train loss: 301.100506 Time: 351.20
Run: 31 VAL ap_score: 0.351756 map_score: 0.394387 Time: 160.61
Run: 32 train loss: 301.486826 Time: 350.95
Run: 32 VAL ap_score: 0.353583 map_score: 0.397637 Time: 160.42
Run: 33 train loss: 300.375067 Time: 350.93
Run: 33 VAL ap_score: 0.332499 map_score: 0.400887 Time: 160.78
Run: 34 train loss: 300.741510 Time: 350.38
Run: 34 VAL ap_score: 0.355210 map_score: 0.401227 Time: 160.98
Run: 35 train loss: 299.735912 Time: 350.58
Run: 35 VAL ap_score: 0.342338 map_score: 0.400729 Time: 161.07
Run: 36 train loss: 300.195800 Time: 350.35
Run: 36 VAL ap_score: 0.356954 map_score: 0.399041 Time: 161.46
Run: 37 train loss: 300.105866 Time: 349.74
Run: 37 VAL ap_score: 0.338140 map_score: 0.398565 Time: 161.87
Run: 38 train loss: 300.483643 Time: 350.78
Run: 38 VAL ap_score: 0.347047 map_score: 0.400804 Time: 160.24
Run: 39 train loss: 299.675255 Time: 352.00
Run: 39 VAL ap_score: 0.350317 map_score: 0.400522 Time: 159.05
Run: 40 train loss: 300.346698 Time: 353.05
Run: 40 VAL ap_score: 0.351738 map_score: 0.404635 Time: 158.41
Run: 41 train loss: 300.185527 Time: 353.68
Run: 41 VAL ap_score: 0.359729 map_score: 0.404558 Time: 158.06
Run: 42 train loss: 299.805389 Time: 353.72
Run: 42 VAL ap_score: 0.345386 map_score: 0.402382 Time: 158.05
Run: 43 train loss: 300.076401 Time: 352.54
Run: 43 VAL ap_score: 0.356071 map_score: 0.393720 Time: 159.95
Run: 44 train loss: 299.480437 Time: 351.10
Run: 44 VAL ap_score: 0.345184 map_score: 0.399142 Time: 161.54
Run: 45 train loss: 298.428570 Time: 349.16
Run: 45 VAL ap_score: 0.346395 map_score: 0.403217 Time: 162.71
Run: 46 train loss: 299.931036 Time: 349.04
Run: 46 VAL ap_score: 0.352523 map_score: 0.406020 Time: 163.33
Run: 47 train loss: 299.213373 Time: 349.19
Run: 47 VAL ap_score: 0.349099 map_score: 0.400953 Time: 163.09
Run: 48 train loss: 299.260365 Time: 348.98
Run: 48 VAL ap_score: 0.354540 map_score: 0.399925 Time: 162.89
Run: 49 train loss: 299.403257 Time: 349.98
Run: 49 VAL ap_score: 0.357485 map_score: 0.399175 Time: 161.67
Run: 50 train loss: 299.526370 Time: 350.76
Run: 50 VAL ap_score: 0.352708 map_score: 0.398298 Time: 161.14
Run: 51 train loss: 299.764641 Time: 351.08
Run: 51 VAL ap_score: 0.356665 map_score: 0.402637 Time: 160.47
Run: 52 train loss: 299.652666 Time: 351.30
Run: 52 VAL ap_score: 0.351232 map_score: 0.399754 Time: 161.30
Run: 53 train loss: 298.951361 Time: 337.84
Run: 53 VAL ap_score: 0.358710 map_score: 0.402864 Time: 132.47
Run: 54 train loss: 299.126368 Time: 290.65
Run: 54 VAL ap_score: 0.353538 map_score: 0.405053 Time: 133.03
Run: 55 train loss: 298.530648 Time: 291.05
Run: 55 VAL ap_score: 0.358315 map_score: 0.406175 Time: 132.89
Run: 56 train loss: 298.901112 Time: 290.35
Run: 56 VAL ap_score: 0.337647 map_score: 0.401258 Time: 132.88
Run: 57 train loss: 298.645507 Time: 290.73
Run: 57 VAL ap_score: 0.353098 map_score: 0.405425 Time: 132.50
Run: 58 train loss: 299.406072 Time: 290.77
Run: 58 VAL ap_score: 0.355795 map_score: 0.406131 Time: 131.19
Run: 59 train loss: 297.941182 Time: 291.27
Run: 59 VAL ap_score: 0.354407 map_score: 0.396692 Time: 131.37
Run: 60 train loss: 298.205007 Time: 290.32
Run: 60 VAL ap_score: 0.348609 map_score: 0.405123 Time: 132.30
Run: 61 train loss: 299.768069 Time: 290.26
Run: 61 VAL ap_score: 0.345617 map_score: 0.401467 Time: 132.87
loading best validated model from experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-05-03_01:40:54.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_mm240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
TEST - ap_score: 0.329589 map_score: 0.367502
