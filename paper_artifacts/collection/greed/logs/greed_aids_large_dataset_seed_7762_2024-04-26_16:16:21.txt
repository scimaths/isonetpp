Experiment greed for model: 'greed', dataset: 'aids_large', seed: 7762 started at time: 2024-04-26_16:16:21
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id greed
--experiment_dir experiments/
--model_config_path configs/greed.yaml
--dataset_name aids
--seed 7762
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_aids240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_aids240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/aids240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_aids240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_aids240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/aids240k_corpus_subgraphs.pkl
saving intial model to experiments/greed/initial_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
no. of params in model: 1840
Run: 0 train loss: 338.926321 Time: 281.32
Run: 0 VAL ap_score: 0.329837 map_score: 0.344465 Time: 128.02
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 1 train loss: 323.386257 Time: 281.29
Run: 1 VAL ap_score: 0.319850 map_score: 0.343844 Time: 127.81
Run: 2 train loss: 321.865285 Time: 280.70
Run: 2 VAL ap_score: 0.332128 map_score: 0.358566 Time: 128.01
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 3 train loss: 319.902364 Time: 280.20
Run: 3 VAL ap_score: 0.332525 map_score: 0.363555 Time: 128.16
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 4 train loss: 316.556118 Time: 280.44
Run: 4 VAL ap_score: 0.333794 map_score: 0.365855 Time: 128.34
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 5 train loss: 315.339502 Time: 279.92
Run: 5 VAL ap_score: 0.333703 map_score: 0.367128 Time: 128.75
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 6 train loss: 314.547342 Time: 281.18
Run: 6 VAL ap_score: 0.328811 map_score: 0.368019 Time: 128.00
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 7 train loss: 315.057395 Time: 280.73
Run: 7 VAL ap_score: 0.311896 map_score: 0.325723 Time: 128.33
Run: 8 train loss: 313.103261 Time: 281.00
Run: 8 VAL ap_score: 0.323681 map_score: 0.370631 Time: 129.24
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 9 train loss: 313.990245 Time: 288.17
Run: 9 VAL ap_score: 0.329967 map_score: 0.349853 Time: 136.44
Run: 10 train loss: 312.589415 Time: 289.25
Run: 10 VAL ap_score: 0.332234 map_score: 0.358093 Time: 132.65
Run: 11 train loss: 312.932166 Time: 278.12
Run: 11 VAL ap_score: 0.322906 map_score: 0.339614 Time: 128.37
Run: 12 train loss: 313.124509 Time: 280.61
Run: 12 VAL ap_score: 0.330170 map_score: 0.367819 Time: 129.10
Run: 13 train loss: 312.479763 Time: 280.63
Run: 13 VAL ap_score: 0.337964 map_score: 0.367493 Time: 129.29
Run: 14 train loss: 312.047211 Time: 280.84
Run: 14 VAL ap_score: 0.321162 map_score: 0.333068 Time: 129.04
Run: 15 train loss: 312.040779 Time: 280.86
Run: 15 VAL ap_score: 0.335250 map_score: 0.355879 Time: 128.80
Run: 16 train loss: 312.026577 Time: 286.09
Run: 16 VAL ap_score: 0.335983 map_score: 0.370338 Time: 130.58
Run: 17 train loss: 311.263938 Time: 281.10
Run: 17 VAL ap_score: 0.340619 map_score: 0.366491 Time: 130.68
Run: 18 train loss: 310.568187 Time: 279.28
Run: 18 VAL ap_score: 0.336881 map_score: 0.370433 Time: 129.34
Run: 19 train loss: 310.861683 Time: 279.82
Run: 19 VAL ap_score: 0.303283 map_score: 0.359930 Time: 129.93
Run: 20 train loss: 310.690669 Time: 278.48
Run: 20 VAL ap_score: 0.332749 map_score: 0.373014 Time: 130.34
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 21 train loss: 311.100746 Time: 280.59
Run: 21 VAL ap_score: 0.338405 map_score: 0.374435 Time: 133.33
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 22 train loss: 310.691294 Time: 301.69
Run: 22 VAL ap_score: 0.339076 map_score: 0.366207 Time: 143.92
Run: 23 train loss: 310.425566 Time: 299.29
Run: 23 VAL ap_score: 0.335155 map_score: 0.372524 Time: 129.35
Run: 24 train loss: 310.883293 Time: 286.19
Run: 24 VAL ap_score: 0.329430 map_score: 0.360290 Time: 134.60
Run: 25 train loss: 309.314650 Time: 280.63
Run: 25 VAL ap_score: 0.333099 map_score: 0.360744 Time: 130.60
Run: 26 train loss: 310.795301 Time: 279.05
Run: 26 VAL ap_score: 0.340197 map_score: 0.367359 Time: 133.59
Run: 27 train loss: 309.860804 Time: 282.70
Run: 27 VAL ap_score: 0.332041 map_score: 0.368193 Time: 129.68
Run: 28 train loss: 309.895323 Time: 281.46
Run: 28 VAL ap_score: 0.325029 map_score: 0.370232 Time: 130.23
Run: 29 train loss: 309.545965 Time: 278.74
Run: 29 VAL ap_score: 0.339215 map_score: 0.371533 Time: 130.03
Run: 30 train loss: 309.913166 Time: 280.02
Run: 30 VAL ap_score: 0.334544 map_score: 0.356771 Time: 133.12
Run: 31 train loss: 308.518836 Time: 278.21
Run: 31 VAL ap_score: 0.335273 map_score: 0.373594 Time: 132.24
Run: 32 train loss: 308.739801 Time: 277.23
Run: 32 VAL ap_score: 0.339935 map_score: 0.368988 Time: 128.37
Run: 33 train loss: 307.970454 Time: 277.71
Run: 33 VAL ap_score: 0.330689 map_score: 0.373791 Time: 131.10
Run: 34 train loss: 308.614121 Time: 279.06
Run: 34 VAL ap_score: 0.329115 map_score: 0.342992 Time: 130.72
Run: 35 train loss: 309.311708 Time: 279.71
Run: 35 VAL ap_score: 0.343646 map_score: 0.366208 Time: 130.55
Run: 36 train loss: 308.396953 Time: 282.25
Run: 36 VAL ap_score: 0.331809 map_score: 0.372575 Time: 130.96
Run: 37 train loss: 308.288005 Time: 282.13
Run: 37 VAL ap_score: 0.342916 map_score: 0.361939 Time: 130.62
Run: 38 train loss: 308.802498 Time: 282.95
Run: 38 VAL ap_score: 0.328040 map_score: 0.367546 Time: 131.21
Run: 39 train loss: 308.241006 Time: 282.78
Run: 39 VAL ap_score: 0.341791 map_score: 0.368735 Time: 130.97
Run: 40 train loss: 308.514115 Time: 278.28
Run: 40 VAL ap_score: 0.321063 map_score: 0.369412 Time: 130.94
Run: 41 train loss: 308.093130 Time: 278.58
Run: 41 VAL ap_score: 0.325878 map_score: 0.371436 Time: 130.85
Run: 42 train loss: 306.908538 Time: 278.86
Run: 42 VAL ap_score: 0.336400 map_score: 0.377385 Time: 130.28
saving best validated model to experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
Run: 43 train loss: 308.294809 Time: 279.51
Run: 43 VAL ap_score: 0.331185 map_score: 0.373270 Time: 130.31
Run: 44 train loss: 308.458608 Time: 280.09
Run: 44 VAL ap_score: 0.326386 map_score: 0.369475 Time: 130.61
Run: 45 train loss: 307.954241 Time: 279.14
Run: 45 VAL ap_score: 0.322964 map_score: 0.374847 Time: 130.98
Run: 46 train loss: 308.121647 Time: 278.38
Run: 46 VAL ap_score: 0.339172 map_score: 0.373608 Time: 131.16
Run: 47 train loss: 307.285928 Time: 278.74
Run: 47 VAL ap_score: 0.331812 map_score: 0.373681 Time: 130.47
Run: 48 train loss: 307.959353 Time: 279.87
Run: 48 VAL ap_score: 0.335176 map_score: 0.372966 Time: 130.57
Run: 49 train loss: 307.680499 Time: 279.60
Run: 49 VAL ap_score: 0.342065 map_score: 0.369699 Time: 130.18
Run: 50 train loss: 307.264916 Time: 279.88
Run: 50 VAL ap_score: 0.339724 map_score: 0.372956 Time: 130.86
Run: 51 train loss: 307.358602 Time: 280.13
Run: 51 VAL ap_score: 0.339010 map_score: 0.363964 Time: 130.44
Run: 52 train loss: 307.885958 Time: 278.38
Run: 52 VAL ap_score: 0.308601 map_score: 0.366642 Time: 131.05
Run: 53 train loss: 307.381916 Time: 277.91
Run: 53 VAL ap_score: 0.331950 map_score: 0.374177 Time: 129.87
Run: 54 train loss: 307.721429 Time: 277.01
Run: 54 VAL ap_score: 0.340552 map_score: 0.376811 Time: 130.34
Run: 55 train loss: 307.890381 Time: 278.33
Run: 55 VAL ap_score: 0.331982 map_score: 0.371348 Time: 130.74
Run: 56 train loss: 307.336167 Time: 278.77
Run: 56 VAL ap_score: 0.324747 map_score: 0.366772 Time: 130.43
Run: 57 train loss: 307.388245 Time: 279.02
Run: 57 VAL ap_score: 0.326338 map_score: 0.373085 Time: 130.11
Run: 58 train loss: 307.272645 Time: 279.01
Run: 58 VAL ap_score: 0.340972 map_score: 0.376090 Time: 129.91
Run: 59 train loss: 306.896014 Time: 278.48
Run: 59 VAL ap_score: 0.330117 map_score: 0.369729 Time: 130.66
Run: 60 train loss: 307.503827 Time: 278.74
Run: 60 VAL ap_score: 0.336128 map_score: 0.375827 Time: 130.90
Run: 61 train loss: 307.573507 Time: 279.17
Run: 61 VAL ap_score: 0.342425 map_score: 0.366084 Time: 130.83
Run: 62 train loss: 307.945574 Time: 278.25
Run: 62 VAL ap_score: 0.339182 map_score: 0.371331 Time: 128.98
Run: 63 train loss: 306.699006 Time: 224.90
Run: 63 VAL ap_score: 0.333056 map_score: 0.372612 Time: 99.90
Run: 64 train loss: 308.103608 Time: 218.92
Run: 64 VAL ap_score: 0.336760 map_score: 0.372258 Time: 99.91
Run: 65 train loss: 307.346373 Time: 217.92
Run: 65 VAL ap_score: 0.338839 map_score: 0.374167 Time: 100.49
Run: 66 train loss: 306.685579 Time: 217.82
Run: 66 VAL ap_score: 0.332074 map_score: 0.374423 Time: 99.98
Run: 67 train loss: 307.165253 Time: 219.34
Run: 67 VAL ap_score: 0.335483 map_score: 0.375794 Time: 99.82
Run: 68 train loss: 306.574727 Time: 218.42
Run: 68 VAL ap_score: 0.337068 map_score: 0.371767 Time: 100.56
Run: 69 train loss: 306.540340 Time: 219.18
Run: 69 VAL ap_score: 0.321285 map_score: 0.365034 Time: 100.15
Run: 70 train loss: 306.457702 Time: 218.70
Run: 70 VAL ap_score: 0.338609 map_score: 0.373660 Time: 100.15
Run: 71 train loss: 306.814045 Time: 219.09
Run: 71 VAL ap_score: 0.338048 map_score: 0.372041 Time: 100.12
Run: 72 train loss: 307.634281 Time: 218.46
Run: 72 VAL ap_score: 0.327555 map_score: 0.372970 Time: 100.37
Run: 73 train loss: 307.269270 Time: 219.33
Run: 73 VAL ap_score: 0.340040 map_score: 0.369403 Time: 100.35
Run: 74 train loss: 306.075589 Time: 220.18
Run: 74 VAL ap_score: 0.340926 map_score: 0.372761 Time: 100.06
Run: 75 train loss: 306.696650 Time: 216.44
Run: 75 VAL ap_score: 0.331247 map_score: 0.372503 Time: 101.21
Run: 76 train loss: 306.953299 Time: 221.44
Run: 76 VAL ap_score: 0.337649 map_score: 0.373258 Time: 100.28
Run: 77 train loss: 307.057622 Time: 221.17
Run: 77 VAL ap_score: 0.339072 map_score: 0.370990 Time: 101.13
Run: 78 train loss: 306.801418 Time: 219.95
Run: 78 VAL ap_score: 0.335407 map_score: 0.371106 Time: 65.99
Run: 79 train loss: 306.817043 Time: 139.51
Run: 79 VAL ap_score: 0.331145 map_score: 0.368790 Time: 62.76
Run: 80 train loss: 306.794959 Time: 139.82
Run: 80 VAL ap_score: 0.339512 map_score: 0.375223 Time: 62.99
Run: 81 train loss: 306.579192 Time: 140.80
Run: 81 VAL ap_score: 0.340402 map_score: 0.374063 Time: 63.18
Run: 82 train loss: 306.844547 Time: 141.56
Run: 82 VAL ap_score: 0.335797 map_score: 0.373837 Time: 62.02
Run: 83 train loss: 306.840560 Time: 141.54
Run: 83 VAL ap_score: 0.339520 map_score: 0.373696 Time: 62.49
Run: 84 train loss: 306.174022 Time: 140.51
Run: 84 VAL ap_score: 0.327417 map_score: 0.372962 Time: 61.87
Run: 85 train loss: 306.096844 Time: 142.36
Run: 85 VAL ap_score: 0.317796 map_score: 0.357143 Time: 62.65
Run: 86 train loss: 306.137700 Time: 142.30
Run: 86 VAL ap_score: 0.343137 map_score: 0.369931 Time: 63.44
Run: 87 train loss: 306.537115 Time: 140.93
Run: 87 VAL ap_score: 0.334782 map_score: 0.363209 Time: 63.65
Run: 88 train loss: 306.710809 Time: 141.43
Run: 88 VAL ap_score: 0.341027 map_score: 0.373296 Time: 63.46
Run: 89 train loss: 306.847461 Time: 142.28
Run: 89 VAL ap_score: 0.332993 map_score: 0.371603 Time: 62.79
Run: 90 train loss: 305.987257 Time: 141.47
Run: 90 VAL ap_score: 0.341914 map_score: 0.369036 Time: 63.68
Run: 91 train loss: 307.136266 Time: 142.64
Run: 91 VAL ap_score: 0.335159 map_score: 0.374789 Time: 63.55
Run: 92 train loss: 306.727437 Time: 141.23
Run: 92 VAL ap_score: 0.334645 map_score: 0.371526 Time: 61.66
Run: 93 train loss: 306.483418 Time: 141.16
Run: 93 VAL ap_score: 0.346426 map_score: 0.370948 Time: 62.75
loading best validated model from experiments/greed/trained_models/greed_aids_large_dataset_seed_7762_2024-04-26_16:16:21.pth
loaded test query graphs from ./large_dataset/splits/test/test_aids240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_aids240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/aids240k_corpus_subgraphs.pkl
TEST - ap_score: 0.302673 map_score: 0.327819
