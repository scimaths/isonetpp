Experiment greed for model: 'greed', dataset: 'mutag_large', seed: 1704 started at time: 2024-05-03_01:40:45
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id greed
--experiment_dir experiments/
--model_config_path configs/greed.yaml
--dataset_name mutag
--seed 1704
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_mutag240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_mutag240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/mutag240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_mutag240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_mutag240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/mutag240k_corpus_subgraphs.pkl
saving intial model to experiments/greed/initial_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
no. of params in model: 1840
Run: 0 train loss: 356.785430 Time: 135.81
Run: 0 VAL ap_score: 0.336182 map_score: 0.360985 Time: 56.12
saving best validated model to experiments/greed/trained_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
Run: 1 train loss: 338.805962 Time: 134.50
Run: 1 VAL ap_score: 0.347631 map_score: 0.371066 Time: 56.26
saving best validated model to experiments/greed/trained_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
Run: 2 train loss: 335.687493 Time: 134.79
Run: 2 VAL ap_score: 0.361113 map_score: 0.377498 Time: 55.68
saving best validated model to experiments/greed/trained_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
Run: 3 train loss: 335.252528 Time: 134.77
Run: 3 VAL ap_score: 0.358409 map_score: 0.376612 Time: 55.96
Run: 4 train loss: 333.504818 Time: 134.81
Run: 4 VAL ap_score: 0.355928 map_score: 0.374757 Time: 56.77
Run: 5 train loss: 333.573039 Time: 134.83
Run: 5 VAL ap_score: 0.367720 map_score: 0.382410 Time: 55.31
saving best validated model to experiments/greed/trained_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
Run: 6 train loss: 333.356976 Time: 134.95
Run: 6 VAL ap_score: 0.362382 map_score: 0.378990 Time: 56.52
Run: 7 train loss: 332.626720 Time: 134.41
Run: 7 VAL ap_score: 0.355091 map_score: 0.373568 Time: 56.78
Run: 8 train loss: 331.679734 Time: 134.86
Run: 8 VAL ap_score: 0.357331 map_score: 0.375541 Time: 56.08
Run: 9 train loss: 331.978411 Time: 135.68
Run: 9 VAL ap_score: 0.354739 map_score: 0.376934 Time: 56.63
Run: 10 train loss: 332.185472 Time: 135.74
Run: 10 VAL ap_score: 0.364395 map_score: 0.377623 Time: 56.78
Run: 11 train loss: 331.727181 Time: 135.59
Run: 11 VAL ap_score: 0.355353 map_score: 0.373825 Time: 56.26
Run: 12 train loss: 331.411448 Time: 134.43
Run: 12 VAL ap_score: 0.360074 map_score: 0.373857 Time: 56.53
Run: 13 train loss: 330.489013 Time: 134.91
Run: 13 VAL ap_score: 0.346423 map_score: 0.368569 Time: 102.97
Run: 14 train loss: 331.076663 Time: 283.74
Run: 14 VAL ap_score: 0.367926 map_score: 0.382411 Time: 124.35
Run: 15 train loss: 330.122601 Time: 285.09
Run: 15 VAL ap_score: 0.350513 map_score: 0.367305 Time: 122.46
Run: 16 train loss: 330.865577 Time: 287.77
Run: 16 VAL ap_score: 0.362500 map_score: 0.375974 Time: 121.44
Run: 17 train loss: 330.731382 Time: 287.59
Run: 17 VAL ap_score: 0.361371 map_score: 0.376410 Time: 122.79
Run: 18 train loss: 330.638818 Time: 285.33
Run: 18 VAL ap_score: 0.357224 map_score: 0.369567 Time: 124.90
Run: 19 train loss: 330.361502 Time: 283.19
Run: 19 VAL ap_score: 0.361583 map_score: 0.379218 Time: 126.63
Run: 20 train loss: 330.136067 Time: 281.16
Run: 20 VAL ap_score: 0.356059 map_score: 0.376004 Time: 129.13
Run: 21 train loss: 329.993891 Time: 278.74
Run: 21 VAL ap_score: 0.353299 map_score: 0.369999 Time: 129.82
Run: 22 train loss: 330.079185 Time: 278.66
Run: 22 VAL ap_score: 0.361915 map_score: 0.374025 Time: 130.47
Run: 23 train loss: 330.421348 Time: 277.33
Run: 23 VAL ap_score: 0.359812 map_score: 0.379782 Time: 131.01
Run: 24 train loss: 330.331870 Time: 276.57
Run: 24 VAL ap_score: 0.358159 map_score: 0.372267 Time: 130.88
Run: 25 train loss: 330.197127 Time: 277.33
Run: 25 VAL ap_score: 0.362477 map_score: 0.374122 Time: 130.96
Run: 26 train loss: 330.174076 Time: 278.01
Run: 26 VAL ap_score: 0.354097 map_score: 0.369020 Time: 130.42
Run: 27 train loss: 329.915125 Time: 278.73
Run: 27 VAL ap_score: 0.349677 map_score: 0.366487 Time: 129.56
Run: 28 train loss: 329.803768 Time: 279.73
Run: 28 VAL ap_score: 0.359896 map_score: 0.376151 Time: 128.15
Run: 29 train loss: 330.116515 Time: 280.98
Run: 29 VAL ap_score: 0.364289 map_score: 0.379573 Time: 127.24
Run: 30 train loss: 330.091711 Time: 283.09
Run: 30 VAL ap_score: 0.356016 map_score: 0.371791 Time: 125.70
Run: 31 train loss: 330.011774 Time: 283.90
Run: 31 VAL ap_score: 0.358482 map_score: 0.373308 Time: 125.51
Run: 32 train loss: 329.246113 Time: 283.27
Run: 32 VAL ap_score: 0.358051 map_score: 0.374643 Time: 125.59
Run: 33 train loss: 329.879629 Time: 282.62
Run: 33 VAL ap_score: 0.364541 map_score: 0.376547 Time: 125.60
Run: 34 train loss: 329.841323 Time: 282.69
Run: 34 VAL ap_score: 0.367448 map_score: 0.383563 Time: 126.07
saving best validated model to experiments/greed/trained_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
Run: 35 train loss: 329.279912 Time: 282.70
Run: 35 VAL ap_score: 0.362683 map_score: 0.375452 Time: 126.63
Run: 36 train loss: 329.627403 Time: 281.43
Run: 36 VAL ap_score: 0.360124 map_score: 0.376008 Time: 127.66
Run: 37 train loss: 329.477649 Time: 280.03
Run: 37 VAL ap_score: 0.360473 map_score: 0.388645 Time: 128.56
saving best validated model to experiments/greed/trained_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
Run: 38 train loss: 329.239785 Time: 279.07
Run: 38 VAL ap_score: 0.363012 map_score: 0.380728 Time: 129.46
Run: 39 train loss: 329.815010 Time: 278.27
Run: 39 VAL ap_score: 0.344569 map_score: 0.366744 Time: 130.66
Run: 40 train loss: 329.128905 Time: 277.35
Run: 40 VAL ap_score: 0.358161 map_score: 0.381866 Time: 131.18
Run: 41 train loss: 328.767634 Time: 277.09
Run: 41 VAL ap_score: 0.347835 map_score: 0.367736 Time: 130.72
Run: 42 train loss: 329.447794 Time: 277.75
Run: 42 VAL ap_score: 0.349188 map_score: 0.368099 Time: 130.06
Run: 43 train loss: 329.293900 Time: 280.09
Run: 43 VAL ap_score: 0.364952 map_score: 0.385542 Time: 128.01
Run: 44 train loss: 328.994718 Time: 280.50
Run: 44 VAL ap_score: 0.351754 map_score: 0.371119 Time: 127.25
Run: 45 train loss: 329.229360 Time: 281.56
Run: 45 VAL ap_score: 0.354541 map_score: 0.371703 Time: 126.42
Run: 46 train loss: 329.205897 Time: 281.41
Run: 46 VAL ap_score: 0.353526 map_score: 0.374587 Time: 127.63
Run: 47 train loss: 328.847700 Time: 281.11
Run: 47 VAL ap_score: 0.351300 map_score: 0.368481 Time: 128.75
Run: 48 train loss: 328.885906 Time: 280.25
Run: 48 VAL ap_score: 0.363485 map_score: 0.381741 Time: 128.43
Run: 49 train loss: 329.057170 Time: 279.71
Run: 49 VAL ap_score: 0.358499 map_score: 0.369211 Time: 128.92
Run: 50 train loss: 328.616282 Time: 279.47
Run: 50 VAL ap_score: 0.346868 map_score: 0.364940 Time: 128.06
Run: 51 train loss: 328.907773 Time: 280.60
Run: 51 VAL ap_score: 0.346605 map_score: 0.366246 Time: 126.94
Run: 52 train loss: 328.842255 Time: 281.54
Run: 52 VAL ap_score: 0.358443 map_score: 0.372290 Time: 126.27
Run: 53 train loss: 328.789053 Time: 281.29
Run: 53 VAL ap_score: 0.361112 map_score: 0.378226 Time: 127.23
Run: 54 train loss: 328.658570 Time: 280.15
Run: 54 VAL ap_score: 0.359968 map_score: 0.376340 Time: 128.23
Run: 55 train loss: 328.396304 Time: 279.14
Run: 55 VAL ap_score: 0.346767 map_score: 0.364522 Time: 129.02
Run: 56 train loss: 329.045810 Time: 280.12
Run: 56 VAL ap_score: 0.354696 map_score: 0.375424 Time: 128.69
Run: 57 train loss: 328.867526 Time: 279.88
Run: 57 VAL ap_score: 0.349946 map_score: 0.365162 Time: 128.58
Run: 58 train loss: 328.030062 Time: 279.98
Run: 58 VAL ap_score: 0.360999 map_score: 0.377735 Time: 127.31
Run: 59 train loss: 328.886471 Time: 281.14
Run: 59 VAL ap_score: 0.323909 map_score: 0.363639 Time: 126.22
Run: 60 train loss: 328.977050 Time: 281.35
Run: 60 VAL ap_score: 0.352894 map_score: 0.373948 Time: 126.86
Run: 61 train loss: 329.260619 Time: 280.49
Run: 61 VAL ap_score: 0.359010 map_score: 0.371983 Time: 128.18
Run: 62 train loss: 328.847073 Time: 279.80
Run: 62 VAL ap_score: 0.355235 map_score: 0.385973 Time: 129.86
Run: 63 train loss: 328.476825 Time: 279.26
Run: 63 VAL ap_score: 0.343100 map_score: 0.362970 Time: 130.71
Run: 64 train loss: 328.837189 Time: 277.57
Run: 64 VAL ap_score: 0.346929 map_score: 0.365465 Time: 131.08
Run: 65 train loss: 328.324401 Time: 277.89
Run: 65 VAL ap_score: 0.359412 map_score: 0.376380 Time: 129.91
Run: 66 train loss: 328.784891 Time: 278.71
Run: 66 VAL ap_score: 0.361028 map_score: 0.385353 Time: 128.91
Run: 67 train loss: 328.300340 Time: 279.46
Run: 67 VAL ap_score: 0.357322 map_score: 0.385892 Time: 128.04
Run: 68 train loss: 328.713057 Time: 280.42
Run: 68 VAL ap_score: 0.349406 map_score: 0.369198 Time: 126.80
Run: 69 train loss: 328.406857 Time: 281.38
Run: 69 VAL ap_score: 0.360158 map_score: 0.378774 Time: 126.30
Run: 70 train loss: 328.580892 Time: 282.35
Run: 70 VAL ap_score: 0.355028 map_score: 0.371606 Time: 126.32
Run: 71 train loss: 328.128851 Time: 282.53
Run: 71 VAL ap_score: 0.355554 map_score: 0.374705 Time: 126.07
Run: 72 train loss: 327.979692 Time: 282.53
Run: 72 VAL ap_score: 0.348503 map_score: 0.371536 Time: 126.03
Run: 73 train loss: 328.689815 Time: 282.55
Run: 73 VAL ap_score: 0.352190 map_score: 0.368979 Time: 125.87
Run: 74 train loss: 328.340424 Time: 282.69
Run: 74 VAL ap_score: 0.353775 map_score: 0.373337 Time: 125.98
Run: 75 train loss: 328.596758 Time: 281.93
Run: 75 VAL ap_score: 0.356802 map_score: 0.378662 Time: 127.23
Run: 76 train loss: 328.451457 Time: 281.06
Run: 76 VAL ap_score: 0.353336 map_score: 0.377901 Time: 128.44
Run: 77 train loss: 328.075812 Time: 279.54
Run: 77 VAL ap_score: 0.357174 map_score: 0.377080 Time: 129.86
Run: 78 train loss: 327.991928 Time: 278.56
Run: 78 VAL ap_score: 0.358116 map_score: 0.388278 Time: 130.96
Run: 79 train loss: 328.425768 Time: 277.43
Run: 79 VAL ap_score: 0.353346 map_score: 0.376226 Time: 131.56
Run: 80 train loss: 328.474208 Time: 277.54
Run: 80 VAL ap_score: 0.351965 map_score: 0.369523 Time: 131.43
Run: 81 train loss: 328.524191 Time: 277.40
Run: 81 VAL ap_score: 0.353961 map_score: 0.369054 Time: 131.55
Run: 82 train loss: 328.320904 Time: 277.13
Run: 82 VAL ap_score: 0.358481 map_score: 0.386202 Time: 131.04
Run: 83 train loss: 328.432356 Time: 278.13
Run: 83 VAL ap_score: 0.356525 map_score: 0.383413 Time: 130.59
Run: 84 train loss: 328.200158 Time: 279.14
Run: 84 VAL ap_score: 0.348304 map_score: 0.366233 Time: 129.63
Run: 85 train loss: 328.240483 Time: 280.50
Run: 85 VAL ap_score: 0.347862 map_score: 0.368838 Time: 128.14
Run: 86 train loss: 328.197930 Time: 281.86
Run: 86 VAL ap_score: 0.357478 map_score: 0.384641 Time: 126.22
Run: 87 train loss: 328.126410 Time: 284.10
Run: 87 VAL ap_score: 0.350777 map_score: 0.379901 Time: 124.45
Run: 88 train loss: 328.865370 Time: 285.89
Run: 88 VAL ap_score: 0.352051 map_score: 0.376899 Time: 122.86
loading best validated model from experiments/greed/trained_models/greed_mutag_large_dataset_seed_1704_2024-05-03_01:40:45.pth
loaded test query graphs from ./large_dataset/splits/test/test_mutag240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_mutag240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/mutag240k_corpus_subgraphs.pkl
TEST - ap_score: 0.369090 map_score: 0.387802
