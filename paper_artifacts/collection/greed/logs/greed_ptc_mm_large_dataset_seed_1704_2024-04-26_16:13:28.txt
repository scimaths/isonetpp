Experiment greed for model: 'greed', dataset: 'ptc_mm_large', seed: 1704 started at time: 2024-04-26_16:13:28
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id greed
--experiment_dir experiments/
--model_config_path configs/greed.yaml
--dataset_name ptc_mm
--seed 1704
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
saving intial model to experiments/greed/initial_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
no. of params in model: 1840
Run: 0 train loss: 328.029054 Time: 449.36
Run: 0 VAL ap_score: 0.332500 map_score: 0.379098 Time: 199.87
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
Run: 1 train loss: 311.080288 Time: 447.12
Run: 1 VAL ap_score: 0.340502 map_score: 0.387510 Time: 200.44
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
Run: 2 train loss: 309.607432 Time: 446.74
Run: 2 VAL ap_score: 0.342136 map_score: 0.390317 Time: 200.77
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
Run: 3 train loss: 307.431066 Time: 445.96
Run: 3 VAL ap_score: 0.356289 map_score: 0.401680 Time: 200.85
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
Run: 4 train loss: 307.783191 Time: 446.14
Run: 4 VAL ap_score: 0.344328 map_score: 0.391635 Time: 201.81
Run: 5 train loss: 305.766179 Time: 448.68
Run: 5 VAL ap_score: 0.350349 map_score: 0.400213 Time: 202.36
Run: 6 train loss: 305.782561 Time: 446.03
Run: 6 VAL ap_score: 0.334785 map_score: 0.385344 Time: 202.08
Run: 7 train loss: 305.871973 Time: 445.24
Run: 7 VAL ap_score: 0.358708 map_score: 0.396540 Time: 202.28
Run: 8 train loss: 304.263601 Time: 445.17
Run: 8 VAL ap_score: 0.361928 map_score: 0.403464 Time: 202.87
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
Run: 9 train loss: 304.209631 Time: 445.29
Run: 9 VAL ap_score: 0.354683 map_score: 0.401385 Time: 203.26
Run: 10 train loss: 304.283131 Time: 444.02
Run: 10 VAL ap_score: 0.362832 map_score: 0.406118 Time: 203.32
saving best validated model to experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
Run: 11 train loss: 303.501279 Time: 451.20
Run: 11 VAL ap_score: 0.344049 map_score: 0.396663 Time: 206.43
Run: 12 train loss: 303.203285 Time: 446.07
Run: 12 VAL ap_score: 0.350899 map_score: 0.397995 Time: 203.13
Run: 13 train loss: 303.703434 Time: 445.54
Run: 13 VAL ap_score: 0.360004 map_score: 0.403576 Time: 204.15
Run: 14 train loss: 302.649604 Time: 442.61
Run: 14 VAL ap_score: 0.362347 map_score: 0.401337 Time: 204.08
Run: 15 train loss: 302.621695 Time: 441.61
Run: 15 VAL ap_score: 0.351693 map_score: 0.402115 Time: 204.49
Run: 16 train loss: 303.036855 Time: 442.13
Run: 16 VAL ap_score: 0.357642 map_score: 0.399596 Time: 204.95
Run: 17 train loss: 302.362663 Time: 442.31
Run: 17 VAL ap_score: 0.353650 map_score: 0.399146 Time: 205.24
Run: 18 train loss: 302.632762 Time: 442.03
Run: 18 VAL ap_score: 0.351791 map_score: 0.397479 Time: 205.23
Run: 19 train loss: 301.501704 Time: 441.55
Run: 19 VAL ap_score: 0.352277 map_score: 0.400048 Time: 205.35
Run: 20 train loss: 301.712754 Time: 441.16
Run: 20 VAL ap_score: 0.366644 map_score: 0.405591 Time: 209.31
Run: 21 train loss: 301.454260 Time: 440.86
Run: 21 VAL ap_score: 0.319651 map_score: 0.393265 Time: 205.88
Run: 22 train loss: 302.470763 Time: 441.83
Run: 22 VAL ap_score: 0.350179 map_score: 0.397983 Time: 205.82
Run: 23 train loss: 301.694669 Time: 441.58
Run: 23 VAL ap_score: 0.359131 map_score: 0.405391 Time: 205.87
Run: 24 train loss: 301.977324 Time: 442.54
Run: 24 VAL ap_score: 0.361514 map_score: 0.405945 Time: 205.68
Run: 25 train loss: 301.784108 Time: 441.58
Run: 25 VAL ap_score: 0.347134 map_score: 0.402433 Time: 205.70
Run: 26 train loss: 300.313319 Time: 440.89
Run: 26 VAL ap_score: 0.339582 map_score: 0.399396 Time: 205.93
Run: 27 train loss: 301.036474 Time: 441.41
Run: 27 VAL ap_score: 0.361110 map_score: 0.403478 Time: 205.56
Run: 28 train loss: 301.134492 Time: 444.29
Run: 28 VAL ap_score: 0.355366 map_score: 0.394785 Time: 206.40
Run: 29 train loss: 302.408934 Time: 441.03
Run: 29 VAL ap_score: 0.346778 map_score: 0.399411 Time: 206.35
Run: 30 train loss: 301.044249 Time: 441.18
Run: 30 VAL ap_score: 0.350677 map_score: 0.391819 Time: 206.09
Run: 31 train loss: 301.021029 Time: 441.24
Run: 31 VAL ap_score: 0.344071 map_score: 0.386900 Time: 206.22
Run: 32 train loss: 301.399181 Time: 440.66
Run: 32 VAL ap_score: 0.356677 map_score: 0.399049 Time: 206.33
Run: 33 train loss: 300.230570 Time: 440.93
Run: 33 VAL ap_score: 0.330936 map_score: 0.401580 Time: 205.54
Run: 34 train loss: 300.390636 Time: 440.90
Run: 34 VAL ap_score: 0.353128 map_score: 0.399723 Time: 205.72
Run: 35 train loss: 299.525385 Time: 441.13
Run: 35 VAL ap_score: 0.341991 map_score: 0.401261 Time: 208.73
Run: 36 train loss: 300.187433 Time: 439.87
Run: 36 VAL ap_score: 0.358290 map_score: 0.399120 Time: 205.27
Run: 37 train loss: 300.103129 Time: 440.28
Run: 37 VAL ap_score: 0.340708 map_score: 0.398798 Time: 204.98
Run: 38 train loss: 300.273267 Time: 440.72
Run: 38 VAL ap_score: 0.350017 map_score: 0.401989 Time: 204.95
Run: 39 train loss: 299.867027 Time: 440.87
Run: 39 VAL ap_score: 0.345073 map_score: 0.401907 Time: 204.85
Run: 40 train loss: 300.399667 Time: 440.89
Run: 40 VAL ap_score: 0.349783 map_score: 0.404583 Time: 204.46
Run: 41 train loss: 300.011391 Time: 440.59
Run: 41 VAL ap_score: 0.357586 map_score: 0.403955 Time: 204.43
Run: 42 train loss: 299.705672 Time: 440.79
Run: 42 VAL ap_score: 0.344453 map_score: 0.402483 Time: 204.38
Run: 43 train loss: 299.609764 Time: 444.61
Run: 43 VAL ap_score: 0.355825 map_score: 0.392407 Time: 204.36
Run: 44 train loss: 299.553344 Time: 441.59
Run: 44 VAL ap_score: 0.341885 map_score: 0.397252 Time: 204.36
Run: 45 train loss: 298.534373 Time: 442.03
Run: 45 VAL ap_score: 0.348425 map_score: 0.403347 Time: 203.90
Run: 46 train loss: 299.945366 Time: 442.14
Run: 46 VAL ap_score: 0.356144 map_score: 0.405174 Time: 203.57
Run: 47 train loss: 299.542996 Time: 442.30
Run: 47 VAL ap_score: 0.347768 map_score: 0.402586 Time: 203.74
Run: 48 train loss: 299.558567 Time: 442.50
Run: 48 VAL ap_score: 0.357324 map_score: 0.400459 Time: 203.73
Run: 49 train loss: 299.450175 Time: 442.60
Run: 49 VAL ap_score: 0.362261 map_score: 0.402002 Time: 203.72
Run: 50 train loss: 299.469002 Time: 441.84
Run: 50 VAL ap_score: 0.347501 map_score: 0.392347 Time: 207.09
Run: 51 train loss: 299.542452 Time: 442.25
Run: 51 VAL ap_score: 0.361112 map_score: 0.406132 Time: 203.79
Run: 52 train loss: 299.362686 Time: 442.37
Run: 52 VAL ap_score: 0.346895 map_score: 0.397612 Time: 203.67
Run: 53 train loss: 298.784589 Time: 441.85
Run: 53 VAL ap_score: 0.358719 map_score: 0.402378 Time: 203.67
Run: 54 train loss: 299.230452 Time: 441.57
Run: 54 VAL ap_score: 0.344921 map_score: 0.400398 Time: 202.16
Run: 55 train loss: 298.298127 Time: 371.29
Run: 55 VAL ap_score: 0.357547 map_score: 0.404700 Time: 168.59
Run: 56 train loss: 298.717821 Time: 314.09
Run: 56 VAL ap_score: 0.348474 map_score: 0.403327 Time: 105.00
Run: 57 train loss: 298.426117 Time: 234.55
Run: 57 VAL ap_score: 0.349237 map_score: 0.404172 Time: 104.97
Run: 58 train loss: 298.864841 Time: 234.83
Run: 58 VAL ap_score: 0.359877 map_score: 0.405531 Time: 104.97
Run: 59 train loss: 298.278177 Time: 234.38
Run: 59 VAL ap_score: 0.351609 map_score: 0.394522 Time: 104.97
Run: 60 train loss: 298.500995 Time: 237.60
Run: 60 VAL ap_score: 0.349104 map_score: 0.402681 Time: 104.58
Run: 61 train loss: 299.527143 Time: 234.73
Run: 61 VAL ap_score: 0.341439 map_score: 0.397173 Time: 104.71
loading best validated model from experiments/greed/trained_models/greed_ptc_mm_large_dataset_seed_1704_2024-04-26_16:13:28.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_mm240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
TEST - ap_score: 0.329495 map_score: 0.368240
