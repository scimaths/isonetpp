Experiment h2mn for model: 'H2MN', dataset: 'ptc_mm_large', seed: 4929 started at time: 2024-05-03_03:00:04
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph_matching/train.py
--experiment_id h2mn
--experiment_dir experiments/
--model_config_path configs/h2mn.yaml
--dataset_name ptc_mm
--seed 4929
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
saving intial model to experiments/h2mn/initial_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
no. of params in model: 2974
Run: 0 train loss: 490.260154 Time: 1401.62
Run: 0 VAL ap_score: 0.234021 map_score: 0.247704 Time: 609.03
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 1 train loss: 479.192408 Time: 1401.11
Run: 1 VAL ap_score: 0.227832 map_score: 0.243019 Time: 609.89
Run: 2 train loss: 480.874266 Time: 1399.66
Run: 2 VAL ap_score: 0.220149 map_score: 0.244778 Time: 610.96
Run: 3 train loss: 473.871937 Time: 1398.86
Run: 3 VAL ap_score: 0.237210 map_score: 0.244068 Time: 611.72
Run: 4 train loss: 466.752268 Time: 1397.77
Run: 4 VAL ap_score: 0.234613 map_score: 0.252498 Time: 612.57
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 5 train loss: 463.642795 Time: 1397.20
Run: 5 VAL ap_score: 0.241516 map_score: 0.256963 Time: 613.59
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 6 train loss: 462.498296 Time: 1396.24
Run: 6 VAL ap_score: 0.240019 map_score: 0.255418 Time: 614.35
Run: 7 train loss: 462.771427 Time: 1395.51
Run: 7 VAL ap_score: 0.238914 map_score: 0.262753 Time: 615.52
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 8 train loss: 458.598876 Time: 1393.88
Run: 8 VAL ap_score: 0.239711 map_score: 0.252080 Time: 616.10
Run: 9 train loss: 460.452069 Time: 1394.54
Run: 9 VAL ap_score: 0.245515 map_score: 0.257298 Time: 616.99
Run: 10 train loss: 458.071398 Time: 1392.20
Run: 10 VAL ap_score: 0.237685 map_score: 0.255103 Time: 618.34
Run: 11 train loss: 465.212445 Time: 1391.99
Run: 11 VAL ap_score: 0.235073 map_score: 0.250058 Time: 618.62
Run: 12 train loss: 462.665184 Time: 1390.40
Run: 12 VAL ap_score: 0.235714 map_score: 0.247432 Time: 619.60
Run: 13 train loss: 461.359924 Time: 1389.51
Run: 13 VAL ap_score: 0.247914 map_score: 0.250471 Time: 620.29
Run: 14 train loss: 458.236396 Time: 1389.41
Run: 14 VAL ap_score: 0.237614 map_score: 0.258741 Time: 620.83
Run: 15 train loss: 457.936865 Time: 1389.95
Run: 15 VAL ap_score: 0.240899 map_score: 0.252324 Time: 621.46
Run: 16 train loss: 458.752481 Time: 1389.95
Run: 16 VAL ap_score: 0.242647 map_score: 0.256801 Time: 621.95
Run: 17 train loss: 458.677369 Time: 1388.19
Run: 17 VAL ap_score: 0.243061 map_score: 0.256236 Time: 622.44
Run: 18 train loss: 455.700103 Time: 1388.40
Run: 18 VAL ap_score: 0.239836 map_score: 0.252122 Time: 622.55
Run: 19 train loss: 456.488793 Time: 1387.64
Run: 19 VAL ap_score: 0.240877 map_score: 0.258901 Time: 622.98
Run: 20 train loss: 455.990740 Time: 1387.59
Run: 20 VAL ap_score: 0.238649 map_score: 0.260134 Time: 623.45
Run: 21 train loss: 454.314388 Time: 1386.70
Run: 21 VAL ap_score: 0.242786 map_score: 0.262122 Time: 623.73
Run: 22 train loss: 453.572241 Time: 1386.99
Run: 22 VAL ap_score: 0.236067 map_score: 0.258974 Time: 624.06
Run: 23 train loss: 454.518761 Time: 1387.53
Run: 23 VAL ap_score: 0.242097 map_score: 0.259471 Time: 625.74
Run: 24 train loss: 470.945388 Time: 1390.06
Run: 24 VAL ap_score: 0.230352 map_score: 0.252047 Time: 625.84
Run: 25 train loss: 464.797330 Time: 1389.12
Run: 25 VAL ap_score: 0.236122 map_score: 0.252263 Time: 625.99
Run: 26 train loss: 462.456478 Time: 1389.61
Run: 26 VAL ap_score: 0.238587 map_score: 0.255120 Time: 626.17
Run: 27 train loss: 458.112735 Time: 1389.44
Run: 27 VAL ap_score: 0.243759 map_score: 0.263662 Time: 626.05
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 28 train loss: 455.221703 Time: 1385.31
Run: 28 VAL ap_score: 0.238166 map_score: 0.258436 Time: 624.74
Run: 29 train loss: 451.161253 Time: 1385.33
Run: 29 VAL ap_score: 0.247684 map_score: 0.256019 Time: 624.99
Run: 30 train loss: 451.134573 Time: 1385.59
Run: 30 VAL ap_score: 0.243088 map_score: 0.254762 Time: 624.35
Run: 31 train loss: 452.846465 Time: 1385.11
Run: 31 VAL ap_score: 0.241547 map_score: 0.259922 Time: 624.59
Run: 32 train loss: 448.976804 Time: 1385.85
Run: 32 VAL ap_score: 0.245841 map_score: 0.262356 Time: 624.19
Run: 33 train loss: 455.253392 Time: 1386.04
Run: 33 VAL ap_score: 0.232280 map_score: 0.259929 Time: 624.14
Run: 34 train loss: 451.703699 Time: 1365.55
Run: 34 VAL ap_score: 0.247003 map_score: 0.265030 Time: 512.73
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 35 train loss: 453.578776 Time: 1145.94
Run: 35 VAL ap_score: 0.248224 map_score: 0.260370 Time: 512.45
Run: 36 train loss: 450.914563 Time: 1117.43
Run: 36 VAL ap_score: 0.241040 map_score: 0.259432 Time: 126.01
Run: 37 train loss: 451.384003 Time: 170.13
Run: 37 VAL ap_score: 0.246336 map_score: 0.257740 Time: 68.44
Run: 38 train loss: 450.915812 Time: 171.47
Run: 38 VAL ap_score: 0.244480 map_score: 0.261016 Time: 68.40
Run: 39 train loss: 451.030758 Time: 169.35
Run: 39 VAL ap_score: 0.245739 map_score: 0.260238 Time: 68.46
Run: 40 train loss: 450.586320 Time: 168.72
Run: 40 VAL ap_score: 0.248577 map_score: 0.266499 Time: 68.64
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 41 train loss: 451.078095 Time: 168.59
Run: 41 VAL ap_score: 0.246698 map_score: 0.265274 Time: 68.43
Run: 42 train loss: 450.405665 Time: 168.83
Run: 42 VAL ap_score: 0.245018 map_score: 0.258856 Time: 68.55
Run: 43 train loss: 449.559084 Time: 168.75
Run: 43 VAL ap_score: 0.229849 map_score: 0.254365 Time: 68.65
Run: 44 train loss: 455.402978 Time: 168.89
Run: 44 VAL ap_score: 0.242333 map_score: 0.262420 Time: 68.53
Run: 45 train loss: 455.680554 Time: 169.05
Run: 45 VAL ap_score: 0.241196 map_score: 0.266912 Time: 68.55
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 46 train loss: 451.473505 Time: 169.00
Run: 46 VAL ap_score: 0.244951 map_score: 0.263047 Time: 68.66
Run: 47 train loss: 449.981098 Time: 168.81
Run: 47 VAL ap_score: 0.245539 map_score: 0.259639 Time: 68.55
Run: 48 train loss: 448.460652 Time: 168.69
Run: 48 VAL ap_score: 0.242061 map_score: 0.259681 Time: 68.48
Run: 49 train loss: 449.189728 Time: 168.45
Run: 49 VAL ap_score: 0.244056 map_score: 0.262347 Time: 68.51
Run: 50 train loss: 450.150726 Time: 168.68
Run: 50 VAL ap_score: 0.247089 map_score: 0.267163 Time: 68.49
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 51 train loss: 448.748798 Time: 168.59
Run: 51 VAL ap_score: 0.231095 map_score: 0.252142 Time: 68.44
Run: 52 train loss: 450.766252 Time: 168.60
Run: 52 VAL ap_score: 0.243098 map_score: 0.259920 Time: 68.41
Run: 53 train loss: 450.673705 Time: 168.54
Run: 53 VAL ap_score: 0.246421 map_score: 0.263923 Time: 68.54
Run: 54 train loss: 445.819305 Time: 169.05
Run: 54 VAL ap_score: 0.256407 map_score: 0.271051 Time: 68.45
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 55 train loss: 444.750493 Time: 168.79
Run: 55 VAL ap_score: 0.254237 map_score: 0.274930 Time: 68.40
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 56 train loss: 422.151362 Time: 169.89
Run: 56 VAL ap_score: 0.271555 map_score: 0.307580 Time: 68.56
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 57 train loss: 404.903807 Time: 168.77
Run: 57 VAL ap_score: 0.286082 map_score: 0.311916 Time: 68.56
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 58 train loss: 402.730265 Time: 168.63
Run: 58 VAL ap_score: 0.285525 map_score: 0.316081 Time: 68.61
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 59 train loss: 402.291364 Time: 169.02
Run: 59 VAL ap_score: 0.259322 map_score: 0.300970 Time: 68.61
Run: 60 train loss: 402.656756 Time: 168.75
Run: 60 VAL ap_score: 0.285967 map_score: 0.312721 Time: 68.46
Run: 61 train loss: 400.639390 Time: 168.87
Run: 61 VAL ap_score: 0.282300 map_score: 0.317432 Time: 68.49
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 62 train loss: 402.211310 Time: 168.67
Run: 62 VAL ap_score: 0.287480 map_score: 0.311504 Time: 68.50
Run: 63 train loss: 401.257922 Time: 168.61
Run: 63 VAL ap_score: 0.280912 map_score: 0.308090 Time: 68.62
Run: 64 train loss: 399.908980 Time: 168.55
Run: 64 VAL ap_score: 0.286917 map_score: 0.316394 Time: 68.64
Run: 65 train loss: 400.897203 Time: 168.67
Run: 65 VAL ap_score: 0.287399 map_score: 0.313481 Time: 68.49
Run: 66 train loss: 400.112510 Time: 168.57
Run: 66 VAL ap_score: 0.280104 map_score: 0.316992 Time: 68.58
Run: 67 train loss: 400.729411 Time: 168.62
Run: 67 VAL ap_score: 0.282859 map_score: 0.309355 Time: 68.47
Run: 68 train loss: 402.779575 Time: 168.65
Run: 68 VAL ap_score: 0.279051 map_score: 0.303233 Time: 68.44
Run: 69 train loss: 460.435856 Time: 168.64
Run: 69 VAL ap_score: 0.242216 map_score: 0.263488 Time: 68.61
Run: 70 train loss: 446.587353 Time: 168.67
Run: 70 VAL ap_score: 0.270901 map_score: 0.292303 Time: 68.47
Run: 71 train loss: 408.465525 Time: 168.70
Run: 71 VAL ap_score: 0.308660 map_score: 0.343694 Time: 68.47
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 72 train loss: 383.008960 Time: 169.18
Run: 72 VAL ap_score: 0.303394 map_score: 0.329094 Time: 68.49
Run: 73 train loss: 381.543965 Time: 168.79
Run: 73 VAL ap_score: 0.315809 map_score: 0.341364 Time: 68.60
Run: 74 train loss: 396.805043 Time: 169.05
Run: 74 VAL ap_score: 0.225453 map_score: 0.246295 Time: 68.57
Run: 75 train loss: 437.521410 Time: 171.35
Run: 75 VAL ap_score: 0.297305 map_score: 0.325295 Time: 68.58
Run: 76 train loss: 384.810328 Time: 171.93
Run: 76 VAL ap_score: 0.319579 map_score: 0.348245 Time: 68.70
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
Run: 77 train loss: 379.855983 Time: 171.90
Run: 77 VAL ap_score: 0.312147 map_score: 0.340529 Time: 68.59
Run: 78 train loss: 376.171752 Time: 174.37
Run: 78 VAL ap_score: 0.306842 map_score: 0.331134 Time: 83.83
Run: 79 train loss: 377.779450 Time: 187.01
Run: 79 VAL ap_score: 0.296952 map_score: 0.330557 Time: 68.57
Run: 80 train loss: 374.790835 Time: 171.60
Run: 80 VAL ap_score: 0.312650 map_score: 0.340331 Time: 68.50
Run: 81 train loss: 371.825385 Time: 190.98
Run: 81 VAL ap_score: 0.319357 map_score: 0.346419 Time: 68.59
Run: 82 train loss: 375.117074 Time: 171.52
Run: 82 VAL ap_score: 0.309009 map_score: 0.338382 Time: 68.48
Run: 83 train loss: 380.250650 Time: 171.62
Run: 83 VAL ap_score: 0.317118 map_score: 0.337956 Time: 68.51
Run: 84 train loss: 457.913546 Time: 182.39
Run: 84 VAL ap_score: 0.169972 map_score: 0.169972 Time: 84.04
Run: 85 train loss: 557.999999 Time: 201.71
Run: 85 VAL ap_score: 0.169972 map_score: 0.169972 Time: 83.91
Run: 86 train loss: 557.999999 Time: 189.15
Run: 86 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.47
Run: 87 train loss: 557.999999 Time: 170.44
Run: 87 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.35
Run: 88 train loss: 557.999999 Time: 168.37
Run: 88 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.47
Run: 89 train loss: 557.999999 Time: 168.44
Run: 89 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.37
Run: 90 train loss: 557.999999 Time: 168.32
Run: 90 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.46
Run: 91 train loss: 557.999999 Time: 168.54
Run: 91 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.39
Run: 92 train loss: 557.999999 Time: 168.60
Run: 92 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.45
Run: 93 train loss: 557.999999 Time: 168.56
Run: 93 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.58
Run: 94 train loss: 557.999999 Time: 168.63
Run: 94 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.47
Run: 95 train loss: 557.999999 Time: 168.69
Run: 95 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.47
Run: 96 train loss: 557.999999 Time: 168.58
Run: 96 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.38
Run: 97 train loss: 557.999999 Time: 168.65
Run: 97 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.59
Run: 98 train loss: 557.999999 Time: 168.62
Run: 98 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.49
Run: 99 train loss: 557.999999 Time: 168.62
Run: 99 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.56
Run: 100 train loss: 557.999999 Time: 168.66
Run: 100 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.46
Run: 101 train loss: 557.999999 Time: 168.67
Run: 101 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.65
Run: 102 train loss: 557.999999 Time: 168.59
Run: 102 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.55
Run: 103 train loss: 557.999999 Time: 169.15
Run: 103 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.46
Run: 104 train loss: 557.999999 Time: 168.98
Run: 104 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.66
Run: 105 train loss: 557.999999 Time: 169.37
Run: 105 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.62
Run: 106 train loss: 557.999999 Time: 169.28
Run: 106 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.75
Run: 107 train loss: 557.999999 Time: 169.14
Run: 107 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.65
Run: 108 train loss: 557.999999 Time: 169.06
Run: 108 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.73
Run: 109 train loss: 557.999999 Time: 169.31
Run: 109 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.66
Run: 110 train loss: 557.999999 Time: 169.43
Run: 110 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.54
Run: 111 train loss: 557.999999 Time: 170.51
Run: 111 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.50
Run: 112 train loss: 557.999999 Time: 171.57
Run: 112 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.41
Run: 113 train loss: 557.999999 Time: 171.57
Run: 113 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.40
Run: 114 train loss: 557.999999 Time: 171.59
Run: 114 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.40
Run: 115 train loss: 557.999999 Time: 171.49
Run: 115 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.49
Run: 116 train loss: 557.999999 Time: 171.70
Run: 116 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.51
Run: 117 train loss: 557.999999 Time: 171.42
Run: 117 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.62
Run: 118 train loss: 557.999999 Time: 170.93
Run: 118 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.48
Run: 119 train loss: 557.999999 Time: 168.92
Run: 119 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.46
Run: 120 train loss: 557.999999 Time: 168.65
Run: 120 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.58
Run: 121 train loss: 557.999999 Time: 168.87
Run: 121 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.53
Run: 122 train loss: 557.999999 Time: 169.29
Run: 122 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.55
Run: 123 train loss: 557.999999 Time: 168.84
Run: 123 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.45
Run: 124 train loss: 557.999999 Time: 168.74
Run: 124 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.54
Run: 125 train loss: 557.999999 Time: 168.73
Run: 125 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.50
Run: 126 train loss: 557.999999 Time: 168.91
Run: 126 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.49
Run: 127 train loss: 557.999999 Time: 168.41
Run: 127 VAL ap_score: 0.169972 map_score: 0.169972 Time: 68.38
loading best validated model from experiments/h2mn/trained_models/H2MN_ptc_mm_large_dataset_seed_4929_2024-05-03_03:00:04.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_mm240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
TEST - ap_score: 0.288651 map_score: 0.317038
