Experiment h2mn for model: 'H2MN', dataset: 'mutag_large', seed: 4929 started at time: 2024-05-03_03:00:24
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph_matching/train.py
--experiment_id h2mn
--experiment_dir experiments/
--model_config_path configs/h2mn.yaml
--dataset_name mutag
--seed 4929
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_mutag240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_mutag240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/mutag240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_mutag240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_mutag240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/mutag240k_corpus_subgraphs.pkl
saving intial model to experiments/h2mn/initial_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
no. of params in model: 2974
Run: 0 train loss: 451.424673 Time: 7165.52
Run: 0 VAL ap_score: 0.225728 map_score: 0.247473 Time: 3236.27
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 1 train loss: 445.784389 Time: 7172.23
Run: 1 VAL ap_score: 0.227732 map_score: 0.252060 Time: 3239.50
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 2 train loss: 443.496371 Time: 6548.47
Run: 2 VAL ap_score: 0.228789 map_score: 0.257941 Time: 2654.59
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 3 train loss: 441.010016 Time: 5056.43
Run: 3 VAL ap_score: 0.237282 map_score: 0.265993 Time: 2079.26
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 4 train loss: 439.311989 Time: 4630.14
Run: 4 VAL ap_score: 0.248011 map_score: 0.265055 Time: 2081.01
Run: 5 train loss: 434.486192 Time: 4632.89
Run: 5 VAL ap_score: 0.254828 map_score: 0.272455 Time: 2095.68
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 6 train loss: 432.887715 Time: 4659.74
Run: 6 VAL ap_score: 0.244119 map_score: 0.278986 Time: 2086.53
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 7 train loss: 429.620343 Time: 4625.85
Run: 7 VAL ap_score: 0.253468 map_score: 0.277399 Time: 2083.69
Run: 8 train loss: 432.210486 Time: 4259.44
Run: 8 VAL ap_score: 0.257383 map_score: 0.278547 Time: 1371.13
Run: 9 train loss: 432.286133 Time: 2308.27
Run: 9 VAL ap_score: 0.249456 map_score: 0.281372 Time: 1009.90
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 10 train loss: 427.758089 Time: 1729.83
Run: 10 VAL ap_score: 0.248603 map_score: 0.281335 Time: 770.60
Run: 11 train loss: 429.974100 Time: 1729.02
Run: 11 VAL ap_score: 0.241940 map_score: 0.283047 Time: 771.51
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 12 train loss: 429.403152 Time: 1727.89
Run: 12 VAL ap_score: 0.252038 map_score: 0.284392 Time: 772.20
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 13 train loss: 428.757285 Time: 1726.99
Run: 13 VAL ap_score: 0.249798 map_score: 0.281721 Time: 773.25
Run: 14 train loss: 428.608893 Time: 1726.01
Run: 14 VAL ap_score: 0.250485 map_score: 0.282171 Time: 773.98
Run: 15 train loss: 429.777187 Time: 1725.03
Run: 15 VAL ap_score: 0.257600 map_score: 0.279859 Time: 774.97
Run: 16 train loss: 428.770160 Time: 1724.26
Run: 16 VAL ap_score: 0.253840 map_score: 0.281295 Time: 775.54
Run: 17 train loss: 428.553930 Time: 1723.37
Run: 17 VAL ap_score: 0.253283 map_score: 0.285395 Time: 776.20
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 18 train loss: 427.912879 Time: 1722.56
Run: 18 VAL ap_score: 0.244183 map_score: 0.284016 Time: 777.51
Run: 19 train loss: 428.017926 Time: 1721.92
Run: 19 VAL ap_score: 0.250764 map_score: 0.284752 Time: 778.13
Run: 20 train loss: 429.006314 Time: 1721.02
Run: 20 VAL ap_score: 0.251811 map_score: 0.284306 Time: 779.17
Run: 21 train loss: 428.322632 Time: 1720.59
Run: 21 VAL ap_score: 0.259383 map_score: 0.282300 Time: 779.54
Run: 22 train loss: 428.411458 Time: 1720.78
Run: 22 VAL ap_score: 0.251464 map_score: 0.283534 Time: 780.21
Run: 23 train loss: 428.024241 Time: 1720.08
Run: 23 VAL ap_score: 0.257076 map_score: 0.281056 Time: 780.63
Run: 24 train loss: 429.339396 Time: 1719.54
Run: 24 VAL ap_score: 0.250955 map_score: 0.282752 Time: 780.93
Run: 25 train loss: 427.638452 Time: 1719.08
Run: 25 VAL ap_score: 0.257278 map_score: 0.283716 Time: 781.35
Run: 26 train loss: 427.586525 Time: 1718.83
Run: 26 VAL ap_score: 0.254573 map_score: 0.279022 Time: 781.43
Run: 27 train loss: 426.875181 Time: 1717.73
Run: 27 VAL ap_score: 0.242023 map_score: 0.282706 Time: 781.97
Run: 28 train loss: 427.597082 Time: 1717.47
Run: 28 VAL ap_score: 0.246989 map_score: 0.284790 Time: 782.21
Run: 29 train loss: 428.438095 Time: 1716.97
Run: 29 VAL ap_score: 0.260833 map_score: 0.278924 Time: 782.62
Run: 30 train loss: 427.104301 Time: 1718.35
Run: 30 VAL ap_score: 0.258302 map_score: 0.285199 Time: 782.81
Run: 31 train loss: 428.015865 Time: 928.84
Run: 31 VAL ap_score: 0.254296 map_score: 0.280526 Time: 261.58
Run: 32 train loss: 427.509071 Time: 581.07
Run: 32 VAL ap_score: 0.258893 map_score: 0.282771 Time: 856.65
Run: 33 train loss: 427.829539 Time: 587.88
Run: 33 VAL ap_score: 0.259922 map_score: 0.286074 Time: 260.97
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 34 train loss: 427.296470 Time: 580.77
Run: 34 VAL ap_score: 0.260251 map_score: 0.285270 Time: 261.02
Run: 35 train loss: 427.815342 Time: 580.79
Run: 35 VAL ap_score: 0.251331 map_score: 0.284906 Time: 261.17
Run: 36 train loss: 428.340868 Time: 582.28
Run: 36 VAL ap_score: 0.255482 map_score: 0.283562 Time: 260.94
Run: 37 train loss: 428.955077 Time: 581.29
Run: 37 VAL ap_score: 0.249557 map_score: 0.280638 Time: 261.24
Run: 38 train loss: 429.136305 Time: 581.14
Run: 38 VAL ap_score: 0.241514 map_score: 0.283816 Time: 260.84
Run: 39 train loss: 428.426080 Time: 581.03
Run: 39 VAL ap_score: 0.255715 map_score: 0.281180 Time: 260.68
Run: 40 train loss: 426.996536 Time: 580.35
Run: 40 VAL ap_score: 0.262325 map_score: 0.281476 Time: 260.35
Run: 41 train loss: 427.146021 Time: 581.56
Run: 41 VAL ap_score: 0.258301 map_score: 0.283783 Time: 259.95
Run: 42 train loss: 426.766974 Time: 580.81
Run: 42 VAL ap_score: 0.247026 map_score: 0.282848 Time: 259.37
Run: 43 train loss: 426.509774 Time: 580.45
Run: 43 VAL ap_score: 0.251697 map_score: 0.284581 Time: 259.63
Run: 44 train loss: 427.485445 Time: 578.89
Run: 44 VAL ap_score: 0.253984 map_score: 0.286054 Time: 258.84
Run: 45 train loss: 427.493829 Time: 578.38
Run: 45 VAL ap_score: 0.257925 map_score: 0.283111 Time: 258.35
Run: 46 train loss: 427.342100 Time: 581.14
Run: 46 VAL ap_score: 0.254879 map_score: 0.287376 Time: 259.47
saving best validated model to experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
Run: 47 train loss: 427.454994 Time: 597.66
Run: 47 VAL ap_score: 0.258638 map_score: 0.283689 Time: 256.37
Run: 48 train loss: 427.289926 Time: 580.00
Run: 48 VAL ap_score: 0.259653 map_score: 0.282891 Time: 255.50
Run: 49 train loss: 427.692160 Time: 578.68
Run: 49 VAL ap_score: 0.255204 map_score: 0.282983 Time: 254.40
Run: 50 train loss: 426.434038 Time: 580.34
Run: 50 VAL ap_score: 0.254962 map_score: 0.279887 Time: 254.27
Run: 51 train loss: 427.026388 Time: 581.35
Run: 51 VAL ap_score: 0.262995 map_score: 0.282097 Time: 254.26
Run: 52 train loss: 427.432781 Time: 588.31
Run: 52 VAL ap_score: 0.249103 map_score: 0.283614 Time: 256.23
Run: 53 train loss: 426.658380 Time: 582.19
Run: 53 VAL ap_score: 0.252664 map_score: 0.281073 Time: 256.63
Run: 54 train loss: 426.302002 Time: 580.43
Run: 54 VAL ap_score: 0.259785 map_score: 0.284329 Time: 257.23
Run: 55 train loss: 427.066310 Time: 581.07
Run: 55 VAL ap_score: 0.251016 map_score: 0.283486 Time: 257.92
Run: 56 train loss: 427.873513 Time: 579.23
Run: 56 VAL ap_score: 0.251017 map_score: 0.285481 Time: 257.58
Run: 57 train loss: 426.356912 Time: 581.03
Run: 57 VAL ap_score: 0.254268 map_score: 0.282075 Time: 258.65
Run: 58 train loss: 426.889518 Time: 579.87
Run: 58 VAL ap_score: 0.262601 map_score: 0.285310 Time: 258.80
Run: 59 train loss: 426.242173 Time: 580.56
Run: 59 VAL ap_score: 0.258151 map_score: 0.279735 Time: 259.16
Run: 60 train loss: 426.411967 Time: 580.65
Run: 60 VAL ap_score: 0.259672 map_score: 0.279243 Time: 259.38
Run: 61 train loss: 426.468625 Time: 606.29
Run: 61 VAL ap_score: 0.250404 map_score: 0.285480 Time: 270.73
Run: 62 train loss: 427.043448 Time: 600.31
Run: 62 VAL ap_score: 0.261631 map_score: 0.284876 Time: 261.33
Run: 63 train loss: 426.930503 Time: 581.30
Run: 63 VAL ap_score: 0.249024 map_score: 0.283526 Time: 261.13
Run: 64 train loss: 426.418445 Time: 579.98
Run: 64 VAL ap_score: 0.251923 map_score: 0.285186 Time: 261.06
Run: 65 train loss: 425.986032 Time: 580.84
Run: 65 VAL ap_score: 0.249853 map_score: 0.284103 Time: 260.68
Run: 66 train loss: 426.632030 Time: 580.36
Run: 66 VAL ap_score: 0.264438 map_score: 0.286106 Time: 260.81
Run: 67 train loss: 425.963952 Time: 580.51
Run: 67 VAL ap_score: 0.250692 map_score: 0.274525 Time: 261.06
Run: 68 train loss: 426.691967 Time: 579.82
Run: 68 VAL ap_score: 0.258755 map_score: 0.285006 Time: 261.26
Run: 69 train loss: 426.775239 Time: 580.75
Run: 69 VAL ap_score: 0.263079 map_score: 0.282695 Time: 260.66
Run: 70 train loss: 426.610767 Time: 579.91
Run: 70 VAL ap_score: 0.258196 map_score: 0.283765 Time: 271.37
Run: 71 train loss: 427.460971 Time: 580.14
Run: 71 VAL ap_score: 0.257892 map_score: 0.286419 Time: 261.03
Run: 72 train loss: 427.175847 Time: 580.95
Run: 72 VAL ap_score: 0.259620 map_score: 0.285667 Time: 260.97
Run: 73 train loss: 426.737877 Time: 581.34
Run: 73 VAL ap_score: 0.262561 map_score: 0.281844 Time: 260.77
Run: 74 train loss: 425.725237 Time: 580.43
Run: 74 VAL ap_score: 0.254377 map_score: 0.282439 Time: 260.90
Run: 75 train loss: 425.626815 Time: 581.03
Run: 75 VAL ap_score: 0.254477 map_score: 0.283947 Time: 260.25
Run: 76 train loss: 427.706150 Time: 580.84
Run: 76 VAL ap_score: 0.258809 map_score: 0.284948 Time: 260.10
Run: 77 train loss: 427.184522 Time: 582.02
Run: 77 VAL ap_score: 0.262974 map_score: 0.281783 Time: 259.69
Run: 78 train loss: 425.548897 Time: 582.37
Run: 78 VAL ap_score: 0.259509 map_score: 0.281911 Time: 259.01
Run: 79 train loss: 426.907366 Time: 581.32
Run: 79 VAL ap_score: 0.255544 map_score: 0.284897 Time: 258.43
Run: 80 train loss: 426.657400 Time: 582.14
Run: 80 VAL ap_score: 0.252536 map_score: 0.283571 Time: 257.94
Run: 81 train loss: 426.210693 Time: 581.68
Run: 81 VAL ap_score: 0.254651 map_score: 0.281149 Time: 257.39
Run: 82 train loss: 426.275657 Time: 581.33
Run: 82 VAL ap_score: 0.257393 map_score: 0.283810 Time: 256.66
Run: 83 train loss: 425.493960 Time: 581.27
Run: 83 VAL ap_score: 0.256049 map_score: 0.284303 Time: 257.45
Run: 84 train loss: 426.504062 Time: 581.45
Run: 84 VAL ap_score: 0.256254 map_score: 0.283544 Time: 255.00
Run: 85 train loss: 426.808527 Time: 581.83
Run: 85 VAL ap_score: 0.261204 map_score: 0.286765 Time: 255.72
Run: 86 train loss: 425.650557 Time: 584.29
Run: 86 VAL ap_score: 0.259775 map_score: 0.284444 Time: 260.21
Run: 87 train loss: 427.159176 Time: 592.56
Run: 87 VAL ap_score: 0.259385 map_score: 0.278889 Time: 260.57
Run: 88 train loss: 426.701072 Time: 593.93
Run: 88 VAL ap_score: 0.246998 map_score: 0.284677 Time: 260.15
Run: 89 train loss: 427.486143 Time: 592.00
Run: 89 VAL ap_score: 0.247750 map_score: 0.284365 Time: 260.42
Run: 90 train loss: 425.796871 Time: 594.58
Run: 90 VAL ap_score: 0.259611 map_score: 0.286822 Time: 262.16
Run: 91 train loss: 426.658365 Time: 592.82
Run: 91 VAL ap_score: 0.253177 map_score: 0.280849 Time: 262.44
Run: 92 train loss: 426.699333 Time: 594.65
Run: 92 VAL ap_score: 0.249728 map_score: 0.281810 Time: 262.80
Run: 93 train loss: 426.162094 Time: 588.51
Run: 93 VAL ap_score: 0.264473 map_score: 0.287121 Time: 262.77
Run: 94 train loss: 426.886623 Time: 592.56
Run: 94 VAL ap_score: 0.256550 map_score: 0.287010 Time: 263.50
Run: 95 train loss: 426.851107 Time: 593.09
Run: 95 VAL ap_score: 0.252620 map_score: 0.282427 Time: 264.06
Run: 96 train loss: 425.993803 Time: 592.47
Run: 96 VAL ap_score: 0.248560 map_score: 0.282584 Time: 264.02
Run: 97 train loss: 427.023883 Time: 592.67
Run: 97 VAL ap_score: 0.248452 map_score: 0.284882 Time: 264.03
loading best validated model from experiments/h2mn/trained_models/H2MN_mutag_large_dataset_seed_4929_2024-05-03_03:00:24.pth
loaded test query graphs from ./large_dataset/splits/test/test_mutag240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_mutag240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/mutag240k_corpus_subgraphs.pkl
TEST - ap_score: 0.253537 map_score: 0.273546
