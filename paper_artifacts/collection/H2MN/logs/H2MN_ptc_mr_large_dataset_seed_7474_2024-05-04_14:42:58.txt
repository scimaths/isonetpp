Experiment h2mn for model: 'H2MN', dataset: 'ptc_mr_large', seed: 7474 started at time: 2024-05-04_14:42:58
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph_matching/train.py
--experiment_id h2mn
--experiment_dir experiments/
--model_config_path configs/h2mn.yaml
--dataset_name ptc_mr
--seed 7474
--margin 0.1
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
saving intial model to experiments/h2mn/initial_models/H2MN_ptc_mr_large_dataset_seed_7474_2024-05-04_14:42:58.pth
no. of params in model: 2974
Run: 0 train loss: 95.655620 Time: 187.68
Run: 0 VAL ap_score: 0.241557 map_score: 0.263404 Time: 76.28
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mr_large_dataset_seed_7474_2024-05-04_14:42:58.pth
Run: 1 train loss: 93.306289 Time: 184.49
Run: 1 VAL ap_score: 0.234347 map_score: 0.260206 Time: 76.39
Run: 2 train loss: 92.705768 Time: 184.43
Run: 2 VAL ap_score: 0.258686 map_score: 0.259028 Time: 84.21
Run: 3 train loss: 91.448988 Time: 214.72
Run: 3 VAL ap_score: 0.253416 map_score: 0.257734 Time: 92.33
Run: 4 train loss: 92.448006 Time: 197.87
Run: 4 VAL ap_score: 0.237614 map_score: 0.237793 Time: 76.32
Run: 5 train loss: 92.259014 Time: 184.42
Run: 5 VAL ap_score: 0.250380 map_score: 0.260266 Time: 76.29
Run: 6 train loss: 91.179501 Time: 187.27
Run: 6 VAL ap_score: 0.242718 map_score: 0.257406 Time: 76.54
Run: 7 train loss: 92.209393 Time: 187.29
Run: 7 VAL ap_score: 0.247165 map_score: 0.266666 Time: 76.37
saving best validated model to experiments/h2mn/trained_models/H2MN_ptc_mr_large_dataset_seed_7474_2024-05-04_14:42:58.pth
Run: 8 train loss: 91.817971 Time: 194.18
Run: 8 VAL ap_score: 0.246235 map_score: 0.260123 Time: 92.30
Run: 9 train loss: 91.638068 Time: 195.50
Run: 9 VAL ap_score: 0.247620 map_score: 0.261725 Time: 76.56
Run: 10 train loss: 91.740348 Time: 187.45
Run: 10 VAL ap_score: 0.248152 map_score: 0.258804 Time: 76.37
Run: 11 train loss: 91.613641 Time: 187.14
Run: 11 VAL ap_score: 0.247836 map_score: 0.262639 Time: 76.50
Run: 12 train loss: 92.484125 Time: 187.37
Run: 12 VAL ap_score: 0.248335 map_score: 0.258796 Time: 76.40
Run: 13 train loss: 92.448431 Time: 190.16
Run: 13 VAL ap_score: 0.243501 map_score: 0.255381 Time: 92.42
Run: 14 train loss: 91.628492 Time: 198.68
Run: 14 VAL ap_score: 0.237946 map_score: 0.255311 Time: 76.43
Run: 15 train loss: 91.596542 Time: 184.50
Run: 15 VAL ap_score: 0.245724 map_score: 0.259540 Time: 76.35
Run: 16 train loss: 91.400829 Time: 184.42
Run: 16 VAL ap_score: 0.245961 map_score: 0.255873 Time: 76.40
Run: 17 train loss: 91.277393 Time: 184.61
Run: 17 VAL ap_score: 0.243762 map_score: 0.265413 Time: 76.44
Run: 18 train loss: 91.588306 Time: 184.77
Run: 18 VAL ap_score: 0.243561 map_score: 0.258169 Time: 76.56
Run: 19 train loss: 91.773781 Time: 184.88
Run: 19 VAL ap_score: 0.244825 map_score: 0.259102 Time: 76.45
Run: 20 train loss: 91.793176 Time: 184.76
Run: 20 VAL ap_score: 0.247298 map_score: 0.260614 Time: 76.46
Run: 21 train loss: 91.089697 Time: 184.73
Run: 21 VAL ap_score: 0.240561 map_score: 0.254079 Time: 76.56
Run: 22 train loss: 91.416962 Time: 184.88
Run: 22 VAL ap_score: 0.253590 map_score: 0.264133 Time: 76.48
Run: 23 train loss: 90.839822 Time: 184.86
Run: 23 VAL ap_score: 0.233721 map_score: 0.260307 Time: 76.63
Run: 24 train loss: 91.835874 Time: 185.01
Run: 24 VAL ap_score: 0.245873 map_score: 0.260113 Time: 76.50
Run: 25 train loss: 91.147042 Time: 184.75
Run: 25 VAL ap_score: 0.251363 map_score: 0.265695 Time: 76.62
Run: 26 train loss: 91.741153 Time: 184.89
Run: 26 VAL ap_score: 0.259432 map_score: 0.263565 Time: 76.63
Run: 27 train loss: 90.506359 Time: 184.95
Run: 27 VAL ap_score: 0.252413 map_score: 0.264211 Time: 76.51
Run: 28 train loss: 90.922672 Time: 184.93
Run: 28 VAL ap_score: 0.245822 map_score: 0.255059 Time: 76.61
Run: 29 train loss: 93.105939 Time: 191.97
Run: 29 VAL ap_score: 0.237756 map_score: 0.256577 Time: 84.14
Run: 30 train loss: 91.652490 Time: 187.47
Run: 30 VAL ap_score: 0.247933 map_score: 0.260870 Time: 76.45
Run: 31 train loss: 91.607311 Time: 187.44
Run: 31 VAL ap_score: 0.248494 map_score: 0.263056 Time: 76.35
Run: 32 train loss: 91.831009 Time: 187.33
Run: 32 VAL ap_score: 0.246355 map_score: 0.257029 Time: 76.37
Run: 33 train loss: 92.050631 Time: 187.34
Run: 33 VAL ap_score: 0.241556 map_score: 0.254295 Time: 76.50
Run: 34 train loss: 91.194080 Time: 187.49
Run: 34 VAL ap_score: 0.248921 map_score: 0.258225 Time: 76.35
Run: 35 train loss: 91.515628 Time: 187.37
Run: 35 VAL ap_score: 0.246953 map_score: 0.260392 Time: 76.49
Run: 36 train loss: 90.897542 Time: 203.50
Run: 36 VAL ap_score: 0.245651 map_score: 0.261317 Time: 92.37
Run: 37 train loss: 91.122204 Time: 186.31
Run: 37 VAL ap_score: 0.247905 map_score: 0.260785 Time: 76.04
Run: 38 train loss: 91.216348 Time: 183.41
Run: 38 VAL ap_score: 0.248563 map_score: 0.265041 Time: 75.92
Run: 39 train loss: 91.348480 Time: 183.29
Run: 39 VAL ap_score: 0.248050 map_score: 0.260290 Time: 75.81
Run: 40 train loss: 91.390688 Time: 183.35
Run: 40 VAL ap_score: 0.249997 map_score: 0.261357 Time: 75.94
Run: 41 train loss: 91.210243 Time: 183.28
Run: 41 VAL ap_score: 0.251069 map_score: 0.266445 Time: 75.73
Run: 42 train loss: 91.553293 Time: 182.91
Run: 42 VAL ap_score: 0.245235 map_score: 0.262254 Time: 75.79
Run: 43 train loss: 91.364831 Time: 182.96
Run: 43 VAL ap_score: 0.250506 map_score: 0.258122 Time: 75.69
Run: 44 train loss: 91.528222 Time: 182.91
Run: 44 VAL ap_score: 0.241031 map_score: 0.263038 Time: 75.69
Run: 45 train loss: 90.802902 Time: 182.91
Run: 45 VAL ap_score: 0.248787 map_score: 0.262864 Time: 76.03
Run: 46 train loss: 91.038726 Time: 183.36
Run: 46 VAL ap_score: 0.244706 map_score: 0.259357 Time: 75.92
Run: 47 train loss: 91.070142 Time: 183.20
Run: 47 VAL ap_score: 0.258281 map_score: 0.257749 Time: 76.02
Run: 48 train loss: 90.739725 Time: 183.37
Run: 48 VAL ap_score: 0.249153 map_score: 0.260152 Time: 75.93
Run: 49 train loss: 90.763944 Time: 183.09
Run: 49 VAL ap_score: 0.247277 map_score: 0.256419 Time: 76.05
Run: 50 train loss: 90.946502 Time: 183.28
Run: 50 VAL ap_score: 0.243296 map_score: 0.264304 Time: 76.03
Run: 51 train loss: 91.137618 Time: 183.03
Run: 51 VAL ap_score: 0.246905 map_score: 0.258740 Time: 75.72
Run: 52 train loss: 92.109791 Time: 182.83
Run: 52 VAL ap_score: 0.246771 map_score: 0.265263 Time: 75.84
Run: 53 train loss: 91.188912 Time: 184.12
Run: 53 VAL ap_score: 0.252482 map_score: 0.259918 Time: 75.49
Run: 54 train loss: 91.055807 Time: 209.94
Run: 54 VAL ap_score: 0.238412 map_score: 0.258498 Time: 75.66
Run: 55 train loss: 90.716535 Time: 182.58
Run: 55 VAL ap_score: 0.245222 map_score: 0.266241 Time: 75.54
Run: 56 train loss: 90.566482 Time: 182.51
Run: 56 VAL ap_score: 0.251550 map_score: 0.266594 Time: 75.58
Run: 57 train loss: 91.305777 Time: 182.53
Run: 57 VAL ap_score: 0.257445 map_score: 0.266688 Time: 75.67
Run: 58 train loss: 91.472859 Time: 182.71
Run: 58 VAL ap_score: 0.245610 map_score: 0.260491 Time: 75.54
loading best validated model from experiments/h2mn/trained_models/H2MN_ptc_mr_large_dataset_seed_7474_2024-05-04_14:42:58.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_mr240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
TEST - ap_score: 0.230370 map_score: 0.242204
