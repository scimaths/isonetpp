Experiment egsc_modified for model: 'egsc_modified', dataset: 'ptc_mm_large', seed: 4929 started at time: 2024-04-15_12:31:43
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id egsc_modified
--experiment_dir experiments/
--model_config_path configs/egsc_modified.yaml
--dataset_name ptc_mm
--seed 4929
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
saving intial model to experiments/egsc_modified/initial_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
no. of params in model: 3948
Run: 0 train loss: 226.001429 Time: 593.24
Run: 0 VAL ap_score: 0.441661 map_score: 0.461066 Time: 292.06
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 1 train loss: 163.732679 Time: 615.41
Run: 1 VAL ap_score: 0.500747 map_score: 0.517296 Time: 265.32
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 2 train loss: 148.385251 Time: 619.07
Run: 2 VAL ap_score: 0.479046 map_score: 0.506659 Time: 276.36
Run: 3 train loss: 140.996849 Time: 650.04
Run: 3 VAL ap_score: 0.513709 map_score: 0.534510 Time: 285.09
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 4 train loss: 134.677609 Time: 629.86
Run: 4 VAL ap_score: 0.502828 map_score: 0.517940 Time: 270.86
Run: 5 train loss: 129.969782 Time: 619.22
Run: 5 VAL ap_score: 0.521561 map_score: 0.548000 Time: 284.69
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 6 train loss: 127.707265 Time: 637.25
Run: 6 VAL ap_score: 0.539329 map_score: 0.552318 Time: 278.20
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 7 train loss: 123.846047 Time: 628.49
Run: 7 VAL ap_score: 0.512846 map_score: 0.528042 Time: 277.77
Run: 8 train loss: 121.589240 Time: 609.77
Run: 8 VAL ap_score: 0.554858 map_score: 0.571167 Time: 258.76
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 9 train loss: 117.923308 Time: 597.51
Run: 9 VAL ap_score: 0.578282 map_score: 0.578450 Time: 275.27
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 10 train loss: 114.648437 Time: 623.02
Run: 10 VAL ap_score: 0.510708 map_score: 0.546171 Time: 283.56
Run: 11 train loss: 112.229302 Time: 609.38
Run: 11 VAL ap_score: 0.548224 map_score: 0.559925 Time: 269.14
Run: 12 train loss: 110.806764 Time: 583.79
Run: 12 VAL ap_score: 0.560297 map_score: 0.571744 Time: 264.65
Run: 13 train loss: 108.940361 Time: 605.71
Run: 13 VAL ap_score: 0.565480 map_score: 0.589530 Time: 289.68
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 14 train loss: 104.419552 Time: 660.11
Run: 14 VAL ap_score: 0.545800 map_score: 0.570548 Time: 397.49
Run: 15 train loss: 102.824529 Time: 880.88
Run: 15 VAL ap_score: 0.503809 map_score: 0.536839 Time: 420.05
Run: 16 train loss: 100.683699 Time: 918.18
Run: 16 VAL ap_score: 0.538127 map_score: 0.577267 Time: 312.18
Run: 17 train loss: 100.005023 Time: 638.00
Run: 17 VAL ap_score: 0.539719 map_score: 0.557954 Time: 257.48
Run: 18 train loss: 97.552779 Time: 544.84
Run: 18 VAL ap_score: 0.567471 map_score: 0.587098 Time: 161.55
Run: 19 train loss: 96.932691 Time: 404.29
Run: 19 VAL ap_score: 0.564631 map_score: 0.579789 Time: 158.06
Run: 20 train loss: 94.757378 Time: 378.53
Run: 20 VAL ap_score: 0.495036 map_score: 0.545044 Time: 168.46
Run: 21 train loss: 93.984647 Time: 384.01
Run: 21 VAL ap_score: 0.518009 map_score: 0.551825 Time: 169.88
Run: 22 train loss: 92.789184 Time: 335.52
Run: 22 VAL ap_score: 0.501596 map_score: 0.533186 Time: 202.21
Run: 23 train loss: 92.223722 Time: 484.67
Run: 23 VAL ap_score: 0.567912 map_score: 0.582992 Time: 225.20
Run: 24 train loss: 92.345311 Time: 462.28
Run: 24 VAL ap_score: 0.568181 map_score: 0.587349 Time: 217.81
Run: 25 train loss: 90.199585 Time: 468.84
Run: 25 VAL ap_score: 0.590172 map_score: 0.593897 Time: 220.32
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 26 train loss: 89.704853 Time: 463.15
Run: 26 VAL ap_score: 0.595086 map_score: 0.608300 Time: 156.18
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 27 train loss: 88.765090 Time: 328.27
Run: 27 VAL ap_score: 0.512025 map_score: 0.537450 Time: 126.29
Run: 28 train loss: 88.011098 Time: 274.95
Run: 28 VAL ap_score: 0.544588 map_score: 0.559966 Time: 126.31
Run: 29 train loss: 87.801685 Time: 274.43
Run: 29 VAL ap_score: 0.564066 map_score: 0.575050 Time: 126.56
Run: 30 train loss: 86.892060 Time: 274.95
Run: 30 VAL ap_score: 0.622903 map_score: 0.624639 Time: 126.01
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 31 train loss: 86.562228 Time: 274.68
Run: 31 VAL ap_score: 0.561343 map_score: 0.575598 Time: 125.94
Run: 32 train loss: 84.769706 Time: 273.91
Run: 32 VAL ap_score: 0.580453 map_score: 0.587395 Time: 125.68
Run: 33 train loss: 84.670524 Time: 275.12
Run: 33 VAL ap_score: 0.574628 map_score: 0.571209 Time: 125.70
Run: 34 train loss: 83.303545 Time: 274.02
Run: 34 VAL ap_score: 0.595784 map_score: 0.598715 Time: 125.53
Run: 35 train loss: 82.791346 Time: 274.09
Run: 35 VAL ap_score: 0.566929 map_score: 0.569739 Time: 125.58
Run: 36 train loss: 83.091712 Time: 274.88
Run: 36 VAL ap_score: 0.600803 map_score: 0.593422 Time: 125.61
Run: 37 train loss: 81.896173 Time: 274.35
Run: 37 VAL ap_score: 0.534507 map_score: 0.542346 Time: 125.41
Run: 38 train loss: 81.383130 Time: 273.81
Run: 38 VAL ap_score: 0.485599 map_score: 0.515793 Time: 125.37
Run: 39 train loss: 80.696473 Time: 275.26
Run: 39 VAL ap_score: 0.582653 map_score: 0.580669 Time: 125.23
Run: 40 train loss: 79.763216 Time: 274.80
Run: 40 VAL ap_score: 0.558420 map_score: 0.570323 Time: 125.07
Run: 41 train loss: 79.948105 Time: 274.54
Run: 41 VAL ap_score: 0.619283 map_score: 0.612616 Time: 125.02
Run: 42 train loss: 79.695401 Time: 280.76
Run: 42 VAL ap_score: 0.595802 map_score: 0.612984 Time: 125.25
Run: 43 train loss: 78.757895 Time: 279.53
Run: 43 VAL ap_score: 0.629429 map_score: 0.629124 Time: 126.11
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 44 train loss: 79.105319 Time: 276.49
Run: 44 VAL ap_score: 0.614228 map_score: 0.619553 Time: 125.33
Run: 45 train loss: 78.419148 Time: 274.74
Run: 45 VAL ap_score: 0.542043 map_score: 0.577010 Time: 124.67
Run: 46 train loss: 77.558943 Time: 275.24
Run: 46 VAL ap_score: 0.554508 map_score: 0.574543 Time: 125.09
Run: 47 train loss: 77.480201 Time: 274.66
Run: 47 VAL ap_score: 0.517870 map_score: 0.536854 Time: 125.67
Run: 48 train loss: 77.408902 Time: 275.73
Run: 48 VAL ap_score: 0.583310 map_score: 0.576098 Time: 125.34
Run: 49 train loss: 75.908731 Time: 274.69
Run: 49 VAL ap_score: 0.635443 map_score: 0.642153 Time: 125.15
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
Run: 50 train loss: 76.117006 Time: 273.90
Run: 50 VAL ap_score: 0.503773 map_score: 0.534627 Time: 125.07
Run: 51 train loss: 75.513652 Time: 275.25
Run: 51 VAL ap_score: 0.618190 map_score: 0.614090 Time: 124.99
Run: 52 train loss: 74.756948 Time: 275.14
Run: 52 VAL ap_score: 0.557197 map_score: 0.567224 Time: 125.19
Run: 53 train loss: 75.918052 Time: 274.83
Run: 53 VAL ap_score: 0.610571 map_score: 0.611396 Time: 125.53
Run: 54 train loss: 74.363459 Time: 276.09
Run: 54 VAL ap_score: 0.602917 map_score: 0.602019 Time: 126.15
Run: 55 train loss: 74.346291 Time: 277.58
Run: 55 VAL ap_score: 0.581954 map_score: 0.591859 Time: 125.91
Run: 56 train loss: 74.587153 Time: 276.29
Run: 56 VAL ap_score: 0.602090 map_score: 0.606923 Time: 126.42
Run: 57 train loss: 73.640182 Time: 277.79
Run: 57 VAL ap_score: 0.598243 map_score: 0.608961 Time: 125.92
Run: 58 train loss: 72.981828 Time: 277.11
Run: 58 VAL ap_score: 0.618496 map_score: 0.620094 Time: 126.22
Run: 59 train loss: 72.672208 Time: 276.34
Run: 59 VAL ap_score: 0.626691 map_score: 0.624427 Time: 126.51
Run: 60 train loss: 73.157423 Time: 275.98
Run: 60 VAL ap_score: 0.610890 map_score: 0.614705 Time: 126.42
Run: 61 train loss: 72.258628 Time: 276.75
Run: 61 VAL ap_score: 0.601859 map_score: 0.613516 Time: 126.58
Run: 62 train loss: 71.423424 Time: 276.89
Run: 62 VAL ap_score: 0.585591 map_score: 0.588292 Time: 126.50
Run: 63 train loss: 71.487068 Time: 276.54
Run: 63 VAL ap_score: 0.601759 map_score: 0.610393 Time: 126.74
Run: 64 train loss: 71.611966 Time: 276.47
Run: 64 VAL ap_score: 0.582854 map_score: 0.588171 Time: 126.89
Run: 65 train loss: 71.610259 Time: 277.09
Run: 65 VAL ap_score: 0.579588 map_score: 0.611293 Time: 126.89
Run: 66 train loss: 71.712068 Time: 276.58
Run: 66 VAL ap_score: 0.600730 map_score: 0.606117 Time: 127.19
Run: 67 train loss: 70.864707 Time: 277.27
Run: 67 VAL ap_score: 0.636552 map_score: 0.632602 Time: 127.17
Run: 68 train loss: 70.847621 Time: 275.75
Run: 68 VAL ap_score: 0.558956 map_score: 0.575080 Time: 126.72
Run: 69 train loss: 69.947340 Time: 276.91
Run: 69 VAL ap_score: 0.580024 map_score: 0.594470 Time: 127.04
Run: 70 train loss: 70.655361 Time: 275.86
Run: 70 VAL ap_score: 0.564729 map_score: 0.597771 Time: 126.88
Run: 71 train loss: 69.958225 Time: 275.77
Run: 71 VAL ap_score: 0.579683 map_score: 0.597600 Time: 126.88
Run: 72 train loss: 70.092909 Time: 276.69
Run: 72 VAL ap_score: 0.541756 map_score: 0.569258 Time: 126.79
Run: 73 train loss: 70.461113 Time: 276.25
Run: 73 VAL ap_score: 0.548527 map_score: 0.593051 Time: 125.24
Run: 74 train loss: 69.520826 Time: 276.27
Run: 74 VAL ap_score: 0.568165 map_score: 0.598578 Time: 127.28
Run: 75 train loss: 69.204821 Time: 275.75
Run: 75 VAL ap_score: 0.612613 map_score: 0.605047 Time: 125.19
Run: 76 train loss: 68.682792 Time: 274.83
Run: 76 VAL ap_score: 0.578522 map_score: 0.590058 Time: 124.90
Run: 77 train loss: 68.863983 Time: 277.09
Run: 77 VAL ap_score: 0.630629 map_score: 0.638390 Time: 127.09
Run: 78 train loss: 68.600350 Time: 277.18
Run: 78 VAL ap_score: 0.581985 map_score: 0.601378 Time: 126.51
Run: 79 train loss: 68.669370 Time: 275.87
Run: 79 VAL ap_score: 0.609752 map_score: 0.615193 Time: 126.41
Run: 80 train loss: 69.379172 Time: 274.67
Run: 80 VAL ap_score: 0.591092 map_score: 0.606836 Time: 126.20
Run: 81 train loss: 69.060411 Time: 275.29
Run: 81 VAL ap_score: 0.601033 map_score: 0.605492 Time: 126.26
Run: 82 train loss: 68.506290 Time: 275.19
Run: 82 VAL ap_score: 0.597448 map_score: 0.606588 Time: 126.64
Run: 83 train loss: 67.518266 Time: 274.75
Run: 83 VAL ap_score: 0.615561 map_score: 0.620336 Time: 126.63
Run: 84 train loss: 67.608992 Time: 275.26
Run: 84 VAL ap_score: 0.626903 map_score: 0.633653 Time: 126.61
Run: 85 train loss: 67.434619 Time: 275.31
Run: 85 VAL ap_score: 0.608011 map_score: 0.618956 Time: 126.70
Run: 86 train loss: 68.465448 Time: 275.20
Run: 86 VAL ap_score: 0.604901 map_score: 0.608774 Time: 126.64
Run: 87 train loss: 67.719940 Time: 275.95
Run: 87 VAL ap_score: 0.633502 map_score: 0.626736 Time: 126.10
Run: 88 train loss: 67.729569 Time: 275.62
Run: 88 VAL ap_score: 0.543833 map_score: 0.580682 Time: 126.38
Run: 89 train loss: 66.662172 Time: 275.51
Run: 89 VAL ap_score: 0.565018 map_score: 0.588033 Time: 126.86
Run: 90 train loss: 68.400226 Time: 275.46
Run: 90 VAL ap_score: 0.558787 map_score: 0.583733 Time: 126.21
Run: 91 train loss: 67.569326 Time: 275.72
Run: 91 VAL ap_score: 0.521417 map_score: 0.568912 Time: 126.66
Run: 92 train loss: 67.343192 Time: 275.44
Run: 92 VAL ap_score: 0.559630 map_score: 0.593860 Time: 126.93
Run: 93 train loss: 67.188111 Time: 275.08
Run: 93 VAL ap_score: 0.593914 map_score: 0.621248 Time: 126.67
Run: 94 train loss: 66.603220 Time: 275.93
Run: 94 VAL ap_score: 0.610394 map_score: 0.623866 Time: 126.49
Run: 95 train loss: 67.669096 Time: 275.42
Run: 95 VAL ap_score: 0.631103 map_score: 0.619552 Time: 126.68
Run: 96 train loss: 66.491297 Time: 276.26
Run: 96 VAL ap_score: 0.570040 map_score: 0.599417 Time: 126.46
Run: 97 train loss: 67.058082 Time: 276.53
Run: 97 VAL ap_score: 0.589868 map_score: 0.610831 Time: 126.60
Run: 98 train loss: 66.672630 Time: 275.90
Run: 98 VAL ap_score: 0.593395 map_score: 0.612059 Time: 126.55
Run: 99 train loss: 66.943615 Time: 275.80
Run: 99 VAL ap_score: 0.559566 map_score: 0.574908 Time: 126.18
Run: 100 train loss: 66.420829 Time: 276.28
Run: 100 VAL ap_score: 0.601101 map_score: 0.608104 Time: 125.88
loading best validated model from experiments/egsc_modified/trained_models/egsc_modified_ptc_mm_large_dataset_seed_4929_2024-04-15_12:31:43.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_mm240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mm240k_corpus_subgraphs.pkl
TEST - ap_score: 0.595731 map_score: 0.583621
