Experiment egsc_margin_01 for model: 'egsc_modified', dataset: 'ptc_fm_large', seed: 7762 started at time: 2024-05-10_08:35:43
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id egsc_margin_01
--experiment_dir experiments/
--model_config_path configs/egsc_modified.yaml
--dataset_name ptc_fm
--seed 7762
--dataset_size large
--margin 0.1
loaded train query graphs from ./large_dataset/splits/train/train_ptc_fm240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fm240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_fm240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fm240k_corpus_subgraphs.pkl
saving intial model to experiments/egsc_margin_01/initial_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
no. of params in model: 3948
Run: 0 train loss: 49.740963 Time: 175.72
Run: 0 VAL ap_score: 0.394827 map_score: 0.430782 Time: 79.64
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
Run: 1 train loss: 35.315962 Time: 177.50
Run: 1 VAL ap_score: 0.430359 map_score: 0.458759 Time: 79.72
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
Run: 2 train loss: 31.447553 Time: 443.81
Run: 2 VAL ap_score: 0.490597 map_score: 0.518752 Time: 217.22
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
Run: 3 train loss: 29.515308 Time: 178.00
Run: 3 VAL ap_score: 0.422560 map_score: 0.460768 Time: 80.46
Run: 4 train loss: 27.889554 Time: 176.34
Run: 4 VAL ap_score: 0.509362 map_score: 0.531942 Time: 80.20
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
Run: 5 train loss: 26.789714 Time: 177.41
Run: 5 VAL ap_score: 0.489460 map_score: 0.527166 Time: 80.25
Run: 6 train loss: 25.785760 Time: 180.54
Run: 6 VAL ap_score: 0.417872 map_score: 0.469315 Time: 78.36
Run: 7 train loss: 25.063011 Time: 177.65
Run: 7 VAL ap_score: 0.493949 map_score: 0.516029 Time: 78.37
Run: 8 train loss: 24.554326 Time: 177.92
Run: 8 VAL ap_score: 0.541948 map_score: 0.568572 Time: 77.99
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
Run: 9 train loss: 23.737341 Time: 176.49
Run: 9 VAL ap_score: 0.480929 map_score: 0.523735 Time: 80.02
Run: 10 train loss: 23.386423 Time: 178.92
Run: 10 VAL ap_score: 0.476655 map_score: 0.502047 Time: 81.10
Run: 11 train loss: 23.194245 Time: 190.30
Run: 11 VAL ap_score: 0.336025 map_score: 0.376287 Time: 80.45
Run: 12 train loss: 22.727299 Time: 176.98
Run: 12 VAL ap_score: 0.528628 map_score: 0.561471 Time: 80.83
Run: 13 train loss: 22.550580 Time: 176.81
Run: 13 VAL ap_score: 0.457092 map_score: 0.506892 Time: 81.36
Run: 14 train loss: 22.496141 Time: 176.14
Run: 14 VAL ap_score: 0.441890 map_score: 0.499082 Time: 81.30
Run: 15 train loss: 22.054846 Time: 185.48
Run: 15 VAL ap_score: 0.479034 map_score: 0.519711 Time: 85.16
Run: 16 train loss: 22.071215 Time: 187.50
Run: 16 VAL ap_score: 0.516954 map_score: 0.547953 Time: 81.07
Run: 17 train loss: 21.969546 Time: 185.37
Run: 17 VAL ap_score: 0.490479 map_score: 0.553964 Time: 87.67
Run: 18 train loss: 21.808886 Time: 191.79
Run: 18 VAL ap_score: 0.525321 map_score: 0.546644 Time: 100.15
Run: 19 train loss: 21.570102 Time: 181.88
Run: 19 VAL ap_score: 0.571251 map_score: 0.585995 Time: 78.04
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
Run: 20 train loss: 21.306963 Time: 175.23
Run: 20 VAL ap_score: 0.413538 map_score: 0.463141 Time: 79.50
Run: 21 train loss: 21.238315 Time: 177.57
Run: 21 VAL ap_score: 0.516800 map_score: 0.560071 Time: 76.22
Run: 22 train loss: 21.232682 Time: 171.97
Run: 22 VAL ap_score: 0.511105 map_score: 0.539187 Time: 78.78
Run: 23 train loss: 20.870172 Time: 174.05
Run: 23 VAL ap_score: 0.539922 map_score: 0.591168 Time: 77.42
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
Run: 24 train loss: 20.879321 Time: 177.58
Run: 24 VAL ap_score: 0.487569 map_score: 0.534478 Time: 77.65
Run: 25 train loss: 20.610874 Time: 177.85
Run: 25 VAL ap_score: 0.440810 map_score: 0.500031 Time: 82.01
Run: 26 train loss: 20.514438 Time: 181.11
Run: 26 VAL ap_score: 0.450140 map_score: 0.507146 Time: 82.34
Run: 27 train loss: 20.330382 Time: 179.93
Run: 27 VAL ap_score: 0.451809 map_score: 0.521079 Time: 81.03
Run: 28 train loss: 20.109089 Time: 178.76
Run: 28 VAL ap_score: 0.427224 map_score: 0.494107 Time: 82.24
Run: 29 train loss: 20.055190 Time: 177.71
Run: 29 VAL ap_score: 0.446090 map_score: 0.500048 Time: 81.33
Run: 30 train loss: 19.953561 Time: 178.46
Run: 30 VAL ap_score: 0.427142 map_score: 0.493887 Time: 81.12
Run: 31 train loss: 19.932601 Time: 176.95
Run: 31 VAL ap_score: 0.432034 map_score: 0.506771 Time: 79.77
Run: 32 train loss: 19.931437 Time: 178.61
Run: 32 VAL ap_score: 0.400426 map_score: 0.450982 Time: 81.09
Run: 33 train loss: 19.609617 Time: 179.38
Run: 33 VAL ap_score: 0.427891 map_score: 0.502486 Time: 80.82
Run: 34 train loss: 19.432639 Time: 177.45
Run: 34 VAL ap_score: 0.460130 map_score: 0.498499 Time: 79.83
Run: 35 train loss: 19.504824 Time: 176.30
Run: 35 VAL ap_score: 0.380412 map_score: 0.431525 Time: 79.02
Run: 36 train loss: 19.245965 Time: 178.70
Run: 36 VAL ap_score: 0.468436 map_score: 0.537219 Time: 80.56
Run: 37 train loss: 19.042936 Time: 177.36
Run: 37 VAL ap_score: 0.469600 map_score: 0.529384 Time: 80.70
Run: 38 train loss: 19.116724 Time: 178.94
Run: 38 VAL ap_score: 0.502670 map_score: 0.550750 Time: 81.54
Run: 39 train loss: 19.228451 Time: 178.24
Run: 39 VAL ap_score: 0.490650 map_score: 0.552724 Time: 81.33
Run: 40 train loss: 18.940474 Time: 179.41
Run: 40 VAL ap_score: 0.504106 map_score: 0.548627 Time: 101.44
Run: 41 train loss: 18.869041 Time: 259.63
Run: 41 VAL ap_score: 0.434359 map_score: 0.493857 Time: 85.05
Run: 42 train loss: 18.765046 Time: 178.33
Run: 42 VAL ap_score: 0.482244 map_score: 0.527470 Time: 79.94
Run: 43 train loss: 18.786702 Time: 179.33
Run: 43 VAL ap_score: 0.434726 map_score: 0.503942 Time: 81.19
Run: 44 train loss: 18.997804 Time: 179.58
Run: 44 VAL ap_score: 0.453630 map_score: 0.497578 Time: 114.03
Run: 45 train loss: 18.805359 Time: 251.59
Run: 45 VAL ap_score: 0.480974 map_score: 0.528063 Time: 80.77
Run: 46 train loss: 18.605632 Time: 178.94
Run: 46 VAL ap_score: 0.472765 map_score: 0.520211 Time: 80.29
Run: 47 train loss: 18.446898 Time: 177.24
Run: 47 VAL ap_score: 0.386840 map_score: 0.429220 Time: 79.14
Run: 48 train loss: 18.507860 Time: 179.36
Run: 48 VAL ap_score: 0.413259 map_score: 0.474761 Time: 80.79
Run: 49 train loss: 18.360154 Time: 180.64
Run: 49 VAL ap_score: 0.449140 map_score: 0.521898 Time: 80.58
Run: 50 train loss: 18.467538 Time: 179.44
Run: 50 VAL ap_score: 0.451592 map_score: 0.528421 Time: 80.68
Run: 51 train loss: 18.366734 Time: 179.64
Run: 51 VAL ap_score: 0.463651 map_score: 0.533553 Time: 80.14
Run: 52 train loss: 18.251360 Time: 177.98
Run: 52 VAL ap_score: 0.449517 map_score: 0.500255 Time: 81.04
Run: 53 train loss: 18.382174 Time: 179.15
Run: 53 VAL ap_score: 0.474677 map_score: 0.508429 Time: 80.70
Run: 54 train loss: 18.339707 Time: 178.95
Run: 54 VAL ap_score: 0.494157 map_score: 0.564791 Time: 80.25
Run: 55 train loss: 18.307289 Time: 177.69
Run: 55 VAL ap_score: 0.459300 map_score: 0.544052 Time: 80.49
Run: 56 train loss: 18.051811 Time: 178.15
Run: 56 VAL ap_score: 0.501702 map_score: 0.556434 Time: 81.06
Run: 57 train loss: 18.115302 Time: 178.65
Run: 57 VAL ap_score: 0.487711 map_score: 0.549268 Time: 81.40
Run: 58 train loss: 18.020912 Time: 179.25
Run: 58 VAL ap_score: 0.451724 map_score: 0.502520 Time: 80.90
Run: 59 train loss: 18.000776 Time: 176.85
Run: 59 VAL ap_score: 0.416810 map_score: 0.479959 Time: 80.02
Run: 60 train loss: 17.926099 Time: 176.17
Run: 60 VAL ap_score: 0.439220 map_score: 0.490007 Time: 81.07
Run: 61 train loss: 18.070317 Time: 176.46
Run: 61 VAL ap_score: 0.475676 map_score: 0.523450 Time: 79.19
Run: 62 train loss: 17.940217 Time: 176.85
Run: 62 VAL ap_score: 0.410606 map_score: 0.475764 Time: 80.14
Run: 63 train loss: 17.964136 Time: 175.47
Run: 63 VAL ap_score: 0.433170 map_score: 0.493049 Time: 81.59
Run: 64 train loss: 18.183053 Time: 177.00
Run: 64 VAL ap_score: 0.494858 map_score: 0.542207 Time: 82.11
Run: 65 train loss: 18.100333 Time: 177.46
Run: 65 VAL ap_score: 0.449186 map_score: 0.531313 Time: 81.33
Run: 66 train loss: 17.990011 Time: 176.81
Run: 66 VAL ap_score: 0.442543 map_score: 0.500848 Time: 81.68
Run: 67 train loss: 17.904815 Time: 177.02
Run: 67 VAL ap_score: 0.434175 map_score: 0.507407 Time: 81.10
Run: 68 train loss: 17.942355 Time: 177.19
Run: 68 VAL ap_score: 0.353457 map_score: 0.421310 Time: 80.86
Run: 69 train loss: 17.887169 Time: 177.46
Run: 69 VAL ap_score: 0.465906 map_score: 0.527249 Time: 81.81
Run: 70 train loss: 17.884135 Time: 177.54
Run: 70 VAL ap_score: 0.474268 map_score: 0.527841 Time: 81.19
Run: 71 train loss: 17.801242 Time: 177.00
Run: 71 VAL ap_score: 0.389853 map_score: 0.445727 Time: 81.26
Run: 72 train loss: 17.838322 Time: 177.07
Run: 72 VAL ap_score: 0.389342 map_score: 0.444913 Time: 80.91
Run: 73 train loss: 17.739242 Time: 177.35
Run: 73 VAL ap_score: 0.479276 map_score: 0.525530 Time: 81.33
Run: 74 train loss: 17.910196 Time: 177.36
Run: 74 VAL ap_score: 0.432922 map_score: 0.515114 Time: 81.42
loading best validated model from experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fm_large_dataset_seed_7762_2024-05-10_08:35:43.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_fm240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fm240k_corpus_subgraphs.pkl
TEST - ap_score: 0.575182 map_score: 0.609493
