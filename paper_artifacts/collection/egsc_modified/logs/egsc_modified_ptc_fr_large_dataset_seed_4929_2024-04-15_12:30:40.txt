Experiment egsc_modified for model: 'egsc_modified', dataset: 'ptc_fr_large', seed: 4929 started at time: 2024-04-15_12:30:40
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id egsc_modified
--experiment_dir experiments/
--model_config_path configs/egsc_modified.yaml
--dataset_name ptc_fr
--seed 4929
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
saving intial model to experiments/egsc_modified/initial_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
no. of params in model: 3948
Run: 0 train loss: 234.484046 Time: 677.81
Run: 0 VAL ap_score: 0.506401 map_score: 0.520919 Time: 307.50
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 1 train loss: 168.659311 Time: 769.57
Run: 1 VAL ap_score: 0.509231 map_score: 0.552466 Time: 289.71
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 2 train loss: 153.124648 Time: 718.95
Run: 2 VAL ap_score: 0.466979 map_score: 0.525333 Time: 288.25
Run: 3 train loss: 144.766035 Time: 730.24
Run: 3 VAL ap_score: 0.518499 map_score: 0.529286 Time: 279.59
Run: 4 train loss: 136.706195 Time: 727.43
Run: 4 VAL ap_score: 0.516838 map_score: 0.526178 Time: 286.82
Run: 5 train loss: 128.648180 Time: 698.98
Run: 5 VAL ap_score: 0.487018 map_score: 0.533431 Time: 313.51
Run: 6 train loss: 122.901113 Time: 707.60
Run: 6 VAL ap_score: 0.533905 map_score: 0.552553 Time: 296.32
Run: 7 train loss: 118.099119 Time: 769.54
Run: 7 VAL ap_score: 0.592524 map_score: 0.590788 Time: 347.55
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 8 train loss: 114.958802 Time: 792.43
Run: 8 VAL ap_score: 0.575174 map_score: 0.576516 Time: 304.81
Run: 9 train loss: 110.771634 Time: 757.65
Run: 9 VAL ap_score: 0.603900 map_score: 0.606682 Time: 329.10
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 10 train loss: 109.305064 Time: 731.35
Run: 10 VAL ap_score: 0.575752 map_score: 0.577780 Time: 305.23
Run: 11 train loss: 106.524926 Time: 711.31
Run: 11 VAL ap_score: 0.577246 map_score: 0.580657 Time: 344.51
Run: 12 train loss: 105.044274 Time: 681.11
Run: 12 VAL ap_score: 0.607160 map_score: 0.608608 Time: 243.32
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 13 train loss: 102.613544 Time: 538.68
Run: 13 VAL ap_score: 0.594899 map_score: 0.598385 Time: 222.97
Run: 14 train loss: 102.150568 Time: 538.19
Run: 14 VAL ap_score: 0.558098 map_score: 0.574349 Time: 224.92
Run: 15 train loss: 100.157934 Time: 521.74
Run: 15 VAL ap_score: 0.572073 map_score: 0.582002 Time: 241.45
Run: 16 train loss: 99.960716 Time: 544.76
Run: 16 VAL ap_score: 0.585056 map_score: 0.596916 Time: 246.03
Run: 17 train loss: 97.363780 Time: 523.86
Run: 17 VAL ap_score: 0.607388 map_score: 0.604256 Time: 214.02
Run: 18 train loss: 97.980957 Time: 388.05
Run: 18 VAL ap_score: 0.604374 map_score: 0.599147 Time: 145.57
Run: 19 train loss: 96.269067 Time: 335.85
Run: 19 VAL ap_score: 0.559288 map_score: 0.564297 Time: 147.25
Run: 20 train loss: 96.461638 Time: 351.41
Run: 20 VAL ap_score: 0.612178 map_score: 0.608117 Time: 154.96
Run: 21 train loss: 95.183058 Time: 329.47
Run: 21 VAL ap_score: 0.605477 map_score: 0.600411 Time: 149.11
Run: 22 train loss: 93.618465 Time: 339.47
Run: 22 VAL ap_score: 0.596087 map_score: 0.581537 Time: 150.16
Run: 23 train loss: 92.713438 Time: 412.91
Run: 23 VAL ap_score: 0.575440 map_score: 0.584068 Time: 217.28
Run: 24 train loss: 93.163505 Time: 467.76
Run: 24 VAL ap_score: 0.612105 map_score: 0.605885 Time: 216.51
Run: 25 train loss: 92.058476 Time: 470.51
Run: 25 VAL ap_score: 0.587755 map_score: 0.596344 Time: 221.63
Run: 26 train loss: 90.872173 Time: 469.48
Run: 26 VAL ap_score: 0.623915 map_score: 0.613793 Time: 215.78
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 27 train loss: 91.085560 Time: 359.58
Run: 27 VAL ap_score: 0.621588 map_score: 0.623925 Time: 156.99
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 28 train loss: 89.852772 Time: 276.40
Run: 28 VAL ap_score: 0.609030 map_score: 0.610857 Time: 126.73
Run: 29 train loss: 89.563769 Time: 276.03
Run: 29 VAL ap_score: 0.586764 map_score: 0.590435 Time: 126.29
Run: 30 train loss: 89.135808 Time: 274.65
Run: 30 VAL ap_score: 0.595847 map_score: 0.592030 Time: 126.71
Run: 31 train loss: 88.249584 Time: 276.84
Run: 31 VAL ap_score: 0.536046 map_score: 0.553884 Time: 126.70
Run: 32 train loss: 87.934074 Time: 275.69
Run: 32 VAL ap_score: 0.642844 map_score: 0.634024 Time: 126.35
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 33 train loss: 87.266001 Time: 275.49
Run: 33 VAL ap_score: 0.612037 map_score: 0.599557 Time: 126.66
Run: 34 train loss: 87.300768 Time: 275.35
Run: 34 VAL ap_score: 0.593014 map_score: 0.595207 Time: 126.69
Run: 35 train loss: 85.898323 Time: 274.98
Run: 35 VAL ap_score: 0.604905 map_score: 0.612144 Time: 126.36
Run: 36 train loss: 85.948821 Time: 275.50
Run: 36 VAL ap_score: 0.625495 map_score: 0.613522 Time: 126.94
Run: 37 train loss: 85.212283 Time: 275.00
Run: 37 VAL ap_score: 0.577146 map_score: 0.576103 Time: 126.67
Run: 38 train loss: 84.435215 Time: 275.71
Run: 38 VAL ap_score: 0.618452 map_score: 0.613308 Time: 126.56
Run: 39 train loss: 84.458073 Time: 274.98
Run: 39 VAL ap_score: 0.647922 map_score: 0.630575 Time: 126.18
Run: 40 train loss: 84.395026 Time: 275.44
Run: 40 VAL ap_score: 0.593089 map_score: 0.596664 Time: 126.75
Run: 41 train loss: 82.986527 Time: 276.16
Run: 41 VAL ap_score: 0.632883 map_score: 0.625085 Time: 126.29
Run: 42 train loss: 82.989427 Time: 276.06
Run: 42 VAL ap_score: 0.633525 map_score: 0.613563 Time: 126.41
Run: 43 train loss: 82.269223 Time: 276.51
Run: 43 VAL ap_score: 0.611669 map_score: 0.603342 Time: 126.80
Run: 44 train loss: 82.037255 Time: 276.85
Run: 44 VAL ap_score: 0.589823 map_score: 0.573336 Time: 126.37
Run: 45 train loss: 82.431667 Time: 275.39
Run: 45 VAL ap_score: 0.636635 map_score: 0.623824 Time: 126.73
Run: 46 train loss: 80.822814 Time: 275.39
Run: 46 VAL ap_score: 0.612606 map_score: 0.605452 Time: 127.02
Run: 47 train loss: 81.165017 Time: 275.21
Run: 47 VAL ap_score: 0.572271 map_score: 0.568400 Time: 126.09
Run: 48 train loss: 81.123194 Time: 274.62
Run: 48 VAL ap_score: 0.622353 map_score: 0.612504 Time: 126.25
Run: 49 train loss: 79.937830 Time: 273.95
Run: 49 VAL ap_score: 0.590835 map_score: 0.591156 Time: 126.34
Run: 50 train loss: 79.282010 Time: 274.79
Run: 50 VAL ap_score: 0.596282 map_score: 0.590991 Time: 125.53
Run: 51 train loss: 79.201626 Time: 275.47
Run: 51 VAL ap_score: 0.628330 map_score: 0.619271 Time: 126.65
Run: 52 train loss: 79.068189 Time: 274.74
Run: 52 VAL ap_score: 0.644579 map_score: 0.641604 Time: 126.75
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 53 train loss: 78.009416 Time: 276.51
Run: 53 VAL ap_score: 0.578249 map_score: 0.569118 Time: 126.17
Run: 54 train loss: 77.910153 Time: 276.49
Run: 54 VAL ap_score: 0.641832 map_score: 0.623204 Time: 125.75
Run: 55 train loss: 77.925930 Time: 274.16
Run: 55 VAL ap_score: 0.649528 map_score: 0.638760 Time: 125.49
Run: 56 train loss: 77.306517 Time: 275.65
Run: 56 VAL ap_score: 0.628172 map_score: 0.625298 Time: 126.07
Run: 57 train loss: 76.888623 Time: 276.06
Run: 57 VAL ap_score: 0.588897 map_score: 0.590269 Time: 125.21
Run: 58 train loss: 76.734170 Time: 275.12
Run: 58 VAL ap_score: 0.634628 map_score: 0.626552 Time: 125.88
Run: 59 train loss: 76.717023 Time: 275.93
Run: 59 VAL ap_score: 0.629851 map_score: 0.620767 Time: 125.69
Run: 60 train loss: 76.149372 Time: 277.36
Run: 60 VAL ap_score: 0.641128 map_score: 0.629672 Time: 125.70
Run: 61 train loss: 76.131351 Time: 275.56
Run: 61 VAL ap_score: 0.644560 map_score: 0.629909 Time: 125.22
Run: 62 train loss: 75.961734 Time: 276.15
Run: 62 VAL ap_score: 0.646998 map_score: 0.637259 Time: 124.70
Run: 63 train loss: 74.911477 Time: 275.45
Run: 63 VAL ap_score: 0.645496 map_score: 0.645253 Time: 125.29
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 64 train loss: 74.858813 Time: 276.08
Run: 64 VAL ap_score: 0.634021 map_score: 0.621895 Time: 125.27
Run: 65 train loss: 75.318694 Time: 276.95
Run: 65 VAL ap_score: 0.614641 map_score: 0.604489 Time: 124.43
Run: 66 train loss: 74.942964 Time: 276.75
Run: 66 VAL ap_score: 0.650599 map_score: 0.638947 Time: 125.03
Run: 67 train loss: 74.253541 Time: 275.62
Run: 67 VAL ap_score: 0.614020 map_score: 0.608172 Time: 125.17
Run: 68 train loss: 73.801958 Time: 276.66
Run: 68 VAL ap_score: 0.612792 map_score: 0.608368 Time: 124.55
Run: 69 train loss: 74.005239 Time: 277.10
Run: 69 VAL ap_score: 0.598867 map_score: 0.609936 Time: 125.28
Run: 70 train loss: 73.849550 Time: 276.53
Run: 70 VAL ap_score: 0.597468 map_score: 0.597637 Time: 125.51
Run: 71 train loss: 73.600373 Time: 277.34
Run: 71 VAL ap_score: 0.604200 map_score: 0.605935 Time: 124.82
Run: 72 train loss: 72.965486 Time: 276.01
Run: 72 VAL ap_score: 0.668506 map_score: 0.656463 Time: 124.97
saving best validated model to experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
Run: 73 train loss: 73.986934 Time: 275.67
Run: 73 VAL ap_score: 0.638887 map_score: 0.637545 Time: 126.95
Run: 74 train loss: 73.272042 Time: 282.27
Run: 74 VAL ap_score: 0.622954 map_score: 0.623327 Time: 124.76
Run: 75 train loss: 72.217261 Time: 280.87
Run: 75 VAL ap_score: 0.614840 map_score: 0.617494 Time: 127.79
Run: 76 train loss: 73.204383 Time: 284.25
Run: 76 VAL ap_score: 0.642011 map_score: 0.633670 Time: 127.15
Run: 77 train loss: 73.212973 Time: 283.07
Run: 77 VAL ap_score: 0.589791 map_score: 0.587121 Time: 123.59
Run: 78 train loss: 72.743472 Time: 274.62
Run: 78 VAL ap_score: 0.622824 map_score: 0.614476 Time: 124.86
Run: 79 train loss: 72.746280 Time: 273.72
Run: 79 VAL ap_score: 0.576033 map_score: 0.583407 Time: 124.89
Run: 80 train loss: 72.443431 Time: 276.77
Run: 80 VAL ap_score: 0.651046 map_score: 0.642056 Time: 125.00
Run: 81 train loss: 72.409847 Time: 274.95
Run: 81 VAL ap_score: 0.584134 map_score: 0.586116 Time: 125.50
Run: 82 train loss: 72.792304 Time: 276.21
Run: 82 VAL ap_score: 0.620049 map_score: 0.614924 Time: 125.17
Run: 83 train loss: 72.135518 Time: 276.36
Run: 83 VAL ap_score: 0.640195 map_score: 0.630408 Time: 125.12
Run: 84 train loss: 72.453627 Time: 276.59
Run: 84 VAL ap_score: 0.627163 map_score: 0.623176 Time: 125.66
Run: 85 train loss: 71.301318 Time: 276.30
Run: 85 VAL ap_score: 0.604092 map_score: 0.600671 Time: 125.41
Run: 86 train loss: 71.387497 Time: 276.47
Run: 86 VAL ap_score: 0.632912 map_score: 0.633124 Time: 125.57
Run: 87 train loss: 71.551661 Time: 276.64
Run: 87 VAL ap_score: 0.645236 map_score: 0.635114 Time: 125.74
Run: 88 train loss: 71.190318 Time: 275.43
Run: 88 VAL ap_score: 0.644480 map_score: 0.632256 Time: 125.55
Run: 89 train loss: 71.406296 Time: 275.51
Run: 89 VAL ap_score: 0.650716 map_score: 0.642285 Time: 125.28
Run: 90 train loss: 71.935049 Time: 275.02
Run: 90 VAL ap_score: 0.627177 map_score: 0.616280 Time: 125.83
Run: 91 train loss: 71.428386 Time: 275.49
Run: 91 VAL ap_score: 0.638453 map_score: 0.627605 Time: 126.30
Run: 92 train loss: 70.859226 Time: 275.97
Run: 92 VAL ap_score: 0.623790 map_score: 0.612522 Time: 126.13
Run: 93 train loss: 70.407146 Time: 276.04
Run: 93 VAL ap_score: 0.625555 map_score: 0.612191 Time: 126.16
Run: 94 train loss: 71.177736 Time: 276.30
Run: 94 VAL ap_score: 0.614009 map_score: 0.612479 Time: 126.58
Run: 95 train loss: 70.595705 Time: 275.54
Run: 95 VAL ap_score: 0.628915 map_score: 0.620930 Time: 126.17
Run: 96 train loss: 70.664935 Time: 273.34
Run: 96 VAL ap_score: 0.620143 map_score: 0.615725 Time: 125.84
Run: 97 train loss: 70.311493 Time: 274.71
Run: 97 VAL ap_score: 0.619468 map_score: 0.616290 Time: 126.07
Run: 98 train loss: 70.780023 Time: 274.57
Run: 98 VAL ap_score: 0.654943 map_score: 0.638589 Time: 125.85
Run: 99 train loss: 69.990856 Time: 274.75
Run: 99 VAL ap_score: 0.658352 map_score: 0.638273 Time: 126.12
Run: 100 train loss: 70.747843 Time: 274.29
Run: 100 VAL ap_score: 0.611974 map_score: 0.599466 Time: 126.69
Run: 101 train loss: 70.816267 Time: 274.38
Run: 101 VAL ap_score: 0.627351 map_score: 0.616210 Time: 132.63
Run: 102 train loss: 70.175535 Time: 356.25
Run: 102 VAL ap_score: 0.608929 map_score: 0.592689 Time: 165.75
Run: 103 train loss: 70.128345 Time: 352.64
Run: 103 VAL ap_score: 0.642642 map_score: 0.633185 Time: 167.32
Run: 104 train loss: 70.392628 Time: 352.78
Run: 104 VAL ap_score: 0.632503 map_score: 0.627670 Time: 165.79
Run: 105 train loss: 69.930605 Time: 359.05
Run: 105 VAL ap_score: 0.637256 map_score: 0.627739 Time: 163.11
Run: 106 train loss: 70.311135 Time: 354.57
Run: 106 VAL ap_score: 0.632397 map_score: 0.616285 Time: 167.41
Run: 107 train loss: 70.194498 Time: 350.67
Run: 107 VAL ap_score: 0.654231 map_score: 0.646879 Time: 167.19
Run: 108 train loss: 70.065446 Time: 355.45
Run: 108 VAL ap_score: 0.658132 map_score: 0.648669 Time: 162.16
Run: 109 train loss: 70.304037 Time: 360.85
Run: 109 VAL ap_score: 0.649128 map_score: 0.640776 Time: 166.74
Run: 110 train loss: 68.767310 Time: 354.52
Run: 110 VAL ap_score: 0.617449 map_score: 0.600801 Time: 167.96
Run: 111 train loss: 69.374735 Time: 354.16
Run: 111 VAL ap_score: 0.607112 map_score: 0.611418 Time: 165.90
Run: 112 train loss: 69.667629 Time: 359.95
Run: 112 VAL ap_score: 0.647824 map_score: 0.629675 Time: 163.65
Run: 113 train loss: 69.327194 Time: 356.25
Run: 113 VAL ap_score: 0.612360 map_score: 0.607682 Time: 167.82
Run: 114 train loss: 69.444477 Time: 352.05
Run: 114 VAL ap_score: 0.614295 map_score: 0.609688 Time: 168.38
Run: 115 train loss: 69.506339 Time: 357.25
Run: 115 VAL ap_score: 0.650722 map_score: 0.640812 Time: 163.29
Run: 116 train loss: 68.899563 Time: 357.90
Run: 116 VAL ap_score: 0.628230 map_score: 0.626163 Time: 166.34
Run: 117 train loss: 68.903338 Time: 353.01
Run: 117 VAL ap_score: 0.652264 map_score: 0.645375 Time: 167.17
Run: 118 train loss: 68.616278 Time: 353.51
Run: 118 VAL ap_score: 0.638911 map_score: 0.630905 Time: 165.67
Run: 119 train loss: 68.128519 Time: 358.75
Run: 119 VAL ap_score: 0.659059 map_score: 0.644089 Time: 163.88
Run: 120 train loss: 68.888221 Time: 356.27
Run: 120 VAL ap_score: 0.623032 map_score: 0.605641 Time: 167.31
Run: 121 train loss: 68.350293 Time: 352.33
Run: 121 VAL ap_score: 0.562904 map_score: 0.566781 Time: 167.11
Run: 122 train loss: 68.885585 Time: 356.57
Run: 122 VAL ap_score: 0.599579 map_score: 0.589453 Time: 163.98
Run: 123 train loss: 68.637373 Time: 359.08
Run: 123 VAL ap_score: 0.603430 map_score: 0.592108 Time: 165.83
loading best validated model from experiments/egsc_modified/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-04-15_12:30:40.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_fr240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
TEST - ap_score: 0.608242 map_score: 0.606899
