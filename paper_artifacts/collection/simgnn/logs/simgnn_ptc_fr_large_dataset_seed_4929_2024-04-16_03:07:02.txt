Experiment simgnn for model: 'simgnn', dataset: 'ptc_fr_large', seed: 4929 started at time: 2024-04-16_03:07:02
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id simgnn
--experiment_dir experiments/
--model_config_path configs/simgnn.yaml
--dataset_name ptc_fr
--seed 4929
--margin 0.1
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
saving intial model to experiments/simgnn/initial_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
no. of params in model: 1671
Run: 0 train loss: 102.092763 Time: 740.04
Run: 0 VAL ap_score: 0.195068 map_score: 0.205080 Time: 333.81
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 1 train loss: 100.282138 Time: 735.53
Run: 1 VAL ap_score: 0.205492 map_score: 0.229918 Time: 333.89
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 2 train loss: 98.322376 Time: 732.36
Run: 2 VAL ap_score: 0.215315 map_score: 0.234615 Time: 334.56
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 3 train loss: 96.278337 Time: 730.61
Run: 3 VAL ap_score: 0.217513 map_score: 0.238301 Time: 335.13
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 4 train loss: 94.274792 Time: 732.18
Run: 4 VAL ap_score: 0.231901 map_score: 0.269875 Time: 336.12
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 5 train loss: 91.057590 Time: 729.20
Run: 5 VAL ap_score: 0.247668 map_score: 0.288764 Time: 337.11
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 6 train loss: 88.136335 Time: 729.78
Run: 6 VAL ap_score: 0.255123 map_score: 0.308595 Time: 337.67
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 7 train loss: 85.813874 Time: 729.27
Run: 7 VAL ap_score: 0.281923 map_score: 0.322255 Time: 338.82
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 8 train loss: 82.995368 Time: 727.99
Run: 8 VAL ap_score: 0.294439 map_score: 0.333382 Time: 340.05
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 9 train loss: 81.397716 Time: 729.29
Run: 9 VAL ap_score: 0.290050 map_score: 0.330918 Time: 340.83
Run: 10 train loss: 80.752834 Time: 727.88
Run: 10 VAL ap_score: 0.295662 map_score: 0.340869 Time: 341.30
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 11 train loss: 80.283759 Time: 738.59
Run: 11 VAL ap_score: 0.321880 map_score: 0.350032 Time: 342.04
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 12 train loss: 80.128898 Time: 735.09
Run: 12 VAL ap_score: 0.309487 map_score: 0.345292 Time: 339.76
Run: 13 train loss: 79.864108 Time: 726.30
Run: 13 VAL ap_score: 0.304845 map_score: 0.342431 Time: 341.85
Run: 14 train loss: 79.829091 Time: 728.24
Run: 14 VAL ap_score: 0.290694 map_score: 0.337040 Time: 341.56
Run: 15 train loss: 79.369698 Time: 726.89
Run: 15 VAL ap_score: 0.324943 map_score: 0.351972 Time: 342.01
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 16 train loss: 78.959707 Time: 723.95
Run: 16 VAL ap_score: 0.314839 map_score: 0.348202 Time: 277.10
Run: 17 train loss: 79.082484 Time: 288.22
Run: 17 VAL ap_score: 0.324554 map_score: 0.351363 Time: 113.28
Run: 18 train loss: 79.108294 Time: 266.71
Run: 18 VAL ap_score: 0.321598 map_score: 0.344097 Time: 111.86
Run: 19 train loss: 78.472291 Time: 263.97
Run: 19 VAL ap_score: 0.329907 map_score: 0.352016 Time: 111.49
Run: 20 train loss: 78.483481 Time: 263.94
Run: 20 VAL ap_score: 0.333047 map_score: 0.352410 Time: 112.30
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 21 train loss: 78.253527 Time: 266.01
Run: 21 VAL ap_score: 0.326416 map_score: 0.349959 Time: 114.37
Run: 22 train loss: 78.469708 Time: 267.33
Run: 22 VAL ap_score: 0.330105 map_score: 0.354861 Time: 113.42
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 23 train loss: 78.281693 Time: 265.56
Run: 23 VAL ap_score: 0.321374 map_score: 0.340162 Time: 114.62
Run: 24 train loss: 78.051516 Time: 267.73
Run: 24 VAL ap_score: 0.333617 map_score: 0.351180 Time: 113.82
Run: 25 train loss: 77.904291 Time: 265.76
Run: 25 VAL ap_score: 0.316165 map_score: 0.340434 Time: 113.81
Run: 26 train loss: 77.671761 Time: 267.20
Run: 26 VAL ap_score: 0.327014 map_score: 0.354731 Time: 114.06
Run: 27 train loss: 77.894543 Time: 268.80
Run: 27 VAL ap_score: 0.333659 map_score: 0.359890 Time: 113.58
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 28 train loss: 77.684623 Time: 269.28
Run: 28 VAL ap_score: 0.340345 map_score: 0.357305 Time: 112.86
Run: 29 train loss: 77.354380 Time: 269.49
Run: 29 VAL ap_score: 0.340020 map_score: 0.355330 Time: 113.80
Run: 30 train loss: 77.327433 Time: 271.02
Run: 30 VAL ap_score: 0.337752 map_score: 0.360386 Time: 113.18
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 31 train loss: 77.165590 Time: 270.59
Run: 31 VAL ap_score: 0.339715 map_score: 0.358268 Time: 113.18
Run: 32 train loss: 77.154301 Time: 271.44
Run: 32 VAL ap_score: 0.322529 map_score: 0.348838 Time: 113.06
Run: 33 train loss: 77.285542 Time: 271.22
Run: 33 VAL ap_score: 0.334711 map_score: 0.356847 Time: 111.83
Run: 34 train loss: 76.788858 Time: 272.64
Run: 34 VAL ap_score: 0.341637 map_score: 0.359908 Time: 111.81
Run: 35 train loss: 76.536815 Time: 272.44
Run: 35 VAL ap_score: 0.336937 map_score: 0.354547 Time: 111.72
Run: 36 train loss: 76.924863 Time: 271.49
Run: 36 VAL ap_score: 0.344167 map_score: 0.359800 Time: 111.80
Run: 37 train loss: 76.594776 Time: 270.96
Run: 37 VAL ap_score: 0.323909 map_score: 0.348579 Time: 112.15
Run: 38 train loss: 76.600650 Time: 269.56
Run: 38 VAL ap_score: 0.344002 map_score: 0.356976 Time: 112.16
Run: 39 train loss: 76.755602 Time: 269.26
Run: 39 VAL ap_score: 0.335672 map_score: 0.358019 Time: 112.06
Run: 40 train loss: 76.521882 Time: 269.43
Run: 40 VAL ap_score: 0.342582 map_score: 0.361542 Time: 111.99
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 41 train loss: 76.436434 Time: 270.06
Run: 41 VAL ap_score: 0.342174 map_score: 0.358116 Time: 112.26
Run: 42 train loss: 76.406456 Time: 269.95
Run: 42 VAL ap_score: 0.346751 map_score: 0.363542 Time: 112.95
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 43 train loss: 76.363491 Time: 267.30
Run: 43 VAL ap_score: 0.346419 map_score: 0.361529 Time: 112.47
Run: 44 train loss: 76.162958 Time: 267.78
Run: 44 VAL ap_score: 0.345181 map_score: 0.359314 Time: 112.51
Run: 45 train loss: 76.195738 Time: 268.74
Run: 45 VAL ap_score: 0.348005 map_score: 0.364204 Time: 113.44
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 46 train loss: 76.298298 Time: 267.17
Run: 46 VAL ap_score: 0.347271 map_score: 0.360329 Time: 114.15
Run: 47 train loss: 76.114028 Time: 266.81
Run: 47 VAL ap_score: 0.348094 map_score: 0.361514 Time: 114.00
Run: 48 train loss: 76.175604 Time: 267.60
Run: 48 VAL ap_score: 0.344615 map_score: 0.358361 Time: 114.06
Run: 49 train loss: 76.084055 Time: 266.45
Run: 49 VAL ap_score: 0.335092 map_score: 0.352309 Time: 113.17
Run: 50 train loss: 76.138583 Time: 267.92
Run: 50 VAL ap_score: 0.341348 map_score: 0.356225 Time: 113.55
Run: 51 train loss: 76.123168 Time: 265.20
Run: 51 VAL ap_score: 0.340603 map_score: 0.353187 Time: 112.96
Run: 52 train loss: 76.262718 Time: 268.00
Run: 52 VAL ap_score: 0.345800 map_score: 0.360148 Time: 114.28
Run: 53 train loss: 76.208182 Time: 267.48
Run: 53 VAL ap_score: 0.342928 map_score: 0.355079 Time: 115.08
Run: 54 train loss: 75.956884 Time: 268.25
Run: 54 VAL ap_score: 0.346043 map_score: 0.358591 Time: 127.45
Run: 55 train loss: 75.907243 Time: 269.15
Run: 55 VAL ap_score: 0.345322 map_score: 0.357931 Time: 114.16
Run: 56 train loss: 75.669402 Time: 267.66
Run: 56 VAL ap_score: 0.346543 map_score: 0.358654 Time: 114.61
Run: 57 train loss: 75.841970 Time: 266.80
Run: 57 VAL ap_score: 0.338412 map_score: 0.359846 Time: 112.70
Run: 58 train loss: 75.918712 Time: 278.05
Run: 58 VAL ap_score: 0.342612 map_score: 0.362741 Time: 113.31
Run: 59 train loss: 75.887122 Time: 268.54
Run: 59 VAL ap_score: 0.330333 map_score: 0.356912 Time: 113.07
Run: 60 train loss: 75.682661 Time: 267.69
Run: 60 VAL ap_score: 0.345994 map_score: 0.358295 Time: 111.89
Run: 61 train loss: 75.671117 Time: 268.23
Run: 61 VAL ap_score: 0.349750 map_score: 0.362942 Time: 112.33
Run: 62 train loss: 75.662332 Time: 269.29
Run: 62 VAL ap_score: 0.341938 map_score: 0.357092 Time: 112.67
Run: 63 train loss: 75.714263 Time: 268.13
Run: 63 VAL ap_score: 0.345377 map_score: 0.356520 Time: 110.89
Run: 64 train loss: 75.440312 Time: 268.62
Run: 64 VAL ap_score: 0.338543 map_score: 0.360931 Time: 112.63
Run: 65 train loss: 75.394933 Time: 269.96
Run: 65 VAL ap_score: 0.345693 map_score: 0.360519 Time: 111.31
Run: 66 train loss: 75.636209 Time: 275.91
Run: 66 VAL ap_score: 0.339331 map_score: 0.353999 Time: 111.82
Run: 67 train loss: 75.631796 Time: 277.80
Run: 67 VAL ap_score: 0.344664 map_score: 0.358503 Time: 112.68
Run: 68 train loss: 75.512386 Time: 275.11
Run: 68 VAL ap_score: 0.346550 map_score: 0.364093 Time: 112.86
Run: 69 train loss: 75.502885 Time: 272.41
Run: 69 VAL ap_score: 0.350302 map_score: 0.362335 Time: 111.97
Run: 70 train loss: 75.544318 Time: 276.13
Run: 70 VAL ap_score: 0.346682 map_score: 0.360822 Time: 111.31
Run: 71 train loss: 75.315887 Time: 272.58
Run: 71 VAL ap_score: 0.346203 map_score: 0.359215 Time: 110.50
Run: 72 train loss: 75.586217 Time: 272.34
Run: 72 VAL ap_score: 0.347419 map_score: 0.358880 Time: 112.21
Run: 73 train loss: 75.316888 Time: 272.83
Run: 73 VAL ap_score: 0.346876 map_score: 0.366656 Time: 112.26
saving best validated model to experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
Run: 74 train loss: 75.290316 Time: 272.15
Run: 74 VAL ap_score: 0.349851 map_score: 0.362537 Time: 109.27
Run: 75 train loss: 75.208441 Time: 272.17
Run: 75 VAL ap_score: 0.345742 map_score: 0.362800 Time: 112.98
Run: 76 train loss: 75.440099 Time: 271.75
Run: 76 VAL ap_score: 0.346884 map_score: 0.358065 Time: 111.81
Run: 77 train loss: 75.082435 Time: 270.33
Run: 77 VAL ap_score: 0.348543 map_score: 0.359400 Time: 112.04
Run: 78 train loss: 75.443870 Time: 270.22
Run: 78 VAL ap_score: 0.348387 map_score: 0.362980 Time: 113.06
Run: 79 train loss: 75.130440 Time: 269.54
Run: 79 VAL ap_score: 0.340321 map_score: 0.353509 Time: 113.85
Run: 80 train loss: 75.344957 Time: 269.39
Run: 80 VAL ap_score: 0.345953 map_score: 0.354440 Time: 113.51
Run: 81 train loss: 74.991524 Time: 268.04
Run: 81 VAL ap_score: 0.351502 map_score: 0.364469 Time: 113.32
Run: 82 train loss: 75.039534 Time: 267.55
Run: 82 VAL ap_score: 0.347683 map_score: 0.362200 Time: 114.73
Run: 83 train loss: 75.069561 Time: 267.90
Run: 83 VAL ap_score: 0.343041 map_score: 0.365286 Time: 113.96
Run: 84 train loss: 75.052331 Time: 267.35
Run: 84 VAL ap_score: 0.334207 map_score: 0.355809 Time: 114.61
Run: 85 train loss: 74.975663 Time: 267.64
Run: 85 VAL ap_score: 0.349224 map_score: 0.365040 Time: 114.86
Run: 86 train loss: 74.746336 Time: 268.83
Run: 86 VAL ap_score: 0.347130 map_score: 0.359115 Time: 114.14
Run: 87 train loss: 75.058308 Time: 268.80
Run: 87 VAL ap_score: 0.345695 map_score: 0.354580 Time: 114.07
Run: 88 train loss: 74.853453 Time: 268.19
Run: 88 VAL ap_score: 0.345802 map_score: 0.361611 Time: 114.10
Run: 89 train loss: 74.770127 Time: 268.01
Run: 89 VAL ap_score: 0.338378 map_score: 0.352266 Time: 111.26
Run: 90 train loss: 74.877355 Time: 269.27
Run: 90 VAL ap_score: 0.351018 map_score: 0.360417 Time: 114.28
Run: 91 train loss: 74.748176 Time: 271.76
Run: 91 VAL ap_score: 0.349081 map_score: 0.360256 Time: 114.17
Run: 92 train loss: 74.676376 Time: 272.14
Run: 92 VAL ap_score: 0.349929 map_score: 0.360445 Time: 116.11
Run: 93 train loss: 74.493354 Time: 297.39
Run: 93 VAL ap_score: 0.343364 map_score: 0.354563 Time: 114.46
Run: 94 train loss: 74.776096 Time: 269.45
Run: 94 VAL ap_score: 0.346291 map_score: 0.360712 Time: 125.50
Run: 95 train loss: 74.914636 Time: 325.84
Run: 95 VAL ap_score: 0.350882 map_score: 0.363924 Time: 138.65
Run: 96 train loss: 74.540629 Time: 326.31
Run: 96 VAL ap_score: 0.344627 map_score: 0.353486 Time: 139.89
Run: 97 train loss: 74.862184 Time: 304.35
Run: 97 VAL ap_score: 0.344884 map_score: 0.354144 Time: 128.14
Run: 98 train loss: 74.320648 Time: 315.82
Run: 98 VAL ap_score: 0.350352 map_score: 0.358107 Time: 133.69
Run: 99 train loss: 74.602824 Time: 292.86
Run: 99 VAL ap_score: 0.347509 map_score: 0.354441 Time: 134.82
Run: 100 train loss: 74.375547 Time: 316.75
Run: 100 VAL ap_score: 0.343909 map_score: 0.356512 Time: 134.38
Run: 101 train loss: 74.618809 Time: 326.63
Run: 101 VAL ap_score: 0.345829 map_score: 0.354560 Time: 139.00
Run: 102 train loss: 74.486807 Time: 326.94
Run: 102 VAL ap_score: 0.350006 map_score: 0.358604 Time: 136.66
Run: 103 train loss: 74.453935 Time: 322.85
Run: 103 VAL ap_score: 0.348939 map_score: 0.356808 Time: 135.10
Run: 104 train loss: 74.468649 Time: 329.22
Run: 104 VAL ap_score: 0.348339 map_score: 0.355683 Time: 139.07
Run: 105 train loss: 74.627634 Time: 330.09
Run: 105 VAL ap_score: 0.347049 map_score: 0.358638 Time: 137.45
Run: 106 train loss: 74.692654 Time: 321.70
Run: 106 VAL ap_score: 0.342168 map_score: 0.353355 Time: 135.74
Run: 107 train loss: 74.549447 Time: 331.11
Run: 107 VAL ap_score: 0.348503 map_score: 0.355417 Time: 137.62
Run: 108 train loss: 74.412261 Time: 329.75
Run: 108 VAL ap_score: 0.340981 map_score: 0.351883 Time: 137.05
Run: 109 train loss: 74.018695 Time: 338.11
Run: 109 VAL ap_score: 0.347466 map_score: 0.357182 Time: 150.00
Run: 110 train loss: 74.551457 Time: 355.23
Run: 110 VAL ap_score: 0.344906 map_score: 0.353134 Time: 155.76
Run: 111 train loss: 74.347275 Time: 382.20
Run: 111 VAL ap_score: 0.348109 map_score: 0.360342 Time: 153.65
Run: 112 train loss: 74.265794 Time: 400.73
Run: 112 VAL ap_score: 0.349648 map_score: 0.360240 Time: 156.40
Run: 113 train loss: 74.283946 Time: 396.11
Run: 113 VAL ap_score: 0.345976 map_score: 0.358476 Time: 162.61
Run: 114 train loss: 74.152278 Time: 396.88
Run: 114 VAL ap_score: 0.341801 map_score: 0.359000 Time: 157.79
Run: 115 train loss: 74.406715 Time: 388.06
Run: 115 VAL ap_score: 0.341706 map_score: 0.353371 Time: 170.12
Run: 116 train loss: 74.240279 Time: 409.66
Run: 116 VAL ap_score: 0.346650 map_score: 0.361442 Time: 167.84
Run: 117 train loss: 74.079067 Time: 411.60
Run: 117 VAL ap_score: 0.344161 map_score: 0.361128 Time: 168.77
Run: 118 train loss: 74.044784 Time: 418.66
Run: 118 VAL ap_score: 0.351553 map_score: 0.364332 Time: 164.59
Run: 119 train loss: 73.964627 Time: 413.63
Run: 119 VAL ap_score: 0.349775 map_score: 0.364120 Time: 173.44
Run: 120 train loss: 74.018585 Time: 415.30
Run: 120 VAL ap_score: 0.350517 map_score: 0.365311 Time: 167.41
Run: 121 train loss: 74.057657 Time: 400.46
Run: 121 VAL ap_score: 0.345654 map_score: 0.355961 Time: 162.04
Run: 122 train loss: 74.213722 Time: 406.58
Run: 122 VAL ap_score: 0.351058 map_score: 0.364792 Time: 169.25
Run: 123 train loss: 74.161853 Time: 410.33
Run: 123 VAL ap_score: 0.351233 map_score: 0.364329 Time: 176.00
Run: 124 train loss: 73.857118 Time: 425.37
Run: 124 VAL ap_score: 0.344842 map_score: 0.361907 Time: 170.63
loading best validated model from experiments/simgnn/trained_models/simgnn_ptc_fr_large_dataset_seed_4929_2024-04-16_03:07:02.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_fr240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
TEST - ap_score: 0.316739 map_score: 0.340865
