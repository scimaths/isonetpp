Experiment graphsim for model: 'graphsim', dataset: 'ptc_mr_large', seed: 7474 started at time: 2024-05-03_02:26:22
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id graphsim
--experiment_dir experiments/
--model_config_path configs/graphsim.yaml
--dataset_name ptc_mr
--seed 7474
--dataset_size large
loaded train query graphs from ./large_dataset/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
saving intial model to experiments/graphsim/initial_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
no. of params in model: 3909
Run: 0 train loss: 454.697993 Time: 454.68
Run: 0 VAL ap_score: 0.279253 map_score: 0.303847 Time: 191.86
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 1 train loss: 383.365936 Time: 447.18
Run: 1 VAL ap_score: 0.307612 map_score: 0.343262 Time: 192.45
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 2 train loss: 355.176026 Time: 447.09
Run: 2 VAL ap_score: 0.319035 map_score: 0.362046 Time: 192.37
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 3 train loss: 336.293403 Time: 449.60
Run: 3 VAL ap_score: 0.335661 map_score: 0.366564 Time: 192.87
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 4 train loss: 321.414525 Time: 447.39
Run: 4 VAL ap_score: 0.327075 map_score: 0.373229 Time: 193.41
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 5 train loss: 310.926457 Time: 448.24
Run: 5 VAL ap_score: 0.340611 map_score: 0.375777 Time: 193.39
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 6 train loss: 302.799045 Time: 445.75
Run: 6 VAL ap_score: 0.348883 map_score: 0.375629 Time: 193.63
Run: 7 train loss: 297.099846 Time: 446.39
Run: 7 VAL ap_score: 0.358182 map_score: 0.384336 Time: 194.28
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 8 train loss: 291.813949 Time: 443.46
Run: 8 VAL ap_score: 0.360127 map_score: 0.391305 Time: 194.40
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 9 train loss: 286.181470 Time: 445.13
Run: 9 VAL ap_score: 0.376695 map_score: 0.406226 Time: 195.35
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 10 train loss: 281.097161 Time: 443.54
Run: 10 VAL ap_score: 0.377108 map_score: 0.411457 Time: 196.22
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 11 train loss: 278.490410 Time: 443.19
Run: 11 VAL ap_score: 0.376056 map_score: 0.404037 Time: 197.65
Run: 12 train loss: 275.754168 Time: 438.25
Run: 12 VAL ap_score: 0.385217 map_score: 0.417212 Time: 198.51
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 13 train loss: 271.598979 Time: 445.00
Run: 13 VAL ap_score: 0.382838 map_score: 0.415022 Time: 199.18
Run: 14 train loss: 268.129495 Time: 441.79
Run: 14 VAL ap_score: 0.385772 map_score: 0.417803 Time: 200.27
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 15 train loss: 264.358140 Time: 443.00
Run: 15 VAL ap_score: 0.368491 map_score: 0.408069 Time: 201.02
Run: 16 train loss: 261.321070 Time: 439.14
Run: 16 VAL ap_score: 0.382755 map_score: 0.419829 Time: 201.73
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 17 train loss: 258.754098 Time: 440.05
Run: 17 VAL ap_score: 0.382150 map_score: 0.423160 Time: 201.88
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 18 train loss: 256.732811 Time: 441.13
Run: 18 VAL ap_score: 0.393930 map_score: 0.423393 Time: 202.07
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 19 train loss: 254.020068 Time: 440.26
Run: 19 VAL ap_score: 0.383862 map_score: 0.423686 Time: 202.25
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 20 train loss: 252.248119 Time: 436.90
Run: 20 VAL ap_score: 0.386738 map_score: 0.424263 Time: 202.64
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 21 train loss: 249.769004 Time: 434.10
Run: 21 VAL ap_score: 0.370777 map_score: 0.409540 Time: 202.93
Run: 22 train loss: 248.930582 Time: 434.95
Run: 22 VAL ap_score: 0.396867 map_score: 0.427344 Time: 202.82
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 23 train loss: 246.993724 Time: 435.96
Run: 23 VAL ap_score: 0.389034 map_score: 0.421154 Time: 203.09
Run: 24 train loss: 246.121113 Time: 435.12
Run: 24 VAL ap_score: 0.382164 map_score: 0.423966 Time: 203.02
Run: 25 train loss: 244.011302 Time: 437.52
Run: 25 VAL ap_score: 0.387410 map_score: 0.420405 Time: 203.42
Run: 26 train loss: 243.316335 Time: 428.20
Run: 26 VAL ap_score: 0.387091 map_score: 0.432092 Time: 174.56
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 27 train loss: 241.022389 Time: 374.61
Run: 27 VAL ap_score: 0.385490 map_score: 0.430696 Time: 174.45
Run: 28 train loss: 241.113077 Time: 377.44
Run: 28 VAL ap_score: 0.375199 map_score: 0.415655 Time: 174.96
Run: 29 train loss: 239.108393 Time: 374.71
Run: 29 VAL ap_score: 0.384553 map_score: 0.429893 Time: 174.82
Run: 30 train loss: 239.192826 Time: 377.11
Run: 30 VAL ap_score: 0.386826 map_score: 0.423708 Time: 175.19
Run: 31 train loss: 236.765841 Time: 376.51
Run: 31 VAL ap_score: 0.385148 map_score: 0.425440 Time: 174.70
Run: 32 train loss: 237.693389 Time: 377.05
Run: 32 VAL ap_score: 0.377426 map_score: 0.418705 Time: 174.56
Run: 33 train loss: 236.311312 Time: 372.76
Run: 33 VAL ap_score: 0.379596 map_score: 0.423843 Time: 174.83
Run: 34 train loss: 235.693056 Time: 379.69
Run: 34 VAL ap_score: 0.387213 map_score: 0.428742 Time: 175.07
Run: 35 train loss: 233.698250 Time: 376.05
Run: 35 VAL ap_score: 0.384523 map_score: 0.425541 Time: 174.89
Run: 36 train loss: 232.554929 Time: 376.48
Run: 36 VAL ap_score: 0.382847 map_score: 0.424365 Time: 174.64
Run: 37 train loss: 232.375547 Time: 379.37
Run: 37 VAL ap_score: 0.382075 map_score: 0.424009 Time: 173.96
Run: 38 train loss: 231.066010 Time: 373.97
Run: 38 VAL ap_score: 0.385242 map_score: 0.431110 Time: 173.77
Run: 39 train loss: 230.154567 Time: 375.81
Run: 39 VAL ap_score: 0.374118 map_score: 0.416022 Time: 173.23
Run: 40 train loss: 231.341352 Time: 377.51
Run: 40 VAL ap_score: 0.375938 map_score: 0.417093 Time: 173.04
Run: 41 train loss: 229.619275 Time: 378.91
Run: 41 VAL ap_score: 0.400420 map_score: 0.431878 Time: 172.65
Run: 42 train loss: 227.666421 Time: 379.13
Run: 42 VAL ap_score: 0.373769 map_score: 0.421093 Time: 171.43
Run: 43 train loss: 228.050165 Time: 376.32
Run: 43 VAL ap_score: 0.383343 map_score: 0.424385 Time: 170.95
Run: 44 train loss: 228.722871 Time: 379.15
Run: 44 VAL ap_score: 0.373883 map_score: 0.418999 Time: 170.41
Run: 45 train loss: 226.839831 Time: 379.73
Run: 45 VAL ap_score: 0.388512 map_score: 0.425514 Time: 169.12
Run: 46 train loss: 225.862071 Time: 381.12
Run: 46 VAL ap_score: 0.381899 map_score: 0.426717 Time: 168.18
Run: 47 train loss: 224.468309 Time: 379.23
Run: 47 VAL ap_score: 0.377830 map_score: 0.425084 Time: 167.34
Run: 48 train loss: 225.450976 Time: 385.06
Run: 48 VAL ap_score: 0.381687 map_score: 0.422779 Time: 166.20
Run: 49 train loss: 224.604445 Time: 385.81
Run: 49 VAL ap_score: 0.374707 map_score: 0.425053 Time: 165.64
Run: 50 train loss: 222.953451 Time: 384.28
Run: 50 VAL ap_score: 0.383135 map_score: 0.433723 Time: 164.13
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 51 train loss: 223.094712 Time: 388.40
Run: 51 VAL ap_score: 0.378636 map_score: 0.428937 Time: 163.17
Run: 52 train loss: 222.528677 Time: 388.67
Run: 52 VAL ap_score: 0.376859 map_score: 0.423393 Time: 162.63
Run: 53 train loss: 221.644190 Time: 388.69
Run: 53 VAL ap_score: 0.367982 map_score: 0.419629 Time: 162.43
Run: 54 train loss: 220.501032 Time: 387.71
Run: 54 VAL ap_score: 0.368275 map_score: 0.418086 Time: 161.90
Run: 55 train loss: 220.374496 Time: 384.95
Run: 55 VAL ap_score: 0.376219 map_score: 0.422978 Time: 161.74
Run: 56 train loss: 219.244213 Time: 396.98
Run: 56 VAL ap_score: 0.389011 map_score: 0.436421 Time: 161.08
saving best validated model to experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
Run: 57 train loss: 221.048600 Time: 387.95
Run: 57 VAL ap_score: 0.370289 map_score: 0.421545 Time: 161.87
Run: 58 train loss: 219.510399 Time: 395.70
Run: 58 VAL ap_score: 0.381837 map_score: 0.429955 Time: 162.55
Run: 59 train loss: 218.368213 Time: 397.73
Run: 59 VAL ap_score: 0.371281 map_score: 0.425059 Time: 163.12
Run: 60 train loss: 219.216288 Time: 387.39
Run: 60 VAL ap_score: 0.368761 map_score: 0.419596 Time: 174.29
Run: 61 train loss: 217.759938 Time: 387.26
Run: 61 VAL ap_score: 0.385364 map_score: 0.431430 Time: 165.40
Run: 62 train loss: 218.708050 Time: 385.08
Run: 62 VAL ap_score: 0.379655 map_score: 0.425276 Time: 166.68
Run: 63 train loss: 217.999479 Time: 384.48
Run: 63 VAL ap_score: 0.377617 map_score: 0.419455 Time: 167.39
Run: 64 train loss: 217.134542 Time: 382.51
Run: 64 VAL ap_score: 0.380938 map_score: 0.425692 Time: 168.30
Run: 65 train loss: 216.817155 Time: 383.40
Run: 65 VAL ap_score: 0.372317 map_score: 0.423729 Time: 169.19
Run: 66 train loss: 215.819048 Time: 379.89
Run: 66 VAL ap_score: 0.389825 map_score: 0.432289 Time: 170.02
Run: 67 train loss: 215.837484 Time: 380.46
Run: 67 VAL ap_score: 0.381824 map_score: 0.431445 Time: 170.94
Run: 68 train loss: 215.048127 Time: 377.84
Run: 68 VAL ap_score: 0.387177 map_score: 0.428129 Time: 171.92
Run: 69 train loss: 215.534489 Time: 524.30
Run: 69 VAL ap_score: 0.356167 map_score: 0.402054 Time: 553.77
Run: 70 train loss: 215.531644 Time: 1152.79
Run: 70 VAL ap_score: 0.380836 map_score: 0.415395 Time: 554.25
Run: 71 train loss: 215.228576 Time: 1156.95
Run: 71 VAL ap_score: 0.371389 map_score: 0.424427 Time: 555.66
Run: 72 train loss: 214.597085 Time: 1162.00
Run: 72 VAL ap_score: 0.381385 map_score: 0.424829 Time: 561.41
Run: 73 train loss: 213.669019 Time: 1161.52
Run: 73 VAL ap_score: 0.384660 map_score: 0.433613 Time: 753.51
Run: 74 train loss: 214.209031 Time: 1867.17
Run: 74 VAL ap_score: 0.386016 map_score: 0.423510 Time: 914.51
Run: 75 train loss: 213.786853 Time: 1857.28
Run: 75 VAL ap_score: 0.372422 map_score: 0.422857 Time: 912.99
Run: 76 train loss: 212.920260 Time: 1876.15
Run: 76 VAL ap_score: 0.375357 map_score: 0.431244 Time: 897.25
Run: 77 train loss: 213.761728 Time: 1876.72
Run: 77 VAL ap_score: 0.377526 map_score: 0.425171 Time: 912.54
Run: 78 train loss: 212.032391 Time: 1856.47
Run: 78 VAL ap_score: 0.387144 map_score: 0.418214 Time: 914.65
Run: 79 train loss: 213.116917 Time: 1862.22
Run: 79 VAL ap_score: 0.396624 map_score: 0.434342 Time: 904.12
Run: 80 train loss: 211.846083 Time: 1882.16
Run: 80 VAL ap_score: 0.390843 map_score: 0.435217 Time: 899.83
Run: 81 train loss: 212.181079 Time: 1868.07
Run: 81 VAL ap_score: 0.389772 map_score: 0.427853 Time: 912.64
Run: 82 train loss: 212.181589 Time: 1857.23
Run: 82 VAL ap_score: 0.367482 map_score: 0.424137 Time: 841.86
Run: 83 train loss: 211.513588 Time: 1661.42
Run: 83 VAL ap_score: 0.373964 map_score: 0.418771 Time: 784.72
Run: 84 train loss: 210.549640 Time: 1674.38
Run: 84 VAL ap_score: 0.370728 map_score: 0.428068 Time: 799.77
Run: 85 train loss: 211.342347 Time: 1645.49
Run: 85 VAL ap_score: 0.379507 map_score: 0.428740 Time: 804.78
Run: 86 train loss: 210.971487 Time: 1654.09
Run: 86 VAL ap_score: 0.374475 map_score: 0.424838 Time: 798.48
Run: 87 train loss: 210.242279 Time: 1668.66
Run: 87 VAL ap_score: 0.388308 map_score: 0.428958 Time: 787.80
Run: 88 train loss: 211.271585 Time: 1661.86
Run: 88 VAL ap_score: 0.378046 map_score: 0.428411 Time: 804.22
Run: 89 train loss: 210.567106 Time: 1640.28
Run: 89 VAL ap_score: 0.389922 map_score: 0.432885 Time: 805.58
Run: 90 train loss: 209.945245 Time: 1663.30
Run: 90 VAL ap_score: 0.369438 map_score: 0.421620 Time: 788.32
Run: 91 train loss: 209.776294 Time: 1669.76
Run: 91 VAL ap_score: 0.382203 map_score: 0.420688 Time: 802.66
Run: 92 train loss: 208.952098 Time: 1646.73
Run: 92 VAL ap_score: 0.365452 map_score: 0.416718 Time: 803.96
Run: 93 train loss: 209.678342 Time: 1639.31
Run: 93 VAL ap_score: 0.368400 map_score: 0.411505 Time: 802.52
Run: 94 train loss: 208.729227 Time: 1661.83
Run: 94 VAL ap_score: 0.379917 map_score: 0.427451 Time: 786.66
Run: 95 train loss: 208.075312 Time: 1653.74
Run: 95 VAL ap_score: 0.375718 map_score: 0.418840 Time: 807.75
Run: 96 train loss: 210.277939 Time: 1634.81
Run: 96 VAL ap_score: 0.373849 map_score: 0.417913 Time: 802.89
Run: 97 train loss: 209.414507 Time: 1656.08
Run: 97 VAL ap_score: 0.384140 map_score: 0.431194 Time: 788.89
Run: 98 train loss: 207.766496 Time: 1663.47
Run: 98 VAL ap_score: 0.387907 map_score: 0.431466 Time: 797.44
Run: 99 train loss: 208.104106 Time: 1646.79
Run: 99 VAL ap_score: 0.385559 map_score: 0.430679 Time: 803.50
Run: 100 train loss: 208.948535 Time: 1642.17
Run: 100 VAL ap_score: 0.380066 map_score: 0.423810 Time: 795.66
Run: 101 train loss: 207.401701 Time: 1670.03
Run: 101 VAL ap_score: 0.384955 map_score: 0.420385 Time: 782.29
Run: 102 train loss: 209.256899 Time: 1656.83
Run: 102 VAL ap_score: 0.388126 map_score: 0.431967 Time: 800.46
Run: 103 train loss: 207.056665 Time: 1644.07
Run: 103 VAL ap_score: 0.381397 map_score: 0.424991 Time: 799.41
Run: 104 train loss: 207.948021 Time: 1656.47
Run: 104 VAL ap_score: 0.384299 map_score: 0.430262 Time: 781.84
Run: 105 train loss: 206.254306 Time: 1671.82
Run: 105 VAL ap_score: 0.391051 map_score: 0.429704 Time: 793.30
Run: 106 train loss: 205.766270 Time: 1646.64
Run: 106 VAL ap_score: 0.386035 map_score: 0.427376 Time: 761.23
Run: 107 train loss: 205.631932 Time: 1305.15
Run: 107 VAL ap_score: 0.373672 map_score: 0.423753 Time: 231.06
loading best validated model from experiments/graphsim/trained_models/graphsim_ptc_mr_large_dataset_seed_7474_2024-05-03_02:26:22.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_mr240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_mr240k_corpus_subgraphs.pkl
TEST - ap_score: 0.425150 map_score: 0.452534
