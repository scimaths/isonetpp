Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda08_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=aids
--interpretability_lambda=0.8
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_aids240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_aids240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/aids240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_aids240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_aids240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/aids240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda08_clean/initialModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
no. of params in model: 3730
Run: 0 train loss: 304.085679 Time: 482.08
Run: 0 VAL ap_score: 0.417875 map_score: 0.436379 Time: 182.67
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 1 train loss: 208.109022 Time: 509.46
Run: 1 VAL ap_score: 0.451061 map_score: 0.451339 Time: 177.15
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 2 train loss: 188.641702 Time: 506.14
Run: 2 VAL ap_score: 0.449032 map_score: 0.455235 Time: 186.25
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 3 train loss: 164.982046 Time: 493.68
Run: 3 VAL ap_score: 0.541047 map_score: 0.518855 Time: 178.88
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 4 train loss: 146.241589 Time: 509.25
Run: 4 VAL ap_score: 0.537035 map_score: 0.519533 Time: 174.56
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 5 train loss: 129.311147 Time: 509.21
Run: 5 VAL ap_score: 0.568168 map_score: 0.553209 Time: 173.65
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 6 train loss: 116.187243 Time: 518.38
Run: 6 VAL ap_score: 0.607632 map_score: 0.593025 Time: 180.79
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 7 train loss: 107.887889 Time: 496.08
Run: 7 VAL ap_score: 0.634995 map_score: 0.605068 Time: 183.21
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 8 train loss: 99.401228 Time: 504.05
Run: 8 VAL ap_score: 0.647284 map_score: 0.630901 Time: 181.46
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 9 train loss: 89.567964 Time: 504.32
Run: 9 VAL ap_score: 0.651142 map_score: 0.645554 Time: 184.99
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 10 train loss: 82.195591 Time: 510.90
Run: 10 VAL ap_score: 0.655208 map_score: 0.645876 Time: 189.24
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 11 train loss: 76.194704 Time: 520.82
Run: 11 VAL ap_score: 0.686434 map_score: 0.667214 Time: 180.49
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 12 train loss: 72.154234 Time: 521.34
Run: 12 VAL ap_score: 0.694094 map_score: 0.681934 Time: 186.46
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 13 train loss: 68.999856 Time: 519.63
Run: 13 VAL ap_score: 0.673293 map_score: 0.679082 Time: 183.27
Run: 14 train loss: 66.177061 Time: 519.68
Run: 14 VAL ap_score: 0.696999 map_score: 0.676068 Time: 185.89
Run: 15 train loss: 64.844398 Time: 523.59
Run: 15 VAL ap_score: 0.686557 map_score: 0.670429 Time: 189.25
Run: 16 train loss: 62.401307 Time: 528.30
Run: 16 VAL ap_score: 0.725382 map_score: 0.708743 Time: 192.63
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 17 train loss: 60.412307 Time: 527.19
Run: 17 VAL ap_score: 0.711748 map_score: 0.692358 Time: 188.61
Run: 18 train loss: 58.090799 Time: 521.49
Run: 18 VAL ap_score: 0.724454 map_score: 0.708396 Time: 187.48
Run: 19 train loss: 57.946988 Time: 524.82
Run: 19 VAL ap_score: 0.717800 map_score: 0.700891 Time: 182.50
Run: 20 train loss: 55.590834 Time: 518.17
Run: 20 VAL ap_score: 0.748462 map_score: 0.729149 Time: 189.52
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 21 train loss: 53.645213 Time: 504.81
Run: 21 VAL ap_score: 0.724245 map_score: 0.707975 Time: 180.50
Run: 22 train loss: 53.870662 Time: 506.66
Run: 22 VAL ap_score: 0.742547 map_score: 0.726646 Time: 190.10
Run: 23 train loss: 51.668238 Time: 515.16
Run: 23 VAL ap_score: 0.723983 map_score: 0.719650 Time: 184.77
Run: 24 train loss: 50.524639 Time: 529.92
Run: 24 VAL ap_score: 0.732545 map_score: 0.715126 Time: 187.25
Run: 25 train loss: 49.541439 Time: 525.93
Run: 25 VAL ap_score: 0.762864 map_score: 0.749943 Time: 184.68
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 26 train loss: 48.606601 Time: 528.57
Run: 26 VAL ap_score: 0.758757 map_score: 0.736835 Time: 189.00
Run: 27 train loss: 48.174247 Time: 515.68
Run: 27 VAL ap_score: 0.750355 map_score: 0.738425 Time: 195.37
Run: 28 train loss: 45.665281 Time: 508.24
Run: 28 VAL ap_score: 0.750605 map_score: 0.731936 Time: 188.02
Run: 29 train loss: 46.522050 Time: 527.70
Run: 29 VAL ap_score: 0.759528 map_score: 0.748794 Time: 186.43
Run: 30 train loss: 44.937604 Time: 516.22
Run: 30 VAL ap_score: 0.762663 map_score: 0.763090 Time: 195.08
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 31 train loss: 46.116408 Time: 511.60
Run: 31 VAL ap_score: 0.776429 map_score: 0.758269 Time: 191.44
Run: 32 train loss: 43.927308 Time: 500.24
Run: 32 VAL ap_score: 0.769254 map_score: 0.757656 Time: 189.82
Run: 33 train loss: 44.434212 Time: 511.74
Run: 33 VAL ap_score: 0.789556 map_score: 0.770092 Time: 186.93
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 34 train loss: 42.804404 Time: 520.41
Run: 34 VAL ap_score: 0.787088 map_score: 0.769553 Time: 186.06
Run: 35 train loss: 42.512267 Time: 518.97
Run: 35 VAL ap_score: 0.737545 map_score: 0.741944 Time: 188.64
Run: 36 train loss: 41.536775 Time: 523.31
Run: 36 VAL ap_score: 0.769725 map_score: 0.761229 Time: 193.78
Run: 37 train loss: 40.953620 Time: 524.42
Run: 37 VAL ap_score: 0.793664 map_score: 0.785692 Time: 191.05
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 38 train loss: 40.865095 Time: 511.85
Run: 38 VAL ap_score: 0.801645 map_score: 0.779972 Time: 191.18
Run: 39 train loss: 40.140594 Time: 516.13
Run: 39 VAL ap_score: 0.765929 map_score: 0.757624 Time: 187.35
Run: 40 train loss: 40.786376 Time: 520.95
Run: 40 VAL ap_score: 0.793469 map_score: 0.778129 Time: 195.42
Run: 41 train loss: 39.374331 Time: 519.93
Run: 41 VAL ap_score: 0.792257 map_score: 0.777555 Time: 189.73
Run: 42 train loss: 39.896284 Time: 644.48
Run: 42 VAL ap_score: 0.790428 map_score: 0.770257 Time: 257.73
Run: 43 train loss: 38.837487 Time: 803.08
Run: 43 VAL ap_score: 0.772804 map_score: 0.767326 Time: 290.01
Run: 44 train loss: 38.756147 Time: 664.90
Run: 44 VAL ap_score: 0.793509 map_score: 0.784118 Time: 175.57
Run: 45 train loss: 38.726423 Time: 492.19
Run: 45 VAL ap_score: 0.798505 map_score: 0.781630 Time: 180.34
Run: 46 train loss: 38.633016 Time: 494.86
Run: 46 VAL ap_score: 0.805143 map_score: 0.787927 Time: 189.23
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 47 train loss: 38.432647 Time: 476.50
Run: 47 VAL ap_score: 0.795205 map_score: 0.761521 Time: 168.63
Run: 48 train loss: 38.090236 Time: 510.16
Run: 48 VAL ap_score: 0.775053 map_score: 0.758029 Time: 183.44
Run: 49 train loss: 37.543457 Time: 524.42
Run: 49 VAL ap_score: 0.803234 map_score: 0.786482 Time: 184.67
Run: 50 train loss: 38.634649 Time: 528.17
Run: 50 VAL ap_score: 0.792427 map_score: 0.770493 Time: 184.97
Run: 51 train loss: 37.618873 Time: 541.69
Run: 51 VAL ap_score: 0.796033 map_score: 0.786732 Time: 197.15
Run: 52 train loss: 37.147147 Time: 536.39
Run: 52 VAL ap_score: 0.768680 map_score: 0.756690 Time: 200.45
Run: 53 train loss: 36.395205 Time: 534.86
Run: 53 VAL ap_score: 0.787426 map_score: 0.777306 Time: 202.79
Run: 54 train loss: 36.465810 Time: 525.92
Run: 54 VAL ap_score: 0.798312 map_score: 0.775990 Time: 190.77
Run: 55 train loss: 34.929804 Time: 513.26
Run: 55 VAL ap_score: 0.798159 map_score: 0.769277 Time: 198.67
Run: 56 train loss: 36.206901 Time: 518.74
Run: 56 VAL ap_score: 0.792956 map_score: 0.775504 Time: 190.28
Run: 57 train loss: 35.683882 Time: 522.80
Run: 57 VAL ap_score: 0.797550 map_score: 0.784104 Time: 198.44
Run: 58 train loss: 34.761961 Time: 525.92
Run: 58 VAL ap_score: 0.795851 map_score: 0.783242 Time: 201.23
Run: 59 train loss: 36.942018 Time: 524.12
Run: 59 VAL ap_score: 0.804188 map_score: 0.789079 Time: 198.92
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 60 train loss: 34.392254 Time: 512.68
Run: 60 VAL ap_score: 0.789874 map_score: 0.787797 Time: 188.29
Run: 61 train loss: 34.504436 Time: 500.35
Run: 61 VAL ap_score: 0.795600 map_score: 0.781589 Time: 181.12
Run: 62 train loss: 34.980954 Time: 495.33
Run: 62 VAL ap_score: 0.792396 map_score: 0.778354 Time: 187.91
Run: 63 train loss: 35.176943 Time: 496.39
Run: 63 VAL ap_score: 0.811953 map_score: 0.800307 Time: 169.04
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 64 train loss: 33.535916 Time: 480.20
Run: 64 VAL ap_score: 0.817816 map_score: 0.795723 Time: 186.24
Run: 65 train loss: 34.501371 Time: 487.38
Run: 65 VAL ap_score: 0.790354 map_score: 0.780961 Time: 184.37
Run: 66 train loss: 34.051923 Time: 486.16
Run: 66 VAL ap_score: 0.812588 map_score: 0.798515 Time: 184.61
Run: 67 train loss: 34.536540 Time: 474.43
Run: 67 VAL ap_score: 0.818262 map_score: 0.805165 Time: 178.30
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 68 train loss: 34.095271 Time: 461.09
Run: 68 VAL ap_score: 0.807858 map_score: 0.792642 Time: 177.80
Run: 69 train loss: 32.898018 Time: 442.34
Run: 69 VAL ap_score: 0.821216 map_score: 0.802241 Time: 167.66
Run: 70 train loss: 34.029712 Time: 438.24
Run: 70 VAL ap_score: 0.817167 map_score: 0.804463 Time: 168.06
Run: 71 train loss: 33.520583 Time: 443.78
Run: 71 VAL ap_score: 0.823337 map_score: 0.801461 Time: 168.00
Run: 72 train loss: 33.009830 Time: 454.40
Run: 72 VAL ap_score: 0.792798 map_score: 0.780542 Time: 171.74
Run: 73 train loss: 32.504517 Time: 452.12
Run: 73 VAL ap_score: 0.810740 map_score: 0.798158 Time: 172.65
Run: 74 train loss: 32.847879 Time: 446.32
Run: 74 VAL ap_score: 0.810106 map_score: 0.787545 Time: 177.38
Run: 75 train loss: 32.152122 Time: 475.26
Run: 75 VAL ap_score: 0.766750 map_score: 0.749886 Time: 176.76
Run: 76 train loss: 32.926585 Time: 481.15
Run: 76 VAL ap_score: 0.813880 map_score: 0.796336 Time: 189.22
Run: 77 train loss: 32.377382 Time: 509.20
Run: 77 VAL ap_score: 0.805403 map_score: 0.798659 Time: 180.78
Run: 78 train loss: 33.242388 Time: 488.55
Run: 78 VAL ap_score: 0.834559 map_score: 0.818588 Time: 183.60
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_aids_7474_2024-01-12_01:18:34.984322
Run: 79 train loss: 31.633602 Time: 507.28
Run: 79 VAL ap_score: 0.822221 map_score: 0.810059 Time: 185.65
Run: 80 train loss: 30.994936 Time: 467.70
Run: 80 VAL ap_score: 0.814488 map_score: 0.794671 Time: 180.50
Run: 81 train loss: 31.577174 Time: 475.26
Run: 81 VAL ap_score: 0.819375 map_score: 0.803204 Time: 177.58
Run: 82 train loss: 31.248829 Time: 481.11
Run: 82 VAL ap_score: 0.811191 map_score: 0.790007 Time: 183.35
Run: 83 train loss: 29.865847 Time: 481.50
Run: 83 VAL ap_score: 0.833716 map_score: 0.813639 Time: 182.53
Run: 84 train loss: 31.195519 Time: 502.42
Run: 84 VAL ap_score: 0.809300 map_score: 0.789184 Time: 180.13
Run: 85 train loss: 30.918414 Time: 479.34
Run: 85 VAL ap_score: 0.829529 map_score: 0.810356 Time: 182.14
