Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda08_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mr
--interpretability_lambda=0.8
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda08_clean/initialModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
no. of params in model: 3730
Run: 0 train loss: 275.330261 Time: 520.04
Run: 0 VAL ap_score: 0.482193 map_score: 0.469359 Time: 190.71
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 1 train loss: 188.088069 Time: 533.17
Run: 1 VAL ap_score: 0.513227 map_score: 0.506260 Time: 187.93
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 2 train loss: 160.224421 Time: 521.41
Run: 2 VAL ap_score: 0.525167 map_score: 0.508364 Time: 186.40
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 3 train loss: 137.528315 Time: 526.25
Run: 3 VAL ap_score: 0.546819 map_score: 0.531020 Time: 195.30
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 4 train loss: 115.997088 Time: 529.54
Run: 4 VAL ap_score: 0.569462 map_score: 0.571539 Time: 195.14
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 5 train loss: 103.387511 Time: 535.94
Run: 5 VAL ap_score: 0.619094 map_score: 0.597237 Time: 191.18
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 6 train loss: 95.380200 Time: 538.63
Run: 6 VAL ap_score: 0.648303 map_score: 0.612284 Time: 191.87
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 7 train loss: 90.031092 Time: 540.47
Run: 7 VAL ap_score: 0.681167 map_score: 0.642665 Time: 197.49
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 8 train loss: 86.133125 Time: 543.77
Run: 8 VAL ap_score: 0.649427 map_score: 0.637069 Time: 199.03
Run: 9 train loss: 83.505266 Time: 543.91
Run: 9 VAL ap_score: 0.681719 map_score: 0.652968 Time: 200.13
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 10 train loss: 76.925500 Time: 543.05
Run: 10 VAL ap_score: 0.662748 map_score: 0.631713 Time: 194.03
Run: 11 train loss: 72.205220 Time: 534.91
Run: 11 VAL ap_score: 0.684939 map_score: 0.654469 Time: 194.51
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 12 train loss: 68.619951 Time: 535.16
Run: 12 VAL ap_score: 0.700770 map_score: 0.674228 Time: 200.90
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 13 train loss: 66.560478 Time: 533.82
Run: 13 VAL ap_score: 0.676354 map_score: 0.648166 Time: 201.50
Run: 14 train loss: 63.320155 Time: 532.02
Run: 14 VAL ap_score: 0.691001 map_score: 0.675407 Time: 198.14
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 15 train loss: 60.757494 Time: 523.85
Run: 15 VAL ap_score: 0.705754 map_score: 0.680623 Time: 204.50
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 16 train loss: 59.723935 Time: 539.35
Run: 16 VAL ap_score: 0.706238 map_score: 0.674915 Time: 206.31
Run: 17 train loss: 57.785486 Time: 529.33
Run: 17 VAL ap_score: 0.714600 map_score: 0.695158 Time: 198.84
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 18 train loss: 54.668161 Time: 523.43
Run: 18 VAL ap_score: 0.706152 map_score: 0.699961 Time: 192.87
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 19 train loss: 54.228359 Time: 527.40
Run: 19 VAL ap_score: 0.729501 map_score: 0.713717 Time: 191.04
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 20 train loss: 52.375074 Time: 524.35
Run: 20 VAL ap_score: 0.742794 map_score: 0.722466 Time: 193.45
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 21 train loss: 51.046029 Time: 510.21
Run: 21 VAL ap_score: 0.752498 map_score: 0.727269 Time: 200.08
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 22 train loss: 48.981178 Time: 521.58
Run: 22 VAL ap_score: 0.730158 map_score: 0.714647 Time: 194.74
Run: 23 train loss: 48.640660 Time: 534.79
Run: 23 VAL ap_score: 0.734285 map_score: 0.719882 Time: 194.00
Run: 24 train loss: 46.834146 Time: 540.85
Run: 24 VAL ap_score: 0.736431 map_score: 0.729491 Time: 192.04
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 25 train loss: 46.639400 Time: 539.08
Run: 25 VAL ap_score: 0.727932 map_score: 0.717962 Time: 203.33
Run: 26 train loss: 44.772624 Time: 526.86
Run: 26 VAL ap_score: 0.741970 map_score: 0.720989 Time: 202.55
Run: 27 train loss: 45.570472 Time: 527.51
Run: 27 VAL ap_score: 0.748352 map_score: 0.737149 Time: 194.87
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 28 train loss: 43.588996 Time: 528.15
Run: 28 VAL ap_score: 0.751484 map_score: 0.728628 Time: 191.85
Run: 29 train loss: 42.649743 Time: 534.95
Run: 29 VAL ap_score: 0.760787 map_score: 0.733686 Time: 190.37
Run: 30 train loss: 41.848941 Time: 531.34
Run: 30 VAL ap_score: 0.742165 map_score: 0.726232 Time: 197.39
Run: 31 train loss: 41.574963 Time: 514.61
Run: 31 VAL ap_score: 0.760723 map_score: 0.730868 Time: 187.27
Run: 32 train loss: 40.362372 Time: 521.89
Run: 32 VAL ap_score: 0.775976 map_score: 0.765268 Time: 205.87
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 33 train loss: 39.908673 Time: 518.78
Run: 33 VAL ap_score: 0.759737 map_score: 0.742549 Time: 197.24
Run: 34 train loss: 38.652618 Time: 534.57
Run: 34 VAL ap_score: 0.737834 map_score: 0.735308 Time: 192.42
Run: 35 train loss: 38.647124 Time: 533.94
Run: 35 VAL ap_score: 0.750365 map_score: 0.754163 Time: 196.07
Run: 36 train loss: 37.807203 Time: 528.02
Run: 36 VAL ap_score: 0.773732 map_score: 0.755981 Time: 194.26
Run: 37 train loss: 37.253128 Time: 530.58
Run: 37 VAL ap_score: 0.771328 map_score: 0.763046 Time: 195.56
Run: 38 train loss: 36.090366 Time: 524.61
Run: 38 VAL ap_score: 0.774644 map_score: 0.760242 Time: 195.31
Run: 39 train loss: 37.247275 Time: 526.50
Run: 39 VAL ap_score: 0.788929 map_score: 0.767947 Time: 196.69
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 40 train loss: 36.129535 Time: 533.22
Run: 40 VAL ap_score: 0.783839 map_score: 0.761454 Time: 225.83
Run: 41 train loss: 35.412781 Time: 753.74
Run: 41 VAL ap_score: 0.794159 map_score: 0.767733 Time: 274.94
Run: 42 train loss: 34.541708 Time: 927.31
Run: 42 VAL ap_score: 0.761534 map_score: 0.755809 Time: 293.55
Run: 43 train loss: 34.134669 Time: 622.19
Run: 43 VAL ap_score: 0.793069 map_score: 0.774407 Time: 217.17
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 44 train loss: 34.580076 Time: 600.53
Run: 44 VAL ap_score: 0.791322 map_score: 0.767160 Time: 226.94
Run: 45 train loss: 33.798337 Time: 584.40
Run: 45 VAL ap_score: 0.790206 map_score: 0.765831 Time: 192.19
Run: 46 train loss: 33.616723 Time: 523.33
Run: 46 VAL ap_score: 0.792715 map_score: 0.760905 Time: 201.59
Run: 47 train loss: 33.335033 Time: 527.30
Run: 47 VAL ap_score: 0.787831 map_score: 0.771957 Time: 201.00
Run: 48 train loss: 33.026243 Time: 526.70
Run: 48 VAL ap_score: 0.795375 map_score: 0.780663 Time: 195.19
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 49 train loss: 32.390195 Time: 565.68
Run: 49 VAL ap_score: 0.752555 map_score: 0.759773 Time: 215.24
Run: 50 train loss: 33.165066 Time: 536.27
Run: 50 VAL ap_score: 0.791590 map_score: 0.772084 Time: 203.51
Run: 51 train loss: 31.876597 Time: 549.46
Run: 51 VAL ap_score: 0.806168 map_score: 0.788879 Time: 203.39
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 52 train loss: 31.243475 Time: 518.66
Run: 52 VAL ap_score: 0.789906 map_score: 0.758579 Time: 198.80
Run: 53 train loss: 32.564022 Time: 540.92
Run: 53 VAL ap_score: 0.808172 map_score: 0.782311 Time: 200.34
Run: 54 train loss: 31.729046 Time: 525.57
Run: 54 VAL ap_score: 0.814401 map_score: 0.781385 Time: 197.57
Run: 55 train loss: 30.771865 Time: 538.70
Run: 55 VAL ap_score: 0.806673 map_score: 0.788641 Time: 196.12
Run: 56 train loss: 30.571117 Time: 546.32
Run: 56 VAL ap_score: 0.776839 map_score: 0.761654 Time: 192.94
Run: 57 train loss: 30.992874 Time: 515.91
Run: 57 VAL ap_score: 0.807611 map_score: 0.791499 Time: 188.08
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 58 train loss: 30.753775 Time: 517.09
Run: 58 VAL ap_score: 0.811702 map_score: 0.789480 Time: 181.94
Run: 59 train loss: 30.229679 Time: 503.34
Run: 59 VAL ap_score: 0.791522 map_score: 0.783108 Time: 190.33
Run: 60 train loss: 29.848647 Time: 531.30
Run: 60 VAL ap_score: 0.816681 map_score: 0.794087 Time: 192.72
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 61 train loss: 28.753716 Time: 496.99
Run: 61 VAL ap_score: 0.803066 map_score: 0.782415 Time: 195.08
Run: 62 train loss: 30.396714 Time: 531.05
Run: 62 VAL ap_score: 0.781928 map_score: 0.755715 Time: 199.43
Run: 63 train loss: 29.650255 Time: 542.87
Run: 63 VAL ap_score: 0.795448 map_score: 0.793939 Time: 208.74
Run: 64 train loss: 28.310130 Time: 531.78
Run: 64 VAL ap_score: 0.796932 map_score: 0.782225 Time: 206.12
Run: 65 train loss: 29.323111 Time: 533.18
Run: 65 VAL ap_score: 0.813202 map_score: 0.782283 Time: 186.54
Run: 66 train loss: 29.258952 Time: 490.47
Run: 66 VAL ap_score: 0.787742 map_score: 0.774351 Time: 187.60
Run: 67 train loss: 28.691398 Time: 501.85
Run: 67 VAL ap_score: 0.807521 map_score: 0.781406 Time: 193.32
Run: 68 train loss: 28.599585 Time: 498.75
Run: 68 VAL ap_score: 0.807810 map_score: 0.793994 Time: 195.43
Run: 69 train loss: 28.363481 Time: 520.64
Run: 69 VAL ap_score: 0.806494 map_score: 0.804638 Time: 199.57
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 70 train loss: 27.657752 Time: 526.94
Run: 70 VAL ap_score: 0.820202 map_score: 0.794708 Time: 193.82
Run: 71 train loss: 28.581998 Time: 537.51
Run: 71 VAL ap_score: 0.818902 map_score: 0.793212 Time: 199.01
Run: 72 train loss: 27.959554 Time: 522.20
Run: 72 VAL ap_score: 0.822279 map_score: 0.790301 Time: 185.99
Run: 73 train loss: 26.917780 Time: 535.82
Run: 73 VAL ap_score: 0.819297 map_score: 0.804434 Time: 193.12
Run: 74 train loss: 28.243632 Time: 516.24
Run: 74 VAL ap_score: 0.797160 map_score: 0.794375 Time: 196.64
Run: 75 train loss: 26.889926 Time: 532.20
Run: 75 VAL ap_score: 0.810595 map_score: 0.797854 Time: 205.57
Run: 76 train loss: 26.913766 Time: 529.09
Run: 76 VAL ap_score: 0.836660 map_score: 0.815791 Time: 200.51
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 77 train loss: 26.758616 Time: 543.59
Run: 77 VAL ap_score: 0.843441 map_score: 0.822374 Time: 315.02
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_01:19:14.998986
Run: 78 train loss: 27.063947 Time: 710.82
Run: 78 VAL ap_score: 0.786540 map_score: 0.799407 Time: 273.60
Run: 79 train loss: 26.923567 Time: 708.20
Run: 79 VAL ap_score: 0.816203 map_score: 0.803485 Time: 331.27
