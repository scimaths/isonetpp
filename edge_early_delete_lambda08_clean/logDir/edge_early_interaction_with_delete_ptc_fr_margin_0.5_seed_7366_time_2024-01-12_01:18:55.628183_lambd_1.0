Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda08_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fr
--interpretability_lambda=0.8
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda08_clean/initialModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
no. of params in model: 3730
Run: 0 train loss: 301.825045 Time: 583.31
Run: 0 VAL ap_score: 0.493233 map_score: 0.494314 Time: 215.82
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 1 train loss: 196.992906 Time: 571.36
Run: 1 VAL ap_score: 0.551347 map_score: 0.558561 Time: 205.98
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 2 train loss: 165.131291 Time: 577.59
Run: 2 VAL ap_score: 0.571304 map_score: 0.548601 Time: 203.97
Run: 3 train loss: 146.194105 Time: 590.92
Run: 3 VAL ap_score: 0.624671 map_score: 0.614377 Time: 202.35
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 4 train loss: 130.495316 Time: 590.02
Run: 4 VAL ap_score: 0.636382 map_score: 0.645419 Time: 213.49
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 5 train loss: 118.561372 Time: 583.55
Run: 5 VAL ap_score: 0.661076 map_score: 0.658715 Time: 213.60
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 6 train loss: 105.961534 Time: 583.64
Run: 6 VAL ap_score: 0.693955 map_score: 0.690662 Time: 218.32
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 7 train loss: 100.601125 Time: 577.89
Run: 7 VAL ap_score: 0.707195 map_score: 0.683260 Time: 218.23
Run: 8 train loss: 95.279121 Time: 577.66
Run: 8 VAL ap_score: 0.691720 map_score: 0.674456 Time: 211.16
Run: 9 train loss: 90.183314 Time: 577.50
Run: 9 VAL ap_score: 0.694563 map_score: 0.683993 Time: 213.27
Run: 10 train loss: 86.848581 Time: 580.08
Run: 10 VAL ap_score: 0.737498 map_score: 0.712308 Time: 212.71
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 11 train loss: 83.403362 Time: 584.87
Run: 11 VAL ap_score: 0.738376 map_score: 0.718770 Time: 215.23
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 12 train loss: 81.096977 Time: 575.05
Run: 12 VAL ap_score: 0.744875 map_score: 0.723751 Time: 215.34
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 13 train loss: 78.101759 Time: 575.57
Run: 13 VAL ap_score: 0.744342 map_score: 0.723490 Time: 219.40
Run: 14 train loss: 75.753309 Time: 595.32
Run: 14 VAL ap_score: 0.749794 map_score: 0.736927 Time: 211.27
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 15 train loss: 73.275775 Time: 612.68
Run: 15 VAL ap_score: 0.750352 map_score: 0.732295 Time: 224.44
Run: 16 train loss: 71.400088 Time: 604.18
Run: 16 VAL ap_score: 0.766161 map_score: 0.749096 Time: 208.28
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 17 train loss: 68.458644 Time: 611.09
Run: 17 VAL ap_score: 0.778775 map_score: 0.753823 Time: 207.14
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 18 train loss: 67.766657 Time: 585.88
Run: 18 VAL ap_score: 0.763058 map_score: 0.743361 Time: 222.93
Run: 19 train loss: 66.298898 Time: 578.72
Run: 19 VAL ap_score: 0.774285 map_score: 0.760986 Time: 207.81
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 20 train loss: 64.739762 Time: 587.62
Run: 20 VAL ap_score: 0.754986 map_score: 0.736088 Time: 202.11
Run: 21 train loss: 62.136450 Time: 594.03
Run: 21 VAL ap_score: 0.798258 map_score: 0.778021 Time: 215.59
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 22 train loss: 62.738530 Time: 605.19
Run: 22 VAL ap_score: 0.799697 map_score: 0.775721 Time: 194.61
Run: 23 train loss: 59.495428 Time: 577.47
Run: 23 VAL ap_score: 0.804794 map_score: 0.778526 Time: 215.98
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 24 train loss: 58.019604 Time: 588.92
Run: 24 VAL ap_score: 0.784966 map_score: 0.762870 Time: 210.04
Run: 25 train loss: 56.163842 Time: 606.82
Run: 25 VAL ap_score: 0.801109 map_score: 0.776112 Time: 218.36
Run: 26 train loss: 56.945020 Time: 595.02
Run: 26 VAL ap_score: 0.771748 map_score: 0.758941 Time: 201.96
Run: 27 train loss: 54.285816 Time: 576.34
Run: 27 VAL ap_score: 0.804467 map_score: 0.781265 Time: 207.75
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 28 train loss: 53.338913 Time: 586.58
Run: 28 VAL ap_score: 0.793707 map_score: 0.771736 Time: 213.04
Run: 29 train loss: 52.849907 Time: 582.51
Run: 29 VAL ap_score: 0.805962 map_score: 0.774368 Time: 201.40
Run: 30 train loss: 52.562691 Time: 575.20
Run: 30 VAL ap_score: 0.807428 map_score: 0.771489 Time: 208.41
Run: 31 train loss: 51.789729 Time: 569.07
Run: 31 VAL ap_score: 0.809482 map_score: 0.777427 Time: 194.85
Run: 32 train loss: 52.163258 Time: 571.21
Run: 32 VAL ap_score: 0.810657 map_score: 0.779584 Time: 197.33
Run: 33 train loss: 49.625928 Time: 584.27
Run: 33 VAL ap_score: 0.796577 map_score: 0.774373 Time: 198.73
Run: 34 train loss: 49.337912 Time: 583.92
Run: 34 VAL ap_score: 0.798373 map_score: 0.778725 Time: 205.13
Run: 35 train loss: 49.180904 Time: 589.61
Run: 35 VAL ap_score: 0.803699 map_score: 0.777671 Time: 193.45
Run: 36 train loss: 48.046700 Time: 591.97
Run: 36 VAL ap_score: 0.824781 map_score: 0.794614 Time: 201.83
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 37 train loss: 47.099849 Time: 768.22
Run: 37 VAL ap_score: 0.815945 map_score: 0.797847 Time: 391.36
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 38 train loss: 46.331153 Time: 942.15
Run: 38 VAL ap_score: 0.803182 map_score: 0.796389 Time: 349.24
Run: 39 train loss: 45.242101 Time: 598.43
Run: 39 VAL ap_score: 0.789118 map_score: 0.769756 Time: 214.59
Run: 40 train loss: 46.082755 Time: 639.95
Run: 40 VAL ap_score: 0.802762 map_score: 0.782919 Time: 234.75
Run: 41 train loss: 44.833786 Time: 623.07
Run: 41 VAL ap_score: 0.807144 map_score: 0.777281 Time: 208.65
Run: 42 train loss: 44.760394 Time: 580.66
Run: 42 VAL ap_score: 0.833822 map_score: 0.803326 Time: 201.04
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 43 train loss: 42.985565 Time: 568.20
Run: 43 VAL ap_score: 0.806825 map_score: 0.784704 Time: 205.31
Run: 44 train loss: 42.594243 Time: 569.16
Run: 44 VAL ap_score: 0.833608 map_score: 0.804437 Time: 216.88
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 45 train loss: 42.453604 Time: 614.71
Run: 45 VAL ap_score: 0.836230 map_score: 0.811400 Time: 219.12
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 46 train loss: 41.831251 Time: 621.15
Run: 46 VAL ap_score: 0.818247 map_score: 0.799320 Time: 206.56
Run: 47 train loss: 40.620897 Time: 623.21
Run: 47 VAL ap_score: 0.808862 map_score: 0.782359 Time: 217.87
Run: 48 train loss: 40.069192 Time: 600.04
Run: 48 VAL ap_score: 0.832050 map_score: 0.802863 Time: 215.34
Run: 49 train loss: 40.413226 Time: 606.27
Run: 49 VAL ap_score: 0.830364 map_score: 0.807371 Time: 213.21
Run: 50 train loss: 39.263334 Time: 608.88
Run: 50 VAL ap_score: 0.828840 map_score: 0.808088 Time: 231.89
Run: 51 train loss: 38.740193 Time: 595.87
Run: 51 VAL ap_score: 0.832933 map_score: 0.808757 Time: 207.91
Run: 52 train loss: 38.033754 Time: 595.02
Run: 52 VAL ap_score: 0.837313 map_score: 0.810064 Time: 247.64
Run: 53 train loss: 38.001964 Time: 644.57
Run: 53 VAL ap_score: 0.841124 map_score: 0.819073 Time: 261.94
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 54 train loss: 38.582402 Time: 652.93
Run: 54 VAL ap_score: 0.830047 map_score: 0.813022 Time: 236.86
Run: 55 train loss: 37.099027 Time: 607.92
Run: 55 VAL ap_score: 0.844803 map_score: 0.818008 Time: 242.58
Run: 56 train loss: 36.456966 Time: 602.47
Run: 56 VAL ap_score: 0.842329 map_score: 0.821567 Time: 225.58
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 57 train loss: 37.044592 Time: 604.40
Run: 57 VAL ap_score: 0.819405 map_score: 0.799843 Time: 228.86
Run: 58 train loss: 35.697471 Time: 619.40
Run: 58 VAL ap_score: 0.838847 map_score: 0.827536 Time: 253.80
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 59 train loss: 36.234847 Time: 694.88
Run: 59 VAL ap_score: 0.844982 map_score: 0.817455 Time: 383.70
Run: 60 train loss: 35.984561 Time: 640.56
Run: 60 VAL ap_score: 0.843802 map_score: 0.823270 Time: 234.58
Run: 61 train loss: 36.054684 Time: 623.10
Run: 61 VAL ap_score: 0.848673 map_score: 0.821461 Time: 212.98
Run: 62 train loss: 34.942513 Time: 606.30
Run: 62 VAL ap_score: 0.853312 map_score: 0.825573 Time: 202.54
Run: 63 train loss: 35.669609 Time: 584.65
Run: 63 VAL ap_score: 0.811145 map_score: 0.778727 Time: 219.93
Run: 64 train loss: 34.560330 Time: 589.86
Run: 64 VAL ap_score: 0.846015 map_score: 0.821020 Time: 210.95
Run: 65 train loss: 34.935091 Time: 586.16
Run: 65 VAL ap_score: 0.853903 map_score: 0.829888 Time: 214.88
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 66 train loss: 33.713126 Time: 585.71
Run: 66 VAL ap_score: 0.842368 map_score: 0.823872 Time: 209.52
Run: 67 train loss: 33.115039 Time: 597.34
Run: 67 VAL ap_score: 0.861232 map_score: 0.839594 Time: 230.19
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 68 train loss: 33.605990 Time: 605.68
Run: 68 VAL ap_score: 0.864450 map_score: 0.837210 Time: 218.94
Run: 69 train loss: 33.197383 Time: 698.95
Run: 69 VAL ap_score: 0.864090 map_score: 0.842313 Time: 368.76
saving best validated model to ./edge_early_delete_lambda08_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_fr_7366_2024-01-12_01:18:55.628183
Run: 70 train loss: 31.937904 Time: 994.95
Run: 70 VAL ap_score: 0.850260 map_score: 0.828506 Time: 377.57
