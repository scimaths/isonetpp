Command line
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_scoring_sinkhorn
--TASK=gmn_match_hinge_scoring_sinkhorn
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge baseline scoring
saving initial model to ./gmn_match_hinge_scoring_sinkhorn/initialModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
no. of params in model: 1720
Run: 0 train loss: 268.225778 Time: 466.23
Run: 0 VAL ap_score: 0.451408 map_score: 0.448461 Time: 144.37
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 1 train loss: 191.448793 Time: 462.07
Run: 1 VAL ap_score: 0.453751 map_score: 0.475892 Time: 137.96
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 2 train loss: 168.377136 Time: 458.02
Run: 2 VAL ap_score: 0.499801 map_score: 0.489966 Time: 138.82
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 3 train loss: 150.655516 Time: 460.90
Run: 3 VAL ap_score: 0.484078 map_score: 0.491846 Time: 138.30
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 4 train loss: 139.131020 Time: 462.39
Run: 4 VAL ap_score: 0.535512 map_score: 0.528837 Time: 138.46
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 5 train loss: 130.666657 Time: 460.81
Run: 5 VAL ap_score: 0.543600 map_score: 0.545225 Time: 139.00
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 6 train loss: 124.856311 Time: 457.86
Run: 6 VAL ap_score: 0.543694 map_score: 0.549103 Time: 138.40
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 7 train loss: 121.052417 Time: 461.20
Run: 7 VAL ap_score: 0.579917 map_score: 0.590171 Time: 139.32
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 8 train loss: 117.297072 Time: 461.30
Run: 8 VAL ap_score: 0.592306 map_score: 0.601328 Time: 138.28
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 9 train loss: 113.713498 Time: 458.10
Run: 9 VAL ap_score: 0.563218 map_score: 0.555601 Time: 137.93
Run: 10 train loss: 112.689230 Time: 463.97
Run: 10 VAL ap_score: 0.598112 map_score: 0.606613 Time: 140.07
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 11 train loss: 110.157949 Time: 457.20
Run: 11 VAL ap_score: 0.603647 map_score: 0.598708 Time: 139.04
Run: 12 train loss: 107.869126 Time: 467.56
Run: 12 VAL ap_score: 0.591088 map_score: 0.582694 Time: 140.08
Run: 13 train loss: 104.305228 Time: 466.61
Run: 13 VAL ap_score: 0.616587 map_score: 0.614644 Time: 137.33
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 14 train loss: 103.764742 Time: 458.03
Run: 14 VAL ap_score: 0.641540 map_score: 0.642944 Time: 138.37
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 15 train loss: 102.706670 Time: 466.57
Run: 15 VAL ap_score: 0.619705 map_score: 0.609475 Time: 139.30
Run: 16 train loss: 100.722608 Time: 453.63
Run: 16 VAL ap_score: 0.615015 map_score: 0.617494 Time: 136.71
Run: 17 train loss: 99.279540 Time: 452.71
Run: 17 VAL ap_score: 0.634406 map_score: 0.624026 Time: 137.26
Run: 18 train loss: 97.559741 Time: 452.99
Run: 18 VAL ap_score: 0.604475 map_score: 0.621115 Time: 137.25
Run: 19 train loss: 96.056480 Time: 453.10
Run: 19 VAL ap_score: 0.648335 map_score: 0.644231 Time: 137.48
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 20 train loss: 94.974356 Time: 454.69
Run: 20 VAL ap_score: 0.632929 map_score: 0.633382 Time: 137.90
Run: 21 train loss: 94.601869 Time: 455.66
Run: 21 VAL ap_score: 0.634568 map_score: 0.638587 Time: 137.26
Run: 22 train loss: 94.248216 Time: 453.37
Run: 22 VAL ap_score: 0.646152 map_score: 0.645723 Time: 137.69
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 23 train loss: 92.956619 Time: 451.88
Run: 23 VAL ap_score: 0.661937 map_score: 0.645551 Time: 136.81
Run: 24 train loss: 91.649588 Time: 454.19
Run: 24 VAL ap_score: 0.654206 map_score: 0.646890 Time: 135.86
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 25 train loss: 90.863350 Time: 452.19
Run: 25 VAL ap_score: 0.644699 map_score: 0.653917 Time: 136.63
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 26 train loss: 90.811084 Time: 452.97
Run: 26 VAL ap_score: 0.644010 map_score: 0.651188 Time: 136.99
Run: 27 train loss: 89.782121 Time: 450.60
Run: 27 VAL ap_score: 0.646507 map_score: 0.644286 Time: 136.52
Run: 28 train loss: 88.304295 Time: 456.76
Run: 28 VAL ap_score: 0.656141 map_score: 0.650479 Time: 137.69
Run: 29 train loss: 88.969067 Time: 453.64
Run: 29 VAL ap_score: 0.667130 map_score: 0.649773 Time: 137.32
Run: 30 train loss: 87.673234 Time: 454.58
Run: 30 VAL ap_score: 0.634788 map_score: 0.639690 Time: 136.42
Run: 31 train loss: 86.074186 Time: 454.12
Run: 31 VAL ap_score: 0.652476 map_score: 0.647080 Time: 137.51
Run: 32 train loss: 85.399115 Time: 441.67
Run: 32 VAL ap_score: 0.661790 map_score: 0.649194 Time: 137.65
Run: 33 train loss: 84.167809 Time: 457.13
Run: 33 VAL ap_score: 0.661110 map_score: 0.656802 Time: 140.84
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 34 train loss: 84.004398 Time: 469.44
Run: 34 VAL ap_score: 0.651902 map_score: 0.650754 Time: 143.46
Run: 35 train loss: 83.798005 Time: 477.40
Run: 35 VAL ap_score: 0.655039 map_score: 0.646243 Time: 142.38
Run: 36 train loss: 82.676461 Time: 473.84
Run: 36 VAL ap_score: 0.681402 map_score: 0.676796 Time: 142.48
saving best validated model to ./gmn_match_hinge_scoring_sinkhorn/bestValidationModels/gmn_match_hinge_scoring_sinkhorn_ptc_mm_7762_2024-01-22_22:22:37.738295
Run: 37 train loss: 82.086441 Time: 478.97
Run: 37 VAL ap_score: 0.671059 map_score: 0.659424 Time: 141.92
Run: 38 train loss: 81.566560 Time: 478.93
Run: 38 VAL ap_score: 0.666288 map_score: 0.652741 Time: 142.00
Run: 39 train loss: 81.714321 Time: 473.00
Run: 39 VAL ap_score: 0.645297 map_score: 0.656977 Time: 142.11
Run: 40 train loss: 81.408831 Time: 472.21
Run: 40 VAL ap_score: 0.663104 map_score: 0.639056 Time: 140.06
Run: 41 train loss: 79.829161 Time: 471.40
Run: 41 VAL ap_score: 0.657555 map_score: 0.649609 Time: 140.67
Run: 42 train loss: 79.434765 Time: 471.71
Run: 42 VAL ap_score: 0.671503 map_score: 0.665039 Time: 141.14
Run: 43 train loss: 78.879574 Time: 465.88
Run: 43 VAL ap_score: 0.654346 map_score: 0.651918 Time: 139.58
Run: 44 train loss: 78.048955 Time: 470.66
Run: 44 VAL ap_score: 0.679369 map_score: 0.662563 Time: 140.99
Run: 45 train loss: 79.396247 Time: 469.69
Run: 45 VAL ap_score: 0.654683 map_score: 0.653952 Time: 140.10
Run: 46 train loss: 78.499615 Time: 466.71
Run: 46 VAL ap_score: 0.663076 map_score: 0.658525 Time: 139.57
Run: 47 train loss: 77.551520 Time: 466.48
Run: 47 VAL ap_score: 0.670071 map_score: 0.650260 Time: 141.06
Run: 48 train loss: 76.957077 Time: 471.31
Run: 48 VAL ap_score: 0.671501 map_score: 0.661153 Time: 139.52
Run: 49 train loss: 77.422066 Time: 466.81
Run: 49 VAL ap_score: 0.662596 map_score: 0.653448 Time: 138.85
Run: 50 train loss: 77.140009 Time: 465.61
Run: 50 VAL ap_score: 0.674071 map_score: 0.654904 Time: 138.36
Run: 51 train loss: 77.348989 Time: 451.94
Run: 51 VAL ap_score: 0.677761 map_score: 0.657489 Time: 139.24
Run: 52 train loss: 75.903276 Time: 453.32
Run: 52 VAL ap_score: 0.670092 map_score: 0.650095 Time: 136.57
Run: 53 train loss: 76.567494 Time: 451.93
Run: 53 VAL ap_score: 0.670179 map_score: 0.655136 Time: 136.10
Run: 54 train loss: 76.970279 Time: 453.86
Run: 54 VAL ap_score: 0.665112 map_score: 0.650989 Time: 137.84
Run: 55 train loss: 75.949050 Time: 453.14
Run: 55 VAL ap_score: 0.666624 map_score: 0.664651 Time: 136.43
Run: 56 train loss: 75.756997 Time: 454.00
Run: 56 VAL ap_score: 0.677328 map_score: 0.662530 Time: 138.24
Run: 57 train loss: 75.227956 Time: 452.26
Run: 57 VAL ap_score: 0.664582 map_score: 0.650966 Time: 135.12
Run: 58 train loss: 75.353694 Time: 454.17
Run: 58 VAL ap_score: 0.672906 map_score: 0.660715 Time: 136.07
Run: 59 train loss: 74.304146 Time: 454.41
Run: 59 VAL ap_score: 0.653971 map_score: 0.653682 Time: 136.82
Run: 60 train loss: 74.937525 Time: 451.81
Run: 60 VAL ap_score: 0.656738 map_score: 0.643039 Time: 136.53
Run: 61 train loss: 73.864146 Time: 450.22
Run: 61 VAL ap_score: 0.672518 map_score: 0.653690 Time: 136.13
Run: 62 train loss: 74.910038 Time: 450.19
Run: 62 VAL ap_score: 0.681492 map_score: 0.662485 Time: 136.22
Run: 63 train loss: 74.209600 Time: 445.54
Run: 63 VAL ap_score: 0.667710 map_score: 0.651225 Time: 136.51
Run: 64 train loss: 73.996516 Time: 450.29
Run: 64 VAL ap_score: 0.658490 map_score: 0.661551 Time: 134.68
Run: 65 train loss: 73.747630 Time: 451.79
Run: 65 VAL ap_score: 0.673904 map_score: 0.651244 Time: 135.60
Run: 66 train loss: 73.604469 Time: 455.56
Run: 66 VAL ap_score: 0.685258 map_score: 0.668695 Time: 137.02
Run: 67 train loss: 74.060930 Time: 452.87
Run: 67 VAL ap_score: 0.660278 map_score: 0.649192 Time: 136.32
Run: 68 train loss: 73.507726 Time: 457.25
Run: 68 VAL ap_score: 0.677534 map_score: 0.664950 Time: 137.56
Run: 69 train loss: 73.256034 Time: 451.70
Run: 69 VAL ap_score: 0.678175 map_score: 0.656527 Time: 136.67
Run: 70 train loss: 72.793044 Time: 455.81
Run: 70 VAL ap_score: 0.690609 map_score: 0.666885 Time: 136.00
Run: 71 train loss: 73.024417 Time: 445.61
Run: 71 VAL ap_score: 0.677127 map_score: 0.662134 Time: 136.67
Run: 72 train loss: 72.345914 Time: 453.08
Run: 72 VAL ap_score: 0.665284 map_score: 0.656531 Time: 137.93
Run: 73 train loss: 73.668702 Time: 457.74
Run: 73 VAL ap_score: 0.656144 map_score: 0.653488 Time: 138.16
Run: 74 train loss: 72.374045 Time: 451.34
Run: 74 VAL ap_score: 0.677833 map_score: 0.656133 Time: 135.45
Run: 75 train loss: 72.316786 Time: 445.62
Run: 75 VAL ap_score: 0.674790 map_score: 0.659825 Time: 136.12
Run: 76 train loss: 72.657399 Time: 444.63
Run: 76 VAL ap_score: 0.686692 map_score: 0.666990 Time: 136.95
Run: 77 train loss: 73.225826 Time: 449.96
Run: 77 VAL ap_score: 0.677109 map_score: 0.658723 Time: 136.50
Run: 78 train loss: 70.472520 Time: 447.67
Run: 78 VAL ap_score: 0.689134 map_score: 0.664677 Time: 135.95
Run: 79 train loss: 71.723323 Time: 452.84
Run: 79 VAL ap_score: 0.676800 map_score: 0.665130 Time: 136.44
Run: 80 train loss: 71.400533 Time: 458.80
Run: 80 VAL ap_score: 0.666911 map_score: 0.647351 Time: 139.53
Run: 81 train loss: 70.518607 Time: 458.58
Run: 81 VAL ap_score: 0.691747 map_score: 0.669803 Time: 139.03
Run: 82 train loss: 71.056799 Time: 460.28
Run: 82 VAL ap_score: 0.687771 map_score: 0.666363 Time: 140.36
Run: 83 train loss: 71.455501 Time: 461.41
Run: 83 VAL ap_score: 0.685264 map_score: 0.663203 Time: 138.09
Run: 84 train loss: 70.448444 Time: 453.92
Run: 84 VAL ap_score: 0.676403 map_score: 0.667609 Time: 137.71
Run: 85 train loss: 71.095058 Time: 454.41
Run: 85 VAL ap_score: 0.676338 map_score: 0.655603 Time: 135.04
Run: 86 train loss: 70.250526 Time: 446.67
Run: 86 VAL ap_score: 0.669872 map_score: 0.653641 Time: 135.55
Run: 87 train loss: 71.535661 Time: 446.17
Run: 87 VAL ap_score: 0.661212 map_score: 0.656478 Time: 133.61
