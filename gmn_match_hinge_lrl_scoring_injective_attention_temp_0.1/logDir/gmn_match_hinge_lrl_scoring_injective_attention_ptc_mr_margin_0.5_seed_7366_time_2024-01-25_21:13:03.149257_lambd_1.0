Command line
/raid/infolab/vaibhav/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1
--TASK=gmn_match_hinge_lrl_scoring_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
--temp_gmn_scoring=0.1
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/initialModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
no. of params in model: 2168
Run: 0 train loss: 209.095379 Time: 701.62
Run: 0 VAL ap_score: 0.486839 map_score: 0.501564 Time: 251.99
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 1 train loss: 164.020405 Time: 708.65
Run: 1 VAL ap_score: 0.493732 map_score: 0.513132 Time: 256.29
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 2 train loss: 149.819224 Time: 714.68
Run: 2 VAL ap_score: 0.533065 map_score: 0.518173 Time: 255.70
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 3 train loss: 138.208820 Time: 712.35
Run: 3 VAL ap_score: 0.559168 map_score: 0.552842 Time: 255.94
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 4 train loss: 130.312555 Time: 716.51
Run: 4 VAL ap_score: 0.570586 map_score: 0.557445 Time: 253.24
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 5 train loss: 122.550650 Time: 707.84
Run: 5 VAL ap_score: 0.563453 map_score: 0.569719 Time: 251.33
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 6 train loss: 118.283967 Time: 718.61
Run: 6 VAL ap_score: 0.571041 map_score: 0.563799 Time: 250.41
Run: 7 train loss: 116.232909 Time: 712.00
Run: 7 VAL ap_score: 0.605918 map_score: 0.598570 Time: 250.30
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 8 train loss: 113.009011 Time: 710.94
Run: 8 VAL ap_score: 0.602554 map_score: 0.594632 Time: 253.47
Run: 9 train loss: 108.851639 Time: 706.51
Run: 9 VAL ap_score: 0.586245 map_score: 0.587842 Time: 257.06
Run: 10 train loss: 107.152166 Time: 706.62
Run: 10 VAL ap_score: 0.618051 map_score: 0.587524 Time: 261.31
Run: 11 train loss: 104.192431 Time: 702.27
Run: 11 VAL ap_score: 0.615798 map_score: 0.596039 Time: 262.89
Run: 12 train loss: 102.482625 Time: 693.49
Run: 12 VAL ap_score: 0.597852 map_score: 0.584684 Time: 266.28
Run: 13 train loss: 102.173089 Time: 687.82
Run: 13 VAL ap_score: 0.598564 map_score: 0.584517 Time: 263.94
Run: 14 train loss: 100.992564 Time: 684.31
Run: 14 VAL ap_score: 0.599477 map_score: 0.578150 Time: 265.75
Run: 15 train loss: 99.578737 Time: 691.08
Run: 15 VAL ap_score: 0.611924 map_score: 0.595363 Time: 266.31
Run: 16 train loss: 98.477811 Time: 674.81
Run: 16 VAL ap_score: 0.620041 map_score: 0.604364 Time: 266.60
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 17 train loss: 96.633807 Time: 675.41
Run: 17 VAL ap_score: 0.606821 map_score: 0.607450 Time: 268.28
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 18 train loss: 95.441516 Time: 677.29
Run: 18 VAL ap_score: 0.610766 map_score: 0.604627 Time: 268.55
Run: 19 train loss: 95.614785 Time: 677.67
Run: 19 VAL ap_score: 0.636520 map_score: 0.612724 Time: 270.22
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 20 train loss: 93.523376 Time: 675.99
Run: 20 VAL ap_score: 0.643047 map_score: 0.615495 Time: 269.26
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 21 train loss: 92.407164 Time: 671.61
Run: 21 VAL ap_score: 0.631444 map_score: 0.606979 Time: 268.94
Run: 22 train loss: 92.356386 Time: 674.78
Run: 22 VAL ap_score: 0.633923 map_score: 0.617880 Time: 269.40
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 23 train loss: 90.379496 Time: 675.14
Run: 23 VAL ap_score: 0.630541 map_score: 0.615180 Time: 269.43
Run: 24 train loss: 90.691209 Time: 674.60
Run: 24 VAL ap_score: 0.598537 map_score: 0.583869 Time: 268.96
Run: 25 train loss: 90.585930 Time: 670.89
Run: 25 VAL ap_score: 0.651480 map_score: 0.623140 Time: 270.32
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 26 train loss: 88.979567 Time: 670.93
Run: 26 VAL ap_score: 0.631320 map_score: 0.617830 Time: 269.07
Run: 27 train loss: 87.987848 Time: 670.52
Run: 27 VAL ap_score: 0.650397 map_score: 0.630844 Time: 271.45
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 28 train loss: 87.236967 Time: 730.00
Run: 28 VAL ap_score: 0.644374 map_score: 0.626555 Time: 327.52
Run: 29 train loss: 86.773885 Time: 671.53
Run: 29 VAL ap_score: 0.629359 map_score: 0.598323 Time: 273.84
Run: 30 train loss: 85.908951 Time: 748.84
Run: 30 VAL ap_score: 0.637631 map_score: 0.625430 Time: 300.38
Run: 31 train loss: 84.876654 Time: 661.91
Run: 31 VAL ap_score: 0.632172 map_score: 0.626108 Time: 287.64
Run: 32 train loss: 84.815699 Time: 663.69
Run: 32 VAL ap_score: 0.628964 map_score: 0.615477 Time: 283.24
Run: 33 train loss: 83.785193 Time: 810.67
Run: 33 VAL ap_score: 0.633807 map_score: 0.625010 Time: 276.22
Run: 34 train loss: 83.583230 Time: 668.07
Run: 34 VAL ap_score: 0.641279 map_score: 0.617148 Time: 279.37
Run: 35 train loss: 83.307037 Time: 678.41
Run: 35 VAL ap_score: 0.639033 map_score: 0.624434 Time: 302.68
Run: 36 train loss: 83.144610 Time: 868.21
Run: 36 VAL ap_score: 0.629858 map_score: 0.609385 Time: 284.90
Run: 37 train loss: 82.237281 Time: 728.59
Run: 37 VAL ap_score: 0.627538 map_score: 0.620630 Time: 261.96
Run: 38 train loss: 82.108493 Time: 700.91
Run: 38 VAL ap_score: 0.642207 map_score: 0.625736 Time: 338.73
Run: 39 train loss: 81.862587 Time: 850.40
Run: 39 VAL ap_score: 0.652698 map_score: 0.623950 Time: 281.59
Run: 40 train loss: 81.468182 Time: 837.77
Run: 40 VAL ap_score: 0.632125 map_score: 0.618899 Time: 337.77
Run: 41 train loss: 81.809095 Time: 834.33
Run: 41 VAL ap_score: 0.632740 map_score: 0.625560 Time: 335.41
Run: 42 train loss: 80.604387 Time: 831.24
Run: 42 VAL ap_score: 0.641752 map_score: 0.621617 Time: 338.97
Run: 43 train loss: 80.390919 Time: 835.79
Run: 43 VAL ap_score: 0.661227 map_score: 0.634035 Time: 339.14
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 44 train loss: 79.698123 Time: 831.32
Run: 44 VAL ap_score: 0.647529 map_score: 0.638221 Time: 338.53
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 45 train loss: 79.075555 Time: 827.00
Run: 45 VAL ap_score: 0.654874 map_score: 0.641669 Time: 339.28
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 46 train loss: 79.174228 Time: 826.59
Run: 46 VAL ap_score: 0.641210 map_score: 0.607856 Time: 340.90
Run: 47 train loss: 78.952317 Time: 829.00
Run: 47 VAL ap_score: 0.643335 map_score: 0.632090 Time: 341.93
Run: 48 train loss: 78.427508 Time: 820.96
Run: 48 VAL ap_score: 0.655288 map_score: 0.634734 Time: 346.23
Run: 49 train loss: 78.855317 Time: 819.11
Run: 49 VAL ap_score: 0.651578 map_score: 0.634353 Time: 342.37
Run: 50 train loss: 77.812312 Time: 823.15
Run: 50 VAL ap_score: 0.651975 map_score: 0.635437 Time: 345.48
Run: 51 train loss: 77.965648 Time: 819.44
Run: 51 VAL ap_score: 0.643324 map_score: 0.631751 Time: 343.63
Run: 52 train loss: 77.913597 Time: 829.91
Run: 52 VAL ap_score: 0.660384 map_score: 0.632457 Time: 344.63
Run: 53 train loss: 76.969356 Time: 835.33
Run: 53 VAL ap_score: 0.647735 map_score: 0.625211 Time: 352.57
Run: 54 train loss: 76.390759 Time: 839.11
Run: 54 VAL ap_score: 0.651541 map_score: 0.633338 Time: 349.58
Run: 55 train loss: 76.722202 Time: 833.39
Run: 55 VAL ap_score: 0.651880 map_score: 0.633945 Time: 347.85
Run: 56 train loss: 76.329638 Time: 837.00
Run: 56 VAL ap_score: 0.653967 map_score: 0.644158 Time: 346.72
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 57 train loss: 76.520058 Time: 833.67
Run: 57 VAL ap_score: 0.651993 map_score: 0.638174 Time: 344.88
Run: 58 train loss: 76.203992 Time: 831.43
Run: 58 VAL ap_score: 0.659921 map_score: 0.640298 Time: 338.16
Run: 59 train loss: 75.505845 Time: 820.28
Run: 59 VAL ap_score: 0.652334 map_score: 0.644382 Time: 338.58
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 60 train loss: 75.158619 Time: 851.51
Run: 60 VAL ap_score: 0.666797 map_score: 0.639682 Time: 343.09
Run: 61 train loss: 75.595300 Time: 856.47
Run: 61 VAL ap_score: 0.637937 map_score: 0.624786 Time: 337.07
Run: 62 train loss: 75.360294 Time: 827.27
Run: 62 VAL ap_score: 0.664868 map_score: 0.636088 Time: 327.01
Run: 63 train loss: 74.681724 Time: 834.30
Run: 63 VAL ap_score: 0.657484 map_score: 0.638784 Time: 334.97
Run: 64 train loss: 75.429547 Time: 838.63
Run: 64 VAL ap_score: 0.651638 map_score: 0.630960 Time: 328.03
Run: 65 train loss: 74.357828 Time: 837.40
Run: 65 VAL ap_score: 0.653682 map_score: 0.642943 Time: 328.47
Run: 66 train loss: 74.819645 Time: 848.36
Run: 66 VAL ap_score: 0.653418 map_score: 0.642700 Time: 334.92
Run: 67 train loss: 73.976754 Time: 855.31
Run: 67 VAL ap_score: 0.662436 map_score: 0.637705 Time: 324.85
Run: 68 train loss: 72.883692 Time: 813.36
Run: 68 VAL ap_score: 0.655966 map_score: 0.645279 Time: 312.29
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 69 train loss: 73.337997 Time: 869.30
Run: 69 VAL ap_score: 0.662039 map_score: 0.642966 Time: 326.72
Run: 70 train loss: 72.547356 Time: 849.70
Run: 70 VAL ap_score: 0.647538 map_score: 0.624056 Time: 325.14
Run: 71 train loss: 72.939114 Time: 851.94
Run: 71 VAL ap_score: 0.676811 map_score: 0.649459 Time: 323.43
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 72 train loss: 72.634515 Time: 861.04
Run: 72 VAL ap_score: 0.670000 map_score: 0.644830 Time: 328.77
Run: 73 train loss: 72.738167 Time: 856.81
Run: 73 VAL ap_score: 0.668558 map_score: 0.640645 Time: 335.06
Run: 74 train loss: 72.714942 Time: 846.24
Run: 74 VAL ap_score: 0.640644 map_score: 0.634586 Time: 334.56
Run: 75 train loss: 71.549612 Time: 833.31
Run: 75 VAL ap_score: 0.653163 map_score: 0.645706 Time: 332.72
Run: 76 train loss: 71.741520 Time: 824.09
Run: 76 VAL ap_score: 0.651121 map_score: 0.642693 Time: 331.49
Run: 77 train loss: 70.541332 Time: 823.21
Run: 77 VAL ap_score: 0.661253 map_score: 0.651347 Time: 333.29
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_mr_7366_2024-01-25_21:13:03.149257
Run: 78 train loss: 71.217528 Time: 840.10
Run: 78 VAL ap_score: 0.647783 map_score: 0.643351 Time: 343.99
Run: 79 train loss: 70.840015 Time: 876.73
Run: 79 VAL ap_score: 0.657034 map_score: 0.644489 Time: 364.21
Run: 80 train loss: 70.105555 Time: 864.43
Run: 80 VAL ap_score: 0.676766 map_score: 0.640983 Time: 360.19
Run: 81 train loss: 70.619576 Time: 859.92
Run: 81 VAL ap_score: 0.635152 map_score: 0.642403 Time: 357.35
Run: 82 train loss: 70.956314 Time: 856.13
Run: 82 VAL ap_score: 0.682678 map_score: 0.649230 Time: 361.27
Run: 83 train loss: 70.802726 Time: 858.01
Run: 83 VAL ap_score: 0.653537 map_score: 0.643547 Time: 347.13
Run: 84 train loss: 70.800134 Time: 838.34
Run: 84 VAL ap_score: 0.631230 map_score: 0.627405 Time: 350.03
Run: 85 train loss: 69.857182 Time: 844.47
