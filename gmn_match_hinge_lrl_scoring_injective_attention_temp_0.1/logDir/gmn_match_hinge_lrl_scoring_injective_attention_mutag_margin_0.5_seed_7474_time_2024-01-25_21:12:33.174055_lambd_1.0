Command line
/raid/infolab/vaibhav/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1
--TASK=gmn_match_hinge_lrl_scoring_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=mutag
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
--temp_gmn_scoring=0.1
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/initialModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
no. of params in model: 2168
Run: 0 train loss: 317.823695 Time: 737.57
Run: 0 VAL ap_score: 0.393028 map_score: 0.404700 Time: 277.42
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 1 train loss: 271.275938 Time: 733.69
Run: 1 VAL ap_score: 0.440091 map_score: 0.471173 Time: 279.89
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 2 train loss: 230.033116 Time: 732.23
Run: 2 VAL ap_score: 0.485750 map_score: 0.553844 Time: 280.40
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 3 train loss: 182.671130 Time: 738.42
Run: 3 VAL ap_score: 0.507486 map_score: 0.592433 Time: 283.69
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 4 train loss: 153.175723 Time: 732.14
Run: 4 VAL ap_score: 0.620970 map_score: 0.648528 Time: 281.46
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 5 train loss: 139.835988 Time: 731.90
Run: 5 VAL ap_score: 0.572259 map_score: 0.629943 Time: 284.39
Run: 6 train loss: 133.898581 Time: 725.03
Run: 6 VAL ap_score: 0.610058 map_score: 0.663629 Time: 285.20
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 7 train loss: 128.869857 Time: 730.53
Run: 7 VAL ap_score: 0.651294 map_score: 0.678259 Time: 287.26
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 8 train loss: 123.859325 Time: 731.39
Run: 8 VAL ap_score: 0.641699 map_score: 0.668812 Time: 289.44
Run: 9 train loss: 123.196295 Time: 726.89
Run: 9 VAL ap_score: 0.646157 map_score: 0.654425 Time: 290.53
Run: 10 train loss: 117.066095 Time: 726.50
Run: 10 VAL ap_score: 0.611717 map_score: 0.607121 Time: 293.35
Run: 11 train loss: 114.176029 Time: 724.11
Run: 11 VAL ap_score: 0.655876 map_score: 0.677470 Time: 290.11
Run: 12 train loss: 110.956432 Time: 723.84
Run: 12 VAL ap_score: 0.675350 map_score: 0.686381 Time: 289.17
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 13 train loss: 105.843921 Time: 717.37
Run: 13 VAL ap_score: 0.681052 map_score: 0.691915 Time: 289.63
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 14 train loss: 104.478353 Time: 717.99
Run: 14 VAL ap_score: 0.651235 map_score: 0.688389 Time: 293.43
Run: 15 train loss: 103.026416 Time: 722.15
Run: 15 VAL ap_score: 0.659925 map_score: 0.690427 Time: 295.18
Run: 16 train loss: 98.519824 Time: 720.13
Run: 16 VAL ap_score: 0.671588 map_score: 0.685693 Time: 296.36
Run: 17 train loss: 98.970054 Time: 719.76
Run: 17 VAL ap_score: 0.686695 map_score: 0.688996 Time: 295.13
Run: 18 train loss: 95.372358 Time: 721.33
Run: 18 VAL ap_score: 0.683221 map_score: 0.683803 Time: 296.15
Run: 19 train loss: 93.815624 Time: 719.61
Run: 19 VAL ap_score: 0.679924 map_score: 0.693486 Time: 294.13
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 20 train loss: 91.871028 Time: 719.51
Run: 20 VAL ap_score: 0.652886 map_score: 0.653409 Time: 296.96
Run: 21 train loss: 92.078741 Time: 717.40
Run: 21 VAL ap_score: 0.658920 map_score: 0.684000 Time: 294.05
Run: 22 train loss: 90.768790 Time: 718.87
Run: 22 VAL ap_score: 0.696507 map_score: 0.704668 Time: 291.27
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 23 train loss: 91.669059 Time: 721.47
Run: 23 VAL ap_score: 0.695884 map_score: 0.694191 Time: 292.55
Run: 24 train loss: 87.917372 Time: 721.51
Run: 24 VAL ap_score: 0.679543 map_score: 0.699977 Time: 293.94
Run: 25 train loss: 87.802364 Time: 722.92
Run: 25 VAL ap_score: 0.677006 map_score: 0.672437 Time: 292.42
Run: 26 train loss: 86.922388 Time: 718.78
Run: 26 VAL ap_score: 0.712792 map_score: 0.709606 Time: 354.00
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 27 train loss: 85.480310 Time: 776.34
Run: 27 VAL ap_score: 0.699486 map_score: 0.701667 Time: 294.51
Run: 28 train loss: 85.587358 Time: 712.83
Run: 28 VAL ap_score: 0.700668 map_score: 0.699911 Time: 288.57
Run: 29 train loss: 85.251939 Time: 709.32
Run: 29 VAL ap_score: 0.694305 map_score: 0.691319 Time: 296.30
Run: 30 train loss: 83.875595 Time: 716.63
Run: 30 VAL ap_score: 0.671856 map_score: 0.697756 Time: 299.37
Run: 31 train loss: 82.797337 Time: 720.02
Run: 31 VAL ap_score: 0.704021 map_score: 0.690535 Time: 285.36
Run: 32 train loss: 83.449017 Time: 647.88
Run: 32 VAL ap_score: 0.706567 map_score: 0.717376 Time: 247.14
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 33 train loss: 81.830098 Time: 605.92
Run: 33 VAL ap_score: 0.712272 map_score: 0.719253 Time: 248.75
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 34 train loss: 79.405010 Time: 599.27
Run: 34 VAL ap_score: 0.669155 map_score: 0.678380 Time: 224.28
Run: 35 train loss: 79.383860 Time: 617.43
Run: 35 VAL ap_score: 0.665601 map_score: 0.652284 Time: 220.17
Run: 36 train loss: 80.234469 Time: 603.62
Run: 36 VAL ap_score: 0.689656 map_score: 0.700897 Time: 249.01
Run: 37 train loss: 78.866232 Time: 608.25
Run: 37 VAL ap_score: 0.711696 map_score: 0.704889 Time: 316.63
Run: 38 train loss: 79.357116 Time: 766.08
Run: 38 VAL ap_score: 0.712710 map_score: 0.704058 Time: 296.12
Run: 39 train loss: 78.381161 Time: 723.75
Run: 39 VAL ap_score: 0.706061 map_score: 0.718745 Time: 314.83
Run: 40 train loss: 78.920267 Time: 753.34
Run: 40 VAL ap_score: 0.728085 map_score: 0.717593 Time: 317.68
Run: 41 train loss: 76.343665 Time: 754.47
Run: 41 VAL ap_score: 0.718736 map_score: 0.715835 Time: 313.47
Run: 42 train loss: 77.070552 Time: 753.07
Run: 42 VAL ap_score: 0.699070 map_score: 0.707454 Time: 312.86
Run: 43 train loss: 76.753037 Time: 753.05
Run: 43 VAL ap_score: 0.725739 map_score: 0.727114 Time: 309.82
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 44 train loss: 75.666970 Time: 754.17
Run: 44 VAL ap_score: 0.716759 map_score: 0.713934 Time: 307.58
Run: 45 train loss: 75.660192 Time: 757.29
Run: 45 VAL ap_score: 0.705112 map_score: 0.712539 Time: 309.03
Run: 46 train loss: 75.950567 Time: 758.98
Run: 46 VAL ap_score: 0.693086 map_score: 0.695489 Time: 303.66
Run: 47 train loss: 73.507187 Time: 753.80
Run: 47 VAL ap_score: 0.718960 map_score: 0.718280 Time: 306.21
Run: 48 train loss: 73.919668 Time: 752.76
Run: 48 VAL ap_score: 0.724268 map_score: 0.714915 Time: 310.42
Run: 49 train loss: 74.581582 Time: 754.95
Run: 49 VAL ap_score: 0.709297 map_score: 0.716320 Time: 307.28
Run: 50 train loss: 73.896727 Time: 757.93
Run: 50 VAL ap_score: 0.716286 map_score: 0.729461 Time: 306.70
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 51 train loss: 74.320238 Time: 756.17
Run: 51 VAL ap_score: 0.736391 map_score: 0.728674 Time: 308.66
Run: 52 train loss: 72.171814 Time: 760.60
Run: 52 VAL ap_score: 0.715086 map_score: 0.716222 Time: 309.43
Run: 53 train loss: 72.425731 Time: 763.56
Run: 53 VAL ap_score: 0.702935 map_score: 0.705251 Time: 314.21
Run: 54 train loss: 71.110555 Time: 776.18
Run: 54 VAL ap_score: 0.643106 map_score: 0.683239 Time: 319.17
Run: 55 train loss: 71.571914 Time: 783.69
Run: 55 VAL ap_score: 0.725169 map_score: 0.717073 Time: 314.16
Run: 56 train loss: 70.758804 Time: 767.88
Run: 56 VAL ap_score: 0.738261 map_score: 0.724834 Time: 309.79
Run: 57 train loss: 70.462134 Time: 759.31
Run: 57 VAL ap_score: 0.691942 map_score: 0.704492 Time: 308.72
Run: 58 train loss: 71.002968 Time: 757.25
Run: 58 VAL ap_score: 0.724844 map_score: 0.715302 Time: 306.45
Run: 59 train loss: 69.302780 Time: 756.56
Run: 59 VAL ap_score: 0.704549 map_score: 0.714323 Time: 306.21
Run: 60 train loss: 70.059898 Time: 753.76
Run: 60 VAL ap_score: 0.736429 map_score: 0.726816 Time: 310.99
Run: 61 train loss: 69.356858 Time: 765.00
Run: 61 VAL ap_score: 0.730618 map_score: 0.729244 Time: 308.56
Run: 62 train loss: 69.233585 Time: 759.21
Run: 62 VAL ap_score: 0.734634 map_score: 0.726190 Time: 309.34
Run: 63 train loss: 68.270835 Time: 760.22
Run: 63 VAL ap_score: 0.734420 map_score: 0.731450 Time: 306.40
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 64 train loss: 67.962401 Time: 762.73
Run: 64 VAL ap_score: 0.711795 map_score: 0.708245 Time: 308.68
Run: 65 train loss: 68.414748 Time: 749.80
Run: 65 VAL ap_score: 0.698390 map_score: 0.722086 Time: 312.28
Run: 66 train loss: 68.599577 Time: 754.08
Run: 66 VAL ap_score: 0.717455 map_score: 0.733565 Time: 318.03
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 67 train loss: 67.382392 Time: 750.92
Run: 67 VAL ap_score: 0.732846 map_score: 0.725688 Time: 316.93
Run: 68 train loss: 67.726275 Time: 756.62
Run: 68 VAL ap_score: 0.729297 map_score: 0.720640 Time: 316.44
Run: 69 train loss: 67.058101 Time: 751.86
Run: 69 VAL ap_score: 0.731622 map_score: 0.730312 Time: 305.97
Run: 70 train loss: 66.956028 Time: 726.42
Run: 70 VAL ap_score: 0.739742 map_score: 0.728008 Time: 297.93
Run: 71 train loss: 68.250711 Time: 774.14
Run: 71 VAL ap_score: 0.721869 map_score: 0.731451 Time: 317.59
Run: 72 train loss: 66.268215 Time: 773.34
Run: 72 VAL ap_score: 0.733713 map_score: 0.739199 Time: 313.75
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 73 train loss: 66.221129 Time: 764.45
Run: 73 VAL ap_score: 0.729469 map_score: 0.736626 Time: 307.44
Run: 74 train loss: 67.957095 Time: 756.17
Run: 74 VAL ap_score: 0.693059 map_score: 0.706143 Time: 308.82
Run: 75 train loss: 65.672324 Time: 756.47
Run: 75 VAL ap_score: 0.738527 map_score: 0.734003 Time: 305.01
Run: 76 train loss: 66.734912 Time: 755.29
Run: 76 VAL ap_score: 0.736832 map_score: 0.733945 Time: 305.60
Run: 77 train loss: 65.661483 Time: 756.72
Run: 77 VAL ap_score: 0.736448 map_score: 0.723486 Time: 307.29
Run: 78 train loss: 65.676433 Time: 746.65
Run: 78 VAL ap_score: 0.716892 map_score: 0.717063 Time: 306.16
Run: 79 train loss: 64.546911 Time: 753.06
Run: 79 VAL ap_score: 0.722401 map_score: 0.730017 Time: 310.97
Run: 80 train loss: 65.979408 Time: 774.77
Run: 80 VAL ap_score: 0.729490 map_score: 0.717468 Time: 310.55
Run: 81 train loss: 65.370162 Time: 762.87
Run: 81 VAL ap_score: 0.727301 map_score: 0.744118 Time: 305.62
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention_temp_0.1/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_21:12:33.174055
Run: 82 train loss: 66.381383 Time: 761.03
