loading train query graphs from ./Datasets/splits/train/train_aids80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_aids80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/aids80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_aids80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_aids80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/aids80k_corpus_subgraphs.pkl
Loading model Temporal_ISONET
This model implements early interaction with a temporal ISONET
saving initial model to ./initialModels/temporal_isonet_kt_1_iters_shared_params_aids_0
no. of params in model: 2280
Run: 0 train loss: 171.313783 Time: 57.60
Run: 0 VAL ap_score: 0.430634 map_score: 0.440114 Time: 15.65
saving best validated model to ./bestValidationModels/temporal_isonet_kt_1_iters_shared_params_aids_0
Run: 1 train loss: 64.047620 Time: 48.20
Traceback (most recent call last):
  File "/mnt/home/ashwinr/.conda/envs/btp-mcis/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/mnt/home/ashwinr/.conda/envs/btp-mcis/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/mnt/home/ashwinr/btp24/grph/ISONET/subgraph/iso_matching_models.py", line 466, in <module>
    train(av, config)
  File "/mnt/home/ashwinr/btp24/grph/ISONET/subgraph/iso_matching_models.py", line 224, in train
    ap_score,map_score = evaluate_embeddings_similarity(av,model,val_data)
  File "/mnt/home/ashwinr/btp24/grph/ISONET/subgraph/eval_utils.py", line 43, in evaluate_embeddings_similarity
    pred.append( model(batch_data,batch_data_sizes,batch_adj).data)
  File "/mnt/home/ashwinr/.conda/envs/btp-mcis/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/home/ashwinr/btp24/grph/ISONET/subgraph/models/temporal_isonet.py", line 137, in forward
    edge_counts  = self.fetch_edge_counts(to_idx,from_idx,graph_idx,2*len(batch_data_sizes))
  File "/mnt/home/ashwinr/btp24/grph/ISONET/subgraph/models/temporal_isonet.py", line 37, in fetch_edge_counts
    edge_counts = unsorted_segment_sum(tt, graph_idx, num_graphs)
  File "/mnt/home/ashwinr/btp24/grph/ISONET/GMN/segment.py", line 51, in unsorted_segment_sum
    segment_ids = segment_ids.repeat_interleave(s).view(segment_ids.shape[0], *data.shape[1:])
KeyboardInterrupt