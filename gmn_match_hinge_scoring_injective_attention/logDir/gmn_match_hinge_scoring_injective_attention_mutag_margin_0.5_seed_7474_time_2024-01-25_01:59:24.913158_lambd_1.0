Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_scoring_injective_attention
--TASK=gmn_match_hinge_scoring_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=mutag
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge baseline scoring
saving initial model to ./gmn_match_hinge_scoring_injective_attention/initialModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
no. of params in model: 1720
Run: 0 train loss: 327.034493 Time: 444.06
Run: 0 VAL ap_score: 0.395071 map_score: 0.411778 Time: 150.72
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 1 train loss: 295.432153 Time: 435.17
Run: 1 VAL ap_score: 0.404502 map_score: 0.424553 Time: 150.57
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 2 train loss: 278.692700 Time: 434.95
Run: 2 VAL ap_score: 0.404734 map_score: 0.444769 Time: 150.58
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 3 train loss: 261.681750 Time: 434.06
Run: 3 VAL ap_score: 0.429528 map_score: 0.468396 Time: 155.41
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 4 train loss: 239.093527 Time: 429.80
Run: 4 VAL ap_score: 0.455864 map_score: 0.507861 Time: 150.20
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 5 train loss: 212.606802 Time: 434.90
Run: 5 VAL ap_score: 0.494587 map_score: 0.534227 Time: 150.24
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 6 train loss: 192.030424 Time: 418.88
Run: 6 VAL ap_score: 0.449606 map_score: 0.550001 Time: 145.21
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 7 train loss: 179.786380 Time: 419.04
Run: 7 VAL ap_score: 0.558070 map_score: 0.600230 Time: 145.15
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 8 train loss: 169.716906 Time: 418.99
Run: 8 VAL ap_score: 0.544447 map_score: 0.595840 Time: 144.61
Run: 9 train loss: 160.479262 Time: 419.61
Run: 9 VAL ap_score: 0.572722 map_score: 0.607951 Time: 144.36
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 10 train loss: 155.323742 Time: 419.52
Run: 10 VAL ap_score: 0.541727 map_score: 0.585638 Time: 144.09
Run: 11 train loss: 146.460974 Time: 420.23
Run: 11 VAL ap_score: 0.597562 map_score: 0.618772 Time: 144.32
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 12 train loss: 139.944833 Time: 421.28
Run: 12 VAL ap_score: 0.549225 map_score: 0.623355 Time: 144.68
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 13 train loss: 134.551480 Time: 419.06
Run: 13 VAL ap_score: 0.568301 map_score: 0.647361 Time: 144.70
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 14 train loss: 130.014769 Time: 421.44
Run: 14 VAL ap_score: 0.605392 map_score: 0.654006 Time: 145.88
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 15 train loss: 126.881750 Time: 420.58
Run: 15 VAL ap_score: 0.577951 map_score: 0.656421 Time: 145.22
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 16 train loss: 124.812050 Time: 421.03
Run: 16 VAL ap_score: 0.572353 map_score: 0.670300 Time: 145.75
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 17 train loss: 125.053527 Time: 420.47
Run: 17 VAL ap_score: 0.619694 map_score: 0.666617 Time: 145.66
Run: 18 train loss: 120.659150 Time: 419.83
Run: 18 VAL ap_score: 0.588412 map_score: 0.660495 Time: 145.83
Run: 19 train loss: 119.252794 Time: 421.77
Run: 19 VAL ap_score: 0.592333 map_score: 0.678789 Time: 146.01
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 20 train loss: 116.962213 Time: 420.93
Run: 20 VAL ap_score: 0.575151 map_score: 0.661505 Time: 147.99
Run: 21 train loss: 116.905276 Time: 443.99
Run: 21 VAL ap_score: 0.575154 map_score: 0.667522 Time: 157.33
Run: 22 train loss: 113.465437 Time: 441.96
Run: 22 VAL ap_score: 0.577123 map_score: 0.663669 Time: 157.21
Run: 23 train loss: 112.735836 Time: 442.58
Run: 23 VAL ap_score: 0.631911 map_score: 0.676480 Time: 155.67
Run: 24 train loss: 112.749178 Time: 443.41
Run: 24 VAL ap_score: 0.586999 map_score: 0.690072 Time: 156.54
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 25 train loss: 110.692023 Time: 443.77
Run: 25 VAL ap_score: 0.588977 map_score: 0.673370 Time: 155.73
Run: 26 train loss: 109.452838 Time: 441.51
Run: 26 VAL ap_score: 0.590343 map_score: 0.677285 Time: 155.65
Run: 27 train loss: 108.773346 Time: 443.83
Run: 27 VAL ap_score: 0.574849 map_score: 0.662767 Time: 155.46
Run: 28 train loss: 106.587151 Time: 438.04
Run: 28 VAL ap_score: 0.595145 map_score: 0.681127 Time: 155.79
Run: 29 train loss: 105.206946 Time: 439.96
Run: 29 VAL ap_score: 0.580806 map_score: 0.679322 Time: 155.30
Run: 30 train loss: 103.637007 Time: 441.66
Run: 30 VAL ap_score: 0.582057 map_score: 0.690928 Time: 154.07
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 31 train loss: 103.376632 Time: 441.34
Run: 31 VAL ap_score: 0.612045 map_score: 0.692229 Time: 154.68
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 32 train loss: 101.551927 Time: 442.74
Run: 32 VAL ap_score: 0.591805 map_score: 0.688121 Time: 154.41
Run: 33 train loss: 100.992923 Time: 441.69
Run: 33 VAL ap_score: 0.609103 map_score: 0.693369 Time: 146.59
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 34 train loss: 100.500453 Time: 417.95
Run: 34 VAL ap_score: 0.605099 map_score: 0.678947 Time: 144.32
Run: 35 train loss: 100.455699 Time: 418.04
Run: 35 VAL ap_score: 0.627596 map_score: 0.700661 Time: 144.38
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 36 train loss: 99.374947 Time: 416.97
Run: 36 VAL ap_score: 0.636465 map_score: 0.671891 Time: 144.64
Run: 37 train loss: 98.855686 Time: 418.58
Run: 37 VAL ap_score: 0.637186 map_score: 0.705238 Time: 144.09
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 38 train loss: 97.220784 Time: 418.44
Run: 38 VAL ap_score: 0.660193 map_score: 0.698785 Time: 143.80
Run: 39 train loss: 98.399641 Time: 419.19
Run: 39 VAL ap_score: 0.626463 map_score: 0.707638 Time: 144.01
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 40 train loss: 95.149731 Time: 419.98
Run: 40 VAL ap_score: 0.631276 map_score: 0.699941 Time: 143.57
Run: 41 train loss: 95.145875 Time: 419.19
Run: 41 VAL ap_score: 0.610721 map_score: 0.679695 Time: 144.45
Run: 42 train loss: 95.486507 Time: 419.75
Run: 42 VAL ap_score: 0.634354 map_score: 0.701848 Time: 145.40
Run: 43 train loss: 95.398397 Time: 419.49
Run: 43 VAL ap_score: 0.657140 map_score: 0.713180 Time: 144.38
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_mutag_7474_2024-01-25_01:59:24.913158
Run: 44 train loss: 94.530999 Time: 436.83
Run: 44 VAL ap_score: 0.641785 map_score: 0.689728 Time: 155.07
Run: 45 train loss: 92.271339 Time: 439.65
Run: 45 VAL ap_score: 0.638912 map_score: 0.707327 Time: 155.59
Run: 46 train loss: 93.862744 Time: 440.15
Run: 46 VAL ap_score: 0.613654 map_score: 0.689446 Time: 155.42
Run: 47 train loss: 92.612327 Time: 440.01
Run: 47 VAL ap_score: 0.629763 map_score: 0.701082 Time: 155.71
Run: 48 train loss: 90.840870 Time: 416.72
Run: 48 VAL ap_score: 0.625969 map_score: 0.693844 Time: 144.91
Run: 49 train loss: 92.155500 Time: 490.65
Run: 49 VAL ap_score: 0.659401 map_score: 0.707565 Time: 144.37
Run: 50 train loss: 90.994276 Time: 418.10
Run: 50 VAL ap_score: 0.661876 map_score: 0.709596 Time: 145.30
Run: 51 train loss: 90.389074 Time: 419.35
Run: 51 VAL ap_score: 0.665089 map_score: 0.708872 Time: 150.71
Run: 52 train loss: 90.188564 Time: 427.46
Run: 52 VAL ap_score: 0.643622 map_score: 0.693352 Time: 149.48
