Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_scoring_injective_attention
--TASK=gmn_match_hinge_scoring_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge baseline scoring
saving initial model to ./gmn_match_hinge_scoring_injective_attention/initialModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
no. of params in model: 1720
Run: 0 train loss: 220.745915 Time: 451.51
Run: 0 VAL ap_score: 0.521653 map_score: 0.529874 Time: 150.03
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 1 train loss: 186.451173 Time: 440.90
Run: 1 VAL ap_score: 0.528438 map_score: 0.543363 Time: 150.78
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 2 train loss: 177.111519 Time: 442.44
Run: 2 VAL ap_score: 0.548310 map_score: 0.551138 Time: 149.91
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 3 train loss: 168.977974 Time: 441.43
Run: 3 VAL ap_score: 0.561649 map_score: 0.565418 Time: 154.50
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 4 train loss: 161.213029 Time: 438.76
Run: 4 VAL ap_score: 0.567120 map_score: 0.576730 Time: 151.26
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 5 train loss: 153.764943 Time: 442.72
Run: 5 VAL ap_score: 0.566282 map_score: 0.577273 Time: 142.34
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 6 train loss: 146.979411 Time: 428.43
Run: 6 VAL ap_score: 0.593787 map_score: 0.594127 Time: 144.59
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 7 train loss: 140.141982 Time: 427.67
Run: 7 VAL ap_score: 0.608648 map_score: 0.609985 Time: 144.53
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 8 train loss: 135.860599 Time: 425.51
Run: 8 VAL ap_score: 0.608847 map_score: 0.614062 Time: 144.60
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 9 train loss: 131.844923 Time: 427.10
Run: 9 VAL ap_score: 0.616028 map_score: 0.614992 Time: 144.50
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 10 train loss: 129.475338 Time: 426.82
Run: 10 VAL ap_score: 0.623754 map_score: 0.626016 Time: 144.39
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 11 train loss: 127.245595 Time: 428.81
Run: 11 VAL ap_score: 0.633989 map_score: 0.633042 Time: 144.21
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 12 train loss: 126.055670 Time: 426.90
Run: 12 VAL ap_score: 0.624072 map_score: 0.627100 Time: 144.14
Run: 13 train loss: 124.610084 Time: 428.01
Run: 13 VAL ap_score: 0.632108 map_score: 0.635398 Time: 144.44
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 14 train loss: 122.615960 Time: 429.64
Run: 14 VAL ap_score: 0.628316 map_score: 0.633459 Time: 144.11
Run: 15 train loss: 122.279513 Time: 428.38
Run: 15 VAL ap_score: 0.632717 map_score: 0.630207 Time: 144.85
Run: 16 train loss: 121.557688 Time: 429.03
Run: 16 VAL ap_score: 0.634891 map_score: 0.633318 Time: 144.74
Run: 17 train loss: 119.428632 Time: 428.45
Run: 17 VAL ap_score: 0.644151 map_score: 0.640711 Time: 144.46
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 18 train loss: 119.283738 Time: 429.02
Run: 18 VAL ap_score: 0.638594 map_score: 0.637528 Time: 145.06
Run: 19 train loss: 117.735058 Time: 429.18
Run: 19 VAL ap_score: 0.642328 map_score: 0.641220 Time: 145.45
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 20 train loss: 117.871044 Time: 430.09
Run: 20 VAL ap_score: 0.644106 map_score: 0.646089 Time: 151.88
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 21 train loss: 115.954613 Time: 450.51
Run: 21 VAL ap_score: 0.649267 map_score: 0.645455 Time: 155.14
Run: 22 train loss: 115.553113 Time: 449.66
Run: 22 VAL ap_score: 0.646660 map_score: 0.647141 Time: 155.07
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 23 train loss: 116.025359 Time: 448.94
Run: 23 VAL ap_score: 0.647739 map_score: 0.642317 Time: 155.48
Run: 24 train loss: 113.742744 Time: 450.35
Run: 24 VAL ap_score: 0.658860 map_score: 0.657848 Time: 156.70
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 25 train loss: 112.752774 Time: 450.70
Run: 25 VAL ap_score: 0.659141 map_score: 0.653827 Time: 156.69
Run: 26 train loss: 112.264510 Time: 448.05
Run: 26 VAL ap_score: 0.664435 map_score: 0.651724 Time: 156.60
Run: 27 train loss: 110.937714 Time: 448.38
Run: 27 VAL ap_score: 0.655883 map_score: 0.653541 Time: 156.68
Run: 28 train loss: 110.499780 Time: 446.57
Run: 28 VAL ap_score: 0.671321 map_score: 0.662719 Time: 157.52
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 29 train loss: 108.836060 Time: 446.18
Run: 29 VAL ap_score: 0.661858 map_score: 0.656347 Time: 157.61
Run: 30 train loss: 107.479713 Time: 445.01
Run: 30 VAL ap_score: 0.656853 map_score: 0.655575 Time: 157.21
Run: 31 train loss: 107.759477 Time: 446.01
Run: 31 VAL ap_score: 0.639528 map_score: 0.645366 Time: 157.39
Run: 32 train loss: 106.637367 Time: 449.73
Run: 32 VAL ap_score: 0.670628 map_score: 0.661243 Time: 158.06
Run: 33 train loss: 105.755961 Time: 440.17
Run: 33 VAL ap_score: 0.676350 map_score: 0.665923 Time: 146.36
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 34 train loss: 105.204664 Time: 425.20
Run: 34 VAL ap_score: 0.656512 map_score: 0.654841 Time: 146.43
Run: 35 train loss: 104.025276 Time: 424.44
Run: 35 VAL ap_score: 0.661409 map_score: 0.657260 Time: 145.64
Run: 36 train loss: 104.070120 Time: 425.77
Run: 36 VAL ap_score: 0.659002 map_score: 0.656674 Time: 146.44
Run: 37 train loss: 103.759858 Time: 425.76
Run: 37 VAL ap_score: 0.676049 map_score: 0.672036 Time: 146.12
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 38 train loss: 103.029766 Time: 425.46
Run: 38 VAL ap_score: 0.682281 map_score: 0.669157 Time: 145.00
Run: 39 train loss: 102.708939 Time: 425.42
Run: 39 VAL ap_score: 0.674500 map_score: 0.666487 Time: 145.98
Run: 40 train loss: 102.596204 Time: 424.36
Run: 40 VAL ap_score: 0.654229 map_score: 0.650100 Time: 145.43
Run: 41 train loss: 101.630406 Time: 426.60
Run: 41 VAL ap_score: 0.670826 map_score: 0.661336 Time: 146.17
Run: 42 train loss: 101.443763 Time: 425.44
Run: 42 VAL ap_score: 0.671320 map_score: 0.666030 Time: 146.21
Run: 43 train loss: 101.507904 Time: 430.88
Run: 43 VAL ap_score: 0.674371 map_score: 0.667270 Time: 157.07
Run: 44 train loss: 101.644148 Time: 447.21
Run: 44 VAL ap_score: 0.674311 map_score: 0.670031 Time: 157.50
Run: 45 train loss: 100.876360 Time: 446.86
Run: 45 VAL ap_score: 0.668165 map_score: 0.658588 Time: 157.60
Run: 46 train loss: 100.164513 Time: 447.08
Run: 46 VAL ap_score: 0.665943 map_score: 0.663043 Time: 157.55
Run: 47 train loss: 99.270363 Time: 436.27
Run: 47 VAL ap_score: 0.679044 map_score: 0.673976 Time: 144.81
saving best validated model to ./gmn_match_hinge_scoring_injective_attention/bestValidationModels/gmn_match_hinge_scoring_injective_attention_ptc_fr_7366_2024-01-25_01:59:35.066937
Run: 48 train loss: 100.146204 Time: 424.36
Run: 48 VAL ap_score: 0.664624 map_score: 0.656347 Time: 237.90
Run: 49 train loss: 98.565725 Time: 426.32
Run: 49 VAL ap_score: 0.676937 map_score: 0.664311 Time: 145.33
Run: 50 train loss: 98.623395 Time: 425.68
Run: 50 VAL ap_score: 0.674111 map_score: 0.664730 Time: 145.92
Run: 51 train loss: 98.435179 Time: 434.02
Run: 51 VAL ap_score: 0.667310 map_score: 0.662713 Time: 149.86
