Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_injective_attention
--TASK=gmn_match_hinge_lrl_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl
saving initial model to ./gmn_match_hinge_lrl_injective_attention/initialModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
no. of params in model: 2498
Run: 0 train loss: 266.941964 Time: 412.42
Run: 0 VAL ap_score: 0.461494 map_score: 0.471937 Time: 129.16
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 1 train loss: 188.746770 Time: 399.34
Run: 1 VAL ap_score: 0.479209 map_score: 0.499525 Time: 128.78
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 2 train loss: 173.012503 Time: 399.72
Run: 2 VAL ap_score: 0.504650 map_score: 0.531698 Time: 128.68
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 3 train loss: 161.462344 Time: 397.98
Run: 3 VAL ap_score: 0.520717 map_score: 0.540544 Time: 128.93
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 4 train loss: 155.215262 Time: 396.04
Run: 4 VAL ap_score: 0.507735 map_score: 0.532412 Time: 129.15
Run: 5 train loss: 146.820541 Time: 397.97
Run: 5 VAL ap_score: 0.572427 map_score: 0.580746 Time: 129.88
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 6 train loss: 139.146867 Time: 397.39
Run: 6 VAL ap_score: 0.551530 map_score: 0.581728 Time: 130.62
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 7 train loss: 133.182050 Time: 396.72
Run: 7 VAL ap_score: 0.577154 map_score: 0.590516 Time: 129.91
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 8 train loss: 128.444203 Time: 394.84
Run: 8 VAL ap_score: 0.588320 map_score: 0.592670 Time: 129.89
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 9 train loss: 125.514385 Time: 396.81
Run: 9 VAL ap_score: 0.600245 map_score: 0.604456 Time: 129.81
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 10 train loss: 123.482139 Time: 395.47
Run: 10 VAL ap_score: 0.582419 map_score: 0.590685 Time: 129.87
Run: 11 train loss: 121.670889 Time: 394.18
Run: 11 VAL ap_score: 0.584781 map_score: 0.598822 Time: 129.54
Run: 12 train loss: 119.726666 Time: 396.89
Run: 12 VAL ap_score: 0.595415 map_score: 0.605828 Time: 130.83
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 13 train loss: 117.711638 Time: 395.95
Run: 13 VAL ap_score: 0.616671 map_score: 0.619583 Time: 131.05
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 14 train loss: 117.497916 Time: 395.34
Run: 14 VAL ap_score: 0.612578 map_score: 0.618575 Time: 130.05
Run: 15 train loss: 115.377619 Time: 397.89
Run: 15 VAL ap_score: 0.590508 map_score: 0.601399 Time: 130.45
Run: 16 train loss: 113.856667 Time: 395.25
Run: 16 VAL ap_score: 0.572502 map_score: 0.593475 Time: 130.08
Run: 17 train loss: 113.262558 Time: 395.34
Run: 17 VAL ap_score: 0.621690 map_score: 0.636698 Time: 129.81
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 18 train loss: 111.541673 Time: 394.22
Run: 18 VAL ap_score: 0.607829 map_score: 0.612286 Time: 129.32
Run: 19 train loss: 110.086774 Time: 394.70
Run: 19 VAL ap_score: 0.630765 map_score: 0.628779 Time: 130.52
Run: 20 train loss: 108.814512 Time: 397.36
Run: 20 VAL ap_score: 0.599214 map_score: 0.612436 Time: 130.36
Run: 21 train loss: 108.892775 Time: 397.38
Run: 21 VAL ap_score: 0.597214 map_score: 0.612561 Time: 130.87
Run: 22 train loss: 108.416121 Time: 396.33
Run: 22 VAL ap_score: 0.645299 map_score: 0.639455 Time: 130.42
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 23 train loss: 106.687670 Time: 396.34
Run: 23 VAL ap_score: 0.624041 map_score: 0.631170 Time: 130.85
Run: 24 train loss: 106.228994 Time: 396.70
Run: 24 VAL ap_score: 0.648277 map_score: 0.642479 Time: 130.49
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 25 train loss: 104.663697 Time: 396.49
Run: 25 VAL ap_score: 0.630468 map_score: 0.630918 Time: 130.97
Run: 26 train loss: 104.796375 Time: 397.92
Run: 26 VAL ap_score: 0.619214 map_score: 0.628099 Time: 130.66
Run: 27 train loss: 103.706489 Time: 396.76
Run: 27 VAL ap_score: 0.630731 map_score: 0.630694 Time: 129.41
Run: 28 train loss: 103.798881 Time: 396.19
Run: 28 VAL ap_score: 0.598145 map_score: 0.613819 Time: 129.34
Run: 29 train loss: 103.077210 Time: 397.51
Run: 29 VAL ap_score: 0.610457 map_score: 0.610118 Time: 129.71
Run: 30 train loss: 102.196207 Time: 396.45
Run: 30 VAL ap_score: 0.643864 map_score: 0.641536 Time: 131.95
Run: 31 train loss: 102.455399 Time: 397.79
Run: 31 VAL ap_score: 0.653796 map_score: 0.643590 Time: 129.21
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 32 train loss: 101.468014 Time: 397.49
Run: 32 VAL ap_score: 0.645205 map_score: 0.640441 Time: 128.73
Run: 33 train loss: 100.846575 Time: 399.35
Run: 33 VAL ap_score: 0.638846 map_score: 0.639201 Time: 129.17
Run: 34 train loss: 100.428297 Time: 397.29
Run: 34 VAL ap_score: 0.642135 map_score: 0.637020 Time: 127.70
Run: 35 train loss: 100.070318 Time: 397.34
Run: 35 VAL ap_score: 0.629141 map_score: 0.623675 Time: 127.42
Run: 36 train loss: 99.924392 Time: 400.08
Run: 36 VAL ap_score: 0.647250 map_score: 0.641041 Time: 128.61
Run: 37 train loss: 99.261011 Time: 399.28
Run: 37 VAL ap_score: 0.656588 map_score: 0.652771 Time: 127.71
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 38 train loss: 99.052821 Time: 399.83
Run: 38 VAL ap_score: 0.648589 map_score: 0.651252 Time: 129.55
Run: 39 train loss: 98.599437 Time: 399.16
Run: 39 VAL ap_score: 0.649098 map_score: 0.649259 Time: 128.27
Run: 40 train loss: 98.271328 Time: 398.08
Run: 40 VAL ap_score: 0.649882 map_score: 0.647942 Time: 129.15
Run: 41 train loss: 97.637240 Time: 398.89
Run: 41 VAL ap_score: 0.655306 map_score: 0.652566 Time: 129.27
Run: 42 train loss: 96.854007 Time: 399.29
Run: 42 VAL ap_score: 0.639506 map_score: 0.647644 Time: 129.53
Run: 43 train loss: 97.376425 Time: 398.57
Run: 43 VAL ap_score: 0.639974 map_score: 0.636513 Time: 129.01
Run: 44 train loss: 97.038289 Time: 400.49
Run: 44 VAL ap_score: 0.641112 map_score: 0.635196 Time: 129.57
Run: 45 train loss: 96.924342 Time: 398.02
Run: 45 VAL ap_score: 0.646477 map_score: 0.647522 Time: 129.91
Run: 46 train loss: 95.899835 Time: 399.15
Run: 46 VAL ap_score: 0.659735 map_score: 0.651088 Time: 130.59
Run: 47 train loss: 95.601885 Time: 398.30
Run: 47 VAL ap_score: 0.662607 map_score: 0.654951 Time: 129.98
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 48 train loss: 95.192701 Time: 397.29
Run: 48 VAL ap_score: 0.634558 map_score: 0.633943 Time: 129.61
Run: 49 train loss: 94.553494 Time: 397.82
Run: 49 VAL ap_score: 0.667334 map_score: 0.661438 Time: 130.10
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 50 train loss: 94.425475 Time: 399.94
Run: 50 VAL ap_score: 0.624074 map_score: 0.626939 Time: 132.05
Run: 51 train loss: 93.502907 Time: 400.30
Run: 51 VAL ap_score: 0.653469 map_score: 0.646584 Time: 131.63
Run: 52 train loss: 93.456528 Time: 399.83
Run: 52 VAL ap_score: 0.657724 map_score: 0.656653 Time: 132.31
Run: 53 train loss: 92.969982 Time: 401.03
Run: 53 VAL ap_score: 0.675886 map_score: 0.668473 Time: 131.76
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 54 train loss: 92.665811 Time: 400.70
Run: 54 VAL ap_score: 0.664503 map_score: 0.660476 Time: 131.18
Run: 55 train loss: 92.106730 Time: 400.18
Run: 55 VAL ap_score: 0.669720 map_score: 0.665326 Time: 132.72
Run: 56 train loss: 91.742493 Time: 400.71
Run: 56 VAL ap_score: 0.669868 map_score: 0.657175 Time: 132.85
Run: 57 train loss: 92.532547 Time: 401.06
Run: 57 VAL ap_score: 0.668261 map_score: 0.661088 Time: 142.66
Run: 58 train loss: 91.634967 Time: 441.06
Run: 58 VAL ap_score: 0.657877 map_score: 0.651780 Time: 132.07
Run: 59 train loss: 91.680208 Time: 401.02
Run: 59 VAL ap_score: 0.646611 map_score: 0.636051 Time: 132.96
Run: 60 train loss: 91.266439 Time: 402.58
Run: 60 VAL ap_score: 0.658235 map_score: 0.646372 Time: 132.98
Run: 61 train loss: 90.392283 Time: 403.54
Run: 61 VAL ap_score: 0.659414 map_score: 0.652945 Time: 131.70
Run: 62 train loss: 89.683019 Time: 404.21
Run: 62 VAL ap_score: 0.661295 map_score: 0.659681 Time: 132.27
Run: 63 train loss: 89.833878 Time: 401.81
Run: 63 VAL ap_score: 0.668540 map_score: 0.660844 Time: 132.95
Run: 64 train loss: 89.241972 Time: 400.76
Run: 64 VAL ap_score: 0.672728 map_score: 0.666219 Time: 131.98
Run: 65 train loss: 89.169500 Time: 401.96
Run: 65 VAL ap_score: 0.639646 map_score: 0.642182 Time: 131.34
Run: 66 train loss: 88.035608 Time: 397.41
Run: 66 VAL ap_score: 0.674310 map_score: 0.663858 Time: 130.15
Run: 67 train loss: 88.129406 Time: 397.68
Run: 67 VAL ap_score: 0.673310 map_score: 0.665858 Time: 129.39
Run: 68 train loss: 87.901978 Time: 398.49
Run: 68 VAL ap_score: 0.666740 map_score: 0.662539 Time: 129.32
Run: 69 train loss: 87.320343 Time: 396.87
Run: 69 VAL ap_score: 0.671004 map_score: 0.655222 Time: 129.04
Run: 70 train loss: 86.612288 Time: 399.67
Run: 70 VAL ap_score: 0.631688 map_score: 0.644867 Time: 129.13
Run: 71 train loss: 86.382695 Time: 399.42
Run: 71 VAL ap_score: 0.660055 map_score: 0.657669 Time: 128.97
Run: 72 train loss: 86.380673 Time: 398.95
Run: 72 VAL ap_score: 0.660406 map_score: 0.653695 Time: 129.35
Run: 73 train loss: 86.581874 Time: 397.69
Run: 73 VAL ap_score: 0.671277 map_score: 0.661810 Time: 128.76
Run: 74 train loss: 86.325155 Time: 398.14
Run: 74 VAL ap_score: 0.681249 map_score: 0.674211 Time: 128.57
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 75 train loss: 85.490103 Time: 396.78
Run: 75 VAL ap_score: 0.663481 map_score: 0.662194 Time: 129.02
Run: 76 train loss: 84.595473 Time: 398.09
Run: 76 VAL ap_score: 0.650952 map_score: 0.645033 Time: 129.10
Run: 77 train loss: 84.699045 Time: 397.90
Run: 77 VAL ap_score: 0.656837 map_score: 0.652921 Time: 129.57
Run: 78 train loss: 84.182328 Time: 398.43
Run: 78 VAL ap_score: 0.674464 map_score: 0.668916 Time: 129.20
Run: 79 train loss: 84.126471 Time: 398.11
Run: 79 VAL ap_score: 0.671339 map_score: 0.664259 Time: 129.06
Run: 80 train loss: 83.672756 Time: 397.49
Run: 80 VAL ap_score: 0.670690 map_score: 0.669681 Time: 129.12
Run: 81 train loss: 83.373030 Time: 398.49
Run: 81 VAL ap_score: 0.654574 map_score: 0.657082 Time: 130.22
Run: 82 train loss: 83.897576 Time: 398.89
Run: 82 VAL ap_score: 0.654961 map_score: 0.648682 Time: 129.59
Run: 83 train loss: 84.319953 Time: 397.02
Run: 83 VAL ap_score: 0.676359 map_score: 0.672135 Time: 129.22
Run: 84 train loss: 83.465893 Time: 398.81
Run: 84 VAL ap_score: 0.685094 map_score: 0.675963 Time: 128.94
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_ptc_mm_7762_2024-01-25_01:58:12.898467
Run: 85 train loss: 83.058326 Time: 397.19
Run: 85 VAL ap_score: 0.680277 map_score: 0.675181 Time: 129.83
Run: 86 train loss: 82.164823 Time: 397.69
Run: 86 VAL ap_score: 0.669880 map_score: 0.664692 Time: 129.02
Run: 87 train loss: 83.094581 Time: 399.01
Run: 87 VAL ap_score: 0.678173 map_score: 0.670694 Time: 129.87
Run: 88 train loss: 82.046296 Time: 396.12
Run: 88 VAL ap_score: 0.662781 map_score: 0.661645 Time: 129.77
Run: 89 train loss: 81.832152 Time: 396.10
Run: 89 VAL ap_score: 0.659677 map_score: 0.658547 Time: 130.28
Run: 90 train loss: 82.147527 Time: 397.37
Run: 90 VAL ap_score: 0.680054 map_score: 0.672965 Time: 130.23
Run: 91 train loss: 80.952406 Time: 397.24
Run: 91 VAL ap_score: 0.644226 map_score: 0.647305 Time: 130.33
Run: 92 train loss: 81.189324 Time: 395.46
Run: 92 VAL ap_score: 0.667135 map_score: 0.656747 Time: 129.97
Run: 93 train loss: 80.714032 Time: 398.02
