Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_injective_attention
--TASK=gmn_match_hinge_lrl_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=mutag
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl
saving initial model to ./gmn_match_hinge_lrl_injective_attention/initialModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
no. of params in model: 2498
Run: 0 train loss: 372.710090 Time: 408.64
Run: 0 VAL ap_score: 0.328008 map_score: 0.394137 Time: 129.86
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 1 train loss: 286.094814 Time: 398.55
Run: 1 VAL ap_score: 0.470461 map_score: 0.519972 Time: 129.11
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 2 train loss: 225.041405 Time: 397.69
Run: 2 VAL ap_score: 0.509943 map_score: 0.539813 Time: 129.57
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 3 train loss: 196.511474 Time: 396.74
Run: 3 VAL ap_score: 0.519244 map_score: 0.554777 Time: 129.21
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 4 train loss: 180.456794 Time: 396.98
Run: 4 VAL ap_score: 0.575680 map_score: 0.602096 Time: 129.03
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 5 train loss: 170.022006 Time: 395.72
Run: 5 VAL ap_score: 0.545901 map_score: 0.585177 Time: 129.69
Run: 6 train loss: 160.183082 Time: 396.82
Run: 6 VAL ap_score: 0.589821 map_score: 0.612189 Time: 129.40
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 7 train loss: 152.336884 Time: 395.84
Run: 7 VAL ap_score: 0.617514 map_score: 0.621077 Time: 128.78
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 8 train loss: 146.753325 Time: 394.32
Run: 8 VAL ap_score: 0.602774 map_score: 0.605090 Time: 129.31
Run: 9 train loss: 138.693417 Time: 394.72
Run: 9 VAL ap_score: 0.614258 map_score: 0.622381 Time: 128.60
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 10 train loss: 134.906367 Time: 393.50
Run: 10 VAL ap_score: 0.596049 map_score: 0.596800 Time: 129.61
Run: 11 train loss: 130.681418 Time: 393.31
Run: 11 VAL ap_score: 0.619474 map_score: 0.633055 Time: 129.54
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 12 train loss: 128.460586 Time: 393.00
Run: 12 VAL ap_score: 0.634304 map_score: 0.633146 Time: 129.99
Run: 13 train loss: 124.782524 Time: 394.98
Run: 13 VAL ap_score: 0.641956 map_score: 0.641598 Time: 130.61
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 14 train loss: 123.575337 Time: 393.36
Run: 14 VAL ap_score: 0.634411 map_score: 0.637690 Time: 129.59
Run: 15 train loss: 119.833175 Time: 392.70
Run: 15 VAL ap_score: 0.614722 map_score: 0.622235 Time: 129.52
Run: 16 train loss: 117.948514 Time: 391.01
Run: 16 VAL ap_score: 0.647932 map_score: 0.649799 Time: 129.61
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 17 train loss: 118.632889 Time: 392.33
Run: 17 VAL ap_score: 0.653765 map_score: 0.644679 Time: 129.63
Run: 18 train loss: 114.023240 Time: 393.06
Run: 18 VAL ap_score: 0.656415 map_score: 0.645992 Time: 129.00
Run: 19 train loss: 114.024914 Time: 391.51
Run: 19 VAL ap_score: 0.630723 map_score: 0.642857 Time: 130.53
Run: 20 train loss: 111.470591 Time: 394.24
Run: 20 VAL ap_score: 0.665332 map_score: 0.654140 Time: 131.82
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 21 train loss: 108.674868 Time: 394.50
Run: 21 VAL ap_score: 0.663738 map_score: 0.666734 Time: 131.06
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 22 train loss: 106.975541 Time: 394.57
Run: 22 VAL ap_score: 0.661411 map_score: 0.660532 Time: 131.45
Run: 23 train loss: 105.247677 Time: 394.21
Run: 23 VAL ap_score: 0.645466 map_score: 0.637704 Time: 131.46
Run: 24 train loss: 104.830930 Time: 394.20
Run: 24 VAL ap_score: 0.662258 map_score: 0.650979 Time: 131.06
Run: 25 train loss: 102.522202 Time: 394.53
Run: 25 VAL ap_score: 0.675843 map_score: 0.673211 Time: 130.85
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 26 train loss: 101.541116 Time: 395.06
Run: 26 VAL ap_score: 0.667754 map_score: 0.667718 Time: 130.81
Run: 27 train loss: 100.386351 Time: 393.65
Run: 27 VAL ap_score: 0.678515 map_score: 0.675923 Time: 131.13
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 28 train loss: 100.672957 Time: 394.75
Run: 28 VAL ap_score: 0.680619 map_score: 0.671237 Time: 131.28
Run: 29 train loss: 99.137517 Time: 392.38
Run: 29 VAL ap_score: 0.687213 map_score: 0.684493 Time: 130.01
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 30 train loss: 98.182256 Time: 391.32
Run: 30 VAL ap_score: 0.677098 map_score: 0.668060 Time: 131.03
Run: 31 train loss: 97.355594 Time: 393.01
Run: 31 VAL ap_score: 0.692070 map_score: 0.676346 Time: 130.88
Run: 32 train loss: 97.065912 Time: 394.27
Run: 32 VAL ap_score: 0.674722 map_score: 0.667670 Time: 130.99
Run: 33 train loss: 96.208256 Time: 393.24
Run: 33 VAL ap_score: 0.696971 map_score: 0.682344 Time: 130.68
Run: 34 train loss: 93.970585 Time: 393.61
Run: 34 VAL ap_score: 0.631172 map_score: 0.640173 Time: 130.49
Run: 35 train loss: 94.714860 Time: 393.37
Run: 35 VAL ap_score: 0.683997 map_score: 0.678548 Time: 130.37
Run: 36 train loss: 95.112939 Time: 393.84
Run: 36 VAL ap_score: 0.689276 map_score: 0.681705 Time: 131.60
Run: 37 train loss: 93.378341 Time: 393.53
Run: 37 VAL ap_score: 0.656081 map_score: 0.652449 Time: 131.72
Run: 38 train loss: 92.875835 Time: 392.74
Run: 38 VAL ap_score: 0.686566 map_score: 0.670579 Time: 132.24
Run: 39 train loss: 90.909448 Time: 393.61
Run: 39 VAL ap_score: 0.691680 map_score: 0.679485 Time: 131.48
Run: 40 train loss: 91.906758 Time: 392.57
Run: 40 VAL ap_score: 0.696728 map_score: 0.673828 Time: 131.47
Run: 41 train loss: 91.176367 Time: 395.73
Run: 41 VAL ap_score: 0.701258 map_score: 0.682919 Time: 130.43
Run: 42 train loss: 90.410407 Time: 394.49
Run: 42 VAL ap_score: 0.695213 map_score: 0.684569 Time: 131.98
Run: 43 train loss: 89.814490 Time: 394.85
Run: 43 VAL ap_score: 0.698275 map_score: 0.689347 Time: 132.24
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 44 train loss: 88.001270 Time: 393.99
Run: 44 VAL ap_score: 0.699099 map_score: 0.685943 Time: 131.67
Run: 45 train loss: 89.550493 Time: 394.15
Run: 45 VAL ap_score: 0.702975 map_score: 0.691608 Time: 131.86
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 46 train loss: 88.621031 Time: 394.79
Run: 46 VAL ap_score: 0.703522 map_score: 0.686077 Time: 131.10
Run: 47 train loss: 86.975592 Time: 393.38
Run: 47 VAL ap_score: 0.684920 map_score: 0.679352 Time: 130.56
Run: 48 train loss: 88.293713 Time: 394.51
Run: 48 VAL ap_score: 0.702647 map_score: 0.685707 Time: 130.41
Run: 49 train loss: 86.967007 Time: 394.85
Run: 49 VAL ap_score: 0.696150 map_score: 0.683003 Time: 129.74
Run: 50 train loss: 86.887071 Time: 395.72
Run: 50 VAL ap_score: 0.709532 map_score: 0.691254 Time: 130.20
Run: 51 train loss: 88.244134 Time: 395.85
Run: 51 VAL ap_score: 0.678033 map_score: 0.673882 Time: 131.52
Run: 52 train loss: 86.639801 Time: 396.38
Run: 52 VAL ap_score: 0.701646 map_score: 0.685995 Time: 129.94
Run: 53 train loss: 84.973808 Time: 396.74
Run: 53 VAL ap_score: 0.686556 map_score: 0.689949 Time: 130.78
Run: 54 train loss: 84.977029 Time: 396.13
Run: 54 VAL ap_score: 0.685735 map_score: 0.694331 Time: 131.05
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 55 train loss: 84.831622 Time: 395.66
Run: 55 VAL ap_score: 0.700724 map_score: 0.691777 Time: 130.22
Run: 56 train loss: 85.016529 Time: 396.58
Run: 56 VAL ap_score: 0.717914 map_score: 0.706649 Time: 130.75
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 57 train loss: 84.587601 Time: 397.94
Run: 57 VAL ap_score: 0.693425 map_score: 0.695793 Time: 129.96
Run: 58 train loss: 83.813869 Time: 435.55
Run: 58 VAL ap_score: 0.711288 map_score: 0.699038 Time: 146.29
Run: 59 train loss: 83.842973 Time: 394.34
Run: 59 VAL ap_score: 0.675714 map_score: 0.661681 Time: 130.82
Run: 60 train loss: 83.496661 Time: 395.11
Run: 60 VAL ap_score: 0.694993 map_score: 0.689844 Time: 131.22
Run: 61 train loss: 83.150865 Time: 397.22
Run: 61 VAL ap_score: 0.697153 map_score: 0.695430 Time: 130.80
Run: 62 train loss: 82.720478 Time: 398.18
Run: 62 VAL ap_score: 0.694067 map_score: 0.685695 Time: 132.67
Run: 63 train loss: 81.850272 Time: 398.27
Run: 63 VAL ap_score: 0.712809 map_score: 0.704968 Time: 131.82
Run: 64 train loss: 82.911016 Time: 399.40
Run: 64 VAL ap_score: 0.702101 map_score: 0.689485 Time: 131.98
Run: 65 train loss: 81.681928 Time: 396.25
Run: 65 VAL ap_score: 0.696242 map_score: 0.700392 Time: 130.99
Run: 66 train loss: 82.372179 Time: 394.43
Run: 66 VAL ap_score: 0.705520 map_score: 0.691746 Time: 130.98
Run: 67 train loss: 80.418618 Time: 394.02
Run: 67 VAL ap_score: 0.700295 map_score: 0.698203 Time: 131.11
Run: 68 train loss: 81.090282 Time: 393.73
Run: 68 VAL ap_score: 0.710055 map_score: 0.700602 Time: 131.47
Run: 69 train loss: 81.188208 Time: 393.52
Run: 69 VAL ap_score: 0.707720 map_score: 0.693417 Time: 131.82
Run: 70 train loss: 79.748575 Time: 392.39
Run: 70 VAL ap_score: 0.698722 map_score: 0.705561 Time: 130.87
Run: 71 train loss: 81.560845 Time: 393.33
Run: 71 VAL ap_score: 0.686795 map_score: 0.689683 Time: 131.90
Run: 72 train loss: 80.389491 Time: 392.53
Run: 72 VAL ap_score: 0.655075 map_score: 0.675159 Time: 131.38
Run: 73 train loss: 79.992532 Time: 393.44
Run: 73 VAL ap_score: 0.670602 map_score: 0.668842 Time: 131.18
Run: 74 train loss: 79.535201 Time: 392.52
Run: 74 VAL ap_score: 0.701389 map_score: 0.694728 Time: 130.48
Run: 75 train loss: 78.831530 Time: 393.04
Run: 75 VAL ap_score: 0.693370 map_score: 0.710218 Time: 131.37
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 76 train loss: 79.086515 Time: 392.97
Run: 76 VAL ap_score: 0.701619 map_score: 0.699623 Time: 131.29
Run: 77 train loss: 78.693299 Time: 392.87
Run: 77 VAL ap_score: 0.701934 map_score: 0.699697 Time: 131.31
Run: 78 train loss: 78.448137 Time: 392.82
Run: 78 VAL ap_score: 0.708006 map_score: 0.695771 Time: 131.67
Run: 79 train loss: 78.356564 Time: 392.23
Run: 79 VAL ap_score: 0.697785 map_score: 0.693958 Time: 131.55
Run: 80 train loss: 79.056170 Time: 391.41
Run: 80 VAL ap_score: 0.714204 map_score: 0.703697 Time: 131.89
Run: 81 train loss: 78.600626 Time: 393.22
Run: 81 VAL ap_score: 0.700352 map_score: 0.700989 Time: 131.35
Run: 82 train loss: 77.269074 Time: 393.50
Run: 82 VAL ap_score: 0.679996 map_score: 0.700255 Time: 131.42
Run: 83 train loss: 78.372791 Time: 394.24
Run: 83 VAL ap_score: 0.712412 map_score: 0.702103 Time: 131.46
Run: 84 train loss: 75.922877 Time: 393.64
Run: 84 VAL ap_score: 0.695583 map_score: 0.700618 Time: 131.62
Run: 85 train loss: 77.616310 Time: 391.97
Run: 85 VAL ap_score: 0.688424 map_score: 0.703632 Time: 131.40
Run: 86 train loss: 76.629104 Time: 391.84
Run: 86 VAL ap_score: 0.699948 map_score: 0.696345 Time: 131.48
Run: 87 train loss: 77.040215 Time: 393.66
Run: 87 VAL ap_score: 0.714609 map_score: 0.710401 Time: 132.14
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 88 train loss: 76.130067 Time: 393.03
Run: 88 VAL ap_score: 0.720577 map_score: 0.711650 Time: 132.26
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 89 train loss: 75.796627 Time: 392.92
Run: 89 VAL ap_score: 0.707146 map_score: 0.708282 Time: 131.10
Run: 90 train loss: 75.233115 Time: 392.80
Run: 90 VAL ap_score: 0.714460 map_score: 0.704925 Time: 131.53
Run: 91 train loss: 77.458583 Time: 394.82
Run: 91 VAL ap_score: 0.707876 map_score: 0.715272 Time: 131.35
saving best validated model to ./gmn_match_hinge_lrl_injective_attention/bestValidationModels/gmn_match_hinge_lrl_injective_attention_mutag_7474_2024-01-25_01:57:33.051574
Run: 92 train loss: 75.367367 Time: 394.26
Run: 92 VAL ap_score: 0.704467 map_score: 0.710866 Time: 131.71
Run: 93 train loss: 75.776234 Time: 394.67
Run: 93 VAL ap_score: 0.686981 map_score: 0.703149 Time: 132.20
