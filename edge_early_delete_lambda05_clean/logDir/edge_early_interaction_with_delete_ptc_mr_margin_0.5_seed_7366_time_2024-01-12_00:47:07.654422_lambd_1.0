Command line
/raid/nlp/pulkit/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_delete_lambda05_clean
--TASK=edge_early_interaction_with_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mr
--interpretability_lambda=0.5
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mr240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_delete_lambda05_clean/initialModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
no. of params in model: 3730
Run: 0 train loss: 276.619954 Time: 632.67
Run: 0 VAL ap_score: 0.509961 map_score: 0.496608 Time: 216.07
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 1 train loss: 170.907620 Time: 512.98
Run: 1 VAL ap_score: 0.533869 map_score: 0.533110 Time: 198.22
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 2 train loss: 150.627461 Time: 510.48
Run: 2 VAL ap_score: 0.546927 map_score: 0.555912 Time: 234.38
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 3 train loss: 134.033922 Time: 585.29
Run: 3 VAL ap_score: 0.602486 map_score: 0.573374 Time: 235.81
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 4 train loss: 114.895533 Time: 587.22
Run: 4 VAL ap_score: 0.607458 map_score: 0.598824 Time: 239.57
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 5 train loss: 102.351060 Time: 585.96
Run: 5 VAL ap_score: 0.668093 map_score: 0.635144 Time: 232.84
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 6 train loss: 93.623203 Time: 573.88
Run: 6 VAL ap_score: 0.667466 map_score: 0.632100 Time: 229.60
Run: 7 train loss: 87.308070 Time: 582.95
Run: 7 VAL ap_score: 0.673269 map_score: 0.649339 Time: 225.96
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 8 train loss: 84.321395 Time: 578.45
Run: 8 VAL ap_score: 0.665498 map_score: 0.646224 Time: 227.50
Run: 9 train loss: 78.569149 Time: 578.90
Run: 9 VAL ap_score: 0.669095 map_score: 0.653143 Time: 231.06
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 10 train loss: 73.859096 Time: 570.98
Run: 10 VAL ap_score: 0.692278 map_score: 0.676287 Time: 234.59
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 11 train loss: 70.169920 Time: 582.98
Run: 11 VAL ap_score: 0.688221 map_score: 0.661888 Time: 233.67
Run: 12 train loss: 67.602894 Time: 580.40
Run: 12 VAL ap_score: 0.702152 map_score: 0.685959 Time: 235.46
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 13 train loss: 66.258015 Time: 583.45
Run: 13 VAL ap_score: 0.699463 map_score: 0.678088 Time: 234.22
Run: 14 train loss: 61.933698 Time: 579.80
Run: 14 VAL ap_score: 0.715901 map_score: 0.685527 Time: 232.04
Run: 15 train loss: 59.797893 Time: 583.05
Run: 15 VAL ap_score: 0.712504 map_score: 0.682756 Time: 227.04
Run: 16 train loss: 57.967726 Time: 585.67
Run: 16 VAL ap_score: 0.726163 map_score: 0.696654 Time: 232.32
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 17 train loss: 55.426936 Time: 583.43
Run: 17 VAL ap_score: 0.728467 map_score: 0.707577 Time: 234.33
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 18 train loss: 55.035159 Time: 582.58
Run: 18 VAL ap_score: 0.701641 map_score: 0.692024 Time: 236.92
Run: 19 train loss: 51.341033 Time: 643.67
Run: 19 VAL ap_score: 0.726559 map_score: 0.701875 Time: 241.25
Run: 20 train loss: 49.218585 Time: 642.97
Run: 20 VAL ap_score: 0.750439 map_score: 0.716662 Time: 246.32
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 21 train loss: 50.450494 Time: 632.45
Run: 21 VAL ap_score: 0.761444 map_score: 0.724325 Time: 245.32
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 22 train loss: 48.278796 Time: 645.52
Run: 22 VAL ap_score: 0.755303 map_score: 0.722645 Time: 235.51
Run: 23 train loss: 45.075541 Time: 655.07
Run: 23 VAL ap_score: 0.767770 map_score: 0.739817 Time: 236.46
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 24 train loss: 44.852394 Time: 650.83
Run: 24 VAL ap_score: 0.787202 map_score: 0.750314 Time: 240.17
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 25 train loss: 43.701184 Time: 638.84
Run: 25 VAL ap_score: 0.763812 map_score: 0.739383 Time: 235.30
Run: 26 train loss: 43.473161 Time: 651.57
Run: 26 VAL ap_score: 0.784100 map_score: 0.745908 Time: 238.36
Run: 27 train loss: 41.695293 Time: 656.88
Run: 27 VAL ap_score: 0.785187 map_score: 0.741672 Time: 247.17
Run: 28 train loss: 41.381597 Time: 654.12
Run: 28 VAL ap_score: 0.770098 map_score: 0.734417 Time: 244.90
Run: 29 train loss: 39.662522 Time: 633.93
Run: 29 VAL ap_score: 0.804250 map_score: 0.769023 Time: 255.14
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 30 train loss: 39.305039 Time: 654.11
Run: 30 VAL ap_score: 0.775411 map_score: 0.744035 Time: 244.09
Run: 31 train loss: 39.394482 Time: 657.56
Run: 31 VAL ap_score: 0.739477 map_score: 0.731780 Time: 239.29
Run: 32 train loss: 39.005040 Time: 660.20
Run: 32 VAL ap_score: 0.796031 map_score: 0.756183 Time: 247.83
Run: 33 train loss: 38.096963 Time: 654.72
Run: 33 VAL ap_score: 0.786747 map_score: 0.764518 Time: 243.65
Run: 34 train loss: 37.345853 Time: 659.33
Run: 34 VAL ap_score: 0.799644 map_score: 0.762416 Time: 245.49
Run: 35 train loss: 36.822048 Time: 651.49
Run: 35 VAL ap_score: 0.809382 map_score: 0.781661 Time: 240.92
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 36 train loss: 36.329597 Time: 653.17
Run: 36 VAL ap_score: 0.784962 map_score: 0.766977 Time: 231.04
Run: 37 train loss: 34.317402 Time: 825.53
Run: 37 VAL ap_score: 0.809596 map_score: 0.780562 Time: 323.43
Run: 38 train loss: 33.666818 Time: 937.76
Run: 38 VAL ap_score: 0.818189 map_score: 0.777697 Time: 344.95
Run: 39 train loss: 33.808931 Time: 624.98
Run: 39 VAL ap_score: 0.819927 map_score: 0.778478 Time: 242.23
Run: 40 train loss: 31.623658 Time: 626.33
Run: 40 VAL ap_score: 0.813572 map_score: 0.783221 Time: 237.74
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 41 train loss: 32.857310 Time: 620.23
Run: 41 VAL ap_score: 0.807243 map_score: 0.778840 Time: 242.89
Run: 42 train loss: 31.210624 Time: 653.78
Run: 42 VAL ap_score: 0.807272 map_score: 0.780854 Time: 256.50
Run: 43 train loss: 30.837826 Time: 647.74
Run: 43 VAL ap_score: 0.823732 map_score: 0.795885 Time: 248.27
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 44 train loss: 30.556641 Time: 603.05
Run: 44 VAL ap_score: 0.821899 map_score: 0.792091 Time: 203.20
Run: 45 train loss: 30.832436 Time: 522.17
Run: 45 VAL ap_score: 0.833462 map_score: 0.796903 Time: 205.45
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 46 train loss: 30.140825 Time: 559.58
Run: 46 VAL ap_score: 0.822190 map_score: 0.799102 Time: 222.26
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 47 train loss: 29.282292 Time: 543.43
Run: 47 VAL ap_score: 0.821131 map_score: 0.804818 Time: 216.09
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 48 train loss: 29.239428 Time: 540.14
Run: 48 VAL ap_score: 0.827925 map_score: 0.807260 Time: 221.85
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 49 train loss: 29.149324 Time: 535.10
Run: 49 VAL ap_score: 0.828140 map_score: 0.794613 Time: 215.50
Run: 50 train loss: 28.336819 Time: 530.32
Run: 50 VAL ap_score: 0.825136 map_score: 0.800848 Time: 218.48
Run: 51 train loss: 28.467499 Time: 541.68
Run: 51 VAL ap_score: 0.833032 map_score: 0.805273 Time: 212.66
Run: 52 train loss: 27.309721 Time: 553.46
Run: 52 VAL ap_score: 0.834383 map_score: 0.799368 Time: 216.71
Run: 53 train loss: 27.939307 Time: 536.18
Run: 53 VAL ap_score: 0.815469 map_score: 0.793048 Time: 199.31
Run: 54 train loss: 27.295055 Time: 520.63
Run: 54 VAL ap_score: 0.829586 map_score: 0.798546 Time: 200.08
Run: 55 train loss: 27.458931 Time: 537.76
Run: 55 VAL ap_score: 0.828637 map_score: 0.800619 Time: 196.61
Run: 56 train loss: 26.070096 Time: 505.96
Run: 56 VAL ap_score: 0.826832 map_score: 0.799012 Time: 206.67
Run: 57 train loss: 27.325900 Time: 524.83
Run: 57 VAL ap_score: 0.785633 map_score: 0.772516 Time: 206.97
Run: 58 train loss: 28.287526 Time: 527.82
Run: 58 VAL ap_score: 0.842886 map_score: 0.809143 Time: 209.93
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 59 train loss: 25.682353 Time: 508.13
Run: 59 VAL ap_score: 0.828163 map_score: 0.804921 Time: 209.58
Run: 60 train loss: 27.496232 Time: 542.37
Run: 60 VAL ap_score: 0.828886 map_score: 0.801568 Time: 212.51
Run: 61 train loss: 25.018862 Time: 509.59
Run: 61 VAL ap_score: 0.822544 map_score: 0.799772 Time: 200.79
Run: 62 train loss: 26.027389 Time: 533.76
Run: 62 VAL ap_score: 0.811460 map_score: 0.788911 Time: 203.90
Run: 63 train loss: 26.823454 Time: 527.17
Run: 63 VAL ap_score: 0.840443 map_score: 0.808067 Time: 211.67
Run: 64 train loss: 25.230866 Time: 541.43
Run: 64 VAL ap_score: 0.827161 map_score: 0.805204 Time: 215.17
Run: 65 train loss: 24.859461 Time: 534.76
Run: 65 VAL ap_score: 0.825220 map_score: 0.804224 Time: 210.90
Run: 66 train loss: 25.297958 Time: 562.25
Run: 66 VAL ap_score: 0.838917 map_score: 0.807231 Time: 209.46
Run: 67 train loss: 24.144732 Time: 531.75
Run: 67 VAL ap_score: 0.851533 map_score: 0.829285 Time: 203.45
saving best validated model to ./edge_early_delete_lambda05_clean/bestValidationModels/edge_early_interaction_with_delete_ptc_mr_7366_2024-01-12_00:47:07.654422
Run: 68 train loss: 25.553909 Time: 554.18
Run: 68 VAL ap_score: 0.835833 map_score: 0.820128 Time: 213.37
Run: 69 train loss: 25.240607 Time: 538.67
Run: 69 VAL ap_score: 0.835242 map_score: 0.817701 Time: 209.24
Run: 70 train loss: 24.919693 Time: 553.14
Run: 70 VAL ap_score: 0.843886 map_score: 0.820478 Time: 217.54
Run: 71 train loss: 24.350599 Time: 550.71
Run: 71 VAL ap_score: 0.824543 map_score: 0.806015 Time: 206.47
Run: 72 train loss: 24.273405 Time: 539.41
Run: 72 VAL ap_score: 0.846261 map_score: 0.821551 Time: 209.29
Run: 73 train loss: 23.445638 Time: 532.67
Run: 73 VAL ap_score: 0.849592 map_score: 0.824544 Time: 206.45
Run: 74 train loss: 23.914809 Time: 625.66
Run: 74 VAL ap_score: 0.840909 map_score: 0.817210 Time: 315.95
