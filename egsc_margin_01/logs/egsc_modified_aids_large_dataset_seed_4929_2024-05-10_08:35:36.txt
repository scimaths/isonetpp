Experiment egsc_margin_01 for model: 'egsc_modified', dataset: 'aids_large', seed: 4929 started at time: 2024-05-10_08:35:36
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id egsc_margin_01
--experiment_dir experiments/
--model_config_path configs/egsc_modified.yaml
--dataset_name aids
--seed 4929
--dataset_size large
--margin 0.1
loaded train query graphs from ./large_dataset/splits/train/train_aids240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_aids240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/aids240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_aids240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_aids240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/aids240k_corpus_subgraphs.pkl
saving intial model to experiments/egsc_margin_01/initial_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
no. of params in model: 3948
Run: 0 train loss: 44.811870 Time: 177.53
Run: 0 VAL ap_score: 0.346588 map_score: 0.379102 Time: 81.14
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 1 train loss: 38.266290 Time: 182.42
Run: 1 VAL ap_score: 0.350912 map_score: 0.357569 Time: 79.90
Run: 2 train loss: 34.777747 Time: 184.28
Run: 2 VAL ap_score: 0.437209 map_score: 0.448638 Time: 79.05
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 3 train loss: 31.350600 Time: 183.28
Run: 3 VAL ap_score: 0.445755 map_score: 0.455186 Time: 77.94
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 4 train loss: 30.040772 Time: 180.92
Run: 4 VAL ap_score: 0.457169 map_score: 0.483847 Time: 82.34
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 5 train loss: 28.959688 Time: 183.66
Run: 5 VAL ap_score: 0.454385 map_score: 0.472708 Time: 82.27
Run: 6 train loss: 27.848486 Time: 182.97
Run: 6 VAL ap_score: 0.489403 map_score: 0.505129 Time: 81.83
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 7 train loss: 27.168279 Time: 182.19
Run: 7 VAL ap_score: 0.522895 map_score: 0.514720 Time: 84.01
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 8 train loss: 26.624358 Time: 187.56
Run: 8 VAL ap_score: 0.539693 map_score: 0.517089 Time: 83.75
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 9 train loss: 26.013211 Time: 189.70
Run: 9 VAL ap_score: 0.494266 map_score: 0.507865 Time: 83.92
Run: 10 train loss: 25.550289 Time: 188.52
Run: 10 VAL ap_score: 0.506774 map_score: 0.511520 Time: 83.22
Run: 11 train loss: 25.296419 Time: 80.69
Run: 11 VAL ap_score: 0.514132 map_score: 0.494150 Time: 24.28
Run: 12 train loss: 24.946289 Time: 73.50
Run: 12 VAL ap_score: 0.506012 map_score: 0.506592 Time: 23.16
Run: 13 train loss: 24.292686 Time: 68.89
Run: 13 VAL ap_score: 0.521648 map_score: 0.505973 Time: 22.93
Run: 14 train loss: 23.941634 Time: 104.20
Run: 14 VAL ap_score: 0.498131 map_score: 0.482753 Time: 35.74
Run: 15 train loss: 23.512839 Time: 68.51
Run: 15 VAL ap_score: 0.532142 map_score: 0.520902 Time: 22.81
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 16 train loss: 23.201960 Time: 68.14
Run: 16 VAL ap_score: 0.536412 map_score: 0.524618 Time: 22.95
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 17 train loss: 22.986490 Time: 68.35
Run: 17 VAL ap_score: 0.534192 map_score: 0.523171 Time: 22.71
Run: 18 train loss: 22.734970 Time: 68.69
Run: 18 VAL ap_score: 0.527832 map_score: 0.508636 Time: 22.85
Run: 19 train loss: 22.631661 Time: 68.87
Run: 19 VAL ap_score: 0.517293 map_score: 0.499412 Time: 22.68
Run: 20 train loss: 22.494493 Time: 70.45
Run: 20 VAL ap_score: 0.523112 map_score: 0.526506 Time: 23.03
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 21 train loss: 22.291608 Time: 68.88
Run: 21 VAL ap_score: 0.529442 map_score: 0.509332 Time: 22.60
Run: 22 train loss: 21.999624 Time: 70.21
Run: 22 VAL ap_score: 0.528800 map_score: 0.522756 Time: 23.01
Run: 23 train loss: 21.954174 Time: 68.39
Run: 23 VAL ap_score: 0.486790 map_score: 0.499011 Time: 22.92
Run: 24 train loss: 21.862654 Time: 68.38
Run: 24 VAL ap_score: 0.553216 map_score: 0.549106 Time: 62.56
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 25 train loss: 21.866637 Time: 105.39
Run: 25 VAL ap_score: 0.467792 map_score: 0.461235 Time: 22.88
Run: 26 train loss: 21.557633 Time: 70.71
Run: 26 VAL ap_score: 0.537967 map_score: 0.529654 Time: 22.79
Run: 27 train loss: 21.429192 Time: 68.96
Run: 27 VAL ap_score: 0.515217 map_score: 0.505187 Time: 23.01
Run: 28 train loss: 21.346212 Time: 68.53
Run: 28 VAL ap_score: 0.506699 map_score: 0.490122 Time: 22.64
Run: 29 train loss: 21.292781 Time: 68.60
Run: 29 VAL ap_score: 0.541865 map_score: 0.530778 Time: 23.31
Run: 30 train loss: 21.088998 Time: 68.80
Run: 30 VAL ap_score: 0.515256 map_score: 0.527302 Time: 23.02
Run: 31 train loss: 20.875226 Time: 68.96
Run: 31 VAL ap_score: 0.538556 map_score: 0.513647 Time: 23.26
Run: 32 train loss: 20.838724 Time: 68.71
Run: 32 VAL ap_score: 0.542044 map_score: 0.527687 Time: 22.99
Run: 33 train loss: 20.686260 Time: 68.70
Run: 33 VAL ap_score: 0.500752 map_score: 0.477211 Time: 22.65
Run: 34 train loss: 20.926745 Time: 68.63
Run: 34 VAL ap_score: 0.487508 map_score: 0.492056 Time: 22.62
Run: 35 train loss: 20.561685 Time: 68.68
Run: 35 VAL ap_score: 0.517375 map_score: 0.525979 Time: 25.08
Run: 36 train loss: 20.554484 Time: 78.40
Run: 36 VAL ap_score: 0.550107 map_score: 0.527867 Time: 22.91
Run: 37 train loss: 20.530581 Time: 69.16
Run: 37 VAL ap_score: 0.518931 map_score: 0.513277 Time: 22.92
Run: 38 train loss: 20.453142 Time: 68.50
Run: 38 VAL ap_score: 0.539118 map_score: 0.532016 Time: 22.83
Run: 39 train loss: 20.532070 Time: 68.55
Run: 39 VAL ap_score: 0.533663 map_score: 0.511829 Time: 22.95
Run: 40 train loss: 20.338336 Time: 68.73
Run: 40 VAL ap_score: 0.537185 map_score: 0.528018 Time: 22.68
Run: 41 train loss: 20.346651 Time: 68.01
Run: 41 VAL ap_score: 0.525287 map_score: 0.514148 Time: 23.04
Run: 42 train loss: 20.099894 Time: 68.93
Run: 42 VAL ap_score: 0.501316 map_score: 0.485047 Time: 23.09
Run: 43 train loss: 20.012593 Time: 68.58
Run: 43 VAL ap_score: 0.488501 map_score: 0.498859 Time: 22.63
Run: 44 train loss: 20.113538 Time: 68.20
Run: 44 VAL ap_score: 0.538079 map_score: 0.515048 Time: 22.96
Run: 45 train loss: 20.079931 Time: 68.59
Run: 45 VAL ap_score: 0.534643 map_score: 0.509133 Time: 22.88
Run: 46 train loss: 20.017038 Time: 68.16
Run: 46 VAL ap_score: 0.539947 map_score: 0.528023 Time: 23.09
Run: 47 train loss: 19.733025 Time: 68.27
Run: 47 VAL ap_score: 0.532651 map_score: 0.519900 Time: 22.65
Run: 48 train loss: 19.681228 Time: 68.06
Run: 48 VAL ap_score: 0.492807 map_score: 0.483512 Time: 22.80
Run: 49 train loss: 19.640582 Time: 68.25
Run: 49 VAL ap_score: 0.515690 map_score: 0.512188 Time: 22.85
Run: 50 train loss: 19.531785 Time: 68.14
Run: 50 VAL ap_score: 0.534595 map_score: 0.531795 Time: 22.91
Run: 51 train loss: 19.315620 Time: 71.60
Run: 51 VAL ap_score: 0.498274 map_score: 0.492332 Time: 33.29
Run: 52 train loss: 19.508051 Time: 84.28
Run: 52 VAL ap_score: 0.529564 map_score: 0.516508 Time: 28.27
Run: 53 train loss: 19.469480 Time: 84.68
Run: 53 VAL ap_score: 0.433548 map_score: 0.464849 Time: 27.79
Run: 54 train loss: 19.222299 Time: 84.97
Run: 54 VAL ap_score: 0.544575 map_score: 0.534183 Time: 28.27
Run: 55 train loss: 19.226864 Time: 83.96
Run: 55 VAL ap_score: 0.552355 map_score: 0.532413 Time: 28.15
Run: 56 train loss: 19.455996 Time: 85.86
Run: 56 VAL ap_score: 0.512860 map_score: 0.502389 Time: 28.78
Run: 57 train loss: 19.209065 Time: 85.26
Run: 57 VAL ap_score: 0.519949 map_score: 0.502237 Time: 27.60
Run: 58 train loss: 18.906737 Time: 85.14
Run: 58 VAL ap_score: 0.535400 map_score: 0.510629 Time: 28.43
Run: 59 train loss: 18.985060 Time: 83.77
Run: 59 VAL ap_score: 0.575653 map_score: 0.558933 Time: 28.43
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 60 train loss: 18.918449 Time: 85.25
Run: 60 VAL ap_score: 0.572796 map_score: 0.566148 Time: 28.31
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
Run: 61 train loss: 18.970140 Time: 85.01
Run: 61 VAL ap_score: 0.501084 map_score: 0.491754 Time: 28.23
Run: 62 train loss: 18.808616 Time: 84.99
Run: 62 VAL ap_score: 0.545663 map_score: 0.513982 Time: 27.73
Run: 63 train loss: 18.732372 Time: 85.62
Run: 63 VAL ap_score: 0.483455 map_score: 0.482746 Time: 28.07
Run: 64 train loss: 18.779366 Time: 85.87
Run: 64 VAL ap_score: 0.497166 map_score: 0.501729 Time: 28.15
Run: 65 train loss: 18.588716 Time: 86.71
Run: 65 VAL ap_score: 0.494434 map_score: 0.477497 Time: 29.03
Run: 66 train loss: 18.586849 Time: 87.73
Run: 66 VAL ap_score: 0.520861 map_score: 0.520249 Time: 28.39
Run: 67 train loss: 18.580521 Time: 85.39
Run: 67 VAL ap_score: 0.515444 map_score: 0.515359 Time: 28.40
Run: 68 train loss: 18.480455 Time: 85.75
Run: 68 VAL ap_score: 0.551275 map_score: 0.539806 Time: 28.47
Run: 69 train loss: 18.516957 Time: 81.14
Run: 69 VAL ap_score: 0.540733 map_score: 0.527114 Time: 32.08
Run: 70 train loss: 18.421728 Time: 90.60
Run: 70 VAL ap_score: 0.550086 map_score: 0.552633 Time: 28.62
Run: 71 train loss: 18.485027 Time: 85.34
Run: 71 VAL ap_score: 0.527758 map_score: 0.518122 Time: 28.42
Run: 72 train loss: 18.402612 Time: 85.27
Run: 72 VAL ap_score: 0.463513 map_score: 0.466619 Time: 28.37
Run: 73 train loss: 18.404322 Time: 85.79
Run: 73 VAL ap_score: 0.535021 map_score: 0.519528 Time: 28.56
Run: 74 train loss: 18.285181 Time: 85.62
Run: 74 VAL ap_score: 0.535192 map_score: 0.525360 Time: 28.40
Run: 75 train loss: 18.267594 Time: 86.49
Run: 75 VAL ap_score: 0.567248 map_score: 0.552094 Time: 28.22
Run: 76 train loss: 18.236999 Time: 86.90
Run: 76 VAL ap_score: 0.539884 map_score: 0.533229 Time: 28.26
Run: 77 train loss: 18.307770 Time: 86.30
Run: 77 VAL ap_score: 0.545392 map_score: 0.538855 Time: 28.28
Run: 78 train loss: 18.224341 Time: 84.55
Run: 78 VAL ap_score: 0.520001 map_score: 0.512277 Time: 27.59
Run: 79 train loss: 18.237946 Time: 85.86
Run: 79 VAL ap_score: 0.520020 map_score: 0.520047 Time: 28.36
Run: 80 train loss: 18.156225 Time: 83.90
Run: 80 VAL ap_score: 0.530103 map_score: 0.537018 Time: 28.34
Run: 81 train loss: 18.176933 Time: 84.25
Run: 81 VAL ap_score: 0.530938 map_score: 0.513581 Time: 28.48
Run: 82 train loss: 18.183241 Time: 85.33
Run: 82 VAL ap_score: 0.529181 map_score: 0.512848 Time: 28.16
Run: 83 train loss: 18.060851 Time: 85.50
Run: 83 VAL ap_score: 0.522791 map_score: 0.528050 Time: 28.06
Run: 84 train loss: 18.132303 Time: 85.44
Run: 84 VAL ap_score: 0.557615 map_score: 0.533265 Time: 28.29
Run: 85 train loss: 18.085872 Time: 83.94
Run: 85 VAL ap_score: 0.531064 map_score: 0.539662 Time: 28.06
Run: 86 train loss: 18.287086 Time: 84.67
Run: 86 VAL ap_score: 0.551491 map_score: 0.550569 Time: 28.46
Run: 87 train loss: 18.098679 Time: 83.67
Run: 87 VAL ap_score: 0.549864 map_score: 0.535664 Time: 26.45
Run: 88 train loss: 18.055267 Time: 95.19
Run: 88 VAL ap_score: 0.549841 map_score: 0.551150 Time: 27.46
Run: 89 train loss: 17.948611 Time: 85.34
Run: 89 VAL ap_score: 0.474566 map_score: 0.487342 Time: 27.88
Run: 90 train loss: 18.035715 Time: 84.98
Run: 90 VAL ap_score: 0.519396 map_score: 0.523325 Time: 28.24
Run: 91 train loss: 17.777359 Time: 84.42
Run: 91 VAL ap_score: 0.569375 map_score: 0.557812 Time: 28.07
Run: 92 train loss: 18.029516 Time: 84.62
Run: 92 VAL ap_score: 0.568743 map_score: 0.560422 Time: 27.72
Run: 93 train loss: 17.967140 Time: 85.73
Run: 93 VAL ap_score: 0.578076 map_score: 0.562255 Time: 27.93
Run: 94 train loss: 17.808165 Time: 84.26
Run: 94 VAL ap_score: 0.539903 map_score: 0.532871 Time: 28.34
Run: 95 train loss: 18.007329 Time: 83.82
Run: 95 VAL ap_score: 0.564644 map_score: 0.554170 Time: 28.11
Run: 96 train loss: 17.923301 Time: 83.92
Run: 96 VAL ap_score: 0.557623 map_score: 0.546859 Time: 28.49
Run: 97 train loss: 18.050733 Time: 84.85
Run: 97 VAL ap_score: 0.562347 map_score: 0.562766 Time: 28.29
Run: 98 train loss: 17.889975 Time: 84.55
Run: 98 VAL ap_score: 0.553303 map_score: 0.545871 Time: 28.52
Run: 99 train loss: 18.049757 Time: 84.52
Run: 99 VAL ap_score: 0.547635 map_score: 0.527831 Time: 28.49
Run: 100 train loss: 17.853457 Time: 84.68
Run: 100 VAL ap_score: 0.547092 map_score: 0.531929 Time: 28.61
Run: 101 train loss: 17.899087 Time: 85.82
Run: 101 VAL ap_score: 0.511138 map_score: 0.508342 Time: 27.74
Run: 102 train loss: 17.933520 Time: 86.01
Run: 102 VAL ap_score: 0.503733 map_score: 0.506790 Time: 28.17
Run: 103 train loss: 17.896962 Time: 85.61
Run: 103 VAL ap_score: 0.533557 map_score: 0.532522 Time: 28.24
Run: 104 train loss: 17.922440 Time: 85.21
Run: 104 VAL ap_score: 0.508875 map_score: 0.508096 Time: 28.34
Run: 105 train loss: 17.688189 Time: 85.37
Run: 105 VAL ap_score: 0.551542 map_score: 0.537897 Time: 27.97
Run: 106 train loss: 17.886517 Time: 89.24
Run: 106 VAL ap_score: 0.560379 map_score: 0.554497 Time: 27.55
Run: 107 train loss: 17.852809 Time: 84.27
Run: 107 VAL ap_score: 0.530438 map_score: 0.523587 Time: 27.59
Run: 108 train loss: 17.826140 Time: 84.18
Run: 108 VAL ap_score: 0.571913 map_score: 0.563347 Time: 27.38
Run: 109 train loss: 17.862561 Time: 83.93
Run: 109 VAL ap_score: 0.523264 map_score: 0.534450 Time: 28.27
Run: 110 train loss: 17.795768 Time: 83.67
Run: 110 VAL ap_score: 0.492354 map_score: 0.499483 Time: 27.97
Run: 111 train loss: 17.856265 Time: 84.45
Run: 111 VAL ap_score: 0.536771 map_score: 0.516319 Time: 27.61
loading best validated model from experiments/egsc_margin_01/trained_models/egsc_modified_aids_large_dataset_seed_4929_2024-05-10_08:35:36.pth
loaded test query graphs from ./large_dataset/splits/test/test_aids240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_aids240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/aids240k_corpus_subgraphs.pkl
TEST - ap_score: 0.504389 map_score: 0.504917
