Experiment egsc_margin_01 for model: 'egsc_modified', dataset: 'ptc_fr_large', seed: 4929 started at time: 2024-05-10_08:35:45
/raid/infolab/ashwinr/isonetpp/subgraph_matching/train.py
--experiment_id egsc_margin_01
--experiment_dir experiments/
--model_config_path configs/egsc_modified.yaml
--dataset_name ptc_fr
--seed 4929
--dataset_size large
--margin 0.1
loaded train query graphs from ./large_dataset/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loaded train relationships from ./large_dataset/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
loaded val query graphs from ./large_dataset/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loaded val relationships from ./large_dataset/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
saving intial model to experiments/egsc_margin_01/initial_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
no. of params in model: 3948
Run: 0 train loss: 46.706129 Time: 186.42
Run: 0 VAL ap_score: 0.463536 map_score: 0.470853 Time: 79.70
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 1 train loss: 34.295358 Time: 185.31
Run: 1 VAL ap_score: 0.495690 map_score: 0.495897 Time: 81.18
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 2 train loss: 31.339133 Time: 553.32
Run: 2 VAL ap_score: 0.505377 map_score: 0.491745 Time: 110.33
Run: 3 train loss: 29.239993 Time: 186.83
Run: 3 VAL ap_score: 0.520139 map_score: 0.526176 Time: 83.86
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 4 train loss: 27.979966 Time: 186.10
Run: 4 VAL ap_score: 0.551742 map_score: 0.541863 Time: 80.65
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 5 train loss: 27.283187 Time: 185.81
Run: 5 VAL ap_score: 0.498960 map_score: 0.498283 Time: 81.38
Run: 6 train loss: 26.808475 Time: 192.68
Run: 6 VAL ap_score: 0.547194 map_score: 0.545533 Time: 82.93
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 7 train loss: 26.245860 Time: 191.89
Run: 7 VAL ap_score: 0.527191 map_score: 0.539896 Time: 82.79
Run: 8 train loss: 25.708668 Time: 190.42
Run: 8 VAL ap_score: 0.529478 map_score: 0.530353 Time: 82.57
Run: 9 train loss: 24.918741 Time: 187.94
Run: 9 VAL ap_score: 0.592670 map_score: 0.591872 Time: 80.36
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 10 train loss: 24.897436 Time: 187.04
Run: 10 VAL ap_score: 0.605305 map_score: 0.592799 Time: 109.50
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 11 train loss: 24.407354 Time: 184.70
Run: 11 VAL ap_score: 0.556200 map_score: 0.548425 Time: 82.23
Run: 12 train loss: 24.054049 Time: 186.11
Run: 12 VAL ap_score: 0.594599 map_score: 0.578428 Time: 81.20
Run: 13 train loss: 23.492394 Time: 184.17
Run: 13 VAL ap_score: 0.542537 map_score: 0.527781 Time: 81.82
Run: 14 train loss: 22.883596 Time: 189.89
Run: 14 VAL ap_score: 0.586257 map_score: 0.574960 Time: 89.45
Run: 15 train loss: 22.755564 Time: 198.25
Run: 15 VAL ap_score: 0.566245 map_score: 0.551841 Time: 81.14
Run: 16 train loss: 22.723952 Time: 184.91
Run: 16 VAL ap_score: 0.588722 map_score: 0.563075 Time: 86.44
Run: 17 train loss: 22.266923 Time: 209.74
Run: 17 VAL ap_score: 0.595810 map_score: 0.578148 Time: 85.61
Run: 18 train loss: 22.083808 Time: 219.55
Run: 18 VAL ap_score: 0.540893 map_score: 0.513572 Time: 81.53
Run: 19 train loss: 21.942137 Time: 189.65
Run: 19 VAL ap_score: 0.570017 map_score: 0.562542 Time: 80.60
Run: 20 train loss: 21.895690 Time: 189.95
Run: 20 VAL ap_score: 0.589503 map_score: 0.583603 Time: 82.11
Run: 21 train loss: 21.777451 Time: 191.30
Run: 21 VAL ap_score: 0.601088 map_score: 0.591433 Time: 80.63
Run: 22 train loss: 21.553903 Time: 190.52
Run: 22 VAL ap_score: 0.583239 map_score: 0.568224 Time: 80.64
Run: 23 train loss: 21.371995 Time: 187.93
Run: 23 VAL ap_score: 0.547721 map_score: 0.551482 Time: 81.38
Run: 24 train loss: 21.148253 Time: 186.99
Run: 24 VAL ap_score: 0.601294 map_score: 0.580885 Time: 79.53
Run: 25 train loss: 20.926039 Time: 183.71
Run: 25 VAL ap_score: 0.516132 map_score: 0.514417 Time: 80.14
Run: 26 train loss: 20.684915 Time: 186.26
Run: 26 VAL ap_score: 0.554973 map_score: 0.536367 Time: 81.35
Run: 27 train loss: 20.880546 Time: 185.80
Run: 27 VAL ap_score: 0.606779 map_score: 0.598881 Time: 80.66
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 28 train loss: 20.711595 Time: 186.40
Run: 28 VAL ap_score: 0.585245 map_score: 0.580625 Time: 80.96
Run: 29 train loss: 20.808233 Time: 187.42
Run: 29 VAL ap_score: 0.595110 map_score: 0.593170 Time: 81.05
Run: 30 train loss: 20.519114 Time: 188.00
Run: 30 VAL ap_score: 0.601086 map_score: 0.585042 Time: 81.38
Run: 31 train loss: 20.476785 Time: 186.60
Run: 31 VAL ap_score: 0.536368 map_score: 0.547086 Time: 80.64
Run: 32 train loss: 20.405154 Time: 187.35
Run: 32 VAL ap_score: 0.587904 map_score: 0.587050 Time: 82.17
Run: 33 train loss: 20.247118 Time: 187.52
Run: 33 VAL ap_score: 0.601671 map_score: 0.586388 Time: 82.30
Run: 34 train loss: 20.396030 Time: 188.41
Run: 34 VAL ap_score: 0.577324 map_score: 0.572945 Time: 79.88
Run: 35 train loss: 20.145546 Time: 187.01
Run: 35 VAL ap_score: 0.598877 map_score: 0.595144 Time: 81.94
Run: 36 train loss: 20.103705 Time: 186.13
Run: 36 VAL ap_score: 0.611463 map_score: 0.604167 Time: 80.97
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 37 train loss: 20.261761 Time: 186.88
Run: 37 VAL ap_score: 0.569147 map_score: 0.567765 Time: 80.59
Run: 38 train loss: 19.826409 Time: 186.74
Run: 38 VAL ap_score: 0.593597 map_score: 0.586292 Time: 82.35
Run: 39 train loss: 19.797057 Time: 252.46
Run: 39 VAL ap_score: 0.575619 map_score: 0.573001 Time: 113.01
Run: 40 train loss: 19.942694 Time: 188.22
Run: 40 VAL ap_score: 0.567687 map_score: 0.567275 Time: 80.89
Run: 41 train loss: 19.829015 Time: 186.14
Run: 41 VAL ap_score: 0.609307 map_score: 0.598565 Time: 80.95
Run: 42 train loss: 19.764748 Time: 187.05
Run: 42 VAL ap_score: 0.579491 map_score: 0.577482 Time: 95.46
Run: 43 train loss: 19.666994 Time: 257.78
Run: 43 VAL ap_score: 0.520452 map_score: 0.512817 Time: 91.69
Run: 44 train loss: 19.520574 Time: 186.49
Run: 44 VAL ap_score: 0.529422 map_score: 0.530905 Time: 81.44
Run: 45 train loss: 19.573455 Time: 188.38
Run: 45 VAL ap_score: 0.567329 map_score: 0.567325 Time: 81.95
Run: 46 train loss: 19.496576 Time: 187.43
Run: 46 VAL ap_score: 0.572958 map_score: 0.575384 Time: 80.29
Run: 47 train loss: 19.739145 Time: 185.23
Run: 47 VAL ap_score: 0.529198 map_score: 0.534295 Time: 80.39
Run: 48 train loss: 19.527679 Time: 187.07
Run: 48 VAL ap_score: 0.592212 map_score: 0.582296 Time: 80.68
Run: 49 train loss: 19.388655 Time: 186.47
Run: 49 VAL ap_score: 0.523825 map_score: 0.528211 Time: 81.06
Run: 50 train loss: 19.471115 Time: 187.48
Run: 50 VAL ap_score: 0.508734 map_score: 0.534405 Time: 80.45
Run: 51 train loss: 19.357208 Time: 187.56
Run: 51 VAL ap_score: 0.598810 map_score: 0.592678 Time: 80.82
Run: 52 train loss: 19.496077 Time: 187.17
Run: 52 VAL ap_score: 0.599185 map_score: 0.584553 Time: 80.07
Run: 53 train loss: 19.388516 Time: 188.71
Run: 53 VAL ap_score: 0.507074 map_score: 0.508994 Time: 80.70
Run: 54 train loss: 19.250182 Time: 186.96
Run: 54 VAL ap_score: 0.588282 map_score: 0.578510 Time: 81.31
Run: 55 train loss: 19.280581 Time: 185.45
Run: 55 VAL ap_score: 0.589225 map_score: 0.575991 Time: 80.08
Run: 56 train loss: 19.425563 Time: 186.54
Run: 56 VAL ap_score: 0.594215 map_score: 0.594058 Time: 81.47
Run: 57 train loss: 19.323147 Time: 187.03
Run: 57 VAL ap_score: 0.605461 map_score: 0.600342 Time: 82.02
Run: 58 train loss: 19.150815 Time: 186.02
Run: 58 VAL ap_score: 0.581087 map_score: 0.573592 Time: 81.59
Run: 59 train loss: 19.309101 Time: 187.57
Run: 59 VAL ap_score: 0.589653 map_score: 0.568438 Time: 82.31
Run: 60 train loss: 19.193033 Time: 188.17
Run: 60 VAL ap_score: 0.578002 map_score: 0.565146 Time: 81.90
Run: 61 train loss: 19.278164 Time: 184.48
Run: 61 VAL ap_score: 0.617408 map_score: 0.612626 Time: 81.64
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 62 train loss: 19.163640 Time: 184.69
Run: 62 VAL ap_score: 0.605078 map_score: 0.595227 Time: 81.77
Run: 63 train loss: 19.153951 Time: 185.01
Run: 63 VAL ap_score: 0.615742 map_score: 0.613920 Time: 81.41
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 64 train loss: 19.070055 Time: 184.72
Run: 64 VAL ap_score: 0.563347 map_score: 0.567819 Time: 81.99
Run: 65 train loss: 19.068755 Time: 185.06
Run: 65 VAL ap_score: 0.626591 map_score: 0.615700 Time: 81.79
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 66 train loss: 19.193526 Time: 184.89
Run: 66 VAL ap_score: 0.561660 map_score: 0.562633 Time: 81.64
Run: 67 train loss: 18.937312 Time: 183.78
Run: 67 VAL ap_score: 0.562418 map_score: 0.561929 Time: 81.23
Run: 68 train loss: 19.039006 Time: 184.08
Run: 68 VAL ap_score: 0.552854 map_score: 0.543032 Time: 81.68
Run: 69 train loss: 18.895327 Time: 184.46
Run: 69 VAL ap_score: 0.543679 map_score: 0.560522 Time: 81.82
Run: 70 train loss: 19.181162 Time: 184.54
Run: 70 VAL ap_score: 0.590093 map_score: 0.596863 Time: 81.46
Run: 71 train loss: 18.983499 Time: 184.76
Run: 71 VAL ap_score: 0.565619 map_score: 0.567878 Time: 81.95
Run: 72 train loss: 18.814886 Time: 185.04
Run: 72 VAL ap_score: 0.640619 map_score: 0.631267 Time: 28.24
saving best validated model to experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
Run: 73 train loss: 18.959933 Time: 68.97
Run: 73 VAL ap_score: 0.610091 map_score: 0.604037 Time: 22.56
Run: 74 train loss: 18.998311 Time: 69.11
Run: 74 VAL ap_score: 0.607726 map_score: 0.603144 Time: 22.56
Run: 75 train loss: 18.712695 Time: 68.96
Run: 75 VAL ap_score: 0.552457 map_score: 0.570317 Time: 22.50
Run: 76 train loss: 18.901752 Time: 68.69
Run: 76 VAL ap_score: 0.603278 map_score: 0.608711 Time: 22.73
Run: 77 train loss: 18.963122 Time: 68.45
Run: 77 VAL ap_score: 0.588440 map_score: 0.589264 Time: 22.83
Run: 78 train loss: 18.891183 Time: 68.56
Run: 78 VAL ap_score: 0.567930 map_score: 0.556793 Time: 22.54
Run: 79 train loss: 18.910226 Time: 68.56
Run: 79 VAL ap_score: 0.381718 map_score: 0.419555 Time: 22.49
Run: 80 train loss: 18.803890 Time: 68.22
Run: 80 VAL ap_score: 0.559120 map_score: 0.553726 Time: 22.80
Run: 81 train loss: 18.882967 Time: 69.14
Run: 81 VAL ap_score: 0.547196 map_score: 0.544483 Time: 22.53
Run: 82 train loss: 18.936972 Time: 68.78
Run: 82 VAL ap_score: 0.608178 map_score: 0.601997 Time: 22.82
Run: 83 train loss: 18.943552 Time: 69.08
Run: 83 VAL ap_score: 0.536550 map_score: 0.543651 Time: 22.62
Run: 84 train loss: 18.926198 Time: 68.92
Run: 84 VAL ap_score: 0.577202 map_score: 0.571499 Time: 22.47
Run: 85 train loss: 18.706806 Time: 68.72
Run: 85 VAL ap_score: 0.557217 map_score: 0.557486 Time: 22.82
Run: 86 train loss: 18.621976 Time: 68.93
Run: 86 VAL ap_score: 0.584398 map_score: 0.580702 Time: 22.46
Run: 87 train loss: 18.662665 Time: 69.23
Run: 87 VAL ap_score: 0.572369 map_score: 0.560580 Time: 22.55
Run: 88 train loss: 18.747952 Time: 69.05
Run: 88 VAL ap_score: 0.608085 map_score: 0.595042 Time: 22.46
Run: 89 train loss: 18.875960 Time: 68.97
Run: 89 VAL ap_score: 0.510125 map_score: 0.523373 Time: 22.59
Run: 90 train loss: 18.851477 Time: 68.76
Run: 90 VAL ap_score: 0.583938 map_score: 0.578270 Time: 22.64
Run: 91 train loss: 18.770594 Time: 69.00
Run: 91 VAL ap_score: 0.578519 map_score: 0.580957 Time: 22.78
Run: 92 train loss: 18.697612 Time: 68.61
Run: 92 VAL ap_score: 0.540571 map_score: 0.546968 Time: 22.57
Run: 93 train loss: 18.783816 Time: 68.63
Run: 93 VAL ap_score: 0.551653 map_score: 0.569181 Time: 22.54
Run: 94 train loss: 18.677014 Time: 68.58
Run: 94 VAL ap_score: 0.583579 map_score: 0.584889 Time: 22.80
Run: 95 train loss: 18.717876 Time: 68.96
Run: 95 VAL ap_score: 0.571352 map_score: 0.576920 Time: 22.74
Run: 96 train loss: 18.565462 Time: 68.78
Run: 96 VAL ap_score: 0.498588 map_score: 0.492404 Time: 22.56
Run: 97 train loss: 18.674030 Time: 69.04
Run: 97 VAL ap_score: 0.538875 map_score: 0.548408 Time: 22.86
Run: 98 train loss: 18.671683 Time: 69.14
Run: 98 VAL ap_score: 0.537279 map_score: 0.539102 Time: 22.48
Run: 99 train loss: 18.724674 Time: 68.53
Run: 99 VAL ap_score: 0.585477 map_score: 0.594306 Time: 22.49
Run: 100 train loss: 18.693523 Time: 68.86
Run: 100 VAL ap_score: 0.596522 map_score: 0.598636 Time: 22.57
Run: 101 train loss: 18.636745 Time: 69.04
Run: 101 VAL ap_score: 0.571889 map_score: 0.573755 Time: 22.83
Run: 102 train loss: 18.660988 Time: 69.52
Run: 102 VAL ap_score: 0.590116 map_score: 0.590883 Time: 22.55
Run: 103 train loss: 18.735385 Time: 68.94
Run: 103 VAL ap_score: 0.575675 map_score: 0.575526 Time: 22.81
Run: 104 train loss: 18.653501 Time: 69.08
Run: 104 VAL ap_score: 0.547947 map_score: 0.556786 Time: 22.54
Run: 105 train loss: 18.489164 Time: 68.99
Run: 105 VAL ap_score: 0.504130 map_score: 0.507217 Time: 23.39
Run: 106 train loss: 18.647979 Time: 91.66
Run: 106 VAL ap_score: 0.534876 map_score: 0.549152 Time: 475.52
Run: 107 train loss: 18.688066 Time: 448.52
Run: 107 VAL ap_score: 0.584706 map_score: 0.591758 Time: 22.92
Run: 108 train loss: 18.573397 Time: 70.01
Run: 108 VAL ap_score: 0.484466 map_score: 0.501635 Time: 22.73
Run: 109 train loss: 18.559103 Time: 69.65
Run: 109 VAL ap_score: 0.591052 map_score: 0.601721 Time: 22.57
Run: 110 train loss: 18.478435 Time: 68.62
Run: 110 VAL ap_score: 0.534568 map_score: 0.542318 Time: 22.82
Run: 111 train loss: 18.540537 Time: 69.18
Run: 111 VAL ap_score: 0.532491 map_score: 0.549717 Time: 22.69
Run: 112 train loss: 18.675516 Time: 69.16
Run: 112 VAL ap_score: 0.593930 map_score: 0.600934 Time: 22.62
Run: 113 train loss: 18.716869 Time: 70.02
Run: 113 VAL ap_score: 0.523774 map_score: 0.538566 Time: 22.56
Run: 114 train loss: 18.547814 Time: 68.64
Run: 114 VAL ap_score: 0.545866 map_score: 0.551384 Time: 22.50
Run: 115 train loss: 18.589796 Time: 68.96
Run: 115 VAL ap_score: 0.557925 map_score: 0.563128 Time: 22.80
Run: 116 train loss: 18.592826 Time: 68.49
Run: 116 VAL ap_score: 0.569329 map_score: 0.580507 Time: 22.55
Run: 117 train loss: 18.466581 Time: 68.89
Run: 117 VAL ap_score: 0.596075 map_score: 0.593239 Time: 22.61
Run: 118 train loss: 18.630515 Time: 68.90
Run: 118 VAL ap_score: 0.601834 map_score: 0.602660 Time: 23.01
Run: 119 train loss: 18.386231 Time: 68.73
Run: 119 VAL ap_score: 0.539090 map_score: 0.552358 Time: 22.63
Run: 120 train loss: 18.560822 Time: 69.02
Run: 120 VAL ap_score: 0.486135 map_score: 0.520436 Time: 22.77
Run: 121 train loss: 18.514305 Time: 68.53
Run: 121 VAL ap_score: 0.514033 map_score: 0.539535 Time: 22.81
Run: 122 train loss: 18.580562 Time: 68.83
Run: 122 VAL ap_score: 0.550748 map_score: 0.571157 Time: 22.55
Run: 123 train loss: 18.723733 Time: 68.73
Run: 123 VAL ap_score: 0.550817 map_score: 0.550985 Time: 22.49
loading best validated model from experiments/egsc_margin_01/trained_models/egsc_modified_ptc_fr_large_dataset_seed_4929_2024-05-10_08:35:45.pth
loaded test query graphs from ./large_dataset/splits/test/test_ptc_fr240k_query_subgraphs.pkl
loaded test relationships from ./large_dataset/splits/test/test_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loaded corpus graphs from ./large_dataset/splits/ptc_fr240k_corpus_subgraphs.pkl
TEST - ap_score: 0.579476 map_score: 0.571172
