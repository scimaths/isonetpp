Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=isonet_clean
--TASK=isonet
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--consistency_lambda=0
--IPLUS_LAMBDA=0
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model ISONET
This uses GMN encoder to obtain bad of node embeddings per graph, which is then used to obtain bag of edge embeddings per graph - then parameterized sinkhorn with LRL and similarity computation using hinge scoring (H_q, PH_c) where H consists of edge embeds
saving initial model to ./isonet_clean/initialModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
no. of params in model: 2028
Run: 0 train loss: 365.116262 Time: 161.21
Run: 0 VAL ap_score: 0.455672 map_score: 0.498211 Time: 69.26
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 1 train loss: 215.596500 Time: 205.31
Run: 1 VAL ap_score: 0.487981 map_score: 0.520183 Time: 72.74
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 2 train loss: 194.813147 Time: 208.43
Run: 2 VAL ap_score: 0.533086 map_score: 0.540430 Time: 97.21
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 3 train loss: 178.087486 Time: 294.73
Run: 3 VAL ap_score: 0.520168 map_score: 0.538748 Time: 137.47
Run: 4 train loss: 167.819667 Time: 333.18
Run: 4 VAL ap_score: 0.540404 map_score: 0.565997 Time: 144.42
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 5 train loss: 155.242696 Time: 310.21
Run: 5 VAL ap_score: 0.546092 map_score: 0.564396 Time: 142.37
Run: 6 train loss: 143.671813 Time: 336.14
Run: 6 VAL ap_score: 0.539420 map_score: 0.570877 Time: 139.24
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 7 train loss: 138.856322 Time: 324.41
Run: 7 VAL ap_score: 0.572576 map_score: 0.592575 Time: 131.57
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 8 train loss: 135.977201 Time: 331.35
Run: 8 VAL ap_score: 0.569227 map_score: 0.589505 Time: 148.84
Run: 9 train loss: 132.336562 Time: 313.73
Run: 9 VAL ap_score: 0.565228 map_score: 0.592355 Time: 134.99
Run: 10 train loss: 131.269160 Time: 328.59
Run: 10 VAL ap_score: 0.553145 map_score: 0.587041 Time: 144.62
Run: 11 train loss: 128.905887 Time: 324.46
Run: 11 VAL ap_score: 0.570564 map_score: 0.600067 Time: 139.30
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 12 train loss: 124.668810 Time: 312.88
Run: 12 VAL ap_score: 0.568084 map_score: 0.586149 Time: 154.19
Run: 13 train loss: 121.364098 Time: 316.83
Run: 13 VAL ap_score: 0.584500 map_score: 0.604913 Time: 138.13
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 14 train loss: 119.042443 Time: 325.54
Run: 14 VAL ap_score: 0.596282 map_score: 0.623363 Time: 139.97
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 15 train loss: 116.146333 Time: 327.67
Run: 15 VAL ap_score: 0.563533 map_score: 0.583660 Time: 142.34
Run: 16 train loss: 114.421093 Time: 315.62
Run: 16 VAL ap_score: 0.596946 map_score: 0.613976 Time: 138.60
Run: 17 train loss: 111.451171 Time: 335.90
Run: 17 VAL ap_score: 0.586556 map_score: 0.616589 Time: 135.16
Run: 18 train loss: 110.744156 Time: 325.91
Run: 18 VAL ap_score: 0.583679 map_score: 0.614597 Time: 139.38
Run: 19 train loss: 109.438981 Time: 322.01
Run: 19 VAL ap_score: 0.582523 map_score: 0.613327 Time: 143.56
Run: 20 train loss: 107.250449 Time: 319.92
Run: 20 VAL ap_score: 0.594459 map_score: 0.628455 Time: 138.34
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 21 train loss: 106.522236 Time: 330.42
Run: 21 VAL ap_score: 0.572512 map_score: 0.620964 Time: 138.99
Run: 22 train loss: 104.369380 Time: 314.12
Run: 22 VAL ap_score: 0.597331 map_score: 0.633569 Time: 146.92
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 23 train loss: 102.706927 Time: 324.98
Run: 23 VAL ap_score: 0.592753 map_score: 0.625939 Time: 145.28
Run: 24 train loss: 101.609615 Time: 323.11
Run: 24 VAL ap_score: 0.600380 map_score: 0.635391 Time: 142.78
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 25 train loss: 101.244345 Time: 320.97
Run: 25 VAL ap_score: 0.607479 map_score: 0.635205 Time: 144.88
Run: 26 train loss: 99.438382 Time: 317.77
Run: 26 VAL ap_score: 0.585529 map_score: 0.632369 Time: 145.50
Run: 27 train loss: 99.288874 Time: 321.14
Run: 27 VAL ap_score: 0.594414 map_score: 0.643503 Time: 141.01
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 28 train loss: 97.472505 Time: 326.94
Run: 28 VAL ap_score: 0.607448 map_score: 0.639199 Time: 136.33
Run: 29 train loss: 96.183563 Time: 317.48
Run: 29 VAL ap_score: 0.609570 map_score: 0.652057 Time: 148.68
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 30 train loss: 94.452668 Time: 323.41
Run: 30 VAL ap_score: 0.609843 map_score: 0.644181 Time: 135.02
Run: 31 train loss: 93.087448 Time: 331.16
Run: 31 VAL ap_score: 0.626636 map_score: 0.648660 Time: 135.32
Run: 32 train loss: 91.855484 Time: 330.49
Run: 32 VAL ap_score: 0.606993 map_score: 0.643476 Time: 142.23
Run: 33 train loss: 90.040068 Time: 315.89
Run: 33 VAL ap_score: 0.620322 map_score: 0.660577 Time: 144.93
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 34 train loss: 89.811604 Time: 334.65
Run: 34 VAL ap_score: 0.618958 map_score: 0.654671 Time: 134.78
Run: 35 train loss: 88.846798 Time: 328.28
Run: 35 VAL ap_score: 0.621979 map_score: 0.650552 Time: 143.37
Run: 36 train loss: 88.288074 Time: 328.29
Run: 36 VAL ap_score: 0.618991 map_score: 0.645779 Time: 142.31
Run: 37 train loss: 87.191155 Time: 309.45
Run: 37 VAL ap_score: 0.640265 map_score: 0.664850 Time: 143.56
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 38 train loss: 87.798135 Time: 332.50
Run: 38 VAL ap_score: 0.613847 map_score: 0.633077 Time: 139.63
Run: 39 train loss: 86.764107 Time: 320.33
Run: 39 VAL ap_score: 0.607221 map_score: 0.652685 Time: 142.90
Run: 40 train loss: 85.866375 Time: 326.87
Run: 40 VAL ap_score: 0.644802 map_score: 0.665596 Time: 145.51
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 41 train loss: 85.317636 Time: 325.39
Run: 41 VAL ap_score: 0.617338 map_score: 0.657104 Time: 138.74
Run: 42 train loss: 83.570487 Time: 333.51
Run: 42 VAL ap_score: 0.641684 map_score: 0.656853 Time: 148.40
Run: 43 train loss: 83.631707 Time: 320.11
Run: 43 VAL ap_score: 0.618856 map_score: 0.649932 Time: 136.73
Run: 44 train loss: 82.797607 Time: 328.30
Run: 44 VAL ap_score: 0.636888 map_score: 0.669606 Time: 146.07
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 45 train loss: 83.514456 Time: 322.01
Run: 45 VAL ap_score: 0.616563 map_score: 0.656024 Time: 134.02
Run: 46 train loss: 81.701315 Time: 326.84
Run: 46 VAL ap_score: 0.647544 map_score: 0.678027 Time: 146.16
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 47 train loss: 81.364574 Time: 324.37
Run: 47 VAL ap_score: 0.641677 map_score: 0.659065 Time: 136.46
Run: 48 train loss: 82.170101 Time: 325.11
Run: 48 VAL ap_score: 0.641584 map_score: 0.673016 Time: 141.16
Run: 49 train loss: 81.198875 Time: 332.52
Run: 49 VAL ap_score: 0.622819 map_score: 0.662294 Time: 136.70
Run: 50 train loss: 80.133529 Time: 317.76
Run: 50 VAL ap_score: 0.618300 map_score: 0.651718 Time: 139.89
Run: 51 train loss: 81.025686 Time: 333.32
Run: 51 VAL ap_score: 0.650884 map_score: 0.673262 Time: 135.26
Run: 52 train loss: 80.337646 Time: 320.54
Run: 52 VAL ap_score: 0.639561 map_score: 0.681651 Time: 140.99
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 53 train loss: 79.487065 Time: 329.15
Run: 53 VAL ap_score: 0.644666 map_score: 0.659496 Time: 150.59
Run: 54 train loss: 80.141117 Time: 320.85
Run: 54 VAL ap_score: 0.639420 map_score: 0.665197 Time: 140.64
Run: 55 train loss: 79.047443 Time: 329.92
Run: 55 VAL ap_score: 0.615800 map_score: 0.665248 Time: 145.45
Run: 56 train loss: 78.145437 Time: 315.50
Run: 56 VAL ap_score: 0.647701 map_score: 0.683201 Time: 144.11
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 57 train loss: 78.364561 Time: 320.42
Run: 57 VAL ap_score: 0.638922 map_score: 0.669522 Time: 143.79
Run: 58 train loss: 78.881392 Time: 321.26
Run: 58 VAL ap_score: 0.646231 map_score: 0.680835 Time: 133.24
Run: 59 train loss: 77.751888 Time: 328.71
Run: 59 VAL ap_score: 0.637160 map_score: 0.664746 Time: 144.71
Run: 60 train loss: 77.271184 Time: 325.77
Run: 60 VAL ap_score: 0.643049 map_score: 0.668776 Time: 142.22
Run: 61 train loss: 77.148595 Time: 316.97
Run: 61 VAL ap_score: 0.651074 map_score: 0.684085 Time: 144.01
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 62 train loss: 77.993151 Time: 333.91
Run: 62 VAL ap_score: 0.649318 map_score: 0.677542 Time: 133.61
Run: 63 train loss: 76.413505 Time: 323.94
Run: 63 VAL ap_score: 0.650746 map_score: 0.675467 Time: 143.01
Run: 64 train loss: 77.065722 Time: 321.20
Run: 64 VAL ap_score: 0.638304 map_score: 0.667862 Time: 147.58
Run: 65 train loss: 75.893046 Time: 317.73
Run: 65 VAL ap_score: 0.659846 map_score: 0.680648 Time: 134.16
Run: 66 train loss: 76.240832 Time: 334.10
Run: 66 VAL ap_score: 0.636060 map_score: 0.680211 Time: 141.15
Run: 67 train loss: 76.087408 Time: 318.46
Run: 67 VAL ap_score: 0.658863 map_score: 0.687484 Time: 139.97
saving best validated model to ./isonet_clean/bestValidationModels/isonet_ptc_mm_7762_2023-12-27_00:25:38.296678
Run: 68 train loss: 76.164505 Time: 320.84
Run: 68 VAL ap_score: 0.640705 map_score: 0.678715 Time: 144.69
Run: 69 train loss: 75.430541 Time: 325.31
Run: 69 VAL ap_score: 0.650138 map_score: 0.684367 Time: 136.44
Run: 70 train loss: 74.920414 Time: 328.43
Run: 70 VAL ap_score: 0.646680 map_score: 0.680907 Time: 147.98
Run: 71 train loss: 74.432591 Time: 321.73
Run: 71 VAL ap_score: 0.650609 map_score: 0.682076 Time: 144.08
Run: 72 train loss: 75.548882 Time: 318.92
Run: 72 VAL ap_score: 0.645763 map_score: 0.680760 Time: 141.20
