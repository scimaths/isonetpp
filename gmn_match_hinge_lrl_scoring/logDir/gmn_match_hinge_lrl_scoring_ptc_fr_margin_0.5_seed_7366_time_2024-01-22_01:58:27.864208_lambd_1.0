Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring
--TASK=gmn_match_hinge_lrl_scoring
--MARGIN=0.5
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring/initialModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
no. of params in model: 2498
Run: 0 train loss: 279.498076 Time: 559.59
Run: 0 VAL ap_score: 0.472598 map_score: 0.474393 Time: 191.48
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 1 train loss: 203.193206 Time: 551.93
Run: 1 VAL ap_score: 0.496910 map_score: 0.508585 Time: 189.39
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 2 train loss: 186.989383 Time: 553.88
Run: 2 VAL ap_score: 0.505170 map_score: 0.514864 Time: 190.97
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 3 train loss: 178.060479 Time: 558.79
Run: 3 VAL ap_score: 0.556983 map_score: 0.550471 Time: 188.44
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 4 train loss: 171.897086 Time: 557.75
Run: 4 VAL ap_score: 0.547086 map_score: 0.544106 Time: 193.09
Run: 5 train loss: 165.304679 Time: 555.24
Run: 5 VAL ap_score: 0.548473 map_score: 0.558924 Time: 190.83
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 6 train loss: 159.181849 Time: 555.65
Run: 6 VAL ap_score: 0.598155 map_score: 0.566561 Time: 189.79
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 7 train loss: 154.750429 Time: 552.93
Run: 7 VAL ap_score: 0.594624 map_score: 0.572388 Time: 191.83
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 8 train loss: 151.994251 Time: 552.78
Run: 8 VAL ap_score: 0.594538 map_score: 0.577648 Time: 190.32
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 9 train loss: 148.210582 Time: 552.28
Run: 9 VAL ap_score: 0.595792 map_score: 0.571227 Time: 194.24
Run: 10 train loss: 145.411897 Time: 549.91
Run: 10 VAL ap_score: 0.614319 map_score: 0.581462 Time: 189.98
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 11 train loss: 142.410490 Time: 549.58
Run: 11 VAL ap_score: 0.611923 map_score: 0.590734 Time: 193.77
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 12 train loss: 140.215072 Time: 554.10
Run: 12 VAL ap_score: 0.620808 map_score: 0.589570 Time: 192.68
Run: 13 train loss: 137.351244 Time: 553.04
Run: 13 VAL ap_score: 0.623236 map_score: 0.597344 Time: 194.21
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 14 train loss: 135.386087 Time: 549.99
Run: 14 VAL ap_score: 0.618654 map_score: 0.602962 Time: 196.49
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 15 train loss: 132.547942 Time: 552.56
Run: 15 VAL ap_score: 0.628855 map_score: 0.604616 Time: 194.89
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 16 train loss: 130.771235 Time: 551.28
Run: 16 VAL ap_score: 0.621402 map_score: 0.601711 Time: 193.61
Run: 17 train loss: 129.709217 Time: 550.57
Run: 17 VAL ap_score: 0.609603 map_score: 0.584740 Time: 194.60
Run: 18 train loss: 127.673162 Time: 554.58
Run: 18 VAL ap_score: 0.640548 map_score: 0.610889 Time: 194.90
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 19 train loss: 125.780153 Time: 548.48
Run: 19 VAL ap_score: 0.619528 map_score: 0.610369 Time: 196.89
Run: 20 train loss: 124.564960 Time: 555.81
Run: 20 VAL ap_score: 0.640011 map_score: 0.616043 Time: 197.74
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 21 train loss: 123.010095 Time: 552.18
Run: 21 VAL ap_score: 0.633191 map_score: 0.612116 Time: 194.26
Run: 22 train loss: 121.520325 Time: 548.03
Run: 22 VAL ap_score: 0.657272 map_score: 0.626978 Time: 197.55
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 23 train loss: 121.179704 Time: 547.66
Run: 23 VAL ap_score: 0.647030 map_score: 0.633927 Time: 194.87
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 24 train loss: 119.120083 Time: 551.05
Run: 24 VAL ap_score: 0.658581 map_score: 0.632778 Time: 198.81
Run: 25 train loss: 120.015788 Time: 553.06
Run: 25 VAL ap_score: 0.653942 map_score: 0.629969 Time: 196.60
Run: 26 train loss: 117.664650 Time: 553.24
Run: 26 VAL ap_score: 0.641462 map_score: 0.631625 Time: 197.74
Run: 27 train loss: 117.007124 Time: 550.96
Run: 27 VAL ap_score: 0.644692 map_score: 0.626257 Time: 197.79
Run: 28 train loss: 115.631719 Time: 552.22
Run: 28 VAL ap_score: 0.662864 map_score: 0.633504 Time: 200.33
Run: 29 train loss: 115.192378 Time: 550.35
Run: 29 VAL ap_score: 0.669030 map_score: 0.635509 Time: 197.45
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 30 train loss: 114.820428 Time: 551.34
Run: 30 VAL ap_score: 0.653951 map_score: 0.633654 Time: 197.06
Run: 31 train loss: 114.357462 Time: 550.02
Run: 31 VAL ap_score: 0.641955 map_score: 0.619203 Time: 197.58
Run: 32 train loss: 113.767966 Time: 549.59
Run: 32 VAL ap_score: 0.654669 map_score: 0.634904 Time: 197.11
Run: 33 train loss: 112.400001 Time: 551.26
Run: 33 VAL ap_score: 0.636023 map_score: 0.626251 Time: 200.01
Run: 34 train loss: 112.155506 Time: 551.65
Run: 34 VAL ap_score: 0.638951 map_score: 0.633164 Time: 199.14
Run: 35 train loss: 111.566003 Time: 551.38
Run: 35 VAL ap_score: 0.598509 map_score: 0.608472 Time: 198.58
Run: 36 train loss: 111.295780 Time: 548.98
Run: 36 VAL ap_score: 0.642369 map_score: 0.628610 Time: 198.38
Run: 37 train loss: 110.830778 Time: 548.78
Run: 37 VAL ap_score: 0.661644 map_score: 0.636916 Time: 197.87
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 38 train loss: 110.084280 Time: 547.61
Run: 38 VAL ap_score: 0.636759 map_score: 0.623938 Time: 198.09
Run: 39 train loss: 108.813482 Time: 549.70
Run: 39 VAL ap_score: 0.663289 map_score: 0.639809 Time: 199.05
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 40 train loss: 110.067959 Time: 551.33
Run: 40 VAL ap_score: 0.662986 map_score: 0.641717 Time: 198.62
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 41 train loss: 109.619596 Time: 553.13
Run: 41 VAL ap_score: 0.654322 map_score: 0.636027 Time: 198.90
Run: 42 train loss: 108.266816 Time: 554.78
Run: 42 VAL ap_score: 0.670516 map_score: 0.641025 Time: 200.06
Run: 43 train loss: 108.933324 Time: 548.81
Run: 43 VAL ap_score: 0.627735 map_score: 0.624831 Time: 198.44
Run: 44 train loss: 108.559796 Time: 551.08
Run: 44 VAL ap_score: 0.643172 map_score: 0.641813 Time: 200.29
Run: 45 train loss: 107.466729 Time: 553.88
Run: 45 VAL ap_score: 0.665877 map_score: 0.637334 Time: 197.67
Run: 46 train loss: 108.726441 Time: 552.03
Run: 46 VAL ap_score: 0.663863 map_score: 0.633828 Time: 198.55
Run: 47 train loss: 107.029313 Time: 550.29
Run: 47 VAL ap_score: 0.656030 map_score: 0.638490 Time: 198.09
Run: 48 train loss: 106.800722 Time: 552.78
Run: 48 VAL ap_score: 0.610986 map_score: 0.615434 Time: 200.65
Run: 49 train loss: 106.652180 Time: 557.18
Run: 49 VAL ap_score: 0.666087 map_score: 0.645782 Time: 200.55
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 50 train loss: 106.053072 Time: 564.59
Run: 50 VAL ap_score: 0.643056 map_score: 0.636690 Time: 198.06
Run: 51 train loss: 105.596790 Time: 559.29
Run: 51 VAL ap_score: 0.667017 map_score: 0.647911 Time: 199.68
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_fr_7366_2024-01-22_01:58:27.864208
Run: 52 train loss: 105.591172 Time: 568.13
Run: 52 VAL ap_score: 0.617121 map_score: 0.632836 Time: 203.02
Run: 53 train loss: 105.849649 Time: 549.09
Run: 53 VAL ap_score: 0.638082 map_score: 0.630161 Time: 199.65
Run: 54 train loss: 105.627544 Time: 558.60
Run: 54 VAL ap_score: 0.643096 map_score: 0.640969 Time: 199.47
Run: 55 train loss: 103.959331 Time: 551.03
Run: 55 VAL ap_score: 0.642254 map_score: 0.637076 Time: 197.98
Run: 56 train loss: 104.041251 Time: 550.84
Run: 56 VAL ap_score: 0.657192 map_score: 0.646033 Time: 197.04
Run: 57 train loss: 104.392179 Time: 548.09
Run: 57 VAL ap_score: 0.655892 map_score: 0.643933 Time: 197.41
Run: 58 train loss: 103.896228 Time: 549.80
Run: 58 VAL ap_score: 0.669797 map_score: 0.640834 Time: 197.41
Run: 59 train loss: 103.635383 Time: 550.17
Run: 59 VAL ap_score: 0.667393 map_score: 0.645458 Time: 200.20
