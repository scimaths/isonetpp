Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring
--TASK=gmn_match_hinge_lrl_scoring
--MARGIN=0.5
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring/initialModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
no. of params in model: 2498
Run: 0 train loss: 253.045047 Time: 452.96
Run: 0 VAL ap_score: 0.464929 map_score: 0.481954 Time: 150.22
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 1 train loss: 195.584135 Time: 451.22
Run: 1 VAL ap_score: 0.484536 map_score: 0.504067 Time: 150.30
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 2 train loss: 184.274921 Time: 451.87
Run: 2 VAL ap_score: 0.490258 map_score: 0.510946 Time: 151.01
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 3 train loss: 174.487041 Time: 452.62
Run: 3 VAL ap_score: 0.471159 map_score: 0.518235 Time: 150.25
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 4 train loss: 165.955689 Time: 451.46
Run: 4 VAL ap_score: 0.498278 map_score: 0.521779 Time: 151.37
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 5 train loss: 159.622441 Time: 450.37
Run: 5 VAL ap_score: 0.505051 map_score: 0.525360 Time: 151.04
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 6 train loss: 153.881877 Time: 449.98
Run: 6 VAL ap_score: 0.503288 map_score: 0.530302 Time: 151.67
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 7 train loss: 150.352934 Time: 449.10
Run: 7 VAL ap_score: 0.523258 map_score: 0.539373 Time: 151.72
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 8 train loss: 147.622986 Time: 450.34
Run: 8 VAL ap_score: 0.504603 map_score: 0.539501 Time: 152.06
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 9 train loss: 144.414111 Time: 449.57
Run: 9 VAL ap_score: 0.536375 map_score: 0.550152 Time: 151.95
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 10 train loss: 143.443208 Time: 449.01
Run: 10 VAL ap_score: 0.542646 map_score: 0.552251 Time: 152.55
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 11 train loss: 142.109263 Time: 450.38
Run: 11 VAL ap_score: 0.529374 map_score: 0.544597 Time: 152.46
Run: 12 train loss: 139.994357 Time: 451.85
Run: 12 VAL ap_score: 0.547775 map_score: 0.560755 Time: 152.18
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 13 train loss: 138.147038 Time: 449.85
Run: 13 VAL ap_score: 0.542563 map_score: 0.547422 Time: 151.64
Run: 14 train loss: 135.784205 Time: 450.51
Run: 14 VAL ap_score: 0.549225 map_score: 0.567527 Time: 152.42
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 15 train loss: 134.874547 Time: 450.99
Run: 15 VAL ap_score: 0.552992 map_score: 0.564197 Time: 152.51
Run: 16 train loss: 132.345834 Time: 451.44
Run: 16 VAL ap_score: 0.542210 map_score: 0.553348 Time: 152.20
Run: 17 train loss: 130.965032 Time: 451.36
Run: 17 VAL ap_score: 0.537591 map_score: 0.553693 Time: 153.35
Run: 18 train loss: 130.152719 Time: 451.45
Run: 18 VAL ap_score: 0.540653 map_score: 0.548828 Time: 152.48
Run: 19 train loss: 129.179021 Time: 450.38
Run: 19 VAL ap_score: 0.555825 map_score: 0.563629 Time: 152.92
Run: 20 train loss: 127.361593 Time: 451.05
Run: 20 VAL ap_score: 0.568193 map_score: 0.569657 Time: 152.61
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 21 train loss: 125.307543 Time: 451.01
Run: 21 VAL ap_score: 0.563235 map_score: 0.574455 Time: 153.23
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 22 train loss: 124.368291 Time: 451.26
Run: 22 VAL ap_score: 0.575422 map_score: 0.572318 Time: 151.93
Run: 23 train loss: 123.539277 Time: 451.18
Run: 23 VAL ap_score: 0.559977 map_score: 0.571440 Time: 152.84
Run: 24 train loss: 123.365224 Time: 449.62
Run: 24 VAL ap_score: 0.557975 map_score: 0.569256 Time: 151.38
Run: 25 train loss: 121.561935 Time: 449.26
Run: 25 VAL ap_score: 0.556602 map_score: 0.569673 Time: 151.32
Run: 26 train loss: 120.383740 Time: 448.56
Run: 26 VAL ap_score: 0.561261 map_score: 0.579895 Time: 151.55
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 27 train loss: 120.340711 Time: 451.13
Run: 27 VAL ap_score: 0.576082 map_score: 0.584592 Time: 152.16
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 28 train loss: 118.812639 Time: 448.99
Run: 28 VAL ap_score: 0.570651 map_score: 0.580033 Time: 150.89
Run: 29 train loss: 118.871164 Time: 452.42
Run: 29 VAL ap_score: 0.557749 map_score: 0.579344 Time: 151.81
Run: 30 train loss: 116.166304 Time: 451.18
Run: 30 VAL ap_score: 0.548707 map_score: 0.578196 Time: 150.81
Run: 31 train loss: 115.465297 Time: 451.20
Run: 31 VAL ap_score: 0.574291 map_score: 0.587313 Time: 150.90
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 32 train loss: 115.519625 Time: 451.46
Run: 32 VAL ap_score: 0.570864 map_score: 0.589487 Time: 150.66
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 33 train loss: 114.042579 Time: 451.52
Run: 33 VAL ap_score: 0.566682 map_score: 0.592857 Time: 150.78
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 34 train loss: 113.265746 Time: 451.42
Run: 34 VAL ap_score: 0.565260 map_score: 0.581002 Time: 150.44
Run: 35 train loss: 111.621720 Time: 447.31
Run: 35 VAL ap_score: 0.570373 map_score: 0.588281 Time: 149.97
Run: 36 train loss: 111.337540 Time: 447.17
Run: 36 VAL ap_score: 0.563914 map_score: 0.579573 Time: 150.50
Run: 37 train loss: 110.601866 Time: 446.89
Run: 37 VAL ap_score: 0.552012 map_score: 0.576998 Time: 150.50
Run: 38 train loss: 110.898588 Time: 447.01
Run: 38 VAL ap_score: 0.549123 map_score: 0.589360 Time: 150.81
Run: 39 train loss: 109.497236 Time: 446.98
Run: 39 VAL ap_score: 0.569964 map_score: 0.589003 Time: 151.51
Run: 40 train loss: 108.449391 Time: 446.60
Run: 40 VAL ap_score: 0.576926 map_score: 0.593714 Time: 151.70
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 41 train loss: 107.047179 Time: 445.78
Run: 41 VAL ap_score: 0.562681 map_score: 0.588994 Time: 151.31
Run: 42 train loss: 106.664442 Time: 446.10
Run: 42 VAL ap_score: 0.579459 map_score: 0.592453 Time: 151.16
Run: 43 train loss: 106.801978 Time: 446.36
Run: 43 VAL ap_score: 0.562442 map_score: 0.587864 Time: 151.30
Run: 44 train loss: 106.340805 Time: 447.03
Run: 44 VAL ap_score: 0.555166 map_score: 0.575592 Time: 150.91
Run: 45 train loss: 105.391169 Time: 445.65
Run: 45 VAL ap_score: 0.525534 map_score: 0.582394 Time: 150.90
Run: 46 train loss: 105.481282 Time: 447.89
Run: 46 VAL ap_score: 0.584356 map_score: 0.597389 Time: 150.71
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 47 train loss: 104.552092 Time: 448.38
Run: 47 VAL ap_score: 0.562648 map_score: 0.581734 Time: 151.41
Run: 48 train loss: 104.502703 Time: 446.80
Run: 48 VAL ap_score: 0.578854 map_score: 0.586796 Time: 150.59
Run: 49 train loss: 103.685170 Time: 448.08
Run: 49 VAL ap_score: 0.575503 map_score: 0.592871 Time: 151.77
Run: 50 train loss: 103.752658 Time: 451.99
Run: 50 VAL ap_score: 0.572673 map_score: 0.596638 Time: 151.50
Run: 51 train loss: 103.653291 Time: 450.77
Run: 51 VAL ap_score: 0.588767 map_score: 0.597006 Time: 151.95
Run: 52 train loss: 103.377969 Time: 452.22
Run: 52 VAL ap_score: 0.563075 map_score: 0.593409 Time: 151.71
Run: 53 train loss: 102.981741 Time: 450.63
Run: 53 VAL ap_score: 0.574816 map_score: 0.605186 Time: 150.70
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 54 train loss: 102.113199 Time: 451.81
Run: 54 VAL ap_score: 0.581378 map_score: 0.591094 Time: 151.89
Run: 55 train loss: 102.047555 Time: 456.05
Run: 55 VAL ap_score: 0.583814 map_score: 0.607046 Time: 151.90
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 56 train loss: 101.181619 Time: 455.79
Run: 56 VAL ap_score: 0.589828 map_score: 0.602790 Time: 151.11
Run: 57 train loss: 101.305584 Time: 454.24
Run: 57 VAL ap_score: 0.572111 map_score: 0.602828 Time: 150.71
Run: 58 train loss: 100.522851 Time: 542.56
Run: 58 VAL ap_score: 0.580803 map_score: 0.604897 Time: 202.09
Run: 59 train loss: 100.850791 Time: 576.23
Run: 59 VAL ap_score: 0.579849 map_score: 0.589164 Time: 200.80
Run: 60 train loss: 100.340492 Time: 523.83
Run: 60 VAL ap_score: 0.580599 map_score: 0.600530 Time: 153.23
Run: 61 train loss: 98.865629 Time: 461.62
Run: 61 VAL ap_score: 0.574635 map_score: 0.597032 Time: 154.76
Run: 62 train loss: 99.278517 Time: 467.31
Run: 62 VAL ap_score: 0.604156 map_score: 0.609459 Time: 151.54
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 63 train loss: 99.668163 Time: 462.59
Run: 63 VAL ap_score: 0.558108 map_score: 0.593920 Time: 155.88
Run: 64 train loss: 98.634938 Time: 468.56
Run: 64 VAL ap_score: 0.590683 map_score: 0.607477 Time: 157.37
Run: 65 train loss: 97.015020 Time: 448.54
Run: 65 VAL ap_score: 0.589315 map_score: 0.599917 Time: 151.83
Run: 66 train loss: 98.433699 Time: 447.73
Run: 66 VAL ap_score: 0.594279 map_score: 0.610728 Time: 153.13
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 67 train loss: 97.508112 Time: 451.02
Run: 67 VAL ap_score: 0.570070 map_score: 0.584805 Time: 151.62
Run: 68 train loss: 97.744499 Time: 445.75
Run: 68 VAL ap_score: 0.573495 map_score: 0.597760 Time: 153.16
Run: 69 train loss: 97.267419 Time: 445.48
Run: 69 VAL ap_score: 0.578229 map_score: 0.612348 Time: 151.92
saving best validated model to ./gmn_match_hinge_lrl_scoring/bestValidationModels/gmn_match_hinge_lrl_scoring_ptc_mm_7762_2024-01-22_01:58:58.016311
Run: 70 train loss: 96.480395 Time: 446.67
Run: 70 VAL ap_score: 0.579846 map_score: 0.598973 Time: 152.31
Run: 71 train loss: 96.492108 Time: 446.21
Run: 71 VAL ap_score: 0.583654 map_score: 0.608253 Time: 151.31
Run: 72 train loss: 96.238801 Time: 446.04
Run: 72 VAL ap_score: 0.579169 map_score: 0.608803 Time: 151.50
Run: 73 train loss: 96.024043 Time: 446.12
Run: 73 VAL ap_score: 0.573000 map_score: 0.609621 Time: 151.08
