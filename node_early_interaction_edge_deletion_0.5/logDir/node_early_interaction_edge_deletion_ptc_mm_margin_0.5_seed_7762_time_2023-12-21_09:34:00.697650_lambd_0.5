Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=node_early_interaction_edge_deletion_0.5
--TASK=node_early_interaction_edge_deletion
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--lambd=0.5
--DATASET_NAME=ptc_mm
--SEED=3
fringe_isonet= {'masking_for_msg_passing_count': 4}
edge_early_interaction= {'hidden_dim': 30}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_edge_deletion= {'lambd': 0.5}
loading train query graphs from ./Datasets/splits/train/train_ptc_mm80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_mm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mm80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_mm80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_mm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_mm80k_corpus_subgraphs.pkl
Loading model node_early_interaction_edge_deletion
saving initial model to ./node_early_interaction_edge_deletion_0.5/initialModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
no. of params in model: 2498
Run: 0 train loss: 115.771216 Time: 157.18
Run: 0 VAL ap_score: 0.433455 map_score: 0.478036 Time: 69.24
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 1 train loss: 44.333872 Time: 151.81
Run: 1 VAL ap_score: 0.583622 map_score: 0.605176 Time: 68.95
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 2 train loss: 34.433652 Time: 152.29
Run: 2 VAL ap_score: 0.614415 map_score: 0.668916 Time: 67.36
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 3 train loss: 25.667774 Time: 151.79
Run: 3 VAL ap_score: 0.653860 map_score: 0.708856 Time: 67.88
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 4 train loss: 20.728701 Time: 153.43
Run: 4 VAL ap_score: 0.711566 map_score: 0.780611 Time: 66.22
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 5 train loss: 17.156533 Time: 152.76
Run: 5 VAL ap_score: 0.677306 map_score: 0.742406 Time: 66.57
Run: 6 train loss: 15.703507 Time: 153.78
Run: 6 VAL ap_score: 0.775148 map_score: 0.822605 Time: 66.50
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 7 train loss: 14.597908 Time: 154.00
Run: 7 VAL ap_score: 0.764803 map_score: 0.787203 Time: 67.04
Run: 8 train loss: 13.368987 Time: 153.93
Run: 8 VAL ap_score: 0.778036 map_score: 0.828319 Time: 65.62
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 9 train loss: 12.643466 Time: 154.43
Run: 9 VAL ap_score: 0.812383 map_score: 0.833147 Time: 66.09
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 10 train loss: 11.676067 Time: 152.14
Run: 10 VAL ap_score: 0.790736 map_score: 0.805750 Time: 66.97
Run: 11 train loss: 11.412884 Time: 153.65
Run: 11 VAL ap_score: 0.778725 map_score: 0.797182 Time: 65.92
Run: 12 train loss: 10.583136 Time: 154.60
Run: 12 VAL ap_score: 0.832360 map_score: 0.840278 Time: 65.42
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 13 train loss: 10.329834 Time: 155.05
Run: 13 VAL ap_score: 0.788244 map_score: 0.810067 Time: 64.58
Run: 14 train loss: 10.434254 Time: 155.46
Run: 14 VAL ap_score: 0.808526 map_score: 0.827169 Time: 65.51
Run: 15 train loss: 9.302606 Time: 154.81
Run: 15 VAL ap_score: 0.815978 map_score: 0.833415 Time: 65.83
Run: 16 train loss: 9.388246 Time: 153.46
Run: 16 VAL ap_score: 0.801022 map_score: 0.832107 Time: 65.28
Run: 17 train loss: 8.951344 Time: 153.24
Run: 17 VAL ap_score: 0.819472 map_score: 0.836407 Time: 65.56
Run: 18 train loss: 9.201798 Time: 153.43
Run: 18 VAL ap_score: 0.806891 map_score: 0.833808 Time: 65.38
Run: 19 train loss: 7.725953 Time: 154.42
Run: 19 VAL ap_score: 0.830503 map_score: 0.856215 Time: 65.52
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 20 train loss: 7.636958 Time: 153.05
Run: 20 VAL ap_score: 0.783297 map_score: 0.822503 Time: 65.84
Run: 21 train loss: 7.549742 Time: 153.69
Run: 21 VAL ap_score: 0.848091 map_score: 0.857663 Time: 65.63
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 22 train loss: 7.650268 Time: 152.65
Run: 22 VAL ap_score: 0.859654 map_score: 0.876554 Time: 69.30
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 23 train loss: 6.709823 Time: 169.52
Run: 23 VAL ap_score: 0.852931 map_score: 0.875350 Time: 73.00
Run: 24 train loss: 6.528896 Time: 167.51
Run: 24 VAL ap_score: 0.873342 map_score: 0.880852 Time: 76.84
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 25 train loss: 6.451037 Time: 164.46
Run: 25 VAL ap_score: 0.886868 map_score: 0.892103 Time: 77.04
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 26 train loss: 6.237798 Time: 163.80
Run: 26 VAL ap_score: 0.866379 map_score: 0.873719 Time: 76.92
Run: 27 train loss: 5.917860 Time: 169.75
Run: 27 VAL ap_score: 0.890163 map_score: 0.885125 Time: 75.71
Run: 28 train loss: 5.991363 Time: 171.56
Run: 28 VAL ap_score: 0.880873 map_score: 0.883115 Time: 74.82
Run: 29 train loss: 5.579568 Time: 167.89
Run: 29 VAL ap_score: 0.844837 map_score: 0.855767 Time: 77.48
Run: 30 train loss: 5.338931 Time: 162.93
Run: 30 VAL ap_score: 0.901485 map_score: 0.894025 Time: 78.23
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 31 train loss: 5.537993 Time: 163.74
Run: 31 VAL ap_score: 0.875793 map_score: 0.881621 Time: 78.53
Run: 32 train loss: 5.366859 Time: 166.21
Run: 32 VAL ap_score: 0.849226 map_score: 0.865923 Time: 75.02
Run: 33 train loss: 5.230502 Time: 166.14
Run: 33 VAL ap_score: 0.887023 map_score: 0.879177 Time: 77.05
Run: 34 train loss: 5.126004 Time: 164.81
Run: 34 VAL ap_score: 0.896305 map_score: 0.890906 Time: 78.52
Run: 35 train loss: 4.871905 Time: 161.47
Run: 35 VAL ap_score: 0.899231 map_score: 0.892815 Time: 78.74
Run: 36 train loss: 4.601214 Time: 162.66
Run: 36 VAL ap_score: 0.912007 map_score: 0.899936 Time: 77.95
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 37 train loss: 4.661969 Time: 168.76
Run: 37 VAL ap_score: 0.913747 map_score: 0.895896 Time: 74.81
Run: 38 train loss: 4.902322 Time: 170.20
Run: 38 VAL ap_score: 0.909598 map_score: 0.897581 Time: 77.18
Run: 39 train loss: 4.472226 Time: 167.22
Run: 39 VAL ap_score: 0.902518 map_score: 0.888977 Time: 78.10
Run: 40 train loss: 4.537751 Time: 167.22
Run: 40 VAL ap_score: 0.888859 map_score: 0.882461 Time: 78.43
Run: 41 train loss: 3.930871 Time: 169.48
Run: 41 VAL ap_score: 0.892190 map_score: 0.882813 Time: 76.58
Run: 42 train loss: 4.295927 Time: 172.40
Run: 42 VAL ap_score: 0.903593 map_score: 0.893495 Time: 74.79
Run: 43 train loss: 4.529267 Time: 171.60
Run: 43 VAL ap_score: 0.894659 map_score: 0.883510 Time: 77.45
Run: 44 train loss: 4.044222 Time: 169.71
Run: 44 VAL ap_score: 0.901704 map_score: 0.902749 Time: 77.01
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 45 train loss: 3.806249 Time: 167.74
Run: 45 VAL ap_score: 0.898081 map_score: 0.900263 Time: 76.36
Run: 46 train loss: 3.973739 Time: 170.10
Run: 46 VAL ap_score: 0.879055 map_score: 0.884049 Time: 74.56
Run: 47 train loss: 4.053922 Time: 174.49
Run: 47 VAL ap_score: 0.878570 map_score: 0.886990 Time: 71.57
Run: 48 train loss: 3.984171 Time: 175.06
Run: 48 VAL ap_score: 0.892847 map_score: 0.885485 Time: 74.70
Run: 49 train loss: 3.569004 Time: 170.48
Run: 49 VAL ap_score: 0.872887 map_score: 0.873930 Time: 74.29
Run: 50 train loss: 3.719518 Time: 171.32
Run: 50 VAL ap_score: 0.886484 map_score: 0.888527 Time: 74.31
Run: 51 train loss: 3.706676 Time: 173.14
Run: 51 VAL ap_score: 0.905951 map_score: 0.912501 Time: 71.93
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 52 train loss: 3.574822 Time: 174.71
Run: 52 VAL ap_score: 0.860623 map_score: 0.864625 Time: 70.26
Run: 53 train loss: 3.581234 Time: 174.72
Run: 53 VAL ap_score: 0.900927 map_score: 0.911160 Time: 73.28
Run: 54 train loss: 3.173372 Time: 171.59
Run: 54 VAL ap_score: 0.892836 map_score: 0.889193 Time: 74.08
Run: 55 train loss: 3.279429 Time: 174.55
Run: 55 VAL ap_score: 0.912718 map_score: 0.914134 Time: 73.76
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 56 train loss: 3.398110 Time: 175.03
Run: 56 VAL ap_score: 0.904565 map_score: 0.914419 Time: 72.78
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 57 train loss: 3.509824 Time: 177.20
Run: 57 VAL ap_score: 0.901941 map_score: 0.902695 Time: 70.46
Run: 58 train loss: 3.354801 Time: 175.37
Run: 58 VAL ap_score: 0.913295 map_score: 0.914673 Time: 74.12
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 59 train loss: 3.056225 Time: 173.33
Run: 59 VAL ap_score: 0.906675 map_score: 0.921437 Time: 74.88
saving best validated model to ./node_early_interaction_edge_deletion_0.5/bestValidationModels/node_early_interaction_edge_deletion_ptc_mm_7762_2023-12-21_09:34:00.697650
Run: 60 train loss: 3.069736 Time: 171.11
Run: 60 VAL ap_score: 0.898102 map_score: 0.915172 Time: 76.24
Run: 61 train loss: 2.873336 Time: 171.54
Run: 61 VAL ap_score: 0.908066 map_score: 0.907986 Time: 75.12
Run: 62 train loss: 3.380811 Time: 174.80
Run: 62 VAL ap_score: 0.900025 map_score: 0.905856 Time: 73.55
Run: 63 train loss: 2.947098 Time: 173.88
Run: 63 VAL ap_score: 0.911226 map_score: 0.909532 Time: 77.79
Run: 64 train loss: 3.148902 Time: 170.55
Run: 64 VAL ap_score: 0.924316 map_score: 0.907056 Time: 78.86
Run: 65 train loss: 2.940510 Time: 166.37
Run: 65 VAL ap_score: 0.898518 map_score: 0.902919 Time: 78.93
Run: 66 train loss: 3.069542 Time: 168.26
Run: 66 VAL ap_score: 0.913466 map_score: 0.912025 Time: 77.35
Run: 67 train loss: 2.777332 Time: 168.00
Run: 67 VAL ap_score: 0.899255 map_score: 0.908839 Time: 79.13
Run: 68 train loss: 2.833225 Time: 166.54
Run: 68 VAL ap_score: 0.903820 map_score: 0.900861 Time: 81.25
Run: 69 train loss: 3.341663 Time: 165.95
Run: 69 VAL ap_score: 0.899058 map_score: 0.911275 Time: 81.92
Run: 70 train loss: 2.624114 Time: 166.49
Run: 70 VAL ap_score: 0.899762 map_score: 0.904500 Time: 81.60
Run: 71 train loss: 3.167849 Time: 166.62
Run: 71 VAL ap_score: 0.913983 map_score: 0.911210 Time: 78.34
Run: 72 train loss: 3.099974 Time: 169.33
Run: 72 VAL ap_score: 0.897485 map_score: 0.900861 Time: 80.89
Run: 73 train loss: 2.766777 Time: 166.93
Run: 73 VAL ap_score: 0.911365 map_score: 0.915400 Time: 81.37
Run: 74 train loss: 2.817597 Time: 165.15
Run: 74 VAL ap_score: 0.893835 map_score: 0.895849 Time: 79.77
Run: 75 train loss: 2.882277 Time: 165.73
Run: 75 VAL ap_score: 0.877165 map_score: 0.883001 Time: 79.29
Run: 76 train loss: 2.701189 Time: 168.50
Run: 76 VAL ap_score: 0.910747 map_score: 0.907150 Time: 75.72
Run: 77 train loss: 2.910886 Time: 170.05
Run: 77 VAL ap_score: 0.909980 map_score: 0.912693 Time: 78.49
Run: 78 train loss: 2.472455 Time: 165.54
Run: 78 VAL ap_score: 0.904858 map_score: 0.910325 Time: 79.33
Run: 79 train loss: 2.735497 Time: 166.70
Run: 79 VAL ap_score: 0.905391 map_score: 0.920475 Time: 80.22
Run: 80 train loss: 2.743933 Time: 168.28
Run: 80 VAL ap_score: 0.900689 map_score: 0.910098 Time: 79.16
Run: 81 train loss: 2.527177 Time: 171.31
Run: 81 VAL ap_score: 0.897241 map_score: 0.904402 Time: 76.45
Run: 82 train loss: 2.638217 Time: 169.18
Run: 82 VAL ap_score: 0.884924 map_score: 0.906489 Time: 78.20
Run: 83 train loss: 2.667704 Time: 169.32
Run: 83 VAL ap_score: 0.897662 map_score: 0.911005 Time: 80.20
Run: 84 train loss: 2.935018 Time: 166.17
Run: 84 VAL ap_score: 0.879242 map_score: 0.897146 Time: 80.23
Run: 85 train loss: 2.962631 Time: 165.57
Run: 85 VAL ap_score: 0.886280 map_score: 0.902479 Time: 79.19
Run: 86 train loss: 2.485063 Time: 169.22
Run: 86 VAL ap_score: 0.896145 map_score: 0.910453 Time: 77.07
Run: 87 train loss: 2.503742 Time: 168.59
Run: 87 VAL ap_score: 0.906742 map_score: 0.901123 Time: 76.69
Run: 88 train loss: 2.726125 Time: 169.46
Run: 88 VAL ap_score: 0.910921 map_score: 0.908453 Time: 76.27
Run: 89 train loss: 2.530475 Time: 169.64
Run: 89 VAL ap_score: 0.924065 map_score: 0.909848 Time: 75.25
Run: 90 train loss: 2.487372 Time: 168.52
Run: 90 VAL ap_score: 0.863349 map_score: 0.887992 Time: 75.05
Run: 91 train loss: 2.802265 Time: 173.21
Run: 91 VAL ap_score: 0.912942 map_score: 0.915572 Time: 73.87
Run: 92 train loss: 2.626504 Time: 172.55
Run: 92 VAL ap_score: 0.914307 map_score: 0.897127 Time: 73.71
Run: 93 train loss: 2.336206 Time: 172.03
Run: 93 VAL ap_score: 0.901525 map_score: 0.915029 Time: 76.70
Run: 94 train loss: 2.471083 Time: 168.75
Run: 94 VAL ap_score: 0.903706 map_score: 0.907817 Time: 76.18
Run: 95 train loss: 2.683314 Time: 168.88
Run: 95 VAL ap_score: 0.874168 map_score: 0.887993 Time: 76.97
Run: 96 train loss: 2.572708 Time: 170.86
Run: 96 VAL ap_score: 0.903979 map_score: 0.896619 Time: 74.01
Run: 97 train loss: 2.606101 Time: 173.70
Run: 97 VAL ap_score: 0.890017 map_score: 0.872780 Time: 74.94
Run: 98 train loss: 2.266853 Time: 169.80
Run: 98 VAL ap_score: 0.913570 map_score: 0.896132 Time: 76.81
Run: 99 train loss: 2.488026 Time: 168.53
Run: 99 VAL ap_score: 0.898105 map_score: 0.906340 Time: 76.80
Run: 100 train loss: 3.018068 Time: 169.94
Run: 100 VAL ap_score: 0.900603 map_score: 0.909011 Time: 77.27
Run: 101 train loss: 2.600920 Time: 171.29
Run: 101 VAL ap_score: 0.899770 map_score: 0.907445 Time: 74.17
Run: 102 train loss: 2.113769 Time: 173.67
Run: 102 VAL ap_score: 0.910717 map_score: 0.904226 Time: 73.29
Run: 103 train loss: 2.276909 Time: 172.42
Run: 103 VAL ap_score: 0.907863 map_score: 0.909558 Time: 74.97
Run: 104 train loss: 2.455117 Time: 169.06
Run: 104 VAL ap_score: 0.862549 map_score: 0.890089 Time: 74.49
Run: 105 train loss: 2.565191 Time: 169.45
Run: 105 VAL ap_score: 0.917436 map_score: 0.915148 Time: 74.04
Run: 106 train loss: 2.453070 Time: 170.64
Run: 106 VAL ap_score: 0.905113 map_score: 0.901012 Time: 71.43
Run: 107 train loss: 2.445104 Time: 171.71
Run: 107 VAL ap_score: 0.895856 map_score: 0.907099 Time: 70.01
Run: 108 train loss: 2.153588 Time: 173.52
Run: 108 VAL ap_score: 0.909569 map_score: 0.905236 Time: 72.74
Run: 109 train loss: 2.530956 Time: 172.02
Run: 109 VAL ap_score: 0.897164 map_score: 0.897999 Time: 72.85
Run: 110 train loss: 2.310813 Time: 173.29
Run: 110 VAL ap_score: 0.897251 map_score: 0.896016 Time: 72.23
