Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring_injective_attention
--TASK=gmn_match_hinge_lrl_scoring_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=mutag
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7474
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_mutag240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/mutag240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring_injective_attention/initialModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
no. of params in model: 2168
Run: 0 train loss: 326.716270 Time: 439.22
Run: 0 VAL ap_score: 0.413220 map_score: 0.416302 Time: 148.60
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 1 train loss: 295.360929 Time: 434.18
Run: 1 VAL ap_score: 0.373968 map_score: 0.447800 Time: 148.16
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 2 train loss: 272.574248 Time: 434.51
Run: 2 VAL ap_score: 0.415431 map_score: 0.458324 Time: 148.75
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 3 train loss: 226.338888 Time: 433.91
Run: 3 VAL ap_score: 0.509555 map_score: 0.564203 Time: 148.39
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 4 train loss: 203.421525 Time: 433.83
Run: 4 VAL ap_score: 0.504624 map_score: 0.584697 Time: 148.48
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 5 train loss: 181.628962 Time: 433.99
Run: 5 VAL ap_score: 0.591234 map_score: 0.610502 Time: 129.00
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 6 train loss: 167.249494 Time: 397.12
Run: 6 VAL ap_score: 0.558648 map_score: 0.596437 Time: 129.64
Run: 7 train loss: 157.928938 Time: 399.77
Run: 7 VAL ap_score: 0.602363 map_score: 0.618127 Time: 130.57
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 8 train loss: 146.623011 Time: 397.02
Run: 8 VAL ap_score: 0.578112 map_score: 0.605618 Time: 128.78
Run: 9 train loss: 139.618943 Time: 396.07
Run: 9 VAL ap_score: 0.621313 map_score: 0.630659 Time: 129.13
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 10 train loss: 136.962482 Time: 399.10
Run: 10 VAL ap_score: 0.625424 map_score: 0.624070 Time: 129.29
Run: 11 train loss: 130.562428 Time: 398.70
Run: 11 VAL ap_score: 0.629735 map_score: 0.648779 Time: 129.51
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 12 train loss: 127.353448 Time: 396.87
Run: 12 VAL ap_score: 0.607632 map_score: 0.640036 Time: 129.41
Run: 13 train loss: 123.380697 Time: 396.39
Run: 13 VAL ap_score: 0.635720 map_score: 0.649792 Time: 129.99
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 14 train loss: 120.831836 Time: 404.34
Run: 14 VAL ap_score: 0.601175 map_score: 0.650382 Time: 130.56
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 15 train loss: 118.770533 Time: 406.26
Run: 15 VAL ap_score: 0.628519 map_score: 0.663199 Time: 130.16
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 16 train loss: 115.850551 Time: 406.46
Run: 16 VAL ap_score: 0.613282 map_score: 0.662471 Time: 132.18
Run: 17 train loss: 115.849753 Time: 405.70
Run: 17 VAL ap_score: 0.597393 map_score: 0.657589 Time: 131.15
Run: 18 train loss: 114.034809 Time: 404.09
Run: 18 VAL ap_score: 0.620813 map_score: 0.647676 Time: 131.39
Run: 19 train loss: 111.391384 Time: 406.20
Run: 19 VAL ap_score: 0.604903 map_score: 0.663897 Time: 131.61
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 20 train loss: 108.766884 Time: 408.16
Run: 20 VAL ap_score: 0.598302 map_score: 0.658956 Time: 132.00
Run: 21 train loss: 110.067971 Time: 431.08
Run: 21 VAL ap_score: 0.627848 map_score: 0.679454 Time: 149.20
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 22 train loss: 107.746314 Time: 407.52
Run: 22 VAL ap_score: 0.609122 map_score: 0.668582 Time: 132.74
Run: 23 train loss: 106.746023 Time: 406.13
Run: 23 VAL ap_score: 0.649624 map_score: 0.673857 Time: 131.29
Run: 24 train loss: 105.618367 Time: 407.99
Run: 24 VAL ap_score: 0.620430 map_score: 0.687469 Time: 132.98
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 25 train loss: 105.544672 Time: 405.69
Run: 25 VAL ap_score: 0.607810 map_score: 0.668682 Time: 133.33
Run: 26 train loss: 103.763294 Time: 407.18
Run: 26 VAL ap_score: 0.631595 map_score: 0.628416 Time: 132.56
Run: 27 train loss: 103.491847 Time: 407.14
Run: 27 VAL ap_score: 0.629731 map_score: 0.662464 Time: 132.71
Run: 28 train loss: 102.419843 Time: 406.73
Run: 28 VAL ap_score: 0.593701 map_score: 0.672639 Time: 131.76
Run: 29 train loss: 101.245616 Time: 405.51
Run: 29 VAL ap_score: 0.615205 map_score: 0.659826 Time: 129.67
Run: 30 train loss: 101.743008 Time: 399.04
Run: 30 VAL ap_score: 0.621056 map_score: 0.672429 Time: 130.87
Run: 31 train loss: 100.064772 Time: 400.26
Run: 31 VAL ap_score: 0.610215 map_score: 0.659778 Time: 130.61
Run: 32 train loss: 98.340137 Time: 398.07
Run: 32 VAL ap_score: 0.638257 map_score: 0.688310 Time: 130.49
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 33 train loss: 99.617049 Time: 399.88
Run: 33 VAL ap_score: 0.611863 map_score: 0.672773 Time: 130.20
Run: 34 train loss: 95.998889 Time: 399.83
Run: 34 VAL ap_score: 0.616360 map_score: 0.668844 Time: 129.69
Run: 35 train loss: 96.367225 Time: 399.99
Run: 35 VAL ap_score: 0.615680 map_score: 0.680000 Time: 130.38
Run: 36 train loss: 95.559319 Time: 397.08
Run: 36 VAL ap_score: 0.577943 map_score: 0.687609 Time: 129.96
Run: 37 train loss: 93.459214 Time: 398.09
Run: 37 VAL ap_score: 0.659538 map_score: 0.696799 Time: 129.45
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 38 train loss: 92.778455 Time: 396.32
Run: 38 VAL ap_score: 0.644168 map_score: 0.698324 Time: 128.20
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 39 train loss: 92.465361 Time: 397.82
Run: 39 VAL ap_score: 0.614873 map_score: 0.693310 Time: 129.46
Run: 40 train loss: 92.102754 Time: 397.32
Run: 40 VAL ap_score: 0.645269 map_score: 0.686274 Time: 129.54
Run: 41 train loss: 90.703633 Time: 397.82
Run: 41 VAL ap_score: 0.619129 map_score: 0.692909 Time: 129.35
Run: 42 train loss: 91.260036 Time: 399.76
Run: 42 VAL ap_score: 0.635430 map_score: 0.702504 Time: 129.68
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 43 train loss: 88.027571 Time: 396.38
Run: 43 VAL ap_score: 0.617855 map_score: 0.699926 Time: 129.52
Run: 44 train loss: 87.613777 Time: 397.26
Run: 44 VAL ap_score: 0.654364 map_score: 0.707270 Time: 129.89
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_mutag_7474_2024-01-25_02:02:21.760673
Run: 45 train loss: 87.110088 Time: 400.96
Run: 45 VAL ap_score: 0.661955 map_score: 0.683797 Time: 129.18
Run: 46 train loss: 86.908492 Time: 396.55
Run: 46 VAL ap_score: 0.662521 map_score: 0.691072 Time: 128.87
Run: 47 train loss: 85.820904 Time: 397.96
Run: 47 VAL ap_score: 0.651280 map_score: 0.700871 Time: 129.70
Run: 48 train loss: 85.165219 Time: 396.20
Run: 48 VAL ap_score: 0.654903 map_score: 0.695167 Time: 129.52
Run: 49 train loss: 85.409750 Time: 396.69
Run: 49 VAL ap_score: 0.648920 map_score: 0.700950 Time: 129.25
Run: 50 train loss: 84.358296 Time: 398.96
Run: 50 VAL ap_score: 0.649051 map_score: 0.707163 Time: 129.14
Run: 51 train loss: 83.995381 Time: 396.45
Run: 51 VAL ap_score: 0.670133 map_score: 0.707256 Time: 128.73
Run: 52 train loss: 83.150248 Time: 396.32
Run: 52 VAL ap_score: 0.664141 map_score: 0.684916 Time: 129.30
Run: 53 train loss: 82.515336 Time: 394.95
Run: 53 VAL ap_score: 0.622253 map_score: 0.707039 Time: 129.51
Run: 54 train loss: 81.802073 Time: 398.52
Run: 54 VAL ap_score: 0.649821 map_score: 0.705430 Time: 129.04
Run: 55 train loss: 81.414302 Time: 397.00
Run: 55 VAL ap_score: 0.659698 map_score: 0.701733 Time: 128.77
Run: 56 train loss: 81.381261 Time: 396.34
Run: 56 VAL ap_score: 0.643631 map_score: 0.702420 Time: 129.80
