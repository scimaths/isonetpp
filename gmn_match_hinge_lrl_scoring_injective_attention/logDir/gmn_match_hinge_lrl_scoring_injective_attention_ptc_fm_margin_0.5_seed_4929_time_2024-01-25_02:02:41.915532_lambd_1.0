Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring_injective_attention
--TASK=gmn_match_hinge_lrl_scoring_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fm
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 4929
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fm240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring_injective_attention/initialModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
no. of params in model: 2168
Run: 0 train loss: 237.177918 Time: 435.55
Run: 0 VAL ap_score: 0.482813 map_score: 0.500087 Time: 154.69
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 1 train loss: 173.062285 Time: 480.88
Run: 1 VAL ap_score: 0.520344 map_score: 0.540942 Time: 149.90
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 2 train loss: 159.930383 Time: 426.86
Run: 2 VAL ap_score: 0.540138 map_score: 0.562146 Time: 149.19
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 3 train loss: 148.192444 Time: 433.20
Run: 3 VAL ap_score: 0.575668 map_score: 0.588634 Time: 153.96
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 4 train loss: 139.910913 Time: 436.35
Run: 4 VAL ap_score: 0.597686 map_score: 0.609812 Time: 154.67
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 5 train loss: 133.107453 Time: 440.93
Run: 5 VAL ap_score: 0.594220 map_score: 0.603065 Time: 148.14
Run: 6 train loss: 126.409597 Time: 441.83
Run: 6 VAL ap_score: 0.590173 map_score: 0.623946 Time: 154.49
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 7 train loss: 122.945376 Time: 442.15
Run: 7 VAL ap_score: 0.624303 map_score: 0.641403 Time: 149.95
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 8 train loss: 120.346683 Time: 439.96
Run: 8 VAL ap_score: 0.625455 map_score: 0.637253 Time: 154.06
Run: 9 train loss: 118.020273 Time: 442.72
Run: 9 VAL ap_score: 0.635948 map_score: 0.638434 Time: 150.16
Run: 10 train loss: 116.155354 Time: 439.53
Run: 10 VAL ap_score: 0.623336 map_score: 0.635426 Time: 154.85
Run: 11 train loss: 113.116672 Time: 442.48
Run: 11 VAL ap_score: 0.626565 map_score: 0.644656 Time: 150.26
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 12 train loss: 111.726557 Time: 440.18
Run: 12 VAL ap_score: 0.624639 map_score: 0.648875 Time: 154.62
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 13 train loss: 108.349802 Time: 444.37
Run: 13 VAL ap_score: 0.638414 map_score: 0.649228 Time: 152.68
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 14 train loss: 107.470120 Time: 477.03
Run: 14 VAL ap_score: 0.634944 map_score: 0.650817 Time: 156.03
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 15 train loss: 106.086887 Time: 441.14
Run: 15 VAL ap_score: 0.640957 map_score: 0.659934 Time: 150.50
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 16 train loss: 104.355294 Time: 436.66
Run: 16 VAL ap_score: 0.641399 map_score: 0.659568 Time: 155.30
Run: 17 train loss: 103.411447 Time: 449.77
Run: 17 VAL ap_score: 0.618806 map_score: 0.654967 Time: 155.86
Run: 18 train loss: 101.049284 Time: 444.78
Run: 18 VAL ap_score: 0.640370 map_score: 0.665520 Time: 156.83
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 19 train loss: 99.703416 Time: 446.61
Run: 19 VAL ap_score: 0.641861 map_score: 0.657056 Time: 155.18
Run: 20 train loss: 99.335488 Time: 445.38
Run: 20 VAL ap_score: 0.630992 map_score: 0.655103 Time: 158.05
Run: 21 train loss: 97.619475 Time: 452.38
Run: 21 VAL ap_score: 0.635433 map_score: 0.653502 Time: 156.96
Run: 22 train loss: 97.664153 Time: 444.00
Run: 22 VAL ap_score: 0.635661 map_score: 0.660561 Time: 158.46
Run: 23 train loss: 95.419266 Time: 446.86
Run: 23 VAL ap_score: 0.659603 map_score: 0.674920 Time: 155.56
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 24 train loss: 95.602987 Time: 442.30
Run: 24 VAL ap_score: 0.612332 map_score: 0.651839 Time: 155.99
Run: 25 train loss: 94.483254 Time: 481.33
Run: 25 VAL ap_score: 0.658417 map_score: 0.670124 Time: 152.00
Run: 26 train loss: 93.244136 Time: 434.98
Run: 26 VAL ap_score: 0.660613 map_score: 0.668145 Time: 152.04
Run: 27 train loss: 93.368324 Time: 434.77
Run: 27 VAL ap_score: 0.641300 map_score: 0.662717 Time: 155.70
Run: 28 train loss: 90.970741 Time: 436.38
Run: 28 VAL ap_score: 0.657825 map_score: 0.667442 Time: 155.11
Run: 29 train loss: 91.645018 Time: 441.13
Run: 29 VAL ap_score: 0.620064 map_score: 0.651844 Time: 154.92
Run: 30 train loss: 90.039213 Time: 435.55
Run: 30 VAL ap_score: 0.650116 map_score: 0.667225 Time: 155.57
Run: 31 train loss: 90.588806 Time: 441.83
Run: 31 VAL ap_score: 0.648874 map_score: 0.668224 Time: 155.57
Run: 32 train loss: 90.271378 Time: 434.49
Run: 32 VAL ap_score: 0.649573 map_score: 0.673290 Time: 155.38
Run: 33 train loss: 88.751243 Time: 441.59
Run: 33 VAL ap_score: 0.662953 map_score: 0.673275 Time: 155.95
Run: 34 train loss: 88.772686 Time: 435.41
Run: 34 VAL ap_score: 0.675163 map_score: 0.685022 Time: 154.83
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 35 train loss: 88.527600 Time: 440.76
Run: 35 VAL ap_score: 0.648410 map_score: 0.654911 Time: 155.10
Run: 36 train loss: 87.548035 Time: 464.20
Run: 36 VAL ap_score: 0.680694 map_score: 0.680874 Time: 150.09
Run: 37 train loss: 87.062877 Time: 432.04
Run: 37 VAL ap_score: 0.687744 map_score: 0.683109 Time: 150.46
Run: 38 train loss: 87.173820 Time: 432.12
Run: 38 VAL ap_score: 0.671596 map_score: 0.679183 Time: 155.79
Run: 39 train loss: 85.725949 Time: 440.87
Run: 39 VAL ap_score: 0.656707 map_score: 0.668010 Time: 155.47
Run: 40 train loss: 85.944494 Time: 434.77
Run: 40 VAL ap_score: 0.651624 map_score: 0.665045 Time: 138.45
Run: 41 train loss: 86.371643 Time: 395.49
Run: 41 VAL ap_score: 0.661163 map_score: 0.677775 Time: 133.57
Run: 42 train loss: 85.065692 Time: 394.55
Run: 42 VAL ap_score: 0.693984 map_score: 0.682001 Time: 134.42
Run: 43 train loss: 85.481138 Time: 396.85
Run: 43 VAL ap_score: 0.665062 map_score: 0.680943 Time: 134.06
Run: 44 train loss: 85.021945 Time: 396.99
Run: 44 VAL ap_score: 0.689448 map_score: 0.689461 Time: 133.96
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fm_4929_2024-01-25_02:02:41.915532
Run: 45 train loss: 85.219436 Time: 398.18
Run: 45 VAL ap_score: 0.671532 map_score: 0.681075 Time: 133.77
Run: 46 train loss: 83.829417 Time: 426.85
Run: 46 VAL ap_score: 0.671427 map_score: 0.675738 Time: 130.94
Run: 47 train loss: 83.905575 Time: 390.14
Run: 47 VAL ap_score: 0.687042 map_score: 0.687125 Time: 130.19
Run: 48 train loss: 83.519383 Time: 390.69
Run: 48 VAL ap_score: 0.688039 map_score: 0.685171 Time: 131.57
Run: 49 train loss: 83.249749 Time: 397.54
Run: 49 VAL ap_score: 0.698123 map_score: 0.688571 Time: 132.81
Run: 50 train loss: 83.875966 Time: 400.18
Run: 50 VAL ap_score: 0.657961 map_score: 0.678351 Time: 132.26
Run: 51 train loss: 83.290718 Time: 396.77
Run: 51 VAL ap_score: 0.683921 map_score: 0.685970 Time: 132.22
Run: 52 train loss: 82.388023 Time: 398.67
