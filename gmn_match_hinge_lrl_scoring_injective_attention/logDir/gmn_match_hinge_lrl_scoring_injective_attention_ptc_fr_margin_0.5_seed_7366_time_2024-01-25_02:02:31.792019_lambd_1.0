Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_lrl_scoring_injective_attention
--TASK=gmn_match_hinge_lrl_scoring_injective_attention
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--NOISE_FACTOR=0
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
graphsim= {'conv_kernel_size': [10, 4, 2], 'linear_size': [24, 16], 'gcn_size': [10, 10, 10], 'conv_pool_size': [3, 3, 2], 'conv_out_channels': [2, 4, 8], 'dropout': 0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge lrl_scoring
saving initial model to ./gmn_match_hinge_lrl_scoring_injective_attention/initialModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
no. of params in model: 2168
Run: 0 train loss: 266.564494 Time: 421.24
Run: 0 VAL ap_score: 0.476295 map_score: 0.489975 Time: 128.49
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 1 train loss: 214.116883 Time: 407.43
Run: 1 VAL ap_score: 0.459732 map_score: 0.482434 Time: 129.81
Run: 2 train loss: 198.213035 Time: 405.62
Run: 2 VAL ap_score: 0.514375 map_score: 0.512666 Time: 128.64
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 3 train loss: 183.485671 Time: 404.25
Run: 3 VAL ap_score: 0.521982 map_score: 0.523018 Time: 130.22
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 4 train loss: 176.628119 Time: 405.78
Run: 4 VAL ap_score: 0.559262 map_score: 0.556486 Time: 129.39
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 5 train loss: 169.291612 Time: 407.28
Run: 5 VAL ap_score: 0.532840 map_score: 0.550639 Time: 128.84
Run: 6 train loss: 161.936984 Time: 405.30
Run: 6 VAL ap_score: 0.572887 map_score: 0.568386 Time: 116.78
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 7 train loss: 157.037681 Time: 381.82
Run: 7 VAL ap_score: 0.589183 map_score: 0.579209 Time: 117.21
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 8 train loss: 150.887777 Time: 381.85
Run: 8 VAL ap_score: 0.596722 map_score: 0.592212 Time: 116.69
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 9 train loss: 145.686912 Time: 381.21
Run: 9 VAL ap_score: 0.582415 map_score: 0.588629 Time: 116.89
Run: 10 train loss: 142.428431 Time: 381.24
Run: 10 VAL ap_score: 0.614876 map_score: 0.597246 Time: 117.08
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 11 train loss: 137.639234 Time: 381.50
Run: 11 VAL ap_score: 0.621923 map_score: 0.606544 Time: 116.51
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 12 train loss: 134.023076 Time: 381.85
Run: 12 VAL ap_score: 0.621598 map_score: 0.610510 Time: 116.96
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 13 train loss: 129.469966 Time: 383.03
Run: 13 VAL ap_score: 0.620604 map_score: 0.608002 Time: 116.46
Run: 14 train loss: 126.920433 Time: 380.67
Run: 14 VAL ap_score: 0.626589 map_score: 0.628517 Time: 116.38
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 15 train loss: 123.320463 Time: 384.14
Run: 15 VAL ap_score: 0.645871 map_score: 0.630435 Time: 118.85
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 16 train loss: 121.882526 Time: 408.02
Run: 16 VAL ap_score: 0.634313 map_score: 0.623958 Time: 126.91
Run: 17 train loss: 118.266674 Time: 409.05
Run: 17 VAL ap_score: 0.650463 map_score: 0.635982 Time: 126.59
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 18 train loss: 116.973372 Time: 407.96
Run: 18 VAL ap_score: 0.645584 map_score: 0.633230 Time: 126.14
Run: 19 train loss: 115.661667 Time: 407.31
Run: 19 VAL ap_score: 0.667254 map_score: 0.648833 Time: 126.34
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 20 train loss: 113.827706 Time: 405.76
Run: 20 VAL ap_score: 0.628716 map_score: 0.615823 Time: 125.94
Run: 21 train loss: 111.733872 Time: 408.30
Run: 21 VAL ap_score: 0.655392 map_score: 0.642174 Time: 126.58
Run: 22 train loss: 110.884839 Time: 410.04
Run: 22 VAL ap_score: 0.651978 map_score: 0.642565 Time: 126.02
Run: 23 train loss: 109.316754 Time: 411.33
Run: 23 VAL ap_score: 0.662676 map_score: 0.640302 Time: 126.28
Run: 24 train loss: 107.138871 Time: 408.28
Run: 24 VAL ap_score: 0.669764 map_score: 0.648355 Time: 124.76
Run: 25 train loss: 106.086360 Time: 407.83
Run: 25 VAL ap_score: 0.664788 map_score: 0.647968 Time: 125.65
Run: 26 train loss: 103.955854 Time: 409.36
Run: 26 VAL ap_score: 0.679373 map_score: 0.655462 Time: 125.73
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 27 train loss: 102.761519 Time: 410.69
Run: 27 VAL ap_score: 0.684343 map_score: 0.661313 Time: 125.94
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 28 train loss: 102.148274 Time: 406.62
Run: 28 VAL ap_score: 0.679358 map_score: 0.651865 Time: 124.06
Run: 29 train loss: 100.483389 Time: 405.02
Run: 29 VAL ap_score: 0.687769 map_score: 0.657866 Time: 123.66
Run: 30 train loss: 99.584820 Time: 405.20
Run: 30 VAL ap_score: 0.671956 map_score: 0.661191 Time: 124.33
Run: 31 train loss: 97.932306 Time: 400.57
Run: 31 VAL ap_score: 0.683527 map_score: 0.662415 Time: 122.09
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 32 train loss: 96.995287 Time: 397.53
Run: 32 VAL ap_score: 0.696502 map_score: 0.669425 Time: 122.11
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 33 train loss: 95.583700 Time: 399.12
Run: 33 VAL ap_score: 0.687876 map_score: 0.665345 Time: 121.59
Run: 34 train loss: 95.299154 Time: 396.14
Run: 34 VAL ap_score: 0.690545 map_score: 0.669673 Time: 121.79
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 35 train loss: 93.220918 Time: 398.21
Run: 35 VAL ap_score: 0.689225 map_score: 0.669002 Time: 121.81
Run: 36 train loss: 93.082881 Time: 397.33
Run: 36 VAL ap_score: 0.701001 map_score: 0.675092 Time: 123.09
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 37 train loss: 91.962700 Time: 399.68
Run: 37 VAL ap_score: 0.680748 map_score: 0.665410 Time: 122.46
Run: 38 train loss: 91.640179 Time: 397.76
Run: 38 VAL ap_score: 0.710255 map_score: 0.688742 Time: 122.36
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 39 train loss: 90.820463 Time: 396.90
Run: 39 VAL ap_score: 0.690810 map_score: 0.668548 Time: 122.62
Run: 40 train loss: 90.277526 Time: 397.11
Run: 40 VAL ap_score: 0.686453 map_score: 0.672714 Time: 121.30
Run: 41 train loss: 89.221393 Time: 398.08
Run: 41 VAL ap_score: 0.703012 map_score: 0.675477 Time: 122.27
Run: 42 train loss: 89.311157 Time: 398.20
Run: 42 VAL ap_score: 0.704549 map_score: 0.677469 Time: 122.23
Run: 43 train loss: 88.707805 Time: 398.25
Run: 43 VAL ap_score: 0.683571 map_score: 0.663601 Time: 121.37
Run: 44 train loss: 88.072313 Time: 398.51
Run: 44 VAL ap_score: 0.706193 map_score: 0.684909 Time: 122.13
Run: 45 train loss: 87.769201 Time: 395.97
Run: 45 VAL ap_score: 0.706684 map_score: 0.689968 Time: 122.20
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 46 train loss: 87.865327 Time: 397.65
Run: 46 VAL ap_score: 0.711881 map_score: 0.685994 Time: 122.01
Run: 47 train loss: 87.791990 Time: 397.40
Run: 47 VAL ap_score: 0.708700 map_score: 0.678990 Time: 122.36
Run: 48 train loss: 87.019652 Time: 398.36
Run: 48 VAL ap_score: 0.687645 map_score: 0.673897 Time: 121.77
Run: 49 train loss: 86.562416 Time: 398.14
Run: 49 VAL ap_score: 0.711955 map_score: 0.689945 Time: 122.88
Run: 50 train loss: 86.757458 Time: 399.09
Run: 50 VAL ap_score: 0.713775 map_score: 0.688159 Time: 122.66
Run: 51 train loss: 85.793378 Time: 398.95
Run: 51 VAL ap_score: 0.709639 map_score: 0.689849 Time: 122.39
Run: 52 train loss: 84.596708 Time: 397.24
Run: 52 VAL ap_score: 0.713620 map_score: 0.687323 Time: 122.79
Run: 53 train loss: 85.280452 Time: 395.99
Run: 53 VAL ap_score: 0.693379 map_score: 0.681939 Time: 121.79
Run: 54 train loss: 85.408417 Time: 396.23
Run: 54 VAL ap_score: 0.666244 map_score: 0.671601 Time: 122.26
Run: 55 train loss: 84.317781 Time: 399.42
Run: 55 VAL ap_score: 0.715576 map_score: 0.684250 Time: 121.56
Run: 56 train loss: 84.061971 Time: 402.33
Run: 56 VAL ap_score: 0.714180 map_score: 0.693269 Time: 121.77
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
Run: 57 train loss: 83.161113 Time: 397.65
Run: 57 VAL ap_score: 0.670464 map_score: 0.673522 Time: 121.86
Run: 58 train loss: 83.185207 Time: 399.81
Run: 58 VAL ap_score: 0.707118 map_score: 0.696142 Time: 123.18
saving best validated model to ./gmn_match_hinge_lrl_scoring_injective_attention/bestValidationModels/gmn_match_hinge_lrl_scoring_injective_attention_ptc_fr_7366_2024-01-25_02:02:31.792019
