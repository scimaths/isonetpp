Command line
/mnt/home/ashwinr/btp24/grph/gitlab_repo/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_with_delete_edge_lambd_0.5
--TASK=edge_early_interaction_delete
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fm
--lambd=0.5
--SEED=1
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 0.5}
edge_early_interaction_delete= {'lambd': 0.5}
loading train query graphs from ./Datasets/splits/train/train_ptc_fm80k_query_subgraphs.pkl
loading train relationships from ./Datasets/splits/train/train_ptc_fm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fm80k_corpus_subgraphs.pkl
loading val query graphs from ./Datasets/splits/val/val_ptc_fm80k_query_subgraphs.pkl
loading val relationships from ./Datasets/splits/val/val_ptc_fm80k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./Datasets/splits/ptc_fm80k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteractionDelete
This model implements early interaction for edges delete
saving initial model to ./edge_early_with_delete_edge_lambd_0.5/initialModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
no. of params in model: 3730
Run: 0 train loss: 114.461322 Time: 557.30
Run: 0 VAL ap_score: 0.779037 map_score: 0.718965 Time: 340.84
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 1 train loss: 50.238136 Time: 1014.74
Run: 1 VAL ap_score: 0.819886 map_score: 0.763823 Time: 385.65
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 2 train loss: 40.239499 Time: 1002.06
Run: 2 VAL ap_score: 0.835292 map_score: 0.784307 Time: 365.91
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 3 train loss: 32.978036 Time: 1017.20
Run: 3 VAL ap_score: 0.862119 map_score: 0.810899 Time: 379.83
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 4 train loss: 25.692408 Time: 1044.08
Run: 4 VAL ap_score: 0.877166 map_score: 0.826305 Time: 375.47
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 5 train loss: 20.015604 Time: 1035.02
Run: 5 VAL ap_score: 0.894879 map_score: 0.856508 Time: 375.95
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 6 train loss: 17.791927 Time: 1037.44
Run: 6 VAL ap_score: 0.885183 map_score: 0.837138 Time: 358.57
Run: 7 train loss: 16.336225 Time: 1045.53
Run: 7 VAL ap_score: 0.901350 map_score: 0.849993 Time: 364.95
Run: 8 train loss: 15.025792 Time: 1034.46
Run: 8 VAL ap_score: 0.915165 map_score: 0.873914 Time: 372.65
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 9 train loss: 14.206808 Time: 1038.98
Run: 9 VAL ap_score: 0.912782 map_score: 0.873416 Time: 358.01
Run: 10 train loss: 14.383566 Time: 1036.57
Run: 10 VAL ap_score: 0.918325 map_score: 0.876055 Time: 379.42
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 11 train loss: 12.957758 Time: 1025.42
Run: 11 VAL ap_score: 0.928875 map_score: 0.885350 Time: 377.10
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 12 train loss: 12.960850 Time: 1055.27
Run: 12 VAL ap_score: 0.932778 map_score: 0.908455 Time: 364.26
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 13 train loss: 11.938471 Time: 1041.39
Run: 13 VAL ap_score: 0.906804 map_score: 0.861057 Time: 363.36
Run: 14 train loss: 11.356384 Time: 1031.93
Run: 14 VAL ap_score: 0.916329 map_score: 0.879870 Time: 364.39
Run: 15 train loss: 10.565635 Time: 1034.20
Run: 15 VAL ap_score: 0.924174 map_score: 0.891563 Time: 357.00
Run: 16 train loss: 10.131054 Time: 1015.94
Run: 16 VAL ap_score: 0.928221 map_score: 0.914448 Time: 372.58
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 17 train loss: 9.662934 Time: 1049.67
Run: 17 VAL ap_score: 0.927242 map_score: 0.880713 Time: 366.60
Run: 18 train loss: 9.015843 Time: 1064.01
Run: 18 VAL ap_score: 0.948744 map_score: 0.926308 Time: 358.10
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 19 train loss: 9.300803 Time: 1035.97
Run: 19 VAL ap_score: 0.926020 map_score: 0.893344 Time: 363.64
Run: 20 train loss: 8.684563 Time: 1022.38
Run: 20 VAL ap_score: 0.946211 map_score: 0.924179 Time: 380.58
Run: 21 train loss: 8.474258 Time: 1036.06
Run: 21 VAL ap_score: 0.929042 map_score: 0.899094 Time: 371.87
Run: 22 train loss: 7.908710 Time: 1010.05
Run: 22 VAL ap_score: 0.950418 map_score: 0.932066 Time: 371.71
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 23 train loss: 7.264451 Time: 991.32
Run: 23 VAL ap_score: 0.949092 map_score: 0.928053 Time: 374.61
Run: 24 train loss: 7.175380 Time: 1012.70
Run: 24 VAL ap_score: 0.947820 map_score: 0.927678 Time: 377.87
Run: 25 train loss: 6.448596 Time: 1015.76
Run: 25 VAL ap_score: 0.940297 map_score: 0.918882 Time: 375.66
Run: 26 train loss: 7.264976 Time: 1042.47
Run: 26 VAL ap_score: 0.952228 map_score: 0.933616 Time: 383.64
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 27 train loss: 5.411527 Time: 1061.23
Run: 27 VAL ap_score: 0.951599 map_score: 0.941183 Time: 377.38
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 28 train loss: 7.537460 Time: 1070.50
Run: 28 VAL ap_score: 0.948903 map_score: 0.937295 Time: 385.75
Run: 29 train loss: 7.326145 Time: 1047.20
Run: 29 VAL ap_score: 0.949984 map_score: 0.932452 Time: 390.56
Run: 30 train loss: 5.088052 Time: 1100.18
Run: 30 VAL ap_score: 0.956980 map_score: 0.944535 Time: 361.77
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 31 train loss: 5.532723 Time: 1086.86
Run: 31 VAL ap_score: 0.956057 map_score: 0.938840 Time: 370.92
Run: 32 train loss: 4.985926 Time: 1031.64
Run: 32 VAL ap_score: 0.959709 map_score: 0.945417 Time: 379.70
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 33 train loss: 8.436695 Time: 1059.88
Run: 33 VAL ap_score: 0.909925 map_score: 0.853745 Time: 373.31
Run: 34 train loss: 6.461433 Time: 1070.58
Run: 34 VAL ap_score: 0.930581 map_score: 0.906766 Time: 375.07
Run: 35 train loss: 4.444431 Time: 1054.43
Run: 35 VAL ap_score: 0.951634 map_score: 0.936169 Time: 382.99
Run: 36 train loss: 5.776752 Time: 1092.08
Run: 36 VAL ap_score: 0.960112 map_score: 0.943262 Time: 362.99
Run: 37 train loss: 4.173156 Time: 1052.70
Run: 37 VAL ap_score: 0.958181 map_score: 0.940134 Time: 391.40
Run: 38 train loss: 4.471239 Time: 1054.77
Run: 38 VAL ap_score: 0.950034 map_score: 0.928799 Time: 380.12
Run: 39 train loss: 7.388769 Time: 1057.02
Run: 39 VAL ap_score: 0.947512 map_score: 0.912083 Time: 390.56
Run: 40 train loss: 4.554151 Time: 1104.68
Run: 40 VAL ap_score: 0.946289 map_score: 0.917569 Time: 396.12
Run: 41 train loss: 11.259768 Time: 1131.29
Run: 41 VAL ap_score: 0.931033 map_score: 0.913501 Time: 394.13
Run: 42 train loss: 5.725227 Time: 1098.38
Run: 42 VAL ap_score: 0.956131 map_score: 0.938143 Time: 395.73
Run: 43 train loss: 3.810334 Time: 1106.27
Run: 43 VAL ap_score: 0.959323 map_score: 0.942635 Time: 384.73
Run: 44 train loss: 3.466257 Time: 1110.02
Run: 44 VAL ap_score: 0.960706 map_score: 0.945618 Time: 394.93
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 45 train loss: 3.499965 Time: 1085.95
Run: 45 VAL ap_score: 0.958801 map_score: 0.943329 Time: 387.28
Run: 46 train loss: 3.921310 Time: 1089.92
Run: 46 VAL ap_score: 0.956990 map_score: 0.941674 Time: 390.21
Run: 47 train loss: 3.844856 Time: 1104.37
Run: 47 VAL ap_score: 0.923208 map_score: 0.902489 Time: 394.64
Run: 48 train loss: 3.926246 Time: 1121.89
Run: 48 VAL ap_score: 0.963475 map_score: 0.949441 Time: 396.07
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 49 train loss: 5.418955 Time: 1093.54
Run: 49 VAL ap_score: 0.952685 map_score: 0.934894 Time: 410.74
Run: 50 train loss: 3.800223 Time: 1090.70
Run: 50 VAL ap_score: 0.962944 map_score: 0.943714 Time: 403.40
Run: 51 train loss: 3.814302 Time: 1069.98
Run: 51 VAL ap_score: 0.956558 map_score: 0.944612 Time: 398.02
Run: 52 train loss: 4.181469 Time: 1097.95
Run: 52 VAL ap_score: 0.948673 map_score: 0.931437 Time: 395.59
Run: 53 train loss: 3.453718 Time: 1096.78
Run: 53 VAL ap_score: 0.959527 map_score: 0.941881 Time: 398.67
Run: 54 train loss: 3.539804 Time: 1109.43
Run: 54 VAL ap_score: 0.963973 map_score: 0.948444 Time: 404.91
Run: 55 train loss: 3.777101 Time: 1071.20
Run: 55 VAL ap_score: 0.955395 map_score: 0.940207 Time: 390.88
Run: 56 train loss: 6.419176 Time: 1106.88
Run: 56 VAL ap_score: 0.946748 map_score: 0.936328 Time: 387.52
Run: 57 train loss: 4.317229 Time: 1092.96
Run: 57 VAL ap_score: 0.963513 map_score: 0.947730 Time: 385.24
Run: 58 train loss: 3.028683 Time: 1123.36
Run: 58 VAL ap_score: 0.960925 map_score: 0.946081 Time: 389.38
Run: 59 train loss: 3.357990 Time: 1095.87
Run: 59 VAL ap_score: 0.955856 map_score: 0.942341 Time: 395.40
Run: 60 train loss: 4.765135 Time: 1082.83
Run: 60 VAL ap_score: 0.956038 map_score: 0.942023 Time: 388.73
Run: 61 train loss: 2.925160 Time: 1085.96
Run: 61 VAL ap_score: 0.956883 map_score: 0.936023 Time: 390.46
Run: 62 train loss: 3.694553 Time: 1088.74
Run: 62 VAL ap_score: 0.958257 map_score: 0.941597 Time: 391.12
Run: 63 train loss: 3.857572 Time: 1119.30
Run: 63 VAL ap_score: 0.964321 map_score: 0.956243 Time: 379.94
saving best validated model to ./edge_early_with_delete_edge_lambd_0.5/bestValidationModels/edge_early_interaction_delete_ptc_fm_7366_2023-12-23_17:56:34.517942
Run: 64 train loss: 4.976172 Time: 1107.75
Run: 64 VAL ap_score: 0.962766 map_score: 0.943476 Time: 393.15
Run: 65 train loss: 2.708183 Time: 1090.83
Run: 65 VAL ap_score: 0.965328 map_score: 0.945859 Time: 380.29
Run: 66 train loss: 5.827311 Time: 1116.77
Run: 66 VAL ap_score: 0.956800 map_score: 0.939638 Time: 383.99
Run: 67 train loss: 3.237357 Time: 1106.05
Run: 67 VAL ap_score: 0.967779 map_score: 0.954929 Time: 374.99
Run: 68 train loss: 2.621327 Time: 1095.51
Run: 68 VAL ap_score: 0.967949 map_score: 0.951439 Time: 384.36
Run: 69 train loss: 3.091863 Time: 1129.55
Run: 69 VAL ap_score: 0.936296 map_score: 0.899548 Time: 381.10
Run: 70 train loss: 5.932963 Time: 1126.92
Run: 70 VAL ap_score: 0.939359 map_score: 0.923119 Time: 371.43
Run: 71 train loss: 3.203599 Time: 1122.46
Run: 71 VAL ap_score: 0.951553 map_score: 0.932872 Time: 375.90
Run: 72 train loss: 2.662011 Time: 1131.74
Run: 72 VAL ap_score: 0.964937 map_score: 0.949305 Time: 379.44
Run: 73 train loss: 2.934870 Time: 1120.98
Run: 73 VAL ap_score: 0.964783 map_score: 0.947279 Time: 389.39
Run: 74 train loss: 6.299261 Time: 1107.03
Run: 74 VAL ap_score: 0.814752 map_score: 0.827678 Time: 380.62
Run: 75 train loss: 5.931858 Time: 1111.35
Run: 75 VAL ap_score: 0.964991 map_score: 0.949612 Time: 372.94
Run: 76 train loss: 3.029781 Time: 1119.81
Run: 76 VAL ap_score: 0.960697 map_score: 0.945906 Time: 396.51
Run: 77 train loss: 2.676312 Time: 1173.51
Run: 77 VAL ap_score: 0.968259 map_score: 0.955181 Time: 394.78
Run: 78 train loss: 2.764704 Time: 1149.52
Run: 78 VAL ap_score: 0.964990 map_score: 0.950622 Time: 379.35
Run: 79 train loss: 2.811356 Time: 1164.74
Run: 79 VAL ap_score: 0.955168 map_score: 0.938449 Time: 408.15
Run: 80 train loss: 3.501562 Time: 1171.29
Run: 80 VAL ap_score: 0.951675 map_score: 0.935968 Time: 397.78
Run: 81 train loss: 3.704253 Time: 1156.62
Run: 81 VAL ap_score: 0.961949 map_score: 0.943238 Time: 408.22
Run: 82 train loss: 2.962631 Time: 1141.01
Run: 82 VAL ap_score: 0.954210 map_score: 0.925753 Time: 393.89
Run: 83 train loss: 2.691698 Time: 1175.05
Run: 83 VAL ap_score: 0.967737 map_score: 0.954563 Time: 378.53
Run: 84 train loss: 7.563061 Time: 1151.74
Run: 84 VAL ap_score: 0.951158 map_score: 0.928177 Time: 395.91
Run: 85 train loss: 3.586387 Time: 1154.54
Run: 85 VAL ap_score: 0.953750 map_score: 0.937649 Time: 386.66
Run: 86 train loss: 3.548897 Time: 1154.38
Run: 86 VAL ap_score: 0.951229 map_score: 0.937928 Time: 390.83
Run: 87 train loss: 2.468619 Time: 1164.33
Run: 87 VAL ap_score: 0.963532 map_score: 0.947382 Time: 387.72
Run: 88 train loss: 2.705610 Time: 1170.82
Run: 88 VAL ap_score: 0.960448 map_score: 0.942401 Time: 386.51
Run: 89 train loss: 2.608826 Time: 1163.87
Run: 89 VAL ap_score: 0.964300 map_score: 0.954097 Time: 396.96
Run: 90 train loss: 3.597156 Time: 1152.87
Run: 90 VAL ap_score: 0.962914 map_score: 0.946063 Time: 397.61
Run: 91 train loss: 5.832971 Time: 1162.91
Run: 91 VAL ap_score: 0.963482 map_score: 0.952865 Time: 379.25
Run: 92 train loss: 2.530312 Time: 1168.75
Run: 92 VAL ap_score: 0.961027 map_score: 0.946854 Time: 384.32
Run: 93 train loss: 2.365553 Time: 1158.07
Run: 93 VAL ap_score: 0.962697 map_score: 0.949298 Time: 394.58
Run: 94 train loss: 2.578336 Time: 1142.79
Run: 94 VAL ap_score: 0.962014 map_score: 0.943171 Time: 387.47
Run: 95 train loss: 2.755198 Time: 1201.56
Run: 95 VAL ap_score: 0.945385 map_score: 0.930520 Time: 390.12
Run: 96 train loss: 2.606574 Time: 1210.33
Run: 96 VAL ap_score: 0.957569 map_score: 0.938128 Time: 401.40
Run: 97 train loss: 4.011449 Time: 1181.05
Run: 97 VAL ap_score: 0.954889 map_score: 0.935805 Time: 403.96
Run: 98 train loss: 2.615950 Time: 1192.21
Run: 98 VAL ap_score: 0.953917 map_score: 0.932865 Time: 424.91
Run: 99 train loss: 2.999248 Time: 1152.28
Run: 99 VAL ap_score: 0.962459 map_score: 0.947669 Time: 405.68
Run: 100 train loss: 2.650712 Time: 1192.02
Run: 100 VAL ap_score: 0.960965 map_score: 0.941957 Time: 407.54
Run: 101 train loss: 2.747544 Time: 1183.08
Run: 101 VAL ap_score: 0.952160 map_score: 0.927437 Time: 425.83
Run: 102 train loss: 2.787703 Time: 1191.88
Run: 102 VAL ap_score: 0.962227 map_score: 0.946933 Time: 421.26
Run: 103 train loss: 2.777153 Time: 1169.41
Run: 103 VAL ap_score: 0.938788 map_score: 0.905407 Time: 411.19
Run: 104 train loss: 6.378192 Time: 1168.75
Run: 104 VAL ap_score: 0.959593 map_score: 0.942352 Time: 427.07
Run: 105 train loss: 2.218674 Time: 1159.33
Run: 105 VAL ap_score: 0.960398 map_score: 0.942558 Time: 428.84
Run: 106 train loss: 3.124548 Time: 1154.21
Run: 106 VAL ap_score: 0.957884 map_score: 0.940785 Time: 419.62
Run: 107 train loss: 2.285854 Time: 1148.74
Run: 107 VAL ap_score: 0.959691 map_score: 0.941853 Time: 430.24
Run: 108 train loss: 2.215074 Time: 1130.27
Run: 108 VAL ap_score: 0.958421 map_score: 0.943948 Time: 431.84
Run: 109 train loss: 2.933972 Time: 1169.52
Run: 109 VAL ap_score: 0.953487 map_score: 0.931697 Time: 427.20
Run: 110 train loss: 4.356874 Time: 1179.00
Run: 110 VAL ap_score: 0.963108 map_score: 0.947630 Time: 442.02
Run: 111 train loss: 2.365998 Time: 1165.92
Run: 111 VAL ap_score: 0.960903 map_score: 0.942744 Time: 423.60
Run: 112 train loss: 2.388757 Time: 1173.62
Run: 112 VAL ap_score: 0.959134 map_score: 0.939015 Time: 428.70
Run: 113 train loss: 2.601589 Time: 1176.67
Run: 113 VAL ap_score: 0.957346 map_score: 0.940823 Time: 415.44
Run: 114 train loss: 5.527840 Time: 1151.58
Run: 114 VAL ap_score: 0.956503 map_score: 0.942988 Time: 423.29
