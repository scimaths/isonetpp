Command line
/raid/infolab/vaibhav/isonetpp/subgraph/iso_matching_models.py
--experiment_group=edge_early_clean
--TASK=edge_early_interaction
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--consistency_lambda=0
--IPLUS_LAMBDA=0
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model EdgeEarlyInteraction
This model implements early interaction for edges
saving initial model to ./edge_early_clean/initialModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
no. of params in model: 3730
Run: 0 train loss: 313.400987 Time: 1421.86
Run: 0 VAL ap_score: 0.446679 map_score: 0.476548 Time: 551.36
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 1 train loss: 240.231282 Time: 1434.23
Run: 1 VAL ap_score: 0.487402 map_score: 0.496565 Time: 565.80
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 2 train loss: 199.581902 Time: 1406.80
Run: 2 VAL ap_score: 0.533986 map_score: 0.543078 Time: 581.77
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 3 train loss: 169.977118 Time: 1421.40
Run: 3 VAL ap_score: 0.548445 map_score: 0.569562 Time: 573.99
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 4 train loss: 145.484970 Time: 1339.06
Run: 4 VAL ap_score: 0.553328 map_score: 0.582602 Time: 510.42
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 5 train loss: 127.559961 Time: 1408.85
Run: 5 VAL ap_score: 0.623972 map_score: 0.642875 Time: 624.08
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 6 train loss: 114.402693 Time: 1505.98
Run: 6 VAL ap_score: 0.626323 map_score: 0.659739 Time: 600.27
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 7 train loss: 105.196585 Time: 1472.12
Run: 7 VAL ap_score: 0.656263 map_score: 0.674697 Time: 605.35
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 8 train loss: 96.471178 Time: 1434.85
Run: 8 VAL ap_score: 0.694380 map_score: 0.703157 Time: 588.26
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 9 train loss: 90.871175 Time: 1444.90
Run: 9 VAL ap_score: 0.697652 map_score: 0.689956 Time: 588.43
Run: 10 train loss: 85.772439 Time: 1463.81
Run: 10 VAL ap_score: 0.665173 map_score: 0.683456 Time: 593.90
Run: 11 train loss: 82.372774 Time: 1475.21
Run: 11 VAL ap_score: 0.695023 map_score: 0.710918 Time: 585.56
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 12 train loss: 77.635196 Time: 1424.66
Run: 12 VAL ap_score: 0.673723 map_score: 0.690733 Time: 589.87
Run: 13 train loss: 75.981736 Time: 1458.16
Run: 13 VAL ap_score: 0.694780 map_score: 0.712121 Time: 580.61
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 14 train loss: 71.822855 Time: 1448.00
Run: 14 VAL ap_score: 0.728958 map_score: 0.734899 Time: 579.32
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 15 train loss: 71.511123 Time: 1449.56
Run: 15 VAL ap_score: 0.712338 map_score: 0.735585 Time: 596.60
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 16 train loss: 69.523369 Time: 1435.39
Run: 16 VAL ap_score: 0.711321 map_score: 0.714830 Time: 593.96
Run: 17 train loss: 66.775684 Time: 1443.03
Run: 17 VAL ap_score: 0.727561 map_score: 0.741295 Time: 592.84
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 18 train loss: 65.096169 Time: 1490.79
Run: 18 VAL ap_score: 0.705987 map_score: 0.709725 Time: 602.36
Run: 19 train loss: 64.417235 Time: 1479.71
Run: 19 VAL ap_score: 0.730874 map_score: 0.736590 Time: 579.39
Run: 20 train loss: 63.230276 Time: 1433.37
Run: 20 VAL ap_score: 0.706102 map_score: 0.749953 Time: 586.94
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 21 train loss: 61.188577 Time: 1427.06
Run: 21 VAL ap_score: 0.729123 map_score: 0.740181 Time: 592.51
Run: 22 train loss: 60.767630 Time: 1429.27
Run: 22 VAL ap_score: 0.746450 map_score: 0.755946 Time: 586.24
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 23 train loss: 58.999451 Time: 1410.66
Run: 23 VAL ap_score: 0.746751 map_score: 0.758756 Time: 599.29
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 24 train loss: 58.007781 Time: 1422.41
Run: 24 VAL ap_score: 0.727431 map_score: 0.743824 Time: 573.58
Run: 25 train loss: 57.990412 Time: 1416.26
Run: 25 VAL ap_score: 0.727657 map_score: 0.763066 Time: 566.70
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 26 train loss: 56.964438 Time: 1410.38
Run: 26 VAL ap_score: 0.754734 map_score: 0.755362 Time: 589.26
Run: 27 train loss: 56.800582 Time: 1414.12
Run: 27 VAL ap_score: 0.745622 map_score: 0.753941 Time: 572.09
Run: 28 train loss: 55.580361 Time: 1416.37
Run: 28 VAL ap_score: 0.697453 map_score: 0.735141 Time: 575.95
Run: 29 train loss: 55.122429 Time: 1406.19
Run: 29 VAL ap_score: 0.745885 map_score: 0.762040 Time: 560.36
Run: 30 train loss: 54.091418 Time: 1410.30
Run: 30 VAL ap_score: 0.705937 map_score: 0.770211 Time: 575.89
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 31 train loss: 53.422507 Time: 1380.62
Run: 31 VAL ap_score: 0.746822 map_score: 0.741817 Time: 561.42
Run: 32 train loss: 52.329244 Time: 1392.60
Run: 32 VAL ap_score: 0.743651 map_score: 0.758465 Time: 561.51
Run: 33 train loss: 51.965805 Time: 1416.49
Run: 33 VAL ap_score: 0.695350 map_score: 0.726950 Time: 559.04
Run: 34 train loss: 52.298782 Time: 1408.29
Run: 34 VAL ap_score: 0.705431 map_score: 0.736043 Time: 570.42
Run: 35 train loss: 50.365614 Time: 1393.04
Run: 35 VAL ap_score: 0.729707 map_score: 0.747733 Time: 549.74
Run: 36 train loss: 50.344752 Time: 1387.22
Run: 36 VAL ap_score: 0.743695 map_score: 0.768984 Time: 547.67
Run: 37 train loss: 50.099839 Time: 1396.28
Run: 37 VAL ap_score: 0.761824 map_score: 0.766848 Time: 561.26
Run: 38 train loss: 49.656685 Time: 1405.09
Run: 38 VAL ap_score: 0.729343 map_score: 0.762738 Time: 553.96
Run: 39 train loss: 49.185018 Time: 1394.17
Run: 39 VAL ap_score: 0.750224 map_score: 0.761028 Time: 583.25
Run: 40 train loss: 48.720408 Time: 1445.62
Run: 40 VAL ap_score: 0.757050 map_score: 0.767574 Time: 579.22
Run: 41 train loss: 48.434509 Time: 1422.26
Run: 41 VAL ap_score: 0.748974 map_score: 0.760502 Time: 574.06
Run: 42 train loss: 46.849984 Time: 1420.42
Run: 42 VAL ap_score: 0.755799 map_score: 0.772387 Time: 566.90
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 43 train loss: 47.961132 Time: 1426.36
Run: 43 VAL ap_score: 0.744636 map_score: 0.766663 Time: 571.78
Run: 44 train loss: 46.927860 Time: 1414.65
Run: 44 VAL ap_score: 0.720459 map_score: 0.764387 Time: 589.56
Run: 45 train loss: 47.214025 Time: 1410.72
Run: 45 VAL ap_score: 0.704920 map_score: 0.736070 Time: 584.31
Run: 46 train loss: 46.343149 Time: 1425.25
Run: 46 VAL ap_score: 0.740444 map_score: 0.767022 Time: 580.52
Run: 47 train loss: 46.014174 Time: 1424.27
Run: 47 VAL ap_score: 0.740301 map_score: 0.777995 Time: 552.51
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 48 train loss: 45.788606 Time: 1410.96
Run: 48 VAL ap_score: 0.764072 map_score: 0.779218 Time: 576.90
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 49 train loss: 46.162103 Time: 1473.94
Run: 49 VAL ap_score: 0.770018 map_score: 0.788089 Time: 592.71
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 50 train loss: 45.573636 Time: 1734.16
Run: 50 VAL ap_score: 0.746730 map_score: 0.771516 Time: 625.20
Run: 51 train loss: 44.382887 Time: 1635.90
Run: 51 VAL ap_score: 0.737712 map_score: 0.761131 Time: 517.02
Run: 52 train loss: 44.441511 Time: 1112.74
Run: 52 VAL ap_score: 0.750331 map_score: 0.775931 Time: 441.72
Run: 53 train loss: 44.536431 Time: 1093.51
Run: 53 VAL ap_score: 0.770143 map_score: 0.768470 Time: 409.14
Run: 54 train loss: 44.263203 Time: 1075.82
Run: 54 VAL ap_score: 0.754606 map_score: 0.779542 Time: 431.74
Run: 55 train loss: 44.367756 Time: 1088.61
Run: 55 VAL ap_score: 0.776053 map_score: 0.777704 Time: 432.96
Run: 56 train loss: 43.590587 Time: 1093.75
Run: 56 VAL ap_score: 0.769330 map_score: 0.791815 Time: 432.90
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 57 train loss: 43.292962 Time: 1040.39
Run: 57 VAL ap_score: 0.787717 map_score: 0.790131 Time: 414.39
Run: 58 train loss: 42.722703 Time: 1024.06
Run: 58 VAL ap_score: 0.760498 map_score: 0.772442 Time: 402.91
Run: 59 train loss: 43.137019 Time: 999.18
Run: 59 VAL ap_score: 0.749532 map_score: 0.790468 Time: 402.50
Run: 60 train loss: 43.100606 Time: 997.98
Run: 60 VAL ap_score: 0.788769 map_score: 0.799195 Time: 403.63
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 61 train loss: 41.866220 Time: 993.85
Run: 61 VAL ap_score: 0.795581 map_score: 0.796998 Time: 388.08
Run: 62 train loss: 41.929058 Time: 991.24
Run: 62 VAL ap_score: 0.750688 map_score: 0.765661 Time: 387.24
Run: 63 train loss: 42.534971 Time: 991.56
Run: 63 VAL ap_score: 0.783663 map_score: 0.781879 Time: 388.48
Run: 64 train loss: 41.467856 Time: 1028.14
Run: 64 VAL ap_score: 0.790887 map_score: 0.792194 Time: 386.96
Run: 65 train loss: 41.825874 Time: 1010.25
Run: 65 VAL ap_score: 0.760239 map_score: 0.784155 Time: 395.23
Run: 66 train loss: 41.005800 Time: 976.32
Run: 66 VAL ap_score: 0.775325 map_score: 0.783902 Time: 363.37
Run: 67 train loss: 41.613003 Time: 960.25
Run: 67 VAL ap_score: 0.792687 map_score: 0.793148 Time: 362.98
Run: 68 train loss: 41.660804 Time: 921.80
Run: 68 VAL ap_score: 0.784641 map_score: 0.778962 Time: 367.17
Run: 69 train loss: 42.045464 Time: 919.81
Run: 69 VAL ap_score: 0.761801 map_score: 0.792840 Time: 359.17
Run: 70 train loss: 41.376552 Time: 897.37
Run: 70 VAL ap_score: 0.782423 map_score: 0.784689 Time: 348.43
Run: 71 train loss: 40.782077 Time: 861.02
Run: 71 VAL ap_score: 0.807871 map_score: 0.806439 Time: 346.46
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 72 train loss: 41.318010 Time: 839.38
Run: 72 VAL ap_score: 0.758603 map_score: 0.775372 Time: 346.31
Run: 73 train loss: 41.013528 Time: 843.55
Run: 73 VAL ap_score: 0.790761 map_score: 0.788220 Time: 342.44
Run: 74 train loss: 40.555037 Time: 814.35
Run: 74 VAL ap_score: 0.813716 map_score: 0.803237 Time: 342.40
Run: 75 train loss: 40.220881 Time: 818.84
Run: 75 VAL ap_score: 0.791977 map_score: 0.799380 Time: 339.52
Run: 76 train loss: 40.864499 Time: 840.40
Run: 76 VAL ap_score: 0.804866 map_score: 0.802817 Time: 337.46
Run: 77 train loss: 40.141896 Time: 823.59
Run: 77 VAL ap_score: 0.797140 map_score: 0.794475 Time: 339.34
Run: 78 train loss: 40.069566 Time: 818.25
Run: 78 VAL ap_score: 0.792165 map_score: 0.799463 Time: 349.01
Run: 79 train loss: 39.574849 Time: 805.80
Run: 79 VAL ap_score: 0.801096 map_score: 0.800173 Time: 330.94
Run: 80 train loss: 39.988691 Time: 802.64
Run: 80 VAL ap_score: 0.817165 map_score: 0.802691 Time: 314.65
Run: 81 train loss: 39.232637 Time: 748.53
Run: 81 VAL ap_score: 0.778406 map_score: 0.787490 Time: 317.29
Run: 82 train loss: 39.604480 Time: 757.30
Run: 82 VAL ap_score: 0.803958 map_score: 0.792732 Time: 316.85
Run: 83 train loss: 39.396575 Time: 737.05
Run: 83 VAL ap_score: 0.805475 map_score: 0.796369 Time: 319.49
Run: 84 train loss: 39.607967 Time: 745.61
Run: 84 VAL ap_score: 0.800720 map_score: 0.789683 Time: 324.06
Run: 85 train loss: 40.082568 Time: 740.04
Run: 85 VAL ap_score: 0.801469 map_score: 0.802441 Time: 330.31
Run: 86 train loss: 39.055407 Time: 746.19
Run: 86 VAL ap_score: 0.806773 map_score: 0.800829 Time: 331.68
Run: 87 train loss: 38.785804 Time: 758.04
Run: 87 VAL ap_score: 0.787780 map_score: 0.790015 Time: 328.39
Run: 88 train loss: 38.509598 Time: 761.41
Run: 88 VAL ap_score: 0.785821 map_score: 0.785214 Time: 330.90
Run: 89 train loss: 38.707458 Time: 778.55
Run: 89 VAL ap_score: 0.807967 map_score: 0.799754 Time: 320.88
Run: 90 train loss: 39.043694 Time: 752.61
Run: 90 VAL ap_score: 0.792043 map_score: 0.799799 Time: 317.56
Run: 91 train loss: 38.444926 Time: 755.52
Run: 91 VAL ap_score: 0.817996 map_score: 0.812989 Time: 316.56
saving best validated model to ./edge_early_clean/bestValidationModels/edge_early_interaction_ptc_mm_7762_2023-12-27_16:08:48.228379
Run: 92 train loss: 38.189607 Time: 750.21
Run: 92 VAL ap_score: 0.784127 map_score: 0.779585 Time: 301.73
Run: 93 train loss: 38.452363 Time: 753.72
Run: 93 VAL ap_score: 0.802525 map_score: 0.798416 Time: 318.46
Run: 94 train loss: 37.738036 Time: 783.61
Run: 94 VAL ap_score: 0.812495 map_score: 0.803316 Time: 320.96
Run: 95 train loss: 38.246776 Time: 763.17
Run: 95 VAL ap_score: 0.776839 map_score: 0.790599 Time: 318.52
Run: 96 train loss: 37.713225 Time: 756.35
Run: 96 VAL ap_score: 0.795703 map_score: 0.798504 Time: 318.26
Run: 97 train loss: 38.120531 Time: 776.87
Run: 97 VAL ap_score: 0.785968 map_score: 0.785428 Time: 304.73
Run: 98 train loss: 38.195643 Time: 777.81
Run: 98 VAL ap_score: 0.791050 map_score: 0.799365 Time: 310.28
Run: 99 train loss: 37.764403 Time: 814.81
Run: 99 VAL ap_score: 0.779054 map_score: 0.782421 Time: 347.62
Run: 100 train loss: 38.175702 Time: 800.16
Run: 100 VAL ap_score: 0.802056 map_score: 0.803849 Time: 312.20
Run: 101 train loss: 37.110383 Time: 773.71
Run: 101 VAL ap_score: 0.815753 map_score: 0.807981 Time: 313.40
Run: 102 train loss: 37.162464 Time: 774.86
Run: 102 VAL ap_score: 0.797004 map_score: 0.800848 Time: 331.74
Run: 103 train loss: 37.746674 Time: 776.26
Run: 103 VAL ap_score: 0.795477 map_score: 0.801472 Time: 317.38
Run: 104 train loss: 37.599327 Time: 780.49
Run: 104 VAL ap_score: 0.805154 map_score: 0.803268 Time: 318.69
Run: 105 train loss: 36.965925 Time: 782.53
Run: 105 VAL ap_score: 0.810787 map_score: 0.807349 Time: 316.48
