Command line
/raid/infolab/ashwinr/isonetpp/subgraph/iso_matching_models.py
--experiment_group=gmn_match_hinge_baseline
--TASK=gmn_match_hinge_baseline
--MARGIN=0.5
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_fr
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7366
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_fr240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_fr240k_corpus_subgraphs.pkl
Loading model GMN Match Hinge baseline
saving initial model to ./gmn_match_hinge_baseline/initialModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
no. of params in model: 2050
Run: 0 train loss: 268.324839 Time: 1004.55
Run: 0 VAL ap_score: 0.407529 map_score: 0.439460 Time: 269.99
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 1 train loss: 204.894576 Time: 987.38
Run: 1 VAL ap_score: 0.445706 map_score: 0.473509 Time: 274.54
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 2 train loss: 182.924128 Time: 985.58
Run: 2 VAL ap_score: 0.484417 map_score: 0.496602 Time: 266.80
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 3 train loss: 169.376766 Time: 1003.94
Run: 3 VAL ap_score: 0.495304 map_score: 0.504842 Time: 267.85
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 4 train loss: 161.238473 Time: 990.92
Run: 4 VAL ap_score: 0.543617 map_score: 0.527575 Time: 274.54
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 5 train loss: 151.550559 Time: 1018.64
Run: 5 VAL ap_score: 0.500774 map_score: 0.514696 Time: 275.14
Run: 6 train loss: 143.001041 Time: 990.04
Run: 6 VAL ap_score: 0.542779 map_score: 0.535060 Time: 261.31
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 7 train loss: 137.306673 Time: 1013.42
Run: 7 VAL ap_score: 0.578507 map_score: 0.557272 Time: 280.95
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 8 train loss: 130.859183 Time: 1012.58
Run: 8 VAL ap_score: 0.585570 map_score: 0.574129 Time: 278.28
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 9 train loss: 127.539566 Time: 1008.14
Run: 9 VAL ap_score: 0.597663 map_score: 0.594044 Time: 279.38
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 10 train loss: 124.784803 Time: 1021.57
Run: 10 VAL ap_score: 0.607299 map_score: 0.598722 Time: 272.13
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 11 train loss: 121.373702 Time: 1008.35
Run: 11 VAL ap_score: 0.613387 map_score: 0.599424 Time: 269.17
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 12 train loss: 119.702100 Time: 1014.93
Run: 12 VAL ap_score: 0.614267 map_score: 0.601920 Time: 281.25
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 13 train loss: 117.689301 Time: 990.85
Run: 13 VAL ap_score: 0.605142 map_score: 0.594162 Time: 272.67
Run: 14 train loss: 117.492075 Time: 976.51
Run: 14 VAL ap_score: 0.606308 map_score: 0.605702 Time: 273.60
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 15 train loss: 114.681258 Time: 995.32
Run: 15 VAL ap_score: 0.598030 map_score: 0.592369 Time: 267.67
Run: 16 train loss: 113.889700 Time: 1016.62
Run: 16 VAL ap_score: 0.632003 map_score: 0.617947 Time: 278.94
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 17 train loss: 111.442265 Time: 981.26
Run: 17 VAL ap_score: 0.618569 map_score: 0.601689 Time: 262.27
Run: 18 train loss: 110.221027 Time: 972.01
Run: 18 VAL ap_score: 0.628498 map_score: 0.622004 Time: 261.16
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 19 train loss: 108.132809 Time: 949.22
Run: 19 VAL ap_score: 0.632241 map_score: 0.621654 Time: 266.41
Run: 20 train loss: 108.237156 Time: 957.91
Run: 20 VAL ap_score: 0.635848 map_score: 0.616290 Time: 262.07
Run: 21 train loss: 105.511334 Time: 945.59
Run: 21 VAL ap_score: 0.629636 map_score: 0.616642 Time: 259.55
Run: 22 train loss: 104.448724 Time: 891.52
Run: 22 VAL ap_score: 0.646895 map_score: 0.632541 Time: 254.95
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 23 train loss: 102.507926 Time: 899.61
Run: 23 VAL ap_score: 0.656502 map_score: 0.639472 Time: 259.15
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 24 train loss: 101.280116 Time: 894.13
Run: 24 VAL ap_score: 0.654813 map_score: 0.637909 Time: 251.87
Run: 25 train loss: 101.080851 Time: 893.69
Run: 25 VAL ap_score: 0.655897 map_score: 0.641669 Time: 252.09
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 26 train loss: 99.220564 Time: 898.22
Run: 26 VAL ap_score: 0.643748 map_score: 0.632039 Time: 254.39
Run: 27 train loss: 98.929936 Time: 901.83
Run: 27 VAL ap_score: 0.644825 map_score: 0.622952 Time: 254.57
Run: 28 train loss: 98.492709 Time: 900.81
Run: 28 VAL ap_score: 0.655714 map_score: 0.638830 Time: 258.05
Run: 29 train loss: 96.903054 Time: 996.08
Run: 29 VAL ap_score: 0.669915 map_score: 0.652086 Time: 340.20
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 30 train loss: 95.774593 Time: 1067.35
Run: 30 VAL ap_score: 0.653449 map_score: 0.627323 Time: 271.08
Run: 31 train loss: 95.823454 Time: 1143.29
Run: 31 VAL ap_score: 0.645431 map_score: 0.620972 Time: 337.89
Run: 32 train loss: 95.328003 Time: 1165.00
Run: 32 VAL ap_score: 0.660591 map_score: 0.642053 Time: 306.27
Run: 33 train loss: 94.454101 Time: 1251.18
Run: 33 VAL ap_score: 0.673754 map_score: 0.647066 Time: 343.35
Run: 34 train loss: 93.003772 Time: 1296.96
Run: 34 VAL ap_score: 0.673068 map_score: 0.656614 Time: 271.78
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 35 train loss: 93.094921 Time: 903.07
Run: 35 VAL ap_score: 0.659979 map_score: 0.646269 Time: 257.70
Run: 36 train loss: 91.879198 Time: 906.67
Run: 36 VAL ap_score: 0.667464 map_score: 0.639266 Time: 259.50
Run: 37 train loss: 91.479863 Time: 918.38
Run: 37 VAL ap_score: 0.679639 map_score: 0.657689 Time: 258.56
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 38 train loss: 90.458330 Time: 903.49
Run: 38 VAL ap_score: 0.660301 map_score: 0.638053 Time: 257.96
Run: 39 train loss: 90.165627 Time: 911.58
Run: 39 VAL ap_score: 0.670683 map_score: 0.649353 Time: 258.57
Run: 40 train loss: 88.908770 Time: 889.83
Run: 40 VAL ap_score: 0.667142 map_score: 0.658822 Time: 253.61
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 41 train loss: 88.764879 Time: 878.15
Run: 41 VAL ap_score: 0.681416 map_score: 0.662027 Time: 250.84
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 42 train loss: 88.712315 Time: 875.80
Run: 42 VAL ap_score: 0.678315 map_score: 0.657045 Time: 252.67
Run: 43 train loss: 87.648885 Time: 856.52
Run: 43 VAL ap_score: 0.655183 map_score: 0.639643 Time: 252.52
Run: 44 train loss: 88.619255 Time: 879.37
Run: 44 VAL ap_score: 0.693710 map_score: 0.675789 Time: 253.57
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 45 train loss: 86.619069 Time: 875.50
Run: 45 VAL ap_score: 0.686543 map_score: 0.664393 Time: 254.38
Run: 46 train loss: 87.493012 Time: 877.33
Run: 46 VAL ap_score: 0.679440 map_score: 0.656891 Time: 252.88
Run: 47 train loss: 86.288714 Time: 877.00
Run: 47 VAL ap_score: 0.691001 map_score: 0.669429 Time: 252.78
Run: 48 train loss: 85.817787 Time: 872.49
Run: 48 VAL ap_score: 0.686951 map_score: 0.661484 Time: 251.09
Run: 49 train loss: 85.639647 Time: 878.04
Run: 49 VAL ap_score: 0.702376 map_score: 0.682405 Time: 251.64
saving best validated model to ./gmn_match_hinge_baseline/bestValidationModels/gmn_match_hinge_baseline_ptc_fr_7366_2024-01-21_04:39:53.141277
Run: 50 train loss: 85.748803 Time: 877.55
Run: 50 VAL ap_score: 0.678611 map_score: 0.663219 Time: 254.51
Run: 51 train loss: 84.477528 Time: 890.94
Run: 51 VAL ap_score: 0.675851 map_score: 0.657834 Time: 263.64
Run: 52 train loss: 84.480646 Time: 900.50
Run: 52 VAL ap_score: 0.691792 map_score: 0.662033 Time: 269.45
Run: 53 train loss: 84.848542 Time: 897.65
Run: 53 VAL ap_score: 0.680506 map_score: 0.656149 Time: 268.12
Run: 54 train loss: 83.873463 Time: 898.28
Run: 54 VAL ap_score: 0.700485 map_score: 0.672988 Time: 253.93
