Command line
/mnt/home/vaibhavraj/isonetpp/subgraph/iso_matching_models.py
--experiment_group=nanl_clean
--TASK=node_align_node_loss
--time_updates=3
--NOISE_FACTOR=0
--MARGIN=0.5
--filters_1=10
--filters_2=10
--filters_3=10
--transform_dim=16
--FEAT_TYPE=One
--DATASET_NAME=ptc_mm
--consistency_lambda=0
--IPLUS_LAMBDA=0
--no_of_query_subgraphs=300
--MIN_QUERY_SUBGRAPH_SIZE=5
--MAX_QUERY_SUBGRAPH_SIZE=15
--MIN_CORPUS_SUBGRAPH_SIZE=16
--MAX_CORPUS_SUBGRAPH_SIZE=20
fringe_isonet= {'masking_for_msg_passing_count': 4}
encoder= {'node_hidden_sizes': [10], 'node_feature_dim': 1, 'edge_hidden_sizes': None, 'edge_feature_dim': 1}
aggregator= {'node_hidden_sizes': [10], 'graph_transform_sizes': [10], 'input_size': [10], 'gated': True, 'aggregation_type': 'sum'}
graph_embedding_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'embedding'}
graph_matching_net= {'node_state_dim': 10, 'edge_hidden_sizes': [20], 'node_hidden_sizes': [10], 'n_prop_layers': 5, 'share_prop_params': True, 'edge_net_init_scale': 0.1, 'node_update_type': 'gru', 'use_reverse_direction': True, 'reverse_dir_param_different': False, 'layer_norm': False, 'prop_type': 'matching', 'similarity': 'dotproduct'}
model_type= embedding
data= {'problem': 'graph_edit_distance', 'dataset_params': {'n_nodes_range': [20, 20], 'p_edge_range': [0.2, 0.2], 'n_changes_positive': 1, 'n_changes_negative': 2, 'validation_dataset_size': 1000}}
training= {'batch_size': 128, 'learning_rate': 0.0001, 'mode': 'pair', 'loss': 'margin', 'margin': 0.5, 'graph_vec_regularizer_weight': 1e-06, 'clip_value': 10.0, 'n_training_steps': 500000, 'print_after': 100, 'eval_after': 10}
evaluation= {'batch_size': 128}
seed= 7762
early_interaction= {'n_time_updates': 3, 'time_update_idx': 'k_t', 'prop_separate_params': None}
node_early_interaction_interpretability= {'lambd': 1.0}
loading train query graphs from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_query_subgraphs.pkl
loading train relationships from ./velugoti_dataset/Datasets/splits/train/train_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
loading val query graphs from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_query_subgraphs.pkl
loading val relationships from ./velugoti_dataset/Datasets/splits/val/val_ptc_mm240k_rel_nx_is_subgraph_iso.pkl
loading corpus graphs from ./velugoti_dataset/Datasets/splits/ptc_mm240k_corpus_subgraphs.pkl
Loading model NodeAlignNodeLoss
This uses GMN encoder followed by parameterized sinkhorn with LRL and similarity computation using hinge scoring (H_q, PH_c)
saving initial model to ./nanl_clean/initialModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
no. of params in model: 1868
Run: 0 train loss: 316.725182 Time: 378.74
Run: 0 VAL ap_score: 0.460764 map_score: 0.486351 Time: 174.53
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 1 train loss: 189.212648 Time: 366.58
Run: 1 VAL ap_score: 0.525313 map_score: 0.544828 Time: 162.12
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 2 train loss: 162.549802 Time: 378.14
Run: 2 VAL ap_score: 0.547028 map_score: 0.558202 Time: 170.19
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 3 train loss: 151.147916 Time: 370.08
Run: 3 VAL ap_score: 0.559070 map_score: 0.575466 Time: 162.63
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 4 train loss: 142.041193 Time: 378.65
Run: 4 VAL ap_score: 0.554020 map_score: 0.561347 Time: 172.03
Run: 5 train loss: 135.406392 Time: 363.79
Run: 5 VAL ap_score: 0.567374 map_score: 0.575959 Time: 161.47
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 6 train loss: 131.088827 Time: 379.62
Run: 6 VAL ap_score: 0.575659 map_score: 0.593431 Time: 165.41
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 7 train loss: 126.608335 Time: 363.28
Run: 7 VAL ap_score: 0.582775 map_score: 0.590473 Time: 163.73
Run: 8 train loss: 123.070532 Time: 383.58
Run: 8 VAL ap_score: 0.582437 map_score: 0.596182 Time: 168.83
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 9 train loss: 118.093295 Time: 361.00
Run: 9 VAL ap_score: 0.592198 map_score: 0.606308 Time: 166.83
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 10 train loss: 115.468139 Time: 380.91
Run: 10 VAL ap_score: 0.585883 map_score: 0.611830 Time: 170.74
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 11 train loss: 113.545526 Time: 365.45
Run: 11 VAL ap_score: 0.589367 map_score: 0.604336 Time: 166.54
Run: 12 train loss: 110.921121 Time: 374.39
Run: 12 VAL ap_score: 0.591798 map_score: 0.608050 Time: 162.87
Run: 13 train loss: 109.729068 Time: 362.98
Run: 13 VAL ap_score: 0.612333 map_score: 0.627934 Time: 169.27
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 14 train loss: 107.933843 Time: 375.24
Run: 14 VAL ap_score: 0.614984 map_score: 0.637118 Time: 162.11
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 15 train loss: 105.977106 Time: 363.46
Run: 15 VAL ap_score: 0.604972 map_score: 0.634776 Time: 167.35
Run: 16 train loss: 104.814524 Time: 378.83
Run: 16 VAL ap_score: 0.591182 map_score: 0.620484 Time: 165.18
Run: 17 train loss: 102.845886 Time: 365.34
Run: 17 VAL ap_score: 0.597400 map_score: 0.628686 Time: 167.38
Run: 18 train loss: 101.235105 Time: 377.51
Run: 18 VAL ap_score: 0.605689 map_score: 0.639421 Time: 168.99
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 19 train loss: 99.607300 Time: 364.54
Run: 19 VAL ap_score: 0.583876 map_score: 0.650385 Time: 170.94
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 20 train loss: 98.567718 Time: 373.28
Run: 20 VAL ap_score: 0.607379 map_score: 0.648218 Time: 167.73
Run: 21 train loss: 97.069681 Time: 367.61
Run: 21 VAL ap_score: 0.599824 map_score: 0.639672 Time: 170.91
Run: 22 train loss: 96.247802 Time: 375.35
Run: 22 VAL ap_score: 0.620023 map_score: 0.655579 Time: 164.40
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 23 train loss: 95.561043 Time: 368.94
Run: 23 VAL ap_score: 0.624836 map_score: 0.658445 Time: 171.51
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 24 train loss: 95.163441 Time: 373.96
Run: 24 VAL ap_score: 0.647410 map_score: 0.667858 Time: 163.37
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 25 train loss: 94.106431 Time: 367.45
Run: 25 VAL ap_score: 0.580492 map_score: 0.627590 Time: 168.10
Run: 26 train loss: 93.681265 Time: 374.69
Run: 26 VAL ap_score: 0.611297 map_score: 0.663079 Time: 164.81
Run: 27 train loss: 92.428666 Time: 365.73
Run: 27 VAL ap_score: 0.642068 map_score: 0.664849 Time: 174.84
Run: 28 train loss: 91.142370 Time: 368.13
Run: 28 VAL ap_score: 0.626442 map_score: 0.664794 Time: 171.27
Run: 29 train loss: 91.261092 Time: 360.68
Run: 29 VAL ap_score: 0.622506 map_score: 0.667763 Time: 178.37
Run: 30 train loss: 90.418379 Time: 368.88
Run: 30 VAL ap_score: 0.626592 map_score: 0.649701 Time: 161.93
Run: 31 train loss: 88.833010 Time: 369.19
Run: 31 VAL ap_score: 0.644957 map_score: 0.664310 Time: 171.10
Run: 32 train loss: 88.388022 Time: 364.90
Run: 32 VAL ap_score: 0.659551 map_score: 0.665311 Time: 163.46
Run: 33 train loss: 87.533967 Time: 371.18
Run: 33 VAL ap_score: 0.646623 map_score: 0.673613 Time: 167.19
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 34 train loss: 88.180620 Time: 368.77
Run: 34 VAL ap_score: 0.649858 map_score: 0.675156 Time: 169.55
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 35 train loss: 86.941879 Time: 370.90
Run: 35 VAL ap_score: 0.635939 map_score: 0.670197 Time: 174.73
Run: 36 train loss: 86.964388 Time: 369.44
Run: 36 VAL ap_score: 0.604949 map_score: 0.656676 Time: 165.01
Run: 37 train loss: 85.136998 Time: 370.83
Run: 37 VAL ap_score: 0.634229 map_score: 0.675135 Time: 174.13
Run: 38 train loss: 85.270072 Time: 366.75
Run: 38 VAL ap_score: 0.642457 map_score: 0.653529 Time: 166.11
Run: 39 train loss: 84.645477 Time: 366.88
Run: 39 VAL ap_score: 0.640597 map_score: 0.672273 Time: 174.16
Run: 40 train loss: 83.684808 Time: 359.55
Run: 40 VAL ap_score: 0.638050 map_score: 0.654164 Time: 165.67
Run: 41 train loss: 83.113195 Time: 370.74
Run: 41 VAL ap_score: 0.646709 map_score: 0.686987 Time: 169.20
saving best validated model to ./nanl_clean/bestValidationModels/node_align_node_loss_ptc_mm_7762_2023-12-27_00:40:46.343219
Run: 42 train loss: 83.614541 Time: 364.38
Run: 42 VAL ap_score: 0.662356 map_score: 0.663090 Time: 167.59
Run: 43 train loss: 83.549183 Time: 373.90
Run: 43 VAL ap_score: 0.649991 map_score: 0.678724 Time: 168.03
Run: 44 train loss: 82.557409 Time: 364.42
Run: 44 VAL ap_score: 0.657547 map_score: 0.678101 Time: 161.06
Run: 45 train loss: 82.514325 Time: 377.88
Run: 45 VAL ap_score: 0.623042 map_score: 0.676246 Time: 165.70
Run: 46 train loss: 81.873057 Time: 371.74
Run: 46 VAL ap_score: 0.639119 map_score: 0.679746 Time: 168.66
Run: 47 train loss: 80.983660 Time: 375.96
Run: 47 VAL ap_score: 0.673963 map_score: 0.678121 Time: 168.67
Run: 48 train loss: 80.677047 Time: 367.69
Run: 48 VAL ap_score: 0.644277 map_score: 0.675406 Time: 171.31
Run: 49 train loss: 80.459658 Time: 371.47
Run: 49 VAL ap_score: 0.677765 map_score: 0.680847 Time: 170.56
Run: 50 train loss: 80.795965 Time: 361.15
Run: 50 VAL ap_score: 0.670502 map_score: 0.679631 Time: 170.33
Run: 51 train loss: 80.906988 Time: 377.01
Run: 51 VAL ap_score: 0.677316 map_score: 0.680545 Time: 163.66
Run: 52 train loss: 80.092563 Time: 367.22
Run: 52 VAL ap_score: 0.665436 map_score: 0.679708 Time: 164.84
Run: 53 train loss: 80.092071 Time: 378.80
Run: 53 VAL ap_score: 0.660060 map_score: 0.672413 Time: 166.68
Run: 54 train loss: 79.160213 Time: 367.49
Run: 54 VAL ap_score: 0.657731 map_score: 0.662604 Time: 163.57
Run: 55 train loss: 78.077388 Time: 375.75
Run: 55 VAL ap_score: 0.643915 map_score: 0.680000 Time: 162.80
Run: 56 train loss: 78.629955 Time: 368.96
Run: 56 VAL ap_score: 0.640867 map_score: 0.679887 Time: 167.04
Run: 57 train loss: 78.838566 Time: 369.06
Run: 57 VAL ap_score: 0.678701 map_score: 0.686695 Time: 164.44
Run: 58 train loss: 77.763141 Time: 369.46
Run: 58 VAL ap_score: 0.664385 map_score: 0.678027 Time: 169.12
Run: 59 train loss: 78.061471 Time: 370.31
Run: 59 VAL ap_score: 0.644341 map_score: 0.678856 Time: 167.53
